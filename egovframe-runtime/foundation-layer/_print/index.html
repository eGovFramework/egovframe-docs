<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=ko class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://eGovFramework.github.io/egovframe-docs/egovframe-runtime/foundation-layer/><link rel=alternate type=application/rss+xml href=https://eGovFramework.github.io/egovframe-docs/egovframe-runtime/foundation-layer/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/egovframe-docs/favicons/favicon.ico><link rel=apple-touch-icon href=/egovframe-docs/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/egovframe-docs/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/egovframe-docs/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/egovframe-docs/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/egovframe-docs/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/egovframe-docs/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/egovframe-docs/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/egovframe-docs/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/egovframe-docs/favicons/android-192x192.png sizes=192x192><title>공통기반 | 표준프레임워크 개발가이드</title><meta name=description content="공통기반 서비스는 실행환경 서비스 간에 공통적으로 사용되는 기능을 제공한다."><meta property="og:title" content="공통기반"><meta property="og:description" content="공통기반 서비스는 실행환경 서비스 간에 공통적으로 사용되는 기능을 제공한다."><meta property="og:type" content="website"><meta property="og:url" content="https://eGovFramework.github.io/egovframe-docs/egovframe-runtime/foundation-layer/"><meta itemprop=name content="공통기반"><meta itemprop=description content="공통기반 서비스는 실행환경 서비스 간에 공통적으로 사용되는 기능을 제공한다."><meta name=twitter:card content="summary"><meta name=twitter:title content="공통기반"><meta name=twitter:description content="공통기반 서비스는 실행환경 서비스 간에 공통적으로 사용되는 기능을 제공한다."><link rel=preload href=/egovframe-docs/scss/main.min.91a6c15c7b322e5048cc8b945675ac980b8d9488c3d6a4487f1aacf27b341387.css as=style integrity="sha256-kabBXHsyLlBIzIuUVnWsmAuNlIjD1qRIfxqs8ns0E4c=" crossorigin=anonymous><link href=/egovframe-docs/scss/main.min.91a6c15c7b322e5048cc8b945675ac980b8d9488c3d6a4487f1aacf27b341387.css rel=stylesheet integrity="sha256-kabBXHsyLlBIzIuUVnWsmAuNlIjD1qRIfxqs8ns0E4c=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/egovframe-docs/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="60" height="25" viewBox="0 0 60 25" enable-background="new 0 0 60 25"><image id="image0" width="60" height="25" x="0" y="0" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAZCAYAAABtnU33AAAAIGNIUk0AAHomAACAhAAA+gAAAIDo AAB1MAAA6mAAADqYAAAXcJy6UTwAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAAHCAAABwgAc0P m54AAAHcelRYdFJhdyBwcm9maWxlIHR5cGUgeG1wAAA4jYVUQZLjIAy86xX7BCyBBM/x2vg2VXPc 528Lj23imIypOAlI6lZLiP59fdMffywlksWyzJZ1taCrJos6cfD/umg18TNZmXXSqJuyJpn3/dN6 Y+ZAVxhs/nWXlOOaAocouhkcOYhyldA+LDXMHHyBAiO4ypw4Rop6w98PnUO2iBVkBuZm7eFqMOLa IIw3maT44o0kCGOD8V73IPgWKwgL2pZ5dQA/vrjcGcWoiUxUsFFaagUqVDD8MYAuDGwo4QwhxEug flmmXlRX6j2pxqheYuM31NMV6WZwDp4gV6Tmqn/CuqBQpQzWDwpqpRHa4bTj/Q7Xp+Ya6TPeMLkf H6/aiXevylmbXbs5elESVIle/ORBN12kxgZADSHEAmaTmqbUjDVakaXJ+THIBU099inmnAIaIsN1 QZ87fVwHT3BvEKlorAl9s1xa0u9OzwlfoH6VdKFGVXBhJwiYgDX1OIfZ3eo9OA1TKo8pCa7UC9Dh QSOXQQWPFplT9rJY4+uXiE4sa5e3JTY2H8PQDac8Ow5gOmv6jPMKE30KlSZBbD11wACAeoSR4X0O 8dZPon0QUT+J+jF6Gfsgjepne6/fJ7yf0H9Fc2ZpNW51UwAAAAFvck5UAc+id5oAAAyuSURBVFjD tZd/kFXlecc/z3vOub932R/sroKC+GuUNWOMxNq0UTDGtqZ2iHLXSttEO9GkMaBi0KBWz4yGKKBW MU0wWm20Gu9V04mGaJoWNErjTMyodRGMCkXk18ICu3vv3XvPed+nf5zLdTUSTWd8/rrz3vf5/X3e 53uEg4iCCKiGoV/N5UvWpL846tgZYc4+4qpv/KZULHoD5bLlo4kkJpEr79p4U0PNYRFBPRZPrZdq U5EH7/9a7+piseSVywMf1eb/S8xB/wlDDyDOZhfncvkvGhG68oU+8YIVAMVy2X10N5qYBMEEA5m2 7i+ZVPZiCTKXZDt6L1AvfxJA/9eL8nEme9CEVVUkDGMNw5wPC+rVmoucfXxftbo14wdzNtzy/VkC WiqWvD/E2Q2gLq5X65W9uEalro1aLaqOQlyLANY+83Gne7AOl8vJeS59GoX8oTG6pHPx5edF2pgf O0fg+58DKPav/4M6IqCIZF0cXaeWs1SjYlzbNxdTfQxg7Q18rHBuiSqiYehrKemYhqEPoLcsXam3 3Dw8sTBvLv/+T19f8YOnAA7cL5VKXqlU8hSVxJ5KGIYtnTAMjWry3+UrN7yx8I7XPvMBQUgYqglD NcWStpBTLKk3O1Q/VJ1gTw2qUiypN3uN+gfOZq9Rn6aflr427xw41+RBeddvGBptBqvLlv5al918 H8C2cFUO4M1bV/3D67fes/6Arr7PAe+z9365fOWGNxbc+dpZAMVQU8WSemGoH4y099ueUMT3Hr9P v6k3sUgHzn0B1SuuyNJrvozz3pRrw/94t8sy3Vq9C6Cyp24BnHOvOTFT7gvvy0h40TgirF7x8LyG pHNzR195kDB0K1Y8MVnEZq+8cu7bAN9c/nQ+Q6b3psWnbxIRRV3y4M0s2/LAgC0Dl6zSYLT2alfQ OaMPguN/+OX0I4jo/Ef0bAmY5Rz//vA8eQWg+IROHd/24t7sMSfPNgHd4WflgeJzOo0051Pj/rLI ULGkXihiz12vp0mKT+Yq3PuASMUHoFeuor09ZHS8pt++5lS5dukr+FEfmsp6gQwCHN09bAF8MTsw fPeiwXwE8F/LH/6CpHPldJDjUU5Oz4MftAeFeRjvTGAeQFv+sNMUWQR8/j0AKAOogGjsV3uCrpk3 K5r3M965F96nTzdSHGsCfprtg8puzv+b1frH/3a2jPiTWFhoO7mi8HW/QF/xGX1OUiyZdAwXj2ym C1hSHhBbfFlnkOLx7DS6a9s5FFhiNLyiC1jE6Kglm83iy6UApII+RKNq3W1thucAqmPb3zpm0cXX 0tyXnmcWe2Ko1WvgyRIAEXYrfKKVWBzNxNlsE1YeSAK1/n5vdrjWAzBOLS7+I+DMOMIN79ptTYqF QRYqu9iZmsRMjfgzAI3pULgMoU9jMFmuxzC3ugPU59ziOs0CSJ5LU510V7fSUI8F52zTyYa0zMHz 2omjM6jUVoH5SwCMX0BMdXRvamTifJchHgxLKYB1t5WmisjplVrlqnocXZRJZ2c8tOKJ46oavWyt y4S3r+lIcrSHW9f4bXPChdjVAMphf2NtOCcGiP2hOnF9Mi4OVHm6Z8bkADirMcpyN86nGiNUCDgF AItNF+jSmIvjOqvTBS6UmJ81xrhcLMeSZmrzjSnWhyjbKqegpFLCGQZ1c4jj5+W6O56Fxp2o69Tv fKsTKx5o9Owp08cBJAydhKELw9CVWR8nJbCnOBdXRj1z13lXnnf/WK06hO+fftnedZsQCXJeqjsp nswA2doMwuH7c7+yctP5f3/X1ku+9N0d5wNUqvkYY7rE2mUP/q2cXYuYpkpK4O4fXSDbVPmxWo5K 7FFojLD1kc/JPQKPGw8M3FqeJXeoYcSl6CgOahcRU5yw/McnyMuiPIVltg8cj2MNAI3RzWRyO8Ec iYhDiQcGEuhuCsNMLZjUORZEWqlmfGCr4vpFzEsDiwZqSSDml9a6WYThKr1zzngGexjwpjjXh3hv NoES+blJi/xGDOl2XKO+fXaoj6XsG0YlXxMv9RyASdEhhu3eyOatAGLYqMKpAEZJOeFFADyGasNU x/bwdnNF7DQWY1Ic5YSdsWNDcx5fEDjdAL3gXkm6eHcVka2Im0KMA2nRx47C5FO60unVPabjsSnt bY/oJZcEqmaKYN6Y8OoPGt+fBqCOvc7pIclMmy5PzJbkDooqB+gmzhlYi/opT1THrB3fBmCj0Vdd Lb6skj8i2e0+Qy0/BhHDFgCx1DC8k6sykpijhsE6y2HA2z85TkYB1ON/ROj2MWRxpkdvvPx4rESA Qbx2PG8IXFAqlbyBgQHre9Lb0dbxyd3jlv2x440pJ2RB2xXd0XqcjG4Toa05qztQmZb81sx4VNnS 7IAfVffdHpvMC7aytwPj718bzokvWLXNQ0zN82QM4OH57buBnwMUS9ojDS5E2JZkjGCTBNUjwjBW HhDbtO9EUevTIUBxUI82jiCK6NEMOR9LBt+sQPwKGEfg91KP/5nAWZTg0+vXB4CtxI3h4eHdG+sS jNclOPKQbE13iRac2tFW5R37LS4H4JS3ReSQS5e+0I0qLura2VxCxsCj9yyYsW4iJ/Bd1Sidsai2 6GWxpD0BXE+Gc7LdTK/u4cEWmBxRsgEAf4IhRVA8YqzfxqlRiuedjzFCHscOgxDgeVlEJoP0kk6B ZwIaOoqScZlMGqCvsv/ZadWFM0cqlTNFZF/d5lOqIqJNxwl0K5iEhqp4mx3a11Uw01DGll19XFIY FVWhkCQ0mDpADaGAINaZbGuM0sKNuT6+YQzTa8NYkfewuIMzugBUcV4GROjFMNlkyBKQ9wGlES1H vI04k2bfSBui63B+HTWpI/2gA9hfHhzUgTJuwy22HunEgr7Ls521aTV+M2C32Yj3p77I0SC7AIrF YpMje807g3bt7JluYgrGJfaK/zLaA8yv7aGhyo2aJhA4sdVFg3IQcXWctJGvD7EeuBmPSbaKMRnG fUTqiHlElqx4caKShmEXqYyN43g68L/F/n6hXKbhnC8eopmMqkpdkGwrXl8KojQSqOkW57m88fRE p7oFoL+/X/bye0QF6yedC/KF44E2tZz3UFEen/8zXai2Cd4P+UZzHk4ED58N5WPlgfeMDmgdOBZ4 URcsSNPX/gni4C0Jw2Fd9p2Kb7yTgGc59FABGDEmngR2hBHEFIaNSFcrYZVeI94YgDPRDicZ3ygn OMxLyY3TSbj0QZojkPKa6TiORNj40IA8nhSQTuTDUgUENYJxMXvF4zAAQjXnXcQRAjMMKrtReziA rFxZJx38Ezkzt1nx1yPVLwBs304A0O3au0Wksyedblhrh6zT6a0GOXeUdfFugP37h3cZ8WIDJyE2 YVl8+Be+jcYFQIQOYNeERA4X/QgJJ8XyPOUdHIfOXqM+oTiT5lTy3GkQeQvjfRpAl17ajXUnYt22 ppNfBL7/+XduuvXwKeFXqwBeynwrG6Tah4bAiWwUNTMP+DHGnGSEjQBhODAWq42DVHqauOB1gJmD g+p+93PyYNIAJrWKqcxCmuPyAcho3UsWfMqk2IRPd/dUEl4Q8yfSYLcBXYdyjl51VRu0z0U0j+HV RDv+OX7ApLRZtXnZ7Z/auuJ73875qa/WosaW/vDSMeuiV8Qz059c9vBnH13xxHGeMbOc8N/vejfb nIup22gHwPr+cvKu/x7xgow2A9+B4ehiSbvml/TkdIETEcYPwLal4L9XXwSnAekfHS1vozgR/q7Z 9aIanjeoWYvnpenkKYwsR+Q3cnW4VcPQyNXX/Tpu1J/PZ3N/kcH7paLXpIMUTu33AKan92+0qls8 P/VDMe5R51y1YeVXrXyFbXHUGB0JOnclXUdVcU4PNsRY6yVfZR68BuRShkfJ8K+NMRoqpJpttKJJ 0qKoKO++9IoVkvFDeVYM/zhvk/6n30aPGFYbuebW9Vj7JB3tn6GQ78Tq3QDs2RMA1CGs1KrkAj9X SGfYW6k8s2Hsnds0VHPMwoX12LpV3ZO6jujp6OlXdfd+ZdGfD4fhmgyAOnaKMSMrFx5Tb4VjTJsY 0+xLsRVn7ItgTBsJK+eBv5bXEH5VmMocEWYgXI9wLIB6pNWQaSLBP7DXk7miYEyz745VfgEvM5Uz 4iovlnvluabjYAH7RgW8DeWjfnsvgKxc2dAwNLJ48S/2rbi9WI/tgnpcHxwRc/1AGDZKxUEP4J2x 6m2RDM+oi1cYrlduABgcHIoAnPKkWvvWhElTQa+II/cqQLmIownxeLQxEnjRlZkev7W5NOabY9tZ rsq9keUhvy3hzy7mLt8k1NJPsb4Rc21Lx3Jd7HgJoHyc/GTe63pTVOWv1ONrAP8HnXv5+VCzqmwA AACWZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBMQAC AAAAEQAAAFqHaQAEAAAAAQAAAGwAAAAAAAAASAAAAAEAAABIAAAAAUFkb2JlIEltYWdlUmVhZHkA AAADoAEAAwAAAAEAAQAAoAIABAAAAAEAAAA8oAMABAAAAAEAAAAZAAAAAAcgI+gAAAAldEVYdGRh dGU6Y3JlYXRlADIwMjQtMTItMTVUMDk6MjE6MTErMDA6MDDm9w0tAAAAJXRFWHRkYXRlOm1vZGlm eQAyMDI0LTEyLTE1VDA5OjIxOjExKzAwOjAwl6q1kQAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAy NC0xMi0xNVQwOToyMToxMSswMDowMMC/lE4AAAATdEVYdGV4aWY6Q29sb3JTcGFjZQAxLCCMM8Ni AAAAFXRFWHRleGlmOkV4aWZPZmZzZXQAMTA4LCDt5R1PAAAAGXRFWHRleGlmOlBpeGVsWERpbWVu c2lvbgA2MCwgoYmFBAAAABl0RVh0ZXhpZjpQaXhlbFlEaW1lbnNpb24AMjUsIJHbC1AAAAAedEVY dGV4aWY6U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkefmo5qwAAAASdEVYdHRpZmY6T3JpZW50YXRp b24AMber/DsAAAAQdEVYdHhtcDpDb2xvclNwYWNlADEFDsjRAAAAIHRFWHR4bXA6Q3JlYXRvclRv b2wAQWRvYmUgSW1hZ2VSZWFkeSr/T6AAAAAXdEVYdHhtcDpQaXhlbFhEaW1lbnNpb24AMjE2rgMn zQAAABZ0RVh0eG1wOlBpeGVsWURpbWVuc2lvbgAzMG6tL6oAAAAASUVORK5CYII="/></svg></span><span class=navbar-brand__name>표준프레임워크 개발가이드</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/egovframe-docs/egovframe-development/><span>개발환경(예정)</span></a></li><li class=nav-item><a class="nav-link active" href=/egovframe-docs/egovframe-runtime/><span>실행환경</span></a></li><li class=nav-item><a class=nav-link href=/egovframe-docs/runtime-example/><span>실행환경 예제</span></a></li><li class=nav-item><a class=nav-link href=/egovframe-docs/common-component/><span>공통컴포넌트(예정)</span></a></li><li class="td-light-dark-menu nav-item dropdown"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg><button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown data-bs-display=static aria-label="Toggle theme (auto)"><svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=bd-theme-text><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false><svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false><svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true><svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></li></ul></div><div class="d-none d-lg-block"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>이 섹션의 다중 페이지 출력 화면임.
<a href=# onclick="return print(),!1">여기를 클릭하여 프린트</a>.</p><p><a href=/egovframe-docs/egovframe-runtime/foundation-layer/>이 페이지의 일반 화면으로 돌아가기</a>.</p></div><h1 class=title>공통기반</h1><div class=lead>공통기반 서비스는 실행환경 서비스 간에 공통적으로 사용되는 기능을 제공한다.</div><ul><li>1: <a href=#pg-4f5a3aafccabd58c3b01bfeac55d34a5>Server Security Service</a></li><li>2: <a href=#pg-f93a384e582d6ad5bc6660ad4ea3e585>Architecture</a></li><li>3: <a href=#pg-b0adb3388dd2ff0658b7959af5061642>Authentication</a></li><li>4: <a href=#pg-4a23d6b5276209a1e7bc4f8cc0f89a6a>Authorization</a></li><li>5: <a href=#pg-36756ce3ff134d7c8747f4fc93a1a03b>설정 간소화</a></li><li>6: <a href=#pg-43b28134c738d893f2783ad0ef8f13d7>Server Security 업그레이드</a></li><li>7: <a href=#pg-3c7e75834c2954205666e8083709828e>Session 방식 접근제어 권한설정</a></li><li>8: <a href=#pg-b95fdbf4211d3a6b3f813f5b8072da13>Scheduling 서비스</a></li><li>9: <a href=#pg-ce3eb8e3fa2fd62a032dd09d0704977a>Logging</a></li><li>10: <a href=#pg-1d19dcf3da2b3672cf478149df4edb13>SLF4J</a></li><li>11: <a href=#pg-06230004c0b9e521ccf3412b4600ddcc>Log4j2</a></li><li>12: <a href=#pg-093515f1aea69abc53e8a6111faf5ba8>Log4j 2 환경설정 (코드 내에서 직접 설정 시)</a></li><li>13: <a href=#pg-7c64b27e2b9c65b360dcee88dfcd8959>Log4j 2 환경설정 (설정 파일 사용 시)</a></li><li>14: <a href=#pg-873e8aee6851d9defe18d5318375c4ea>Id Generation 서비스</a></li><li>15: <a href=#pg-ed65074198e9c6ea1b6512924e35cf7f>Property</a></li><li>16: <a href=#pg-75f53001d45aa5ab4bbec0f5902a1e78>Property Service</a></li><li>17: <a href=#pg-7ac4088d3e9e9bd3b6a413622ed0bc69>Property Source</a></li><li>18: <a href=#pg-0fa8fe95609d5a31fe5b8d4849bae91e>Environment</a></li><li>19: <a href=#pg-7c2a46d9ea16ca5fa9efa63966f2d0d6>Cache Service</a></li><li>20: <a href=#pg-cc5466f92b441fa89a1d6f77abf6d366>EhCache</a></li><li>21: <a href=#pg-9d59ad3d457799d79e6b66ebd9c22c8f>Cache Abstraction</a></li><li>22: <a href=#pg-b6b0beb973ec1663ffc23dab63bad20e>Marshalling/Unmarshallig 서비스</a></li><li>23: <a href=#pg-f2fa98b6113670e3960783cd6a21c139>XML Manipulation Service</a></li><li>24: <a href=#pg-7c3001300ac721267c952903b511f5c8>Object Pooling Service</a></li><li>25: <a href=#pg-84c2fb373aae4cd68c3c5492c4ab3b68></a></li><li>26: <a href=#pg-61d529344b33b9334e383405abfd7356>Encryption/Decryption Service</a></li><li>27: <a href=#pg-b1405ccc47f742a5c71d53d85d4d1251>Crypto 간소화 서비스</a></li><li>28: <a href=#pg-e086468a93ab6c492f08115014a8f597>FTP Service</a></li><li>29: <a href=#pg-7f2afaabbb1c4dc1cf2e636f4e61cbb5>Mail 서비스</a></li><li>30: <a href=#pg-ec0d8ed21d02034b674e59129d4279ec>Compress/Decompress Service</a></li><li>31: <a href=#pg-94023eb3edf6dc77385ba876d0a09a45>압축 파일의 종류</a></li><li>32: <a href=#pg-c2b94522480c18c5837e202209c61411>File Upload/Download 서비스</a></li><li>33: <a href=#pg-f71855a42083daa14eb35bd2ff9a44a9>File Upload Service</a></li><li>34: <a href=#pg-8998679c03b5ede655abd4d93e0cd464>Spring mvc Multipart Multi file upload 지원 문제</a></li><li>35: <a href=#pg-3df8eb811559145f371e10cdef440c86>File Download Service</a></li><li>36: <a href=#pg-8bb315c720fa1ab79f7343724d863de4>Tomcat 한글 설정하기</a></li><li>37: <a href=#pg-8d079c8cc0e72c9a0744b0f6a3d6a3a1>File Handling</a></li><li>38: <a href=#pg-3ede9acf599a89c19ffb34a721b03d69>Excel Service</a></li><li>39: <a href=#pg-3fac5957c584f8f9d6af21400598019b>String Util Service</a></li></ul><div class=content><h1 id=공통기반>공통기반</h1><p>공통기반 서비스는 실행환경 서비스 간에 공통적으로 사용되는 기능을 제공한다.</p></div></div><div class=td-content><h1 id=pg-4f5a3aafccabd58c3b01bfeac55d34a5>1 - Server Security Service</h1><div class=lead>Server Security Service는 Spring Security를 확장하여 사용자 인증과 권한 관리를 DB 기반으로 처리하며, 세션 관리도 지원한다. Spring Security는 인증, 권한 처리, 웹 및 서비스 레이어 보안을 제공하는 강력한 솔루션이지만 사용자 관리와 역할 관리에서 일부 취약점을 가진다. 표준프레임워크 3.0에서는 설정 간소화 기능과 Map 기반 UserDetails로 손쉬운 사용자 정보 관리가 가능해졌으며, 업그레이드 가이드를 통해 최신 보안 기능을 적용할 수 있다.</div><h1 id=server-security-service>Server Security Service</h1><h2 id=개요>개요</h2><p>웹을 통해 데이터를 주고받는 업무를 진행할 경우, 보안상의 문제가 발생하기 쉽다.<br>Security Service는 웹을 통한 서비스 이용 시 발생할 수 있는 다양한 보안상의 취약점들을 사전에 인지하고 대응함으로써, 서비스의 안정성을 확보한다.<br>Security Service는 사용자 정보를 DB에서 관리하여 인증을 거쳐야만 접근할 수 있는 <strong>Authentication</strong>과 사용자 권한 정보를 계층화시켜서 화면 및 페이지, 또는 메소드에 접근할 수 있는 <strong>Authorization</strong>이 포함된다.</p><h2 id=설명>설명</h2><p>Server Security Service는 Spring Framework의 Spring Security를 확장하여 구현하였으며, 사용자 인증정보 및 권한정보를 DB에서 관리하고, Spring Security의 UserDetails 인터페이스를 확장하여 세션정보를 담을 수 있다.<br>Server Security의 주요기능은 다음과 같다.</p><ul><li>자원(url, method 등) 접근 제한</li><li>사용자 인증 확인</li><li>미인증시 인증확인 요청</li><li>계층적 권한 설정 및 사용자 권한 확인</li></ul><h3 id=spring-security-강점>Spring Security 강점</h3><ul><li>Spring Security 는 엔터프라이즈 어플리케이션을 위한 인증(Authentication), 권한 처리(Authorization) 서비스를 제공하는 강력하고 유연한 보안 솔루션이다.</li><li>Servlet Filter 와 Java AOP 를 통하여 보안을 강제하며 Spring의 IoC 의 lifecycle 기반으로 동작한다.</li><li>authentication, Web URL authorization, Method 호출 authorization, 도메인 객체 기반의 security 처리, 채널 보안(https 강제) 등의 주요 기능을 제공한다.</li><li>Web request 보안에 더하여 Service Layer 및 인스턴스 수준의 보안 제공으로 Layering issue 해결 및 웹 클라이언트 외의 다양한 rich 클라이언트/웹서비스에 대한 보안 제어를 지원한다.</li><li>재사용성, 이식성, 코드 품질, 레퍼런스 (정부,은행,대학,기업 등 많은 business field), 다양한 타 프레임워크를 지원하며 community가 활성화 되어있다.</li></ul><h3 id=spring-security-기능-취약-부분>Spring Security 기능 취약 부분</h3><ul><li>사용자관리 기능</li><li>역할 관리 기능</li><li>XML 기반(설정 어려움)의 권한 체크</li></ul><h3 id=si-프로젝트의-보안인증권한처리의-일반적인-요구사항>SI 프로젝트의 보안.인증/권한처리의 일반적인 요구사항</h3><ul><li>RDB 기반의 인증 또는 상용 SSO 연계</li><li>사용자 정보의 쉽고 빠른 참조를 위한 session 사용</li><li>부서, 사용자 및 메뉴/화면/권한 관리 - 개발자가 아닌 최종 사용자가 GUI 기반 관리 기능을 통해 작업하기를 원함</li><li>계층 구조의 부서관리, 사용자 관리, 권한 복제, 권한 상속, 프로젝트 업무 규모에 따른 방대한 사용자/역할 데이터의 관리 필요</li><li>Portal solution / X-internet 도입 등 - 사용자관리/메뉴-권한 처리에 대한 유연한 통합(integration) 필요</li><li>부서/사용자/메뉴/화면/권한처리 등 각 프로젝트별 요구사항이 유사하면서도 달라 중복개발의 위험성 - 일반 업무보다 난이도가 높은 공통 업무 성격. 표준화, 손쉬운 customizing, 유연한 확장이 필요</li></ul><h3 id=기대효과>기대효과</h3><ul><li>전자정부개발프레임워크의 Server Security에서 Spring Security 강점과 SI 프로젝트 활용성을 두루 갖춘 유연하고 강력한 Security 프레임워크를 확보할 수 있다.</li></ul><h3 id=표준프레임워크-30-변경사항>표준프레임워크 3.0 변경사항</h3><ul><li>설정간소화 기능(XML Schema 기반)을 통하여 기존 복잡한 설정을 단순화할 수 있다.</li><li>Map 기반의 UserDetails 사용을 통해 손쉬운 사용자정보 관리가 가능하다.</li></ul><h3 id=server-security>Server Security</h3><ul><li><a href="https://www.egovframe.go.kr//wiki/doku.php?id=egovframework:rte4.2:fdl:server_security:architecture">architecture</a></li><li><a href="https://www.egovframe.go.kr//wiki/doku.php?id=egovframework:rte4.2:fdl:server_security:authentication">Authentication</a></li><li><a href="https://www.egovframe.go.kr//wiki/doku.php?id=egovframework:rte4.2:fdl:server_security:authorization">Authorization</a></li><li><a href="https://www.egovframe.go.kr//wiki/doku.php?id=egovframework:rte4.2:fdl:server_security:xmlschema">설정 간소화</a></li></ul><h3 id=server-security-업그레이드-가이드>Server Security 업그레이드 가이드</h3><ul><li><a href="https://www.egovframe.go.kr//wiki/doku.php?id=egovframework:rte4.2:fdl:server_security:upgrade">업그레이드</a></li></ul><h2 id=참고자료>참고자료</h2><ul><li><a href=https://spring.io/projects/spring-security>Spring Framework-Spring Security</a></li><li><a href=https://docs.spring.io/spring-security/reference/5.8/index.html>Spring Framework-Spring Security Reference Documentation</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-f93a384e582d6ad5bc6660ad4ea3e585>2 - Architecture</h1><div class=lead>전자정부 개발프레임워크의 Spring Security는 DB 기반의 실시간 인증을 사용하며, 주요 구성요소로 Scheduler, Job, JobDetail, Trigger가 있다. Security 설정은 DelegatingFilterProxy를 통해 모든 웹 요청을 관리하며, 사용자 테이블과 권한 테이블을 포함한 여러 테이블이 보안 정보 관리에 사용된다. Spring과 Quartz의 통합으로 스케줄링된 작업을 관리하며, 다양한 설정 파일을 통해 자원과 역할을 보호한다.</div><h1 id=architecture>Architecture</h1><h2 id=개요>개요</h2><p>전자정부 개발프레임워크의 Spring Security 기본구조와 기본 환경 설정을 설명한다.<br>전자정부 개발프레임워크의 Server Security는 컨테이너 기동시 적용되는 XML기반 인증이 아닌 실시간 적용되는 DB기반의 JDBC 인증을 사용한다.</p><h2 id=설명>설명</h2><h3 id=spring-security-아키텍처>Spring Security 아키텍처</h3><h4 id=웹어플리케이션-인증절차>웹어플리케이션 인증절차</h4><p><img src=../images/server_security_%ec%9b%b9%ec%96%b4%ed%94%8c%eb%a6%ac%ec%bc%80%ec%9d%b4%ec%85%98_%ec%9d%b8%ec%a6%9d%ec%a0%88%ec%b0%a8_wbg.png alt=image></p><ul><li><p>리소스 요청</p></li><li><p>요청에 대해 보호되고 있는 자원인지 판단</p></li><li><p>아직 인증이 안되었으므로 HTTP 응답코드(오류) 또는 특정 페이지로 redirect</p></li><li><p>인증 메커니즘에 따라 웹 페이지 로그인 폼 또는 X509 인증서</p></li><li><p>입력 폼의 내용을 HTTP post 또는 인증 세부사항을 포함하는 HTTP 헤더를 서버로 요청</p></li><li><p>신원정보(credential)가 유효한지 판단</p></li><li><p>유효한 경우 다음단계 진행</p></li><li><p>유효하지 않을 경우 신원정보 재요청(되돌아감)</p></li><li><p>보호 자원의 접근 권한이 있을 경우 요청 성공 / 접근 권한이 없을 경우 forbidden 403 HTTP 오류</p></li></ul><h4 id=spring-security-filter-chain>Spring Security Filter Chain</h4><p><img src=../images/server_security_filterchain%ed%9d%90%eb%a6%84_wbg.png alt="server security Filter Chain 흐름"></p><p><img src=../images/server_security_filterchain%ed%9d%90%eb%a6%84_http%ec%9a%94%ec%b2%ad_wbg.png alt="server security Filter Chain 흐름 (HTTP요청)"></p><p><img src=../images/server_security_authenticationprocessingfilter_wbg.png alt="server security Authentication Processing Filter"></p><ul><li>Spring Security에서 생성한 정보 - SecurityContextHoler를 이용하여 SecurityContext 얻음</li><li>응용프로그램이 분산되어 있는 경우 등 다양한 환경에서 사용 가능토록 SecurityContext를 SecurityContextHolder 내부에 생성한 ThreadLocal 객체를 이용하여 저장하고 있음.</li><li>ThreadLocal 객체는 현재 쓰레드에서 필요한 상태 정보만 담을 수 있음.</li><li>웹 환경에서 요청이 있을때 마다 동일한 역할을 하는 SecurityContext를 다시 생성하는 것은 맞지 않음 → httpSessionContextIntegrationFilter 를 사용하여 SecurityContext 정보를 ThreadLocal에 기록하고 가져오는 작업을 수행함. (Session 에 저장)</li></ul><h3 id=security-configuration>Security Configuration</h3><h4 id=필수라이브러리>필수라이브러리</h4><ul><li>spring-security-core-2.0.4.jar</li><li>spring-security-taglibs-2.0.4.jar</li></ul><h4 id=webxml-등록>web.xml 등록</h4><ul><li>org.springframework.web.filter.DelegatingFilterProxy 등록 : Application Context에 Spring bean으로 등록된 필터 구현체를 대표하는 Spring Framework 클래스이다.</li><li>모든 웹요청이 Spring Security의 DelegatingFilterProxy로 전달되도록 한다.</li><li>DelegatingFilterProxy는 웹요청이 서로 다른 URL 패턴에 근거하여 서로 다른 필터로 전달될 수 있도록 해주는 일반적으로 사용할 수 있는 클래스이다.</li><li>이런 위임된 필터들은 어플리케이션 컨텍스트 내에서 관리되며, 따라서 의존성 주입의 이점을 누릴 수 있다.</li></ul><h5 id=example>example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;filter&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;filter-name&gt;</span>springSecurityFilterChain<span style=color:#204a87;font-weight:700>&lt;/filter-name&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span style=color:#204a87;font-weight:700>&lt;/filter-class&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/filter&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;filter-mapping&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;filter-name&gt;</span>springSecurityFilterChain<span style=color:#204a87;font-weight:700>&lt;/filter-name&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;url-pattern&gt;</span>/*<span style=color:#204a87;font-weight:700>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/filter-mapping&gt;</span>
</span></span></code></pre></div><h4 id=주요테이블>주요테이블</h4><p>사용자 인증과 관련된 테이블은 사용자테이블과 사용자권한테이블이며 사용자권한관련 테이블은 역할, 자원, 역할계층 등의 테이블이 있다.</p><p><img src=../images/server_security_custom_security_db_schema.png alt=image></p><p>DaoAuthenticationProvidor</p><h5 id=사용자-테이블>사용자 테이블</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>USERS</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>USERNAME</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>PASSWORD</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>ENABLED</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>BIT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PK_USERS</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>USERNAME</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><ul><li>필수 필드 : USERNAME(사용자 ID), PASSWORD(사용자 암호), ENABLED(계정 사용여부)</li><li>나머지 필드 : 세션처리를 위해 사용자 테이블의 나머지 정보를 사용한다. (예. 주민등록번호, 주소, 생일 ..)</li></ul><h5 id=사용자-권한-테이블>사용자 권한 테이블</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AUTHORITIES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>USERNAME</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>AUTHORITY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PK_AUTHORITIES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>USER_ID</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>AUTHORITY</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>FK_USERS</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>USER_ID</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>REFERENCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>USERS</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>USER_ID</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>FK_ROLES3</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>AUTHORITY</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>REFERENCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ROLES</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>AUTHORITY</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><ul><li>필수 필드 : USER_ID(사용자 ID), AUTHORITY(권한)</li></ul><h5 id=역할-테이블>역할 테이블</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ROLES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>AUTHORITY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>ROLE_NAME</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>DESCRIPTION</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>CREATE_DATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>DATE</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>MODIFY_DATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>DATE</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PK_ROLES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>AUTHORITY</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><table><thead><tr><th>AUTHORITY</th><th>DESCRIPTION</th></tr></thead><tbody><tr><td>IS_AUTHENTICATED_ANONYMOUSLY</td><td>익명 사용자</td></tr><tr><td>IS_AUTHENTICATED_REMEMBERED</td><td>REMEMBERED 사용자</td></tr><tr><td>IS_AUTHENTICATED_FULLY</td><td>인증된 사용자</td></tr><tr><td>ROLE_RESTRICTED</td><td>제한된 사용자</td></tr><tr><td>ROLE_USER</td><td>일반 사용자</td></tr><tr><td>ROLE_ADMIN</td><td>관리자</td></tr><tr><td>ROLE_A</td><td>A 업무</td></tr><tr><td>ROLE_B</td><td>B 업무</td></tr></tbody></table><h5 id=역할-계층-테이블>역할 계층 테이블</h5><p>역할의 계층구조를 저장하는 테이블</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ROLES_HIERARCHY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>PARENT_ROLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>CHILD_ROLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PK_ROLES_HIERARCHY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>PARENT_ROLE</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>CHILD_ROLE</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>FK_ROLES1</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>PARENT_ROLE</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>REFERENCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ROLES</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>AUTHORITY</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>FK_ROLES2</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>CHILD_ROLE</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>REFERENCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ROLES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>AUTHORITY</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><table><thead><tr><th>CHILD_ROLE</th><th>PARENT_ROLE</th></tr></thead><tbody><tr><td>ROLE_ADMIN</td><td>ROLE_USER</td></tr><tr><td>ROLE_USER</td><td>ROLE_RESTRICTED</td></tr><tr><td>ROLE_RESTRICTED</td><td>IS_AUTHENTICATED_FULLY</td></tr><tr><td>IS_AUTHENTICATED_FULLY</td><td>IS_AUTHENTICATED_REMEMBERED</td></tr><tr><td>IS_AUTHENTICATED_REMEMBERED</td><td>IS_AUTHENTICATED_ANONYMOUSLY</td></tr><tr><td>ROLE_ADMIN</td><td>ROLE_A</td></tr><tr><td>ROLE_ADMIN</td><td>ROLE_B</td></tr><tr><td>ROLE_A</td><td>ROLE_RESTRICTED</td></tr><tr><td>ROLE_B</td><td>ROLE_RESTRICTED</td></tr></tbody></table><h5 id=보호된-자원-테이블>보호된 자원 테이블</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SECURED_RESOURCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>RESOURCE_ID</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>RESOURCE_NAME</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>RESOURCE_PATTERN</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>300</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>DESCRIPTION</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>RESOURCE_TYPE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>SORT_ORDER</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>INTEGER</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>CREATE_DATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>DATE</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>MODIFY_DATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>DATE</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PK_RECURED_RESOURCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>RESOURCE_ID</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>url, method, pointcut으로 자원을 보호한다.</p><table><thead><tr><th>RESOURCE_ID</th><th>RESOURCE_PATTERN</th></tr></thead><tbody><tr><td>web-000001</td><td>\A/test\.do\Z</td></tr><tr><td>web-000002</td><td>\A/sale/.*\.do\Z</td></tr><tr><td>web-000003</td><td>\A/cvpl/((?!EgovCvplLogin\.do).)*\Z</td></tr><tr><td>mtd-000001</td><td>egovframework.rte.sample.service.EgovSampleService.updateSample</td></tr><tr><td>mtd-000002</td><td>egovframework.rte.sample.service.EgovSampleService.deleteSample</td></tr><tr><td>mtd-000003</td><td>execution(* egovframework.rte.sample..service.*Service.insert*(..))</td></tr></tbody></table><h5 id=보호된-자원-역할-테이블>보호된 자원 역할 테이블</h5><p>보호된 자원과 역할과의 매핑 테이블</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SECURED_RESOURCES_ROLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>RESOURCE_ID</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#000>AUTHORITY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>50</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PK_SECURED_RESOURCES_ROLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>RESOURCE_ID</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>AUTHORITY</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>FK_SECURED_RESOURCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>RESOURCE_ID</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>REFERENCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SECURED_RESOURCES</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>RESOURCE_ID</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>	</span><span style=color:#204a87;font-weight:700>CONSTRAINT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>FK_ROLES4</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FOREIGN</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>AUTHORITY</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>REFERENCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ROLES</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>AUTHORITY</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=참고자료>참고자료</h2></div><div class=td-content style=page-break-before:always><h1 id=pg-b0adb3388dd2ff0658b7959af5061642>3 - Authentication</h1><div class=lead>전자정부 표준프레임워크의 인증은 DB 기반의 JDBC 인증을 사용하며, Spring Security의 <code>AuthenticationManager</code>와 <code>AuthenticationProvider</code>를 설정하여 사용한다. 최소한의 환경설정으로 XML 또는 DB에서 사용자 정보를 관리할 수 있으며, JDBC 인증을 통해 사용자 정보와 권한을 쿼리로 관리한다. 또한, 세션 관리를 통해 사용자 세션을 확장하고, 동시 세션 제어를 통해 동일한 ID로의 동시 접속을 제한할 수 있다.</div><h1 id=authentication>Authentication</h1><h2 id=개요>개요</h2><p>허락된 사용자에게만 공개되는 컨텐츠(정보 또는 기능)에 접근하기 위해 반드시 아이디와 암호를 입력하는 로그인 과정을 거치는데 이러한 과정이 인증(authentication)이다.<br>즉, 인증은 특정 사용자가 유효한 사용자인지를 판단하는 과정을 의미한다.<br>본 가이드에서는 인증을 위한 기본적인 환경 및 전자정부 표준프레임워크에서 사용된 인증 방법을 설명한다.</p><h2 id=설명>설명</h2><p>전자정부 표준프레임워크의 인증은 XML기반의 인증이 아닌 DB기반의 JDBC인증을 사용한다.<br>기본적인 인증 메커니즘은 인증 주체가 인증을 시도하는 초기에 오직 한 번만 인증 메커니즘이 사용되며 그 이후로는 인증 메커니즘이 정보를 필터에 유지하여 요구되는 요청을 필터 체인상의 다음 필터로 전달하기만 한다.<br>Spring Security에서 제공하는 인증을 사용하기 위해서는 AuthenticationManager와 실제 인증에 대한 정보를 제공하는 AuthenticationProvider의 설정이 필요하다.<br>AuthenticationManager는 요청을 AuthenticationProvider 체인에 전달해야 할 임무가 있다.<br>AuthenticationProvider는 기본적으로 UserDetails와 UserDetailsService인터페이스를 이용한다.<br>UserDetailsService 인터페이스 내 loadUserByUsername 메소드의 리턴된 UserDetails은 사용자명(username), 패스워드(password), 허가권한(GrantedAuthority[]) 및 사용여부(enabled)와 같은 기초적인 인증 정보들을 제공한다.<br>이에 전자정부 표준프레임워크에서는 UserDetails 인터페이스를 확장하였으며 JDBC 기반으로 사용자 테이블로부터 사용자 정보를 Map 또는 VO형태로 사용할 수 있도록 하였다.</p><h3 id=최소환경설정>최소환경설정</h3><p>최소환경설정으로 사용자 인증을 설정하는 예제이다.</p><h5 id=configuration>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;http&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;intercept-url</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;/**&#34;</span> <span style=color:#c4a000>access=</span><span style=color:#4e9a06>&#34;ROLE_USER&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;form-login</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;logout</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/http&gt;</span>
</span></span></code></pre></div><ul><li><intercept-url>은 여러 개를 정의할 수 있으며, 위에서부터 차례로 해당되는 url pattern이 적용된다. 정규식을 사용하여 접근 url을 정의한다. “access”속성은 접근할 수 있는 사용자 권한을 나타낸다.</li><li><form-login>을 지정하지 않을 경우나 기본 형식(<form-login>)으로 등록된 경우 Spring Security에서 제공하는 기본 로그인 폼을 사용한다.</li></ul><p>인증요청을 처리하기 위해 authentication manager가 xml(또는 DB, LDAP 등)에 정의된 사용자 정보를 사용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;authentication-manager&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;authentication-provider&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;user-service&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;user</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;jimi&#34;</span> <span style=color:#c4a000>password=</span><span style=color:#4e9a06>&#34;jimispassword&#34;</span> <span style=color:#c4a000>authorities=</span><span style=color:#4e9a06>&#34;ROLE_USER, ROLE_ADMIN&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;user</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;bob&#34;</span> <span style=color:#c4a000>password=</span><span style=color:#4e9a06>&#34;bobspassword&#34;</span> <span style=color:#c4a000>authorities=</span><span style=color:#4e9a06>&#34;ROLE_USER&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/user-service&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/authentication-provider&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/authentication-manager&gt;</span>
</span></span></code></pre></div><ul><li>user-service : 사용자 정보(사용자 ID, 사용자 암호, 권한 등)를 얻어오는 서비스</li></ul><h3 id=jdbc-인증>JDBC 인증</h3><p>표준프레임워크에서는 JdbcUserDetailsManager(org.springframework.security.provisioning)를 통해 인증 처리 부분을 JDBC 방식으로 확장하였다.</p><p>관련된 설정은 다음과 같이 지정한다.</p><h5 id=configuration-1>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;authentication-manager&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;authentication-provider</span> <span style=color:#c4a000>user-service-ref=</span><span style=color:#4e9a06>&#34;jdbcUserService&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;password-encoder</span> <span style=color:#c4a000>hash=</span><span style=color:#4e9a06>&#34;sha-256&#34;</span> <span style=color:#c4a000>base64=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/authentication-provider&gt;</span>		
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/authentication-manager&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;jdbcUserService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.userdetails.jdbc.EgovJdbcUserDetailsManager&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;usersByUsernameQuery&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,PASSWORD,ENABLED,USER_NAME,BIRTH_DAY,SSN FROM USERS WHERE USER_ID = ?&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;authoritiesByUsernameQuery&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,AUTHORITY FROM AUTHORITIES WHERE USER_ID = ?&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mapClass&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.userdetails.EgovUserDetailsMapping&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><ul><li>usersByUsernameQuery : 사용자 인증을 위한 query로 처음 3개 column은 인증시 사용되는 정보로 각각 user id, 패스워드, 활성화 여부를 나타낸다. 나머지 column의 경우 인증시에는 사용되지 않지만, 지정된 mapClass에 의해 사용되어 인증된 사용자 정보라 이후 참조될 수 있다.</li><li>authoritiesByUsernameQuery : 인증된 사용자에게 부여되는 role(authorites)로 user id와 부여된 authority 2개의 column 지정이 필요하다.</li></ul><p>※ 기타 설정들은 하단 “세션관리” 참조</p><h3 id=http-form-인증-메카니즘>HTTP Form 인증 메카니즘</h3><p>HTTP 폼 인증은 AuthenticationProcessingFilter를 이용하여 로그인 폼을 처리하는 것을 수반한다.<br>HTTP 폼 인증은 어플리케이션에서 가장 널리 사용되는 최종 사용자에 대한 인증 방법이다.<br>로그인 폼은 단순히 j_username과 j_password 입력 필드를 포함하며, 필터에 의해 모니터링되고 있는 URL로 게시한다.기본값은 j_spring_security_check 이다.</p><h3 id=기타-인증>기타 인증</h3><p>BASIC 인증<br>다이제스트 인증<br>익명 인증<br>Remember-Me 인증<br>X509 인증<br>LDAP 인증<br>CAS 인증<br>컨테이너 어댑터 인증</p><h3 id=sample-configuration>Sample Configuration</h3><h5 id=web-security-service>WEB Security service</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;/css/＊＊&#34;</span> <span style=color:#c4a000>security=</span><span style=color:#4e9a06>&#34;none&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>    
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;/images/＊＊&#34;</span> <span style=color:#c4a000>security=</span><span style=color:#4e9a06>&#34;none&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;/js/＊＊&#34;</span> <span style=color:#c4a000>security=</span><span style=color:#4e9a06>&#34;none&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;A/WEB-INF/jsp/.*Z&#34;</span> <span style=color:#c4a000>request-matcher=</span><span style=color:#4e9a06>&#34;regex&#34;</span> <span style=color:#c4a000>security=</span><span style=color:#4e9a06>&#34;none&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span> 	
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>access-denied-page=</span><span style=color:#4e9a06>&#34;/system/accessDenied.do&#34;</span> <span style=color:#c4a000>request-matcher=</span><span style=color:#4e9a06>&#34;regex&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;form-login</span> <span style=color:#c4a000>login-processing-url=</span><span style=color:#4e9a06>&#34;/j_spring_security_check&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>authentication-failure-url=</span><span style=color:#4e9a06>&#34;/cvpl/EgovCvplLogin.do?login_error=1&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>default-target-url=</span><span style=color:#4e9a06>&#34;/index.jsp?flag=L&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>login-page=</span><span style=color:#4e9a06>&#34;/cvpl/EgovCvplLogin.do&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;anonymous/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;logout</span> <span style=color:#c4a000>logout-success-url=</span><span style=color:#4e9a06>&#34;/cvpl/EgovCvplLogin.do&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- for authorization --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;custom-filter</span> <span style=color:#c4a000>before=</span><span style=color:#4e9a06>&#34;FILTER_SECURITY_INTERCEPTOR&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;filterSecurityInterceptor&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/http&gt;</span>
</span></span></code></pre></div><ul><li>&lt;http> 설정으로 허용된 사용자만 접근이 가능하게 할 수 있다.</li><li>&lt;form-login> 을 지정할 경우 개발자가 직접 지정한 로그인 화면 등을 지정할 수 있다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;authentication-manager&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;authentication-provider</span> <span style=color:#c4a000>user-service-ref=</span><span style=color:#4e9a06>&#34;jdbcUserService&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;password-encoder</span>  <span style=color:#c4a000>hash=</span><span style=color:#4e9a06>&#34;sha-256&#34;</span> <span style=color:#c4a000>base64=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/authentication-provider&gt;</span>		
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/authentication-manager&gt;</span>
</span></span></code></pre></div><ul><li>사용자 정보(사용자 ID, 사용자 암호, 권한 등)를 얻어오는 기능은 jdbcUserService 에서 담당한다.</li><li>password-encoder : 저장된 패스워드의 암호화 알고리즘은 sha-256를 사용한다.</li></ul><h5 id=jdbc-user-service>JDBC User Service</h5><p>사용자 정보를 얻어오는 <strong>user service</strong>를 DB에 저장된 사용자 정보를 이용하여 인증할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;jdbc-user-service</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;jdbcUserService&#34;</span> <span style=color:#c4a000>data-source-ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>users-by-username-query=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,PASSWORD,ENABLED,BIRTH_DAY FROM USERS WHERE USER_ID = ?&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>authorities-by-username-query=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,AUTHORITY FROM AUTHORITIES WHERE USER_ID = ?&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h5 id=sample-source>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;form</span> <span style=color:#c4a000>action=</span><span style=color:#4e9a06>&#34;&lt;s:url value=&#39;/j_spring_security_check&#39;/&gt;&#34;</span> <span style=color:#c4a000>method=</span><span style=color:#4e9a06>&#34;POST&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;table&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;tr&gt;&lt;td&gt;</span>User:<span style=color:#204a87;font-weight:700>&lt;/td&gt;&lt;td&gt;&lt;input</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#39;text&#39;</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#39;j_username&#39;</span><span style=color:#204a87;font-weight:700>&gt;&lt;/td&gt;&lt;/tr&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;tr&gt;&lt;td&gt;</span>Password:<span style=color:#204a87;font-weight:700>&lt;/td&gt;&lt;td&gt;&lt;input</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#39;password&#39;</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#39;j_password&#39;</span><span style=color:#204a87;font-weight:700>&gt;&lt;/td&gt;&lt;/tr&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;tr&gt;&lt;td</span> <span style=color:#c4a000>colspan=</span><span style=color:#4e9a06>&#39;2&#39;</span> <span style=color:#c4a000>align=</span><span style=color:#4e9a06>&#34;center&#34;</span><span style=color:#204a87;font-weight:700>&gt;&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;로그인&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			         <span style=color:#ce5c00>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span style=display:flex><span>                                         <span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;reset&#34;</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;reset&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;취소&#34;</span><span style=color:#204a87;font-weight:700>&gt;&lt;/td&gt;&lt;/tr&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/table&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/form&gt;</span>
</span></span></code></pre></div><h3 id=세션관리>세션관리</h3><p>Security Service의 세션 기능은 Spring Security의 JdbcUserDetailsManager 인터페이스를 확장하여 EgovJdbcUserDetailsManager 클래스를 구현하였으며<br>기본 테이블에 기재된 username, password, enabled 필드 외에 다른 사용자 정보를 추가하여 세션정보를 관리할 수 있다.</p><h4 id=세션설정>세션설정</h4><h5 id=configuration-2>Configuration</h5><p>세션 기능을 사용하기 위해서는 JDBC 인증의 환경설정 부분을 전자정부 개발프레임워크 Server Security의 환경으로 수정해야한다.<br>변경전(사용안함)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;jdbc-user-service</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;jdbcUserService&#34;</span> <span style=color:#c4a000>data-source-ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>users-by-username-query=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,PASSWORD,ENABLED FROM USERS WHERE USER_ID = ?&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>authorities-by-username-query=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,AUTHORITY FROM AUTHORITIES WHERE USER_ID = ?&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>변경후(사용)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;jdbcUserService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.userdetails.jdbc.EgovJdbcUserDetailsManager&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;usersByUsernameQuery&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,PASSWORD,ENABLED,USER_NAME,BIRTH_DAY,SSN FROM USERS WHERE USER_ID = ?&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;authoritiesByUsernameQuery&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,AUTHORITY FROM AUTHORITIES WHERE USER_ID = ?&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mapClass&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.userdetails.EgovUserDetailsMapping&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><ul><li>class : egovframework.rte.fdl.security.userdetails.jdbc.EgovJdbcUserDetailsManager</li><li>usersByUsernameQuery : 사용자 인증을 위해 사용자 테이블에서 사용자정보를 조회한다.</li><li>authoritiesByUsernameQuery : 사용자 인증을 위해 사용자권한 테이블에서 사용자권한정보를 조회한다.</li><li>roleHierarchy : 역할의 계층적 관리를 위해 계층 역할을 설정한다.</li><li>mapClass : 세션 사용을 위한 세션 쿼리 및 세션 VO 간의 매핑 클래스를 설정한다.</li><li>dataSource : JDBC 서비스를 위한 dataSource를 설정한다.</li></ul><h5 id=vo-class-ex>VO Class (ex)</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovUserDetailsVO</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>userId</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>passWord</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>userName</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>ssn</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>lsYn</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>birthDay</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Integer</span> <span style=color:#000>age</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>cellPhone</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>addr</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getUserId</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>userId</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setUserId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>userId</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>userId</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>userId</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getPassWord</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>passWord</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setPassWord</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>passWord</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>passWord</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>passWord</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getUserName</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>userName</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setUserName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>userName</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>userName</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>userName</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getSsn</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ssn</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setSsn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>ssn</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ssn</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ssn</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>.</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>.</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>.</span>
</span></span></code></pre></div><h5 id=mapping-class>Mapping Class</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovUserDetailsMapping</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>EgovUsersByUsernameMapping</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>EgovUserDetailsMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DataSource</span> <span style=color:#000>ds</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>usersByUsernameQuery</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ds</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>usersByUsernameQuery</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Object</span> <span style=color:#000>mapRow</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ResultSet</span> <span style=color:#000>rs</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>rownum</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>SQLException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>userid</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>rs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;user_id&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>password</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>rs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;password&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>enabled</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>rs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBoolean</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;enabled&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>username</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>rs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;user_name&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>birthDay</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>rs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;birth_day&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>ssn</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>rs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;ssn&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>EgovUserDetailsVO</span> <span style=color:#000>userVO</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>EgovUserDetailsVO</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>userVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setUserId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>userid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>userVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setPassWord</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>userVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setUserName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>username</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>userVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setBirthDay</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>birthDay</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>userVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSsn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ssn</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>EgovUserDetails</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>userid</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>enabled</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>userVO</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>EgovUsersByUsernameMapping 클래스 상속</li><li>mapRow 메소드 재정의</li><li>ResultSet 클래스에서 작성된 VO로 데이터 매핑</li><li>VO 객체를 EgovUserDetails(userid, password, enabled, userVO) 에 담아서 리턴</li></ul><h4 id=세션사용>세션사용</h4><h5 id=세션-가져오기>세션 가져오기</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>egovframework.rte.fdl.security.userdetails.util.EgovUserDetailsHelper</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>.</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>.</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>.</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>EgovUserDetailsVO</span> <span style=color:#000>user</span> <span style=color:#ce5c00;font-weight:700>=</span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovUserDetailsVO</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>EgovUserDetailsHelper</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAuthenticatedUser</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;jimi&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>		<span style=color:#000>user</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUserId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;jimi test&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>	<span style=color:#000>user</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUserName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;19800604&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>	<span style=color:#000>user</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBirthDay</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1234567890123&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>	<span style=color:#000>user</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getSsn</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><h5 id=인증되지-않은-경우-처리>인증되지 않은 경우 처리</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Boolean</span> <span style=color:#000>isAuthenticated</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>EgovUserDetailsHelper</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isAuthenticated</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>assertFalse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>isAuthenticated</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>booleanValue</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><p>또는</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>assertNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovUserDetailsHelper</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAuthenticatedUser</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><h3 id=동시-세션처리>동시 세션처리</h3><p>Server security에서는 동일한 ID에 대하여 동시 접속을 제한할 수 있다.</p><p>이를 위하여 우선 web.xml에 다음과 같이 HttpSessionEventPublisher listener를 등록해 주어야 한다.</p><h4 id=webxml-설정>web.xml 설정</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;listener&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;listener-class&gt;</span>
</span></span><span style=display:flex><span>    org.springframework.security.web.session.HttpSessionEventPublisher
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/listener-class&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/listener&gt;</span>
</span></span></code></pre></div><h4 id=security-설정>security 설정</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>access-denied-page=</span><span style=color:#4e9a06>&#34;/system/accessDenied.do&#34;</span> <span style=color:#c4a000>request-matcher=</span><span style=color:#4e9a06>&#34;regex&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;form-login</span> <span style=color:#c4a000>login-processing-url=</span><span style=color:#4e9a06>&#34;/j_spring_security_check&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>authentication-failure-url=</span><span style=color:#4e9a06>&#34;/cvpl/EgovCvplLogin.do?login_error=1&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>default-target-url=</span><span style=color:#4e9a06>&#34;/index.jsp?flag=L&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>login-page=</span><span style=color:#4e9a06>&#34;/cvpl/EgovCvplLogin.do&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;anonymous/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;logout</span> <span style=color:#c4a000>logout-success-url=</span><span style=color:#4e9a06>&#34;/cvpl/EgovCvplLogin.do&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;session-management&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;concurrency-control</span> <span style=color:#c4a000>max-sessions=</span><span style=color:#4e9a06>&#34;1&#34;</span> <span style=color:#c4a000>error-if-maximum-exceeded=</span><span style=color:#4e9a06>&#34;true&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/session-management&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/http&gt;</span>
</span></span></code></pre></div><p>concurrent-session-control</p><ul><li>max-sessions : 최대 허용 세션 수</li><li>exception-if-maximum-exceeded : true ⇒ 최대 세션 수 초과할 경우 Exception 발생 , false ⇒ 최대 세션 수 초과할 경우 강제 로그아웃</li></ul><h2 id=참고자료>참고자료</h2></div><div class=td-content style=page-break-before:always><h1 id=pg-4a23d6b5276209a1e7bc4f8cc0f89a6a>4 - Authorization</h1><div class=lead>전자정부 표준프레임워크의 권한 부여(Authorization)는 XML 또는 DB에서 권한을 관리하며 계층적 권한을 지원한다. Spring Security의 FilterSecurityInterceptor를 통해 보호 자원에 대한 접근 권한을 관리하고, DB 기반의 보호 자원 맵핑 정보를 동적으로 반영할 수 있다. 또한, 역할 계층은 XML 또는 DB에서 관리하며, 사용자는 세션을 통해 권한 정보를 가져와 처리할 수 있다.</div><h1 id=authorization>Authorization</h1><h2 id=개요>개요</h2><p>웹 사이트에 존재하는 모든 사용자들은 사이트 정책에 따라 그 부류 별로 컨텐츠에 대한 접근이 제한 되는데 이것을 권한 부여(authorization)라 한다.
즉, 권한은 특정 사용자가 웹 사이트에서 제공하는 컨텐츠(정보 또는 기능)에 접근 가능한지를 판단하는 과정을 의미한다.</p><h2 id=설명>설명</h2><p>Authorization은 <acronym title="Extensible Markup Language">XML</acronym> 또는 DB에서 권한을 관리하며 계층적 권한을 지원한다.</p><p>Server Security에서는 Filter Security Interceptor에 의해 처리되며, DB로부터 권한 정보를 처리하기 위해 다음과 같이 설정된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#a40000>...</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- for authorization --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;custom-filter</span> <span style=color:#c4a000>before=</span><span style=color:#4e9a06>&#34;FILTER_SECURITY_INTERCEPTOR&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;filterSecurityInterceptor&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/http&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;filterSecurityInterceptor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.web.access.intercept.FilterSecurityInterceptor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>	
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;authenticationManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;org.springframework.security.authenticationManager&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;accessDecisionManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.vote.AffirmativeBased#0&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securityMetadataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;databaseSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;databaseSecurityMetadataSource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.intercept.EgovReloadableFilterInvocationSecurityMetadataSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;requestMap&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>	
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!--  url  --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;requestMap&#34;</span> 	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.intercept.UrlResourcesMapFactoryBean&#34;</span> <span style=color:#c4a000>init-method=</span><span style=color:#4e9a06>&#34;init&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.securedobject.impl.SecuredObjectServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectDAO&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectDAO&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;requestMatcherType&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;regex&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>	<span style=color:#8f5902;font-style:italic>&lt;!--  default : ant --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securedObjectDAO&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.securedobject.impl.SecuredObjectDAO&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><ul><li>authenticationManager : &lt;authentication-manager> 설정의 의해 자동으로 생성되는 bean ID를 지정(“org.springframework.security.authenticationManager”)</li><li>accessDecisionManager : 권한 부여 여부를 결정하는 Access Decision Manager로서 자동으로 생성되기 때문에 해당 bean ID를 지정하면 됨(“org.springframework.security.access.vote.AffirmativeBased#0”)</li><li>securityMetadataSource : 권한 설정 정보에 대한 처리 담당
참고로 자동으로 등록되는 AccessDecisionManager는 다음과 같은 설정을 갖는다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;accessDecisionManager&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.vote.AffirmativeBased&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;allowIfAllAbstainDecisions&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;decisionVoters&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:list&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.vote.RoleVoter&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;rolePrefix&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;ROLE_&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.vote.AuthenticatedVoter&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/beans:list&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><ul><li>org.springframework.security.vote.AffirmativeBased : 단 한 개의 오브젝트라도 허락하면 허가하는 방식으로 처리(기본 처리)</li><li>org.springframework.security.vote.UnanimousBased : 모든 오브젝트가 허락해야 허가하는 방식으로 처리</li><li>decisionVoters : 허가 오브젝트에 대한 목록을 설정함</li></ul><h3 id=자원-관리>자원 관리</h3><h4 id=url>url</h4><p>요청되는 웹 url을 점검하여 DB에 저장된 url과 비교하여 접근권한을 지정할 수 있다.</p><pre tabindex=0><code>\A/sale/.*\.do\Z
\A/cvpl/((?!EgovCvplLogin\.do).)*\Z
</code></pre><h5 id=filtersecurityinterceptor>filterSecurityInterceptor</h5><p>FilterSecurityInterceptor는 <acronym title="Hyper Text Transfer Protocol">HTTP</acronym> 자원의 보안을 처리할 책임이 있다.
다른 보안 인터셉터와 유사하게 FilterSecurityInterceptor는 AuthenticationManager와 AccessDecisionManager에 대한 참조를 필요로 한다.
또한 FilterSecurityInterceptor는 서로 다른 <acronym title="Hyper Text Transfer Protocol">HTTP</acronym> <acronym title="Uniform Resource Locator">URL</acronym> 요청에 적용되는 설정 속성도 설정한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;filterSecurityInterceptor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.web.access.intercept.FilterSecurityInterceptor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>	
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;authenticationManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;org.springframework.security.authenticationManager&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;accessDecisionManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.vote.AffirmativeBased#0&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securityMetadataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;databaseSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><h5 id=databasesecuritymetadatasource>databaseSecurityMetadataSource</h5><p>DB 기반으로 현재 시점의 url 보호자원-권한의 맵핑 정보를 Runtime 에 동적으로 변경 반영하기 위한 Spring Security 의 FilterInvocationSecurityMetadataSource 확장 클래스이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;databaseSecurityMetadataSource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.intercept.EgovReloadableFilterInvocationSecurityMetadataSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;requestMap&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>	
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><h5 id=requestmap>requestMap</h5><p>DB 기반의 보호자원 맵핑 정보를 얻어 이를 참조하는 빈의 초기화 데이터로 제공한다.
securedObjectService의 getRolesAndUrl()를 호출하여 DB에서 역할과 url의 매핑정보를 얻어온다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;requestMap&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.intercept.UrlResourcesMapFactoryBean&#34;</span> <span style=color:#c4a000>init-method=</span><span style=color:#4e9a06>&#34;init&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><h4 id=method>method</h4><p>Spring Security는 Spring의 DefaultAdvisorAutoProxyCreator와 함께 사용될 수 있는 MethodSecurityMetadataSourceAdvisor 처리를 제공하며, 이것을 이용하여 자동적으로 보안 인터셉터를 MethodSecurityInterceptor를 정의한 빈의 앞부분에 연결한다.</p><h5 id=methodsecuritymetadatasourceadvisor>methodSecurityMetadataSourceAdvisor</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;methodSecurityMetadataSourceAdvisor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.intercept.aopalliance.MethodSecurityMetadataSourceAdvisor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;methodSecurityInterceptor&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;delegatingMethodSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;delegatingMethodSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><h5 id=methodsecurityinterceptor>methodSecurityInterceptor</h5><p>메소드 요청에 대한 자원을 보호하기 위해 MethodSecurityInterceptor를 어플리케이션 Context에 추가해야하며 보안을 필요로 하는 빈이 인터셉터에 연결(chaining)된다.
이러한 연결은 Spring의 ProxyFactoryBean이나 BeanNameAutoProxyCreator를 이용하여 만들어지며, Spring의 여러 다른 부분들이 통상적으로 이용되는 방식과 유사하다.
MethodSecurityInterceptor 는 다음과 같이 설정한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;methodSecurityInterceptor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;validateConfigAttributes&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;authenticationManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;org.springframework.security.authenticationManager&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;accessDecisionManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.vote.AffirmativeBased#0&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securityMetadataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;delegatingMethodSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;delegatingMethodSecurityMetadataSource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:list&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;beans:ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;methodSecurityMetadataSources&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.annotation.SecuredAnnotationSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.annotation.Jsr250MethodSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/beans:list&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:constructor-arg&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span>methodSecurityMetadataSources
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;methodSecurityMetadataSources&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.method.MapBasedMethodSecurityMetadataSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;methodMap&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><h5 id=methodsecuritymetadatasources>methodSecurityMetadataSources</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;methodSecurityMetadataSources&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.method.MapBasedMethodSecurityMetadataSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;methodMap&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><h5 id=methodmap>methodMap</h5><p>DB 기반의 보호자원 맵핑 정보를 얻어 이를 참조하는 빈의 초기화 데이터로 제공한다.
resourceType을 method로 설정하여 securedObjectService의 getRolesAndMethod()를 호출하여 DB에서 역할과 메소드의 매핑정보를 얻어온다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;methodMap&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.intercept.MethodResourcesMapFactoryBean&#34;</span> <span style=color:#c4a000>init-method=</span><span style=color:#4e9a06>&#34;init&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;resourceType&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;method&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><h4 id=pointcut>pointcut</h4><p>DB 기반의 보호자원 맵핑 정보를 얻어 이를 참조하는 빈의 초기화 데이터로 제공한다.
resourceType을 pointcut으로 설정하여 securedObjectService의 getRolesAndPointcut()를 호출하여 DB에서 역할과 Pointcut의 매핑정보를 얻어온다. ex: execution(* egovframework.rte.security..service.*Service.insert*(..))</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;protectPointcutPostProcessor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.config.method.ProtectPointcutPostProcessor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;methodSecurityMetadataSources&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;pointcutMap&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;pointcutMap&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;pointcutMap&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.intercept.MethodResourcesMapFactoryBean&#34;</span> <span style=color:#c4a000>init-method=</span><span style=color:#4e9a06>&#34;init&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;resourceType&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;pointcut&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><h3 id=역할-관리>역할 관리</h3><p>역할은 상하 계층으로 관리하며 어플리케이션 Context 또는 DB에 저장하여 관리한다.</p><h4 id=xml-context에-계층-역할을-등록하여-관리할-경우>XMl Context에 계층 역할을 등록하여 관리할 경우</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span> 
</span></span><span style=display:flex><span>		<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hierarchy&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:value&gt;</span>
</span></span><span style=display:flex><span>			ROLE_ADMIN &gt; ROLE_USER
</span></span><span style=display:flex><span>			ROLE_USER &gt; ROLE_RESTRICTED
</span></span><span style=display:flex><span>			ROLE_RESTRICTED &gt; IS_AUTHENTICATED_FULLY
</span></span><span style=display:flex><span>			IS_AUTHENTICATED_REMEMBERED &gt; IS_AUTHENTICATED_ANONYMOUSLY
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/beans:value&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><h4 id=db에서-계층-역할을-관리할-경우>DB에서 계층 역할을 관리할 경우</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span> 
</span></span><span style=display:flex><span>		<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hierarchy&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;hierarchyStrings&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;hierarchyStrings&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.userdetails.hierarchicalroles.HierarchyStringsFactoryBean&#34;</span> <span style=color:#c4a000>init-method=</span><span style=color:#4e9a06>&#34;init&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;jdbcUserService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.userdetails.jdbc.EgovJdbcUserDetailsManager&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;usersByUsernameQuery&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,PASSWORD,ENABLED,USER_NAME,BIRTH_DAY,SSN FROM USERS WHERE USER_ID = ?&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;authoritiesByUsernameQuery&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,AUTHORITY FROM AUTHORITIES WHERE USER_ID = ?&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mapClass&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.userdetails.EgovUserDetailsMapping&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><ul><li>class : egovframework.rte.fdl.security.userdetails.jdbc.EgovJdbcUserDetailsManager</li><li>usersByUsernameQuery : 사용자 인증을 위해 사용자 테이블에서 사용자정보를 조회한다.</li><li>authoritiesByUsernameQuery : 사용자 인증을 위해 사용자권한 테이블에서 사용자권한정보를 조회한다.</li><li>roleHierarchy : 역할의 계층적 관리를 위해 계층 역할을 설정한다.</li><li>mapClass : 세션 사용을 위한 세션 쿼리 및 세션VO간의 매핑 클래스를 설정한다.</li><li>dataSource : JDBC 서비스를 위한 dataSource를 설정한다.</li></ul><h4 id=configuration>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.securedobject.impl.SecuredObjectServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectDAO&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectDAO&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;requestMatcherType&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;regex&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>	<span style=color:#8f5902;font-style:italic>&lt;!--  default : ant --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securedObjectDAO&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.securedobject.impl.SecuredObjectDAO&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><p>아래의 속성쿼리는 SecuredObjectDAO 빈에 기본으로 내장되었으며 DBMS 벤더에 따른 SQL문 차이 또는 DB 스키마 차이로 인한 변경된 쿼리를 직접 반영할 수 있다.
내장된 기본 쿼리는 다음과 같다.</p><ul><li>sqlHierarchicalRoles</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>child_role</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>child</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parent_role</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>parent</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ROLES_HIERARCHY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>LEFT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>JOIN</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ROLES_HIERARCHY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>on</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>child_role</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parent_role</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><ul><li>sqlRolesAndUrl</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_pattern</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>url</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>authority</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>authority</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SECURED_RESOURCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SECURED_RESOURCES_ROLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>WHERE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_id</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_id</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>AND</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_type</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;url&#39;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>ORDER</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>BY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>sort_order</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><ul><li>sqlRolesAndMethod</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_pattern</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>method</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>authority</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>authority</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SECURED_RESOURCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SECURED_RESOURCES_ROLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>WHERE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_id</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_id</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>AND</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_type</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;method&#39;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>ORDER</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>BY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>sort_order</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><ul><li>sqlRolesAndPointcut</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_pattern</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>pointcut</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>authority</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>authority</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SECURED_RESOURCES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SECURED_RESOURCES_ROLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>WHERE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_id</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_id</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>AND</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resource_type</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;pointcut&#39;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>ORDER</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>BY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>sort_order</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>SecuredObjectDAO 빈에 내장된 SQL을 사용하지 않을 경우 아래와 같이 SQL을 지정하여 설정한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-XML data-lang=XML><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securedObjectDAO&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.securedobject.impl.SecuredObjectDAO&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sqlHierarchicalRoles&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:value&gt;</span>
</span></span><span style=display:flex><span>			SELECT a.child_role child, a.parent_role parent
</span></span><span style=display:flex><span>			FROM ROLES_HIERARCHY a LEFT JOIN ROLES_HIERARCHY b on (a.child_role = b.parent_role)
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/beans:value&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sqlRolesAndUrl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:value&gt;</span>
</span></span><span style=display:flex><span>			SELECT a.resource_pattern url, b.authority authority
</span></span><span style=display:flex><span>			FROM SECURED_RESOURCES a, SECURED_RESOURCES_ROLE b
</span></span><span style=display:flex><span>			WHERE a.resource_id = b.resource_id
</span></span><span style=display:flex><span>			AND a.resource_type = &#39;url&#39; ORDER BY a.sort_order
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/beans:value&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sqlRolesAndMethod&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:value&gt;</span>
</span></span><span style=display:flex><span>	    SELECT a.resource_pattern method, b.authority authority
</span></span><span style=display:flex><span>			FROM SECURED_RESOURCES a, SECURED_RESOURCES_ROLE b
</span></span><span style=display:flex><span>			WHERE a.resource_id = b.resource_id
</span></span><span style=display:flex><span>			AND a.resource_type = &#39;method&#39; ORDER BY a.sort_order
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/beans:value&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sqlRolesAndPointcut&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:value&gt;</span>
</span></span><span style=display:flex><span>			SELECT a.resource_pattern pointcut, b.authority authority
</span></span><span style=display:flex><span>			FROM SECURED_RESOURCES a, SECURED_RESOURCES_ROLE b
</span></span><span style=display:flex><span>			WHERE a.resource_id = b.resource_id
</span></span><span style=display:flex><span>			AND a.resource_type = &#39;pointcut&#39; ORDER BY a.sort_order
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/beans:value&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span></code></pre></div><h3 id=세션사용>세션사용</h3><h4 id=역할-가져오기>역할 가져오기</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>authorities</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>EgovUserDetailsHelper</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAuthorities</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 1. authorites 에  권한이 있는지 체크 TRUE/FALSE
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>authorities</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>contains</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;ROLE_USER&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>authorities</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>contains</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;ROLE_RESTRICTED&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>authorities</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>contains</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;IS_AUTHENTICATED_ANONYMOUSLY&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>authorities</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>contains</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;IS_AUTHENTICATED_FULLY&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>authorities</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>contains</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;IS_AUTHENTICATED_REMEMBERED&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 2. authorites 에  ROLE 이 여러개 설정된 경우
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Iterator</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>it</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>authorities</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>iterator</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>it</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasNext</span><span style=color:#ce5c00;font-weight:700>();)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>String</span> <span style=color:#000>auth</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>it</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>next</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 3. authorites 에  ROLE 이 하나만 설정된 경우
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>String</span> <span style=color:#000>auth</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>authorities</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toArray</span><span style=color:#ce5c00;font-weight:700>()[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-36756ce3ff134d7c8747f4fc93a1a03b>5 - 설정 간소화</h1><div class=lead>전자정부 표준프레임워크 3.0부터 Server Security 설정을 간소화할 수 있는 기능을 제공하며, XML Schema를 통해 필요한 설정만 추가하면 된다. <strong>Security Config</strong>는 로그인, 로그아웃, 권한 관리, 동시 세션, 패스워드 해시 방식 등 다양한 보안 설정을 간단히 설정할 수 있게 해준다. 또한, <strong>Security Object Config</strong>를 통해 URL, Method, Pointcut 방식의 권한 설정과 계층적 역할 관리도 쉽게 구성할 수 있다.</div><h1 id=설정-간소화>설정 간소화</h1><h2 id=개요>개요</h2><p>표준프레임워크 3.0부터 Server security에 대하여 설정을 간소화 할 수 있는 방법을 제공한다.
내부적으로 필요한 설정을 가지고 있고, XML Schema를 통해 필요한 설정만을 추가할 수 있도록 제공한다.</p><h2 id=xml-namespace-및-schema-설정>XML namespace 및 schema 설정</h2><p>설정 간소화 기능을 사용하기 위해서는 다음과 같은 xml 선언이 필요하다.
<strong>4.1 > 4.2 업그레이드 시 xsd 변경(egov-security-4.1.0.xsd > egov-security-4.2.0.xsd)</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:egov-security=</span><span style=color:#4e9a06>&#34;http://maven.egovframe.go.kr/schema/egov-security&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:security=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/security&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		http://maven.egovframe.go.kr/schema/egov-security http://maven.egovframe.go.kr/schema/egov-security/egov-security-4.2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><h2 id=security-config-설정>Security Config 설정</h2><p>Security에 대한 기본 설정 정보를 제공한다.</p><p>예:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;egov-security:config</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securityConfig&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>loginUrl=</span><span style=color:#4e9a06>&#34;/uat/uia/egovLoginUsr.do&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>logoutSuccessUrl=</span><span style=color:#4e9a06>&#34;/EgovContent.do&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>loginFailureUrl=</span><span style=color:#4e9a06>&#34;/uat/uia/egovLoginUsr.do?login_error=1&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>accessDeniedUrl=</span><span style=color:#4e9a06>&#34;/sec/ram/accessDenied.do&#34;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>dataSource=</span><span style=color:#4e9a06>&#34;egov.dataSource&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>jdbcUsersByUsernameQuery=</span><span style=color:#4e9a06>&#34;SELECT USER_ID, ESNTL_ID AS PASSWORD, 1 ENABLED, USER_NM, USER_ZIP,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                  USER_ADRES, USER_EMAIL, USER_SE, ORGNZT_ID, ESNTL_ID,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                  (select a.ORGNZT_NM from COMTNORGNZTINFO a where a.ORGNZT_ID = m.ORGNZT_ID) ORGNZT_NM
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                  FROM COMVNUSERMASTER m WHERE CONCAT(USER_SE, USER_ID) = ?&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>jdbcAuthoritiesByUsernameQuery=</span><span style=color:#4e9a06>&#34;SELECT A.SCRTY_DTRMN_TRGET_ID USER_ID, A.AUTHOR_CODE AUTHORITY
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                        FROM COMTNEMPLYRSCRTYESTBS A, COMVNUSERMASTER B
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                        WHERE A.SCRTY_DTRMN_TRGET_ID = B.ESNTL_ID AND B.USER_ID = ?&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>jdbcMapClass=</span><span style=color:#4e9a06>&#34;egovframework.com.sec.security.common.EgovSessionMapping&#34;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>requestMatcherType=</span><span style=color:#4e9a06>&#34;regex&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>hash=</span><span style=color:#4e9a06>&#34;plaintext&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>hashBase64=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>concurrentMaxSessons=</span><span style=color:#4e9a06>&#34;1&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>concurrentExpiredUrl=</span><span style=color:#4e9a06>&#34;/EgovContent.do&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>errorIfMaximumExceeded=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>defaultTargetUrl=</span><span style=color:#4e9a06>&#34;/EgovContent.do&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>alwaysUseDefaultTargetUrl=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>sniff=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xframeOptions=</span><span style=color:#4e9a06>&#34;SAMEORIGIN&#34;</span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xssProtection=</span><span style=color:#4e9a06>&#34;true&#34;</span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>cacheControl=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>csrf=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>csrfAccessDeniedUrl=</span><span style=color:#4e9a06>&#34;/egovCSRFAccessDenied.do&#34;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h3 id=속성-설명>속성 설명</h3><table><thead><tr><th>속성</th><th>설명</th><th>필수여부</th><th>비고</th></tr></thead><tbody><tr><td>loginUrl</td><td>로그인 페이지 URL</td><td>필수</td><td></td></tr><tr><td>logoutSuccessUrl</td><td>로그아웃 처리 시 호출되는 페이지 URL</td><td>필수</td><td></td></tr><tr><td>loginFailureUrl</td><td>로그인 실패 시 호출되는 페이지 URL</td><td>필수</td><td></td></tr><tr><td>accessDeniedUrl</td><td>권한이 없는 경우 호출되는 페이지 URL</td><td>필수</td><td></td></tr><tr><td>dataSource</td><td>DBMS 설정 dataSource</td><td>선택</td><td>미지정시 &lsquo;dataSource&rsquo; bean name 사용</td></tr><tr><td>jdbcUsersByUsernameQuery</td><td>인증에 사용되는 query</td><td>선택</td><td>default : “select user_id, password, enabled, users.* from users where user_id = ?”</td></tr><tr><td>jdbcAuthoritiesByUsernameQuery</td><td>인증된 사용자의 권한(authority) 조회 query</td><td>선택</td><td>default : “select user_id, authority from authorites where user_id = ?”</td></tr><tr><td>jdbcMapClass</td><td>사용자 정보 mapping 처리 class</td><td>선택</td><td>default : egovframework.rte.fdl.security.userdetails.DefaultMapUserDetailsMapping</td></tr><tr><td>requestMatcherType</td><td>패턴 매칭 방식(regex, ant, ciRegex: case-insensitive regex)</td><td>선택</td><td>default : regex</td></tr><tr><td>hash</td><td>패스워드 저장 방식 (sha-256, plaintext, sha, md5, bcrypt)</td><td>선택</td><td>default : sha-256</td></tr><tr><td>hashBase64</td><td>hash값 base64 인코딩 사용 여부</td><td>선택</td><td>default : true</td></tr><tr><td>concurrentMaxSessons</td><td>동시 접속가능 연결 수</td><td>선택</td><td>default : 999</td></tr><tr><td>concurrentExpiredUrl</td><td>expired된 경우 redirect되는 페이지 URL</td><td>선택</td><td></td></tr><tr><td>errorIfMaximumExceeded</td><td>중복 로그인 방지 옵션</td><td>필수</td><td>default : false</td></tr><tr><td>defaultTargetUrl</td><td>로그인 성공시 redirect되는 페이지 URL</td><td>선택</td><td>미지정시 처음 접속하고자 했던 페이지 URL로 redirect됨</td></tr><tr><td>alwaysUseDefaultTargetUrl</td><td>로그인 이후 설정한 페이지로 이동하게 하는 옵션</td><td>필수</td><td>default : true</td></tr><tr><td>sniff</td><td>선언된 콘텐츠 유형으로부터 벗어난 응답에 대한 브라우저의 MIME 가로채기를 방지 여부</td><td>필수</td><td>default : true</td></tr><tr><td>xframeOptions</td><td>sniff 옵션 이 ture 일때 X-Frame-Options 범위설정</td><td>선택</td><td>DENY, SAMEORIGIN</td></tr><tr><td>xssProtection</td><td>XSS Protection 기능의 사용 여부</td><td>필수</td><td>default : true</td></tr><tr><td>cacheControl</td><td>캐쉬 비활성화 여부 옵션</td><td>필수</td><td>default : false</td></tr><tr><td>csrf</td><td>spring security의 csrf 기능 사용 여부</td><td>필수</td><td>default : false</td></tr><tr><td>csrfAccessDeniedUrl</td><td>토큰 검증이 실패했을 경우 호출되는 페이지 URL</td><td>필수</td><td></td></tr><tr><td>useExpressions</td><td>Spring 표현 언어(SpEL) 설정 옵션</td><td>선택</td><td>default : false</td></tr></tbody></table><ul><li>DefaultMapUserDetailsMapping : VO 없이 Map 방식으로 매핑을 처리함 (jdbcUsersByUsernameQuery 상에 지정된 컬럼에 대하여 camel case 방식으로 Hash Map 키 생성 처리)</li><li>useExpressions 속성은 사용할 경우 설정 추가 필요</li></ul><h2 id=security-config-initializer-설정>Security Config Initializer 설정</h2><p>Security에 대한 초기화 처리 정보를 제공한다.</p><p>예:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;egov-security:initializer</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;initializer&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>supportPointcut=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h3 id=속성-설명-1>속성 설명</h3><table><thead><tr><th>속성</th><th>설명</th><th>필수여부</th><th>비고</th></tr></thead><tbody><tr><td>supportPointcut</td><td>pointcut 방식 지원 여부</td><td>선택</td><td>default : false</td></tr><tr><td>supportMethod</td><td>method 방식 지원 여부</td><td>선택</td><td>default : true</td></tr></tbody></table><h2 id=security-object-config-설정>Security Object Config 설정</h2><p>Security에 대한 기본 query 설정 정보를 제공한다.</p><p>예:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;egov-security:secured-object-config</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securedObjectConfig&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>roleHierarchyString=</span><span style=color:#4e9a06>&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>			ROLE_ADMIN &gt; ROLE_USER
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>			ROLE_USER &gt; ROLE_RESTRICTED
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>			ROLE_RESTRICTED &gt; IS_AUTHENTICATED_FULLY
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>			IS_AUTHENTICATED_FULLY &gt;	IS_AUTHENTICATED_REMEMBERED
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>			IS_AUTHENTICATED_REMEMBERED &gt; IS_AUTHENTICATED_ANONYMOUSLY&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>sqlRolesAndUrl=</span><span style=color:#4e9a06>&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>			SELECT auth.URL url, code.CODE_NM authority
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>			FROM RTETNAUTH auth, RTETCCODE code
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>			WHERE code.CODE_ID = auth.MNGR_SE&#34;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h3 id=속성-설명-2>속성 설명</h3><table><thead><tr><th>속성</th><th>설명</th><th>필수여부</th><th>비고</th></tr></thead><tbody><tr><td>roleHierarchyString</td><td>계층처리를 위한 설정 문자열 지정</td><td>선택</td><td>미지정시 DB로부터 지정된 설정정보 지정</td></tr><tr><td>sqlRolesAndUrl</td><td>URL 방식 role 지정 query</td><td>선택</td><td>미지정시 SecuredObjectDAO의 기본 query가 처리됨</td></tr><tr><td>sqlRolesAndMethod</td><td>method 방식 role 지정 query</td><td>선택</td><td>〃</td></tr><tr><td>sqlRolesAndPointcut</td><td>pointcut 방식 role 지정 query</td><td>선택</td><td>〃</td></tr><tr><td>sqlRegexMatchedRequestMapping</td><td>request 마다 best matching url 보호자원 지정 query</td><td>선택</td><td>〃</td></tr><tr><td>sqlHierarchicalRoles</td><td>계층처리를 위한 query</td><td>선택</td><td>〃</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-43b28134c738d893f2783ad0ef8f13d7>6 - Server Security 업그레이드</h1><div class=lead>표준프레임워크 2.7에서 3.0으로 Server Security 업그레이드 시, Spring Security 패키지와 API 변경, dependencies 수정, web.xml 수정 등이 필요하다. 주요 API 변경 사항에는 SpringSecurityException 삭제, ConfigAttributeDefinition 변경, SavedRequest 인터페이스화 등이 있으며, 패키지 경로 변경과 GrantedAuthority 방식의 변경도 적용해야 한다. 인증 및 GET 방식 호출 방지 처리, Mapping 클래스 변경, 불필요한 클래스 삭제 등 여러 단계에서 소스 코드와 설정의 수정을 요구한다.</div><h1 id=server-security-업그레이드>Server Security 업그레이드</h1><h2 id=개요>개요</h2><p>표준프레임워크 2.7(Spring Security 2.0.4)에서 3.0(Spring Security 3.2.3)로 업그레이드 Server security의 경우 설정 변경뿐만 아니라 소스 상의 변경 작업이 필요하다.</p><h2 id=주요-변경내용-spring-security-부분>주요 변경내용 (Spring Security 부분)</h2><h3 id=dependencies-및-패키지-변경>dependencies 및 패키지 변경</h3><ul><li>spring-security-core (org.springframework.security.core, org.springframework.security.access, etc.)</li><li>spring-security-web (org.springframework.security.web)</li><li>spring-security-config (org.springframework.security.config)</li></ul><h3 id=api-변경>API 변경</h3><ul><li>SpringSecurityException 삭제</li><li>ConfigAttributeDefinition ⇒ Collection<configattribute></li><li>SavedRequest : class ⇒ interface (DefaultSavedRequest 대체)</li></ul><h3 id=기타>기타</h3><ul><li>다중 http elements 지원</li><li>stateless 인증 지원</li><li>DebugFilter 추가 (debugging용)</li><li>hasPermission 표현식 지원 (authorize JSP tag)</li><li>등등</li></ul><h2 id=실행환경-부분-업그레이드-절차>실행환경 부분 업그레이드 절차</h2><h3 id=1-dependency-수정>1. dependency 수정</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>egovframework.rte<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>egovframework.rte.fdl.security<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>3.0.0<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><ul><li>적용 버전은 최신 버전 확인 후 적용(patch 버전 등)</li></ul><h3 id=2-webxml-수정>2. web.xml 수정</h3><p>접속 제한을 사용하는 경우 web.xml 상에 HttpSessionEventPublisher listener의 패키지 변경 필요</p><ul><li>기존 :</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;listener&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;listener-class&gt;</span>org.springframework.security.ui.session.HttpSessionEventPublisher<span style=color:#204a87;font-weight:700>&lt;/listener-class&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/listener&gt;</span>
</span></span></code></pre></div><ul><li>변경 :</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;listener&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;listener-class&gt;</span>org.springframework.security.web.session.HttpSessionEventPublisher<span style=color:#204a87;font-weight:700>&lt;/listener-class&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/listener&gt;</span>
</span></span></code></pre></div><h3 id=3-spring-security-설정-수정>3. Spring Security 설정 수정</h3><p>다음 설정을 참조하여 관련 설정을 변경한다. (Spring Security쪽 패키지 등)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans:beans</span>  <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/security&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:beans=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:aop=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/aop&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>						http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>						http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.2.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.securedobject.impl.SecuredObjectServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectDAO&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectDAO&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;requestMatcherType&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;regex&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>	<span style=color:#8f5902;font-style:italic>&lt;!--  default : ant --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securedObjectDAO&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.securedobject.impl.SecuredObjectDAO&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;sqlHierarchicalRoles&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;beans:value&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				SELECT a.child_role child, a.parent_role parent
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				FROM ROLES_HIERARCHY a LEFT JOIN ROLES_HIERARCHY b on (a.child_role = b.parent_role)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;/beans:value&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;/beans:property&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;sqlRolesAndUrl&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;beans:value&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				SELECT a.resource_pattern url, b.authority authority
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				FROM SECURED_RESOURCES a, SECURED_RESOURCES_ROLE b
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				WHERE a.resource_id = b.resource_id
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				AND a.resource_type = &#39;url&#39; ORDER BY a.sort_order
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;/beans:value&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;/beans:property&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;sqlRolesAndMethod&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;beans:value&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		    SELECT a.resource_pattern method, b.authority authority
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				FROM SECURED_RESOURCES a, SECURED_RESOURCES_ROLE b
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				WHERE a.resource_id = b.resource_id
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				AND a.resource_type = &#39;method&#39; ORDER BY a.sort_order
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;/beans:value&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;/beans:property&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;sqlRolesAndPointcut&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;beans:value&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				SELECT a.resource_pattern pointcut, b.authority authority
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				FROM SECURED_RESOURCES a, SECURED_RESOURCES_ROLE b
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				WHERE a.resource_id = b.resource_id
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				AND a.resource_type = &#39;pointcut&#39; ORDER BY a.sort_order
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;/beans:value&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;/beans:property&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- 불필요 삭제 --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!--   
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	&lt;beans:bean id=&#34;userDetailsServiceWrapper&#34; class=&#34;org.springframework.security.userdetails.hierarchicalroles.UserDetailsServiceWrapper&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;roleHierarchy&#34; ref=&#34;roleHierarchy&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;userDetailsService&#34; ref=&#34;jdbcUserService&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	&lt;/beans:bean&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	--&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>&lt;!-- XML 사용 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;hierarchy&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;beans:value&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				ROLE_ADMIN &gt; ROLE_USER
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				ROLE_USER &gt; ROLE_RESTRICTED
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				ROLE_RESTRICTED &gt; IS_AUTHENTICATED_FULLY
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				IS_AUTHENTICATED_REMEMBERED &gt; IS_AUTHENTICATED_ANONYMOUSLY
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;/beans:value&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;/beans:property&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		--&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>&lt;!-- DB 사용 --&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hierarchy&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;hierarchyStrings&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;hierarchyStrings&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.userdetails.hierarchicalroles.HierarchyStringsFactoryBean&#34;</span> <span style=color:#c4a000>init-method=</span><span style=color:#4e9a06>&#34;init&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	Access Decision Manager는 자동으로 생성되기 때문에 선언 불필요 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	bean id : org.springframework.security.access.vote.AffirmativeBased#0
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	※ #0 부분은 숫자 부분은 선언 순으로 순차적으로 생성됨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	&lt;beans:bean id=&#34;accessDecisionManager&#34; class=&#34;org.springframework.security.access.vote.AffirmativeBased&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;allowIfAllAbstainDecisions&#34; value=&#34;false&#34; /&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;decisionVoters&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;beans:list&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				&lt;beans:bean class=&#34;org.springframework.security.access.vote.RoleVoter&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>					&lt;beans:property name=&#34;rolePrefix&#34; value=&#34;ROLE_&#34; /&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				&lt;/beans:bean&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				&lt;beans:bean class=&#34;org.springframework.security.access.vote.AuthenticatedVoter&#34; /&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			&lt;/beans:list&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;/beans:property&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	&lt;/beans:bean&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	--&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;filterSecurityInterceptor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.web.access.intercept.FilterSecurityInterceptor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>	
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;authenticationManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;org.springframework.security.authenticationManager&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;accessDecisionManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.vote.AffirmativeBased#0&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securityMetadataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;databaseSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;databaseSecurityMetadataSource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.intercept.EgovReloadableFilterInvocationSecurityMetadataSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;requestMap&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>	
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!--  url  --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;requestMap&#34;</span> 	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.intercept.UrlResourcesMapFactoryBean&#34;</span> <span style=color:#c4a000>init-method=</span><span style=color:#4e9a06>&#34;init&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- 지정 불필요 : request-matcher 참조 --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	&lt;beans:bean id=&#34;regexUrlPathMatcher&#34; class=&#34;org.springframework.security.web.util.matcher.RegexRequestMatcher&#34; /&gt;	
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> 	--&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	<span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;/css/＊＊&#34;</span> <span style=color:#c4a000>security=</span><span style=color:#4e9a06>&#34;none&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>    
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;/images/＊＊&#34;</span> <span style=color:#c4a000>security=</span><span style=color:#4e9a06>&#34;none&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 	<span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;/js/＊＊&#34;</span> <span style=color:#c4a000>security=</span><span style=color:#4e9a06>&#34;none&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 	<span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;\A/WEB-INF/jsp/.*\Z&#34;</span> <span style=color:#c4a000>request-matcher=</span><span style=color:#4e9a06>&#34;regex&#34;</span> <span style=color:#c4a000>security=</span><span style=color:#4e9a06>&#34;none&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span> 	
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;http</span> <span style=color:#c4a000>access-denied-page=</span><span style=color:#4e9a06>&#34;/system/accessDenied.do&#34;</span> <span style=color:#c4a000>request-matcher=</span><span style=color:#4e9a06>&#34;regex&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;form-login</span> <span style=color:#c4a000>login-processing-url=</span><span style=color:#4e9a06>&#34;/j_spring_security_check&#34;</span>
</span></span><span style=display:flex><span>					<span style=color:#c4a000>authentication-failure-url=</span><span style=color:#4e9a06>&#34;/cvpl/EgovCvplLogin.do?login_error=1&#34;</span>
</span></span><span style=display:flex><span>					<span style=color:#c4a000>default-target-url=</span><span style=color:#4e9a06>&#34;/index.jsp?flag=L&#34;</span>
</span></span><span style=display:flex><span>					<span style=color:#c4a000>login-page=</span><span style=color:#4e9a06>&#34;/cvpl/EgovCvplLogin.do&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;anonymous/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;logout</span> <span style=color:#c4a000>logout-success-url=</span><span style=color:#4e9a06>&#34;/cvpl/EgovCvplLogin.do&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>&lt;!-- for authorization --&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;custom-filter</span> <span style=color:#c4a000>before=</span><span style=color:#4e9a06>&#34;FILTER_SECURITY_INTERCEPTOR&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;filterSecurityInterceptor&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/http&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	authentication-manager 기본 생성 bean id :  org.springframework.security.authenticationManager
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		(alias로 변경할 수 있음)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;authentication-manager&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;authentication-provider</span> <span style=color:#c4a000>user-service-ref=</span><span style=color:#4e9a06>&#34;jdbcUserService&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;password-encoder</span>  <span style=color:#c4a000>hash=</span><span style=color:#4e9a06>&#34;sha-256&#34;</span> <span style=color:#c4a000>base64=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/authentication-provider&gt;</span>		
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/authentication-manager&gt;</span>	
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- userDetailsServiceWrapper --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- customizing user table, authorities table --&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!--&lt;jdbc-user-service id=&#34;jdbcUserService&#34; data-source-ref=&#34;dataSource&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		users-by-username-query=&#34;SELECT USER_ID,PASSWORD,ENABLED,BIRTH_DAY FROM USERS WHERE USER_ID = ?&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		authorities-by-username-query=&#34;SELECT USER_ID,AUTHORITY FROM AUTHORITIES WHERE USER_ID = ?&#34;/&gt;--&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;jdbcUserService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.userdetails.jdbc.EgovJdbcUserDetailsManager&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;usersByUsernameQuery&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,PASSWORD,ENABLED,USER_NAME,BIRTH_DAY,SSN FROM USERS WHERE USER_ID = ?&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;authoritiesByUsernameQuery&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT USER_ID,AUTHORITY FROM AUTHORITIES WHERE USER_ID = ?&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;roleHierarchy&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mapClass&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.userdetails.EgovUserDetailsMapping&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- method --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;methodSecurityMetadataSourceAdvisor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.intercept.aopalliance.MethodSecurityMetadataSourceAdvisor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;methodSecurityInterceptor&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;delegatingMethodSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;delegatingMethodSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;methodSecurityInterceptor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;validateConfigAttributes&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;authenticationManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;org.springframework.security.authenticationManager&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;accessDecisionManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.vote.AffirmativeBased#0&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securityMetadataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;delegatingMethodSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;delegatingMethodSecurityMetadataSource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;beans:list&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;beans:ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;methodSecurityMetadataSources&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.annotation.SecuredAnnotationSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.annotation.Jsr250MethodSecurityMetadataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;/beans:list&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/beans:constructor-arg&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;methodSecurityMetadataSources&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.security.access.method.MapBasedMethodSecurityMetadataSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;methodMap&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans:bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;methodMap&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.security.intercept.MethodResourcesMapFactoryBean&#34;</span> <span style=color:#c4a000>init-method=</span><span style=color:#4e9a06>&#34;init&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securedObjectService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;beans:property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;resourceType&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;method&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans:bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- pointcut --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- if no map, there is a error that &#34;this map must not be empty; it must contain at least one entry&#34; --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- // so there is dummy entry
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	&lt;beans:bean id=&#34;protectPointcutPostProcessor&#34; class=&#34;org.springframework.security.config.method.ProtectPointcutPostProcessor&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:constructor-arg ref=&#34;methodSecurityMetadataSources&#34; /&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;pointcutMap&#34; ref=&#34;pointcutMap&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	&lt;/beans:bean&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	&lt;beans:bean id=&#34;pointcutMap&#34; class=&#34;egovframework.rte.fdl.security.intercept.MethodResourcesMapFactoryBean&#34; init-method=&#34;init&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;securedObjectService&#34; ref=&#34;securedObjectService&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		&lt;beans:property name=&#34;resourceType&#34; value=&#34;pointcut&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	&lt;/beans:bean&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans:beans&gt;</span>
</span></span></code></pre></div><h3 id=4-불필요-class-삭제>4. 불필요 class 삭제</h3><p>자체 적용된 server security에 대한 소스 삭제 정리
Ex:</p><ul><li>org.springframework.security.intercept.web.EgovReloadableDefaultFilterInvocationDefinitionSource : 패키지 변경으로 인하여 불필요 (egovframework.rte.fdl.security.intercept.EgovReloadableFilterInvocationSecurityMetadataSource)</li><li>…security.intercept.*, …security.securedobject.securedobject.*, …security.securedobject.userdetails.* 등 : 업그레이된 실행환경쪽 패키지(egovframework.rte.fdl.security.*)를 참조하기 때문에 불필요</li></ul><h3 id=5-mapping-클래스-maprow-메소드-변경>5. Mapping 클래스 mapRow 메소드 변경</h3><p>jdbcUserService(egovframework.rte.fdl.security.userdetails.jdbc.EgovJdbcUserDetailsManager)에 의해 지정된 mapClass는 EgovUsersByUsernameMapping 클래스를 extend 하도록 되어 있는데, 해당 EgovUsersByUsernameMapping의 mapRow() 메소드의 return 타입이 Object에서 EgovUserDtails로 변경되었다.</p><ul><li>기존 :</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovSessionMapping</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>EgovUsersByUsernameMapping</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Object</span> <span style=color:#000>mapRow</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ResultSet</span> <span style=color:#000>rs</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>rownum</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>SQLException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>변경 :</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovSessionMapping</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>EgovUsersByUsernameMapping</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>EgovUserDetails</span> <span style=color:#000>mapRow</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ResultSet</span> <span style=color:#000>rs</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>rownum</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>SQLException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=6-참조-패키지-및-클래스-변경>6. 참조 패키지 및 클래스 변경</h3><p>Spring security 관련 패키지 변경 등에 따라 일부 참조 클래스에 대한 패키지 변경 필요</p><ul><li>org.springframework.security.Authentication → org.springframework.security.core.Authentication</li><li>org.springframework.security.GrantedAuthority → org.springframework.security.core.GrantedAuthority</li><li>org.springframework.security.context.SecurityContext → org.springframework.security.core.context.SecurityContext</li><li>org.springframework.security.context.SecurityContextHolder → org.springframework.security.core.context.SecurityContextHolder</li><li>등등</li></ul><h3 id=7-grantedauthority-방식-변경-array---collection-타입>7. GrantedAuthority 방식 변경 (array -> collection 타입)</h3><p>GrantedAuthority[] → Collection&lt;GrantedAuthority> 변경 적용</p><ul><li>이전 코드 :</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>GrantedAuthority</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>authorities</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>authentication</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAuthorities</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>authorities</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>listAuth</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>authorities</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#c4a000>getAuthority</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>변경 코드 :</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Collection</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>GrantedAuthority</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>authorities</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Collection</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>GrantedAuthority</span><span style=color:#ce5c00;font-weight:700>&gt;)</span> <span style=color:#000>authentication</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAuthorities</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>GrantedAuthority</span> <span style=color:#000>authority</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>authorities</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>listAuth</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>authority</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAuthority</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=8-securitycontext의-getauthentication-방식-변경>8. SecurityContext의 getAuthentication() 방식 변경</h3><p>기존의 경우 로그인되지 않은 경우 SecurityContext의 getAuthentication()의 리턴 값이 null이었으나,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>SecurityContext</span> <span style=color:#000>context</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>SecurityContextHolder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getContext</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>Authentication</span> <span style=color:#000>authentication</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAuthentication</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovObjectUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>authentication</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>신규 버전의 경우는 null이 아닌 값으로 처리된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>SecurityContext</span> <span style=color:#000>context</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>SecurityContextHolder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getContext</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>Authentication</span> <span style=color:#000>authentication</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAuthentication</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovObjectUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>authentication</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;## authentication object is null!!&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>authentication</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getPrincipal</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>instanceof</span> <span style=color:#000>EgovUserDetails</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>EgovUserDetails</span> <span style=color:#000>details</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovUserDetails</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>authentication</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getPrincipal</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;## EgovUserDetailsHelper.getAuthenticatedUser : AuthenticatedUser is {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>details</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUsername</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>details</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEgovUserVO</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>authentication</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getPrincipal</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>따라서 사용자 정보를 취득하는 부분은 자체 적용 부분이 아닌 실행환경 제공 부분(egovframework.rte.fdl.security.userdetails.util.EgovUserDetailsHelper)을 사용한다.</p><h3 id=9-get-방식-인증-불가-처리>9. GET 방식 인증 불가 처리</h3><p>신규 버전의 경우는 GET 방식으로 j_spring_security_check를 호출할 수 없게 되었다.(j_spring_security_check URL을 내부적으로 redirect 호출하는 경우에만 해당)
오류 메시지 : Authentication request failed: org.springframework.security.authentication.AuthenticationServiceException: Authentication method not supported: GET</p><p>이 경우 다음 코드와 같이 GET 방식이 아닌 filter chain 호출 방식으로 변경해주어야 한다</p><ul><li>기존 코드 :</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;redirect:/j_spring_security_check?j_username=&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUserSe</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getId</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;&amp;j_password=&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUniqId</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><ul><li>변경 코드 (일반 Controller인 경우) :</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/uat/uia/actionSecurityLogin.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>actionSecurityLogin</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;loginVO&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>LoginVO</span> <span style=color:#000>loginVO</span><span style=color:#ce5c00;font-weight:700>,</span> 
</span></span><span style=display:flex><span>	<span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>	<span style=color:#000>ModelMap</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>UsernamePasswordAuthenticationFilter</span> <span style=color:#000>springSecurity</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>ApplicationContext</span> <span style=color:#000>act</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebApplicationContextUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getRequiredWebApplicationContext</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getSession</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getServletContext</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@SuppressWarnings</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;rawtypes&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Map</span> <span style=color:#000>beans</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>act</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBeansOfType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UsernamePasswordAuthenticationFilter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>beans</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>springSecurity</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UsernamePasswordAuthenticationFilter</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>beans</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>values</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>toArray</span><span style=color:#ce5c00;font-weight:700>()[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>IllegalStateException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;No AuthenticationProcessingFilter&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>springSecurity</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setContinueChainBeforeSuccessfulAuthentication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>);</span>	<span style=color:#8f5902;font-style:italic>// false 이면 chain 처리 되지 않음.. (filter가 아닌 경우 false로...)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>	<span style=color:#000>springSecurity</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>doFilter</span><span style=color:#ce5c00;font-weight:700>(</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>RequestWrapperForSecurity</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUserSe</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getId</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUniqId</span><span style=color:#ce5c00;font-weight:700>()),</span> 
</span></span><span style=display:flex><span>		<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;forward:/cmm/main/mainPage.do&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>	<span style=color:#8f5902;font-style:italic>// 성공 시 페이지.. (redirect 불가)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>RequestWrapperForSecurity</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>HttpServletRequestWrapper</span> <span style=color:#ce5c00;font-weight:700>{</span>	
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>username</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>password</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>RequestWrapperForSecurity</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>username</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>username</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>username</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>password</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getRequestURI</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>HttpServletRequest</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getRequest</span><span style=color:#ce5c00;font-weight:700>()).</span><span style=color:#c4a000>getContextPath</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;/j_spring_security_check&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>equals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;j_username&#34;</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>username</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>equals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;j_password&#34;</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>변경 코드 (Filter인 경우) :</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovSpringSecurityLoginFilter</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>Filter</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>FilterConfig</span> <span style=color:#000>config</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>init</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FilterConfig</span> <span style=color:#000>filterConfig</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>ServletException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>config</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>filterConfig</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>doFilter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>FilterChain</span> <span style=color:#000>chain</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>IOException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ServletException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>HttpServletRequest</span> <span style=color:#000>httpRequest</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#000>HttpServletResponse</span> <span style=color:#000>httpResponse</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletResponse</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>UsernamePasswordAuthenticationFilter</span> <span style=color:#000>springSecurity</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>ApplicationContext</span> <span style=color:#000>act</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebApplicationContextUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getRequiredWebApplicationContext</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getServletContext</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#5c35cc;font-weight:700>@SuppressWarnings</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;rawtypes&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Map</span> <span style=color:#000>beans</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>act</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBeansOfType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UsernamePasswordAuthenticationFilter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>beans</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>springSecurity</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UsernamePasswordAuthenticationFilter</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>beans</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>values</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>toArray</span><span style=color:#ce5c00;font-weight:700>()[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>IllegalStateException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;No AuthenticationProcessingFilter&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//springSecurity.setContinueChainBeforeSuccessfulAuthentication(false);	// false 이면 chain 처리 되지 않음.. (filter가 아닌 경우 false로...)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>		<span style=color:#000>springSecurity</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>doFilter</span><span style=color:#ce5c00;font-weight:700>(</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>RequestWrapperForSecurity</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUserSe</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getId</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUniqId</span><span style=color:#ce5c00;font-weight:700>()),</span> 
</span></span><span style=display:flex><span>			<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>chain</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>RequestWrapperForSecurity</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>HttpServletRequestWrapper</span> <span style=color:#ce5c00;font-weight:700>{</span>	
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>username</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>password</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>RequestWrapperForSecurity</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>username</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>username</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>username</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>password</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getRequestURI</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>HttpServletRequest</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getRequest</span><span style=color:#ce5c00;font-weight:700>()).</span><span style=color:#c4a000>getContextPath</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;/j_spring_security_check&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>equals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;j_username&#34;</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>username</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>equals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;j_password&#34;</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-3c7e75834c2954205666e8083709828e>7 - Session 방식 접근제어 권한설정</h1><div class=lead>표준프레임워크 3.9부터 Session 방식의 접근제어 권한관리를 설정할 수 있으며, 이를 위해 XML 선언 및 SQL 쿼리를 포함한 기본 설정이 필요하다. 롤 권한 변경 시 서버 재기동 없이 <code>AuthorityResourceMetadata</code>의 <code>reload()</code> 메소드를 호출하여 설정을 적용할 수 있다.</div><h1 id=session-방식-접근제어-권한설정>Session 방식 접근제어 권한설정</h1><h2 id=개요>개요</h2><p>표준프레임워크 3.9부터 Session 방식으로 접근제어 권한관리를 설정 할 수 있는 방법을 제공한다.
내부적으로 필요한 설정을 가지고 있고, XML Schema를 통해 필요한 설정만을 추가할 수 있도록 제공한다.
이 기능을 사용하기 위해서는 globals.properties 파일에서 Globals.Auth = session 로 설정한다.</p><h2 id=환경설정>환경설정</h2><h3 id=pomxml-dependency추가>pom.xml (dependency추가)</h3><p>Session 방식의 접근제어 권한관리를 사용하기 위해서는 표준프레임워크 실행환경 구성요소중 org.egovframe.rte.fdl.access 라이브러리가 설치되어야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.egovframe.rte<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>org.egovframe.rte.fdl.access<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;version&gt;</span>${org.egovframe.rte.version}<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><h3 id=xml-namespace-및-schema-설정>XML namespace 및 schema 설정</h3><p>접근제어를 설정하기 위해서는 다음과 같은 xml 선언이 필요하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:egov-access=</span><span style=color:#4e9a06>&#34;http://maven.egovframe.go.kr/schema/egov-access&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		http://maven.egovframe.go.kr/schema/egov-access http://maven.egovframe.go.kr/schema/egov-access/egov-access-4.2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><h2 id=session-접근제어-설정>Session 접근제어 설정</h2><p>Session 방식 접근제어 권한관리에 대한 기본 설정 정보를 제공한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;egov-access:config</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;egovAccessConfig&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>globalAuthen=</span><span style=color:#4e9a06>&#34;session&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>mappingPath=</span><span style=color:#4e9a06>&#34;/**/*.do&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>dataSource=</span><span style=color:#4e9a06>&#34;egov.dataSource&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>loginUrl=</span><span style=color:#4e9a06>&#34;/uat/uia/egovLoginUsr.do&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>accessDeniedUrl=</span><span style=color:#4e9a06>&#34;/uat/uia/egovLoginUsr.do?auth_error=1&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>sqlAuthorityUser=</span><span style=color:#4e9a06>&#34;SELECT CONCAT(B.USER_SE, B.USER_ID) USERID, A.AUTHOR_CODE AUTHORITY
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		FROM COMTNEMPLYRSCRTYESTBS A, COMVNUSERMASTER B
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		WHERE A.SCRTY_DTRMN_TRGET_ID = B.ESNTL_ID&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>sqlRoleAndUrl=</span><span style=color:#4e9a06>&#34;SELECT A.ROLE_PTTRN URL, B.AUTHOR_CODE AUTHORITY
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		FROM COMTNROLEINFO A, COMTNAUTHORROLERELATE B
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		WHERE A.ROLE_CODE = B.ROLE_CODE
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		AND A.ROLE_TY = &#39;url&#39;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		ORDER BY A.ROLE_SORT&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>requestMatcherType=</span><span style=color:#4e9a06>&#34;regex&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>excludeList=</span><span style=color:#4e9a06>&#34;/uat/uia/**, /index.do, /EgovLeft.do, /EgovContent.do, /EgovTop.do, /EgovBottom.do, /validator.do, /uss/umt/**, /sec/rnc/EgovRlnmCnfirm.do, /EgovModal.do&#34;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h3 id=속성-설명>속성 설명</h3><table><thead><tr><th>속성</th><th>설명</th><th>필수여부</th><th>비고</th></tr></thead><tbody><tr><td>globalAuthen</td><td>globals.properties 설정과 동일하게 적용 (Globals.Auth = session 설정 사용시 globalAuthen = “session”으로 값을 동일하게 일치하여 설정 필요)</td><td>필수</td><td></td></tr><tr><td>dataSource</td><td>DBMS 설정 dataSource</td><td>필수</td><td></td></tr><tr><td>loginUrl</td><td>로그인 페이지 URL</td><td>필수</td><td></td></tr><tr><td>accessDeniedUrl</td><td>권한이 없는 경우 호출되는 페이지 URL</td><td>필수</td><td></td></tr><tr><td>sqlAuthorityUser</td><td>인증된 사용자의 권한(authority) 조회 query</td><td>필수</td><td></td></tr><tr><td>sqlRoleAndUrl</td><td>Role 및 URL 패턴</td><td>필수</td><td></td></tr><tr><td>requestMatcherType</td><td>패턴 매칭 방식(regex, ant, ciRegex: case-insensitive regex)</td><td>필수</td><td>default : regex</td></tr><tr><td>excludeList</td><td>접근제한 예외처리 URL(구분자: ,)</td><td>필수</td><td></td></tr></tbody></table><ul><li>excludeList(접근제한 예외 목록 URL) 예시 값<ul><li>회원관리 : /uat/uia/**</li><li>실명확인 : /sec/rnc/**</li><li>우편번호 : /sym/ccm/zip/**</li><li>로그인이미지관리 : /uss/ion/lsi/**</li><li>약관확인 : /uss/umt/**</li><li>포털예제배너 : /uss/ion/bnr/getBannerImage.do</li><li>처음화면 : /index.do</li><li>로그인화면이미지 : /cmm/fms/getImage.do</li><li>좌측메뉴 : /EgovLeft.do</li><li>초기화면 : /EgovContent.do</li><li>상단메뉴 : /EgovTop.do</li><li>하단메뉴 : /EgovBottom.do</li><li>모달팝업 : /EgovModal.do</li><li>만족도조사 : /cop/stf/selectSatisfactionList.do</li><li>만족도조사 선택 : /cop/stf/selectSingleSatisfaction.do</li><li>댓글 : /cop/cmt/selectArticleCommentList.do</li><li>댓글 선택 : /cop/cmt/updateArticleCommentView.do</li></ul></li><li>동적 include 방식 - JSP 에서 <code>&lt;c:import></code> 혹은 <code>&lt;jsp:include></code> 사용시 호출대상 URL이 .do 인 경우<ul><li>호출대상.do 뿐만 아니라 .do URL이 호출하는 JSP파일도 권한관리에 등록해야 함</li></ul></li></ul><h2 id=session-접근제어-재설정>Session 접근제어 재설정</h2><p>Session 접근제어에서 사용자의 롤권한변경 후 서버 재기동 없이 적용하는 방법을 제공한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.egovframe.rte.fdl.access.bean.AuthorityResourceMetadata</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;authorityResource&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>AuthorityResourceMetadata</span> <span style=color:#000>sessionResourceMetadata</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/insertAuthorGroupInsert.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>insertAuthorGroup</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>    <span style=color:#000>sessionResourceMetadata</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>reload</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-b95fdbf4211d3a6b3f813f5b8072da13>8 - Scheduling 서비스</h1><div class=lead>Scheduling 서비스는 주기적 작업을 관리하는 기능으로, Quartz 스케줄러와 Spring을 통합하여 사용된다. Quartz는 작업(Job), 스케줄(Trigger)을 분리해 유연성을 제공하며, Spring에서 JobDetailBean과 MethodInvokingJobDetailFactoryBean을 통해 작업을 생성하고, SimpleTriggerBean과 CronTriggerBean으로 작업을 스케줄링한다.</div><h1 id=scheduling-서비스>Scheduling 서비스</h1><h2 id=개요>개요</h2><p>Scheduling 서비스는 어플리케이션 서버 내에서 주기적으로 발생하거나 반복적으로 발생하는 작업을 지원하는 기능으로서 유닉스의 크론(Cron) 명령어와 유사한 기능을 제공한다.<br>실행환경 Scheduling 서비스는 오픈소스 소프트웨어로 Quartz 스케쥴러를 사용한다. 본 장에서는 Quartz 스케쥴러의 기본 개념을 살펴본 후, IoC 서비스를 제공하는 Spring과 Quartz 스케쥴러를 통합하여 사용하는 방법을 살펴본다.</p><h2 id=설명>설명</h2><h3 id=quartz-스케쥴러>Quartz 스케쥴러</h3><p>Quartz 스케쥴러 실행과 관계된 주요 요소는 Scheduler, Job, JobDetail, Trigger 가 있다.</p><ul><li><strong>Scheduler</strong> 는 Quartz 실행 환경을 관리하는 핵심 개체이다.</li><li><strong>Job</strong> 은 사용자가 수행할 작업을 정의하는 인터페이스로서 Trigger 개체를 이용하여 스케쥴할 수 있다.</li><li><strong>JobDetail</strong> 는 작업명과 작업그룹과 같은 수행할 Job에 대한 상세 정보를 정의하는 개체이다.</li><li><strong>Trigger</strong> 는 정의한 Job 개체의 실행 스케쥴을 정의하는 개체로서 Scheduler 개체에게 Job 수행시점을 알려주는 개체이다.</li></ul><p>Quartz 스케쥴러는 수행 작업을 정의하는 Job과 실행 스케쥴을 정의하는 Trigger를 분리함으로써 유연성을 제공한다. Job 과 실행 스케쥴을 정의한 경우, Job은 그대로 두고 실행 스케쥴만을 변경할 수 있다. 또한 하나의 Job에 여러 개의 실행 스케쥴을 정의할 수 있다.</p><h4 id=quartz-스케쥴러-사용-예제>Quartz 스케쥴러 사용 예제</h4><p>Quartz 스케쥴러의 이해를 돕기 위해 간단한 예제를 살펴본다. 다음 예는 Quartz 매뉴얼에서 참조한 것으로 Quartz를 사용하는 방법과 사용자 Job을 설정하는 방법을 보여준다.</p><h5 id=사용자-정의-job>사용자 정의 Job</h5><p>사용자는 Job 개체를 생성하기 위해 org.quartz.Job 인터페이스를 구현하고 심각한 오류가 발생한 경우 JobExecutionException 예외를 던질 수 있다. Job 인터페이스는 단일 메소드로 execute()을 정의한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DumbJob</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>Job</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>execute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>JobExecutionContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>JobExecutionException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;DumbJob is executing.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>DumbJob은 Job 인터페이스의 execute() 메소드를 구현한다.</li><li>execute() 메소드는 단순히 Job이 수행됨을 표시하는 메시지를 출력한다.</li></ul><h5 id=quartz-사용-코드>Quartz 사용 코드</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>  <span style=color:#000>JobDetail</span> <span style=color:#000>jobDetail</span> <span style=color:#ce5c00;font-weight:700>=</span> 
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>JobDetail</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;myJob&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#8f5902;font-style:italic>// Job 명
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>              <span style=color:#000>sched</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>DEFAULT_GROUP</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#8f5902;font-style:italic>// Job 그룹명(&#39;null&#39; 값인 경우 DEFAULT_GROUP 으로 정의됨)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>              <span style=color:#000>DumbJob</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>       <span style=color:#8f5902;font-style:italic>// 실행할 Job 클래스
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>  <span style=color:#000>Trigger</span> <span style=color:#000>trigger</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>TriggerUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>makeDailyTrigger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>30</span><span style=color:#ce5c00;font-weight:700>);</span>  <span style=color:#8f5902;font-style:italic>// 매일 08시 30분 실행
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>trigger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setStartTime</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Date</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>// 즉시 시작
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>trigger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;myTrigger&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#000>sched</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>scheduleJob</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>jobDetail</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>trigger</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><ul><li>우선 Job 설정을 위해 JobDetail 클래스를 정의한다.</li><li>TriggerUtils을 이용하여 매일 8시30분 실행하는 Trigger를 생성한다.</li><li>마지막으로, Scheduler에 JobDetail과 Trigger를 등록한다.</li></ul><h3 id=spring-과-quartz-통합>Spring 과 Quartz 통합</h3><p>Spring은 Scheduling 지원을 위한 통합 클래스를 제공한다. Spring Framework는 JDK 1.3 버전부터 포함된 Timer 와 오픈소스 소프트웨어인 Quartz 스케쥴러를 지원한다. 여기서는 Quartz 스케쥴러와 Spring을 통합하여 사용하는 방법을 살펴본다.<br>Quartz 스케쥴러와의 통합을 위해 Spring은 Spring 컨텍스트 내에서 Quart Scheduler와 JobDetail, Trigger 를 빈으로 설정할 수 있도록 지원한다. 다음은 예제를 중심으로 Quartz 작업 생성과 작업 스케쥴링, 작업 시작 방법을 살펴본다.</p><h4 id=작업-생성>작업 생성</h4><p>Spring은 작업 생성을 위한 방법으로 다음 두 가지 방식을 제공한다.</p><ul><li>JobDetailBean을 이용한 방법으로, QuartzJobBean을 상속받아 Job 클래스를 생성하는 방법</li><li>MethodInvokingJobDetailFactoryBean을 이용하여 Bean 객체의 메소드를 직접 호출하는 방법</li></ul><h5 id=jobdetailbean을-이용한-작업-생성>JobDetailBean을 이용한 작업 생성</h5><p>JobDetail는 작업 실행에 필요한 정보를 담고 있는 객체이다. Spring은 JobDetail 빈 생성을 위해 JobDetailBean을 제공한다. 예를 들면 다음과 같다.</p><h5 id=jobdetailbean-소스-코드>JobDetailBean 소스 코드</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>egovframework.rte.fdl.scheduling.sample</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>SayHelloJob</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>QuartzJobBean</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setName</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>;</span>	
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>executeInternal</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>JobExecutionContext</span> <span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>JobExecutionException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Hello, &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>SayHelloJob 클래스는 작업 생성을 위해 QuartzJobBean의 executeInternal(..) 함수를 오버라이드한다.</li></ul><h5 id=jobdetailbean-설정>JobDetailBean 설정</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;jobDetailBean&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.scheduling.quartz.JobDetailBean&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;jobClass&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.scheduling.sample.SayHelloJob&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;jobDataAsMap&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;map&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;entry</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;name&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;JobDetail&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/map&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><ul><li>jobDataAsMap 개체를 이용하여 JobDetail 개체에 Job 설정에 필요한 속성 정보를 전달한다.</li></ul><h5 id=methodinvokingjobdetailfactorybean을-이용한-작업-생성>MethodInvokingJobDetailFactoryBean을 이용한 작업 생성</h5><h5 id=소스-코드>소스 코드</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>egovframework.rte.fdl.scheduling.sample</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>SayHelloService</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setName</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>;</span>	
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>sayHello</span> <span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Hello, &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>작업 수행을 할 Bean 클래스를 정의한다.</li></ul><h5 id=설정>설정</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;sayHelloService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.scheduling.sample.SayHelloService&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;name&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;FactoryBean&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;jobDetailFactoryBean&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;targetObject&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;sayHelloService&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;targetMethod&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;sayHello&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;concurrent&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><ul><li>정의한 Bean 객체의 메소드를 직접 호출하는 작업을 생성하기 위해 MethodInvokingJobDetailFactoryBean을 정의한다.</li></ul><h4 id=작업-스케쥴링>작업 스케쥴링</h4><p>Spring에서 주로 사용되는 Trigger타입은 SimpleTriggerBean과 CronTriggerBean 이 있다. SimpleTrigger 는 특정 시간, 반복 회수, 대기 시간과 같은 단순 스케쥴링에 사용된다. CronTrigger 는 유닉스의 Cron 명령어와 유사하며, 복잡한 스케쥴링에 사용된다. CronTrigger 는 달력을 이용하듯 특정 시간, 요일, 월에 Job 을 수행하도록 설정할 수 있다. 다음은 SimpleTriggerBean과 CronTriggerBean을 이용하여 앞서 생성한 작업을 스케쥴링하는 방법을 살펴본다.</p><h5 id=simpletriggerbean을-이용한-설정>SimpleTriggerBean을 이용한 설정</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;simpleTrigger&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.scheduling.quartz.SimpleTriggerBean&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;jobDetail&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;jobDetailBean&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>&lt;!-- 즉시 시작 --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;startDelay&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;0&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   	<span style=color:#8f5902;font-style:italic>&lt;!-- 매 10초마다 실행 --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;repeatInterval&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;10000&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><ul><li>앞서 JobDetailBean 을 이용하여 생성한 작업을 스케쥴링을 위한 Trigger 에 등록한다. SimpleTriggerBean은 즉시 시작하고 매 10초마다 실행하도록 설정하였다.</li></ul><h5 id=crontriggerbean을-이용한-설정>CronTriggerBean을 이용한 설정</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;cronTrigger&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.scheduling.quartz.CronTriggerBean&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;jobDetail&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;jobDetailFactoryBean&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   	<span style=color:#8f5902;font-style:italic>&lt;!-- 매 10초마다 실행 --&gt;</span>
</span></span><span style=display:flex><span>   	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cronExpression&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;*/10 * * * * ?&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><ul><li>앞서 MethodInvokingJobDetailFactoryBean 을 이용하여 생성한 작업을 스케쥴링을 위한 Trigger 에 등록한다. CronTriggerBean은 매 10초마다 실행하도록 설정하였다. 크론 표현식에 대한 자세한 설명은 <a href=http://www.quartz-scheduler.org/documentation/quartz-2.3.0/tutorials/tutorial-lesson-06.html>Quartz Cron 표현식</a>를 참조한다.</li></ul><h4 id=작업-시작하기>작업 시작하기</h4><p>스케쥴링한 작업의 시작을 위해 Spring 은 SchedulerFactoryBean을 제공한다.</p><h5 id=설정-1>설정</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;scheduler&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.scheduling.quartz.SchedulerFactoryBean&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;triggers&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;simpleTrigger&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;cronTrigger&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><ul><li>SchedulerFactoryBean 을 이용하여 SimpleTriggerBean 과 CronTriggerBean 기반의 각 Trigger 작업을 시작한다.</li></ul><h2 id=참고자료>참고자료</h2><ul><li><a href=http://www.quartz-scheduler.org/documentation/quartz-2.3.0/quick-start.html>Quartz 매뉴얼</a></li><li><a href=https://docs.spring.io/spring-framework/docs/5.3.27/reference/html/integration.html#scheduling>Spring Scheduling 매뉴얼</a></li><li><a href=http://www.quartz-scheduler.org/api/2.3.0/index.html>Quartz API</a></li><li><a href=https://docs.spring.io/spring-framework/docs/5.3.27/javadoc-api>Spring API</a></li><li><a href=http://www.quartz-scheduler.org/documentation/quartz-2.3.0/tutorials/tutorial-lesson-06.html>Quartz Cron 표현식</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-ce3eb8e3fa2fd62a032dd09d0704977a>9 - Logging</h1><div class=lead>전자정부 표준프레임워크 3.0부터 SLF4J를 도입하여 다양한 로깅 프레임워크와 연계하며, Log4j 2를 기본 로깅 구현체로 사용한다. 로깅 서비스는 시스템 상태를 기록하고 관리할 수 있지만, 성능 오버헤드를 줄이기 위한 메커니즘이 필요하다. System.out.println() 대신 SLF4J와 Log4j 2를 사용한 로깅이 권장된다.</div><h1 id=logging-서비스>Logging 서비스</h1><h2 id=개요>개요</h2><p>전자정부 표준프레임워크 3.0부터는 다양한 Logging Framework와 연계할 수 있도록 <strong>SLF4J</strong>를 도입하였고,<br>Logging 구현체는 <strong>Log4j 2</strong>를 이용하여 Logging을 수행한다.</p><p>Logging 서비스는 시스템의 개발이나 운용시 발생할 수 있는 사항에 대해서,<br>시스템의 외부 저장소에 기록하여 시스템의 상황을 쉽게 파악할 수 있도록 도와준다.<br>뿐만 아니라 테스팅 코드와 운영 코드를 동일하게 가져가면서 로깅을 선언적으로 관리할 수 있다.<br>과도한 Logging은 운영시 성능 오버헤드를 발생시킬 수 있으므로, 최소화할 수 있는 메커니즘이 필요하다.</p><p>많은 개발자가 Log을 출력하기 위해 일반적으로 사용하는 방식은 System.out.println()이다.<br>하지만 이 방식은 간편한 반면, 다음과 같은 이유로 권장하지 않는다.</p><ul><li>콘솔 로그를 출력 파일로 리다이렉트 할 지라도, 어플리케이션 서버가 재시작할 때 파일이 overwrite될 수도 있음</li><li>개발/테스팅 시점에만 System.out.println()을 사용하고 운영으로 이관하기 전에 삭제하는 것은 좋은 방법이 아님</li><li>System.out.println() 호출은 디스크 I/O동안 동기화(synchronized)처리가 되므로 시스템의 throughput을 떨어뜨림</li><li>기본적으로 stack trace 결과는 콘솔에 남지만, 시스템 운영 중 콘솔을 통해 Exception을 추적하는 것은 바람직하지 못함</li><li>운영시의 코드가 테스트시의 코드와 다르게 동작할 수 있음</li></ul><p>본 페이지에서는 SLF4j와 Log4j 2에 대한 기본 사용법과 Migration에 대해 설명한다.</p><h2 id=설명>설명</h2><ul><li><p><a href=./logging-slf4j.md>SLF4J</a></p></li><li><p><a href=./logging-log4j2.md>Log4J 2</a></p><ul><li><a href=./logging-log4j2-configuration_code.md>프로그래밍내에서 직접 설정하는 방법</a></li><li><a href=./logging-log4j2-configuration_file.md>설정 파일을 사용하는 방법</a></li></ul></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-1d19dcf3da2b3672cf478149df4edb13>10 - SLF4J</h1><div class=lead>SLF4J는 다양한 로깅 프레임워크와 연계할 수 있는 추상화 계층을 제공하며, Log4j 2 또는 Logback과 함께 사용 가능하다. 기존의 Log4j 1.x나 Commons Logging을 SLF4J로 마이그레이션하려면, Bridge jar를 추가하고 logback.xml로 설정 파일을 변경해야 한다.</div><h2 id=slf4j>SLF4J</h2><h3 id=getting-started>Getting Started</h3><p>SLF4J(Simple Logging Facade For Java)는 특정 Logging 서비스 구현체에 종속되지 않도록 추상화 계층을 제공하며,<br>Jakarta Commons Logging(JCL), Log4j, Logback 등과 함께 사용할 수 있다.<br>다음은 SLF4J 샘플 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.slf4j.Logger</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.slf4j.LoggerFactory</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>Slf4JLoggerTest</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// SLF4J를 이용한 Logger 오브젝트 생성
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Logger</span> <span style=color:#000>LOGGER</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LoggerFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Slf4JLoggerTest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// Parameterized logging - String 타입
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>String</span> <span style=color:#000>message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Hello, eGovFrame 3.0&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>   <span style=color:#000>String</span> <span style=color:#000>message2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Welcome to eGovFrame 3.0&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;SLF4J Logger - {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 출력결과 - SLF4J Logger - Hello, eGovFrame 3.0
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;SLF4J Logger - {} and {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>message2</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 출력결과 - SLF4J Logger - Hello, eGovFrame 3.0 and Welcome to eGovFrame 3.0
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// Parameterized logging - Object 타입
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>args</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span><span style=display:flex><span>   <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>   <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Integer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Date</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;SLF4J Logger - {}, {}, {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 출력결과 - SLF4J Logger - 1, 2, Fri Mar 23 11:08:28 KST 2014
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=1-slf4j-기본-설정>1. SLF4J 기본 설정</h4><ol><li>SLF4J API를 사용하기 위해 <strong>slf4j-api.jar를 추가</strong>한다.</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- SLF4J --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.slf4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>slf4j-api<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>x.x.x<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><ol start=2><li>Logging 충돌 방지를 위해 Spring의 Default Logging Framework인 <strong>commons-logging.jar를 제거</strong>하되,<br>기존 Commons Logging API가 적절하게 변환되어 처리될 수 있도록 SLF4j JCL Bridge인 <strong>jcl-over-slf4j.jar를 추가</strong>한다.</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Exclude Commons Logging in favor of SLF4J --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.springframework<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>spring-context<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>${spring.maven.artifact.version}<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;exclusions&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;exclusion&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>commons-logging<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>commons-logging<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/exclusion&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/exclusions&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- SLF4J JCL Bridge --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.slf4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>jcl-over-slf4j<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>x.x.x<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id=2-logging-구현체-설정>2. Logging 구현체 설정</h4><ol><li>SLF4J가 컴파일 시에 Logging 구현체를 사용할 수 있도록 구현체별 <strong>SLF4J Binding jar와 Implementation jar를 추가</strong>한다.</li></ol><table><thead><tr><th>Logging 구현체</th><th>SLF4J Binding jar</th></tr></thead><tbody><tr><td>Log4j 2</td><td>log4j-slf4j-impl.jar</td></tr><tr><td>Log4j 1.2</td><td>slf4j-log4j12.jar</td></tr><tr><td>JDK 1.x Logging</td><td>slf4j-jdk14.jar</td></tr><tr><td>NOP</td><td>slf4j-nop.jar</td></tr><tr><td>JCL</td><td>slf4j-jcl.jar</td></tr><tr><td>Logback</td><td>logback-classic.jar, logback-core.jar</td></tr></tbody></table><ul><li>Log4j 1.2 구현체 사용 시</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!--  SLF4J Log4j1.2 Binding --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span> 
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.slf4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>slf4j-log4j12<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>x.x.x<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Log4j 1.2 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>log4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>log4j<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>1.2<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><ul><li>Log4j 2 구현체 사용 시</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Log4j2 SLF4J Binding --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.apache.logging.log4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>log4j-slf4j-impl<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>x.x.x<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Log4j 2 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.apache.logging.log4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>log4j-api<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>x.x.x<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id=3-slf4j-logger-객체-생성과-메서드-사용>3. SLF4J Logger 객체 생성과 메서드 사용</h4><ol><li>Logger 객체 생성</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Logger</span> <span style=color:#000>LOGGER</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LoggerFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Slf4JLoggerTest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><ol start=2><li>로깅 메서드 호출</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// {}-placeholder를 이용한 Parameterized Logging
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>String</span> <span style=color:#000>message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Hello, eGovFrame 3.0&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;SLF4J Logger - {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=migration-to-slf4j-from-legacy-apis>Migration to SLF4J from Legacy APIs</h3><p>기존 Legacy API을 유지한 채 SLF4J를 함께 사용하려면, SLF4J와 레거시 API를 연결할 수 있는 Bridge jar가 필요하다.<br>아래에서는 Log4j 1.x와 JCL 레거시를 기준으로 설명한다.</p><h4 id=1-logging-구현체-jar를-slf4j-bridge-jar로-대체>1. Logging 구현체 jar를 SLF4J Bridge jar로 대체</h4><p>이는 각 구현체의 Logging 제어권을 SLF4J로 넘긴다는 것을 의미하며, 레거시 API를 유지하기 위해서 필요한 작업이다.</p><ol><li>Log4j 1.x 유지 시, log4j.jar를 log4j-over-slf4j.jar로 대체</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Log4j 1.x --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;dependency&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  &lt;groupId&gt;log4j&lt;/groupId&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  &lt;artifactId&gt;log4j&lt;/artifactId&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  &lt;version&gt;x.x.x&lt;/version&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;/dependency&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>--&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- SLF4J Log4j 1.x Bridge --&gt;</span>  
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.slf4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>log4j-over-slf4j<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>x.x.x<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>(주의) log4j-over-slf4j.jar는 slf4j-log4j12.jar(SLF4j Binding)과 동시에 사용할 수 없다.</p><ol start=2><li>JCL(Jakarta Commons Logging) 유지 시, commons-logging.jar를 jcl-over-slf4j.jar로 대체</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Commons Logging --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;dependency&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  &lt;groupId&gt;commons-logging&lt;/groupId&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  &lt;version&gt;1.1.1&lt;/version&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;/dependency&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>--&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- SLF4j JCL Bridge --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.slf4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>jcl-over-slf4j<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>x.x.x<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id=2-환경설정-파일을-logback으로-변경>2. 환경설정 파일을 logback으로 변경</h4><p>log4j 환경설정 파일은 SLF4J가 인식할 수 없기 때문에, 기존 환경설정을 logback으로 변경해야한다.<br><a href=http://logback.qos.ch/translator/>log4j properties file translator</a> 를 이용하거나 <a href=http://logback.qos.ch/manual/index.html>logback manual</a> 을 참조하여 변경할 수 있다.</p><p>다음은 logback.xml 샘플이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;configuration&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;appender</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;STDOUT&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>&lt;!-- encoders are assigned the type
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>         ch.qos.logback.classic.encoder.PatternLayoutEncoder by default --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;encoder&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;pattern&gt;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span style=color:#204a87;font-weight:700>&lt;/pattern&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/encoder&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/appender&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;root</span> <span style=color:#c4a000>level=</span><span style=color:#4e9a06>&#34;debug&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;appender-ref</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;STDOUT&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/root&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/configuration&gt;</span>
</span></span></code></pre></div><h2 id=참고-자료>참고 자료</h2><ul><li><a href=http://www.slf4j.org/>SLF4J</a></li><li><a href=http://logback.qos.ch/>Logback</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-06230004c0b9e521ccf3412b4600ddcc>11 - Log4j2</h1><div class=lead>Log4j 2는 Log4j의 차세대 버전으로서 비동기 로깅을 지원하여 애플리케이션의 성능에 미치는 영향을 최소화하고, 플러그인 아키텍처로 커스터마이징이 용이하며 다양한 출력 포맷과 로깅 레벨을 세밀하게 제어할 수 있다. XML, JSON, YAML 등 다양한 구성 파일 형식을 지원하여 설정이 유연하고, 구성 변경 시 서버를 재시작할 필요 없이 동적으로 적용할 수 있어 대규모 엔터프라이즈 애플리케이션에서도 널리 사용된다.</div><h2 id=설명>설명</h2><h3 id=log4j-2-변경사항>Log4j 2 변경사항</h3><ul><li>Java 6 이상 필요</li><li>XML 환경설정 단순화 (Log4j 1.x 와 호환되지 않음)</li><li>Property 파일을 통한 환경설정을 지원하지 않음</li><li>JSON을 통한 환경설정 지원</li><li>파라미터 방식으로 Log Message 출력</li><li>환경설정 변경시 서버 재기동 없이 자동 재호출</li><li>필터링 기능 향상</li><li>NoSQLAppender 등의 다양한 Appender 제공</li></ul><h3 id=log4j-2-추가기능>Log4j 2 추가기능</h3><h4 id=1-substituting-parameters>1. Substituting Parameters</h4><p>로그 메시지를 구성하는 방법으로, 기존 문자열 결합 방식과 달리 {} 안에 파라미터를 대입하여 로그 메시지를 생성하는 방법이다.<br>아래 코드는 출력할 로그 메시지를 완성하기 전에 Log Level을 체크하고, isDebugEnabled인 경우에만 메서드를 수행한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Logging in user {} with birthday {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>user</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getName</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>user</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBirthdayCalendar</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><h4 id=2-formatting-parameters>2. Formatting Parameters</h4><p>Substituting Parameters 로깅 방식을 사용하면 코드 내에서 직접 formatting이 가능하다.<br>이 기능을 사용하려면 getFormatterLogger() 메서드를 통해 Logger 오브젝트를 생성해야 한다.<br>포맷 변환 문자와 형식은 Java.util.Formatter 클래스를 참조한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#000>Logger</span> <span style=color:#000>logger</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LogManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFormatterLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;egovframework&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Logging in user %1$s with birthday %2$tm %2$te,%2$tY&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>user</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getName</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>user</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBirthdayCalendar</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Integer.MAX_VALUE = %,d&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Integer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>MAX_VALUE</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Long.MAX_VALUE = %,d&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Long</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>MAX_VALUE</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 출력결과
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// User John Smith with birthday 05 23, 1995
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Integer.MAX_VALUE = 2,147,483,647
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Long.MAX_VALUE = 9,223,372,036,854,775,807
</span></span></span></code></pre></div><h4 id=3-flow-tracing>3. Flow Tracing</h4><p>Log4j 2는 trace(), debug(), info() 등과 같은 로깅 메서드 뿐 아니라, 어플리케이션 실행 순서를 좀 더 쉽게 파악할 수 있도록 하는 추가적인 메서드를 제공한다.</p><table><thead><tr><th>메서드</th><th>기능</th><th>위치</th><th>사용</th></tr></thead><tbody><tr><td>entry()</td><td>로그의 시작을 표시, 전달된 메서드 파라미터 출력</td><td>로깅 메서드 시작부분</td><td>logger.entry() or logger.entry(Object… params)</td></tr><tr><td>exit()</td><td>로그의 끝을 표시, 리턴값 출력</td><td>return문 or 로깅 메서드 끝부분</td><td>logger.exit() or logger.exit(Object… result)</td></tr><tr><td>throwing()</td><td>예외나 에러가 발생했을 때, 해당 예외/에러정보를 출력</td><td>예외발생 시</td><td>throw logger.throwing(new MyException);</td></tr><tr><td>catching()</td><td>예외을 catch했을 때, 해당 예외정보를 출력</td><td>catch문</td><td>logger.catching(e);</td></tr></tbody></table><p>이러한 메서드들이 만드는 로깅 이벤트가 기본적인 로깅 이벤트와 분리될 수 있도록 디폴트 Log Level와 Marker가 설정되어 있다.<br>이에 따라 entry와 exit 메서드는 TRACE 레벨에서만 출력되며 FLOW Marker를 통해 다른 로그 메세지로부터 분리(필터링)할 수 있고,<br>throwing과 catching 메서드는 ERROR 레벨에서만 출력되며 EXCEPTION Marker를 통해 필터링할 수 있다.</p><table><thead><tr><th>메서드</th><th>Log Level</th><th>Marker</th></tr></thead><tbody><tr><td>entry()</td><td>TRACE</td><td>ENTER or FLOW</td></tr><tr><td>exit()</td><td>TRACE</td><td>EXIT or FLOW</td></tr><tr><td>throwing()</td><td>ERROR</td><td>THROWING or EXCEPTION</td></tr><tr><td>catching()</td><td>ERROR</td><td>CATCHING or EXCEPTION</td></tr></tbody></table><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>saveDept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>deptNo</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>entry</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptNo</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 메서드 시작부분에 명시, 전달받은 파라미터 출력
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>     <span style=color:#000>Dept</span> <span style=color:#000>dept</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>saveDept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptNo</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     <span style=color:#000>String</span> <span style=color:#000>nextPg</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;redirect:/dept/deptList.do&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>nextPg</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 메서드 종료부분에 명시, 리턴할 파라미터 출력
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>main</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>     <span style=color:#000>saveDept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     <span style=color:#8f5902;font-style:italic>// 출력결과
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#8f5902;font-style:italic>// TRACE saveDept - entry(20)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#8f5902;font-style:italic>// TRACE saveDept - exit(redirect:/dept/deptList.do)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=4-markers>4. Markers</h4><p>한꺼번에 다량의 로그가 출력되면 어느 위치에서 문제가 발생했는지 정확하게 예측할 수 없다.<br>또한 Log4j와 같은 Logging Framework를 사용하는 이유는 어플리케이션에서 발생하는 문제를 확인하고 디버깅 하기 위한 것이다.<br>이는 원하는 시점에서 로그 정보의 필터링이 가능해야함을 뜻한다.</p><p>이미 로깅 메서드와 Logger의 Log Level 설정을 통해 출력할 로그를 필터링 할 수 있지만,<br>Log4j 2에서는 Marker 기능을 통해 좀 더 상세한 필터링을 지원한다. 예를 들어, Flow Tracing 메서드와 기본적인 로깅 이벤트를 분리하고 싶거나, SQL문만 별도로 출력하고 싶은 경우에는 Marker 설정을 통해 기능을 구현할 수 있다.</p><p>Marker는 다음과 같은 특징을 갖는다.</p><ul><li>Marker name은 유일해야 한다.</li><li>Marker는 final로 선언되어야 하며, 오직 하나의 Parent Marker를 갖는다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>MyClass</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Logger</span> <span style=color:#000>LOGGER</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LogManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MyClass</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Marker name = &#34;SQL&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Marker</span> <span style=color:#000>SQL_MARKER</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>MarkerManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMarker</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;SQL&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Marker name = &#34;SQL_UPDATE&#34;, Parent marker = SQL_MARKER
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Marker</span> <span style=color:#000>UPDATE_MARKER</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>MarkerManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMarker</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;SQL_UPDATE&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>SQL_MARKER</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Marker name = &#34;SQL_QUERY&#34;, Parent marker = SQL_MARKER
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Marker</span> <span style=color:#000>QUERY_MARKER</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>MarkerManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMarker</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;SQL_QUERY&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>SQL_MARKER</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>doQuery</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>table</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>entry</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>table</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>QUERY_MARKER</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;SELECT * FROM {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>table</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// select.log 파일에 출력됨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exit</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>doUpdate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>table</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>params</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>entry</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>table</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UPDATE_MARKER</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;UPDATE {} SET {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>table</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>formatCols</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>// update.log 파일에 출력됨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exit</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;Appenders&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;File</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;fileQuery&#34;</span> <span style=color:#c4a000>fileName=</span><span style=color:#4e9a06>&#34;./logs/file/select.log&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;MarkerFilter</span> <span style=color:#c4a000>marker=</span><span style=color:#4e9a06>&#34;SQL_QUERY&#34;</span> <span style=color:#c4a000>onMatch=</span><span style=color:#4e9a06>&#34;ACCEPT&#34;</span> <span style=color:#c4a000>onMismatch=</span><span style=color:#4e9a06>&#34;DENY&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;PatternLayout</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%level %m%n&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/File&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;File</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;fileUpdate&#34;</span> <span style=color:#c4a000>fileName=</span><span style=color:#4e9a06>&#34;./logs/file/update.log&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;MarkerFilter</span> <span style=color:#c4a000>marker=</span><span style=color:#4e9a06>&#34;SQL_UPDATE&#34;</span> <span style=color:#c4a000>onMatch=</span><span style=color:#4e9a06>&#34;ACCEPT&#34;</span> <span style=color:#c4a000>onMismatch=</span><span style=color:#4e9a06>&#34;DENY&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;PatternLayout</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%level %m%n&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/File&gt;</span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/Appenders&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h4 id=참고자료>참고자료</h4><p><a href=http://logging.apache.org/log4j/2.x/manual/flowtracing.html>Flow Tracing</a><br><a href=http://logging.apache.org/log4j/2.x/manual/markers.html>Markers</a></p><h3 id=migration-to-log4j-2-from-log4j-1x>Migration to Log4j 2 from Log4j 1.x</h3><h4 id=1-log4j-2-jar-추가-log4j-apijar-log4j-corejar--log4j-1x-jar-제거>1. Log4j 2 jar 추가 (log4j-api.jar, log4j-core.jar) + Log4j 1.x jar 제거</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Log4j 1.2 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;dependency&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  &lt;groupId&gt;log4j&lt;/groupId&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  &lt;artifactId&gt;log4j&lt;/artifactId&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  &lt;version&gt;1.2&lt;/version&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;/dependency&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>--&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Log4j 2 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.apache.logging.log4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>log4j-api<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>x.x.x<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.apache.logging.log4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>log4j-core<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>x.x.x<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id=2-log4j-1x---log4j-2-변환-bridge-jar-추가-log4j-12-apijar>2. Log4j 1.x -> Log4j 2 변환 Bridge jar 추가 (log4j-1.2-api.jar)</h4><p>기존 Log4j 1.x API가 Log4j 2 API로 변환 처리될 수 있도록 Log4j 2 Bridge를 추가한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.apache.logging.log4j<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>log4j-1.2-api<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>x.x.x<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id=3-log4j-1x의-logger-api-변경>3. Log4j 1.x의 Logger API 변경</h4><p>Log4j 2의 Logger 객체를 생성할 수 있도록, Logger 생성 메서드를 다음과 같이 변경한다.</p><table><thead><tr><th></th><th>Log4j 1.x</th><th>Log4j 2</th></tr></thead><tbody><tr><td>Package</td><td><strong>org.apache.log4j</strong></td><td><strong>org.apache.logging.log4j</strong></td></tr><tr><td>Logger 생성</td><td>org.apache.log4j.Logger logger = org.apache.log4j.<strong>Logger.getLogger();</strong></td><td>org.apache.logging.log4j.Logger logger = org.apache.logging.log4j.<strong>LogManager.getLogger();</strong></td></tr></tbody></table><h4 id=4-log4j-2-설정-추가-log4j2xml>4. Log4j 2 설정 추가 (log4j2.xml)</h4><p>Log4j 2에서는 설정 태그들이 직관적이고 간단하게 변경되었다. 더 자세한 설명은 <a href=./logging-log4j2_configuration_file.md>Log4j 2 상세 설정</a> 을 참조하도록 한다.</p><ul><li>Log4j 1.x</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE log4j:configuration PUBLIC &#34;-//APACHE//DTD LOG4J 1.2//EN&#34; &#34;log4j.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;log4j:configuration</span> <span style=color:#c4a000>xmlns:log4j=</span><span style=color:#4e9a06>&#39;http://jakarta.apache.org/log4j/&#39;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;appender</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;STDOUT&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.apache.log4j.ConsoleAppender&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;layout</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.apache.log4j.PatternLayout&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;param</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;ConversionPattern&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;%d %-5p [%t] %C{2} (%F:%L) - %m%n&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/layout&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/appender&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;category</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;org.apache.log4j.xml&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;priority</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;info&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/category&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Root&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;priority</span> <span style=color:#c4a000>value =</span><span style=color:#4e9a06>&#34;debug&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;appender-ref</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;STDOUT&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Root&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/log4j:configuration&gt;</span>
</span></span></code></pre></div><ul><li>Log4j 2</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;Configuration&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Appenders&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;Console</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;STDOUT&#34;</span> <span style=color:#c4a000>target=</span><span style=color:#4e9a06>&#34;SYSTEM_OUT&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;PatternLayout</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%d %-5p [%t] %C{2} (%F:%L) - %m%n&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/Console&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Appenders&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Loggers&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;Logger</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;org.apache.log4j.xml&#34;</span> <span style=color:#c4a000>level=</span><span style=color:#4e9a06>&#34;info&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;Root</span> <span style=color:#c4a000>level=</span><span style=color:#4e9a06>&#34;debug&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;AppenderRef</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;STDOUT&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/Root&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Loggers&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/Configuration&gt;</span>
</span></span></code></pre></div><h4 id=참고자료-1>참고자료</h4><p><a href=http://logging.apachttp://logging.apache.org/log4j/2.x/manual/migration.html>Migration to Log4j 2</a><br><a href=http://logging.apache.org/log4j/2.x/log4j-api/apidocs/index.html>Log4j 2 API Documentation</a><br><a href=http://logging.apache.org/log4j/2.x/log4j-core/apidocs/index.html>Log4j 2 Implementation Documentation</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-093515f1aea69abc53e8a6111faf5ba8>12 - Log4j 2 환경설정 (코드 내에서 직접 설정 시)</h1><div class=lead>Log4j 2 환경설정을 코드 내에서 직접 제어하여 Logger 객체를 생성하고, 기본 설정을 수정할 수 있다. 예시에서는 ConsoleAppender를 FileAppender로 변경하고 로그 레벨을 DEBUG로 설정하는 방법을 설명한다. Logger 설정 관련 메서드들을 사용하여 Appender와 Layout, Log Level을 동적으로 변경할 수 있다.</div><h1 id=log4j-2-환경설정-코드-내에서-직접-설정-시>Log4j 2 환경설정 (코드 내에서 직접 설정 시)</h1><h2 id=개요>개요</h2><p>Log4j 2 환경 설정(Appender, Layout, Log Level 등)을 코드 내에서 직접 제어할 수 있다.<br>아래는 별도의 외부 설정파일 없이도 로깅할 수 있는 방법을 설명한다.</p><h2 id=설명>설명</h2><h4 id=사용-방법>사용 방법</h4><p>별도의 Log4j 2 설정파일 없이도 코드 내에서 Logger 객체를 획득하여 로깅이 가능하다.<br>LogManager.getLogger() 메서드를 통해 Logger 객체를 생성하며, Log4j 2는 디폴트로 설정된 Logger 객체를 반환한다.<br>디폴트 Logger 객체의 기본적인 디폴트 설정은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span>  <span style=color:#c4a000>Log</span> <span style=color:#4e9a06>Level : ERROR</span>
</span></span><span style=display:flex><span>  <span style=color:#c4a000>Appender</span>  <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>ConsoleAppender</span>
</span></span><span style=display:flex><span>  <span style=color:#c4a000>Layout</span>    <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>PatternLayout</span>
</span></span><span style=display:flex><span>  <span style=color:#c4a000>pattern</span>   <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</span>
</span></span></code></pre></div><p>위 Logger 객체를 org.apache.logging.log4j.core.Logger로 캐스팅하면, Log Level, Appender, Layout 등 설정을 변경할 수 있다.<br>예시에서 사용된 설정 관련 메서드는 다음과 같다. 더 자세한 정보는 Log4j 2 API를 참조하도록 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>  <span style=color:#000>LogManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>()</span>                                                <span style=color:#ce5c00;font-weight:700>--</span> <span style=color:#000>Logger</span> <span style=color:#000>생성</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAppender</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>Logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>removeAppender</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>Logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAppenders</span><span style=color:#ce5c00;font-weight:700>()</span>  <span style=color:#ce5c00;font-weight:700>--</span> <span style=color:#000>Logger에</span> <span style=color:#000>Appender</span> <span style=color:#000>추가</span> <span style=color:#000>및</span> <span style=color:#000>제거</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>획득</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Layout</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createLayout</span><span style=color:#ce5c00;font-weight:700>()</span>                                                 <span style=color:#ce5c00;font-weight:700>--</span> <span style=color:#000>Layout</span> <span style=color:#000>생성</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Appender</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createAppender</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>Appender</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>removeAppender</span><span style=color:#ce5c00;font-weight:700>()</span>                  <span style=color:#ce5c00;font-weight:700>--</span> <span style=color:#000>Appender</span> <span style=color:#000>생성</span> <span style=color:#000>및</span> <span style=color:#000>삭제</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setLevel</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>Logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLevel</span><span style=color:#ce5c00;font-weight:700>()</span>                                  <span style=color:#ce5c00;font-weight:700>--</span> <span style=color:#000>Log</span> <span style=color:#000>Level</span> <span style=color:#000>설정</span> <span style=color:#000>및</span> <span style=color:#000>획득</span>
</span></span></code></pre></div><h4 id=사용-예시>사용 예시</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>log4j2ConfigTest</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// 디폴트 Logger 생성
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>Logger</span> <span style=color:#000>logger</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Logger</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>LogManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// 디폴트 설정 확인
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#8f5902;font-style:italic>// Log Level: ERROR
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Level</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ERROR</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLevel</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Appender: Console
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Appender</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>appenders</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAppenders</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>appenders</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>());</span> 
</span></span><span style=display:flex><span>	<span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ConsoleAppender</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>appenders</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Console&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Layout: Pattern
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>ConsoleAppender</span> <span style=color:#000>console</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ConsoleAppender</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>appenders</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Console&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PatternLayout</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>console</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLayout</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>	<span style=color:#000>PatternLayout</span> <span style=color:#000>pattern</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PatternLayout</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>console</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLayout</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>pattern</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// 설정 변경 전: ERROR Level 이상 로그만 출력됨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 전: [DEBUG] Test log4j 2.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 전: [INFO] Test log4j 2.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>warn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 전: [WARN] Test log4j 2.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 전: [ERROR] Test log4j 2.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>fatal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 전: [FATAL] Test log4j 2.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>/*
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	출력결과
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	===================
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	14:17:09.930 [main] ERROR egovframework.rte.fdl.logging.LogTest - 변경 전: [ERROR] Test log4j 2.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	14:17:09.931 [main] FATAL egovframework.rte.fdl.logging.LogTest - 변경 전: [FATAL] Test log4j 2
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// 디폴트 설정 변경
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>removeAppender</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>console</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Appender: File
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>PatternLayout</span> <span style=color:#000>layout</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>PatternLayout</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createLayout</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;%m%n&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>FileAppender</span> <span style=color:#000>file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>FileAppender</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createAppender</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;./logs/file/promatic.log&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;file&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>layout</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>);</span> 
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAppender</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Log Level: DEBUG
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setLevel</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Level</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>DEBUG</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// 설정 변경 후: DEBUG Level 이상 로그가 file(promatic.log)에 출력됨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 후: [DEBUG] Test log4j 2.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 후: [INFO] Test log4j 2.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>warn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 후: [WARN] Test log4j 2.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 후: [ERROR] Test log4j 2.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>fatal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 후: [FATAL] Test log4j 2.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>/* 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	출력결과
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	===================
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	변경 후: [DEBUG] Test log4j 2.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	변경 후: [INFO] Test log4j 2.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	변경 후: [WARN] Test log4j 2.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	변경 후: [ERROR] Test log4j 2.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	변경 후: [FATAL] Test log4j 2. 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=참고자료>참고자료</h4><p><a href=http://logging.apache.org/log4j/2.x/log4j-core/apidocs/index.html>Apache Log4j Core 2.0-rc1 API</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-7c64b27e2b9c65b360dcee88dfcd8959>13 - Log4j 2 환경설정 (설정 파일 사용 시)</h1><div class=lead>Log4j 2는 XML 형식의 설정 파일을 사용하여 Logger와 Appender, Layout 등을 정의할 수 있으며, 이를 통해 로그의 출력 위치와 형식을 설정할 수 있다. Logger는 로그 레벨과 Appender를 통해 로그의 출력 위치와 레벨을 제어하며, RollingFileAppender와 같은 다양한 Appender를 지원한다. Layout을 통해 로그 출력 형식을 지정하며, 특히 PatternLayout을 사용해 로그 메시지의 포맷을 세밀하게 설정할 수 있다.</div><h1 id=log4j-2-환경설정-설정-파일-사용-시>Log4j 2 환경설정 (설정 파일 사용 시)</h1><h2 id=개요>개요</h2><p>Log4j 2는 기존 Properties 파일 형식의 환경 설정을 지원하지 않으며,<br>XML (log4j2.xml) 혹은 JSON (log4j2.json or log4j2.jsn) 파일 형식의 환경 설정만 가능하다.</p><p>아래는 XML 파일을 이용한 환경 설정에 대해서만 다루며, JOSN 방식은 Log4j 2 매뉴얼을 참고하도록 한다.</p><h2 id=설명>설명</h2><h3 id=log4j-2-xml-configuration>Log4j 2 XML Configuration</h3><h4 id=xml-파일-위치>XML 파일 위치</h4><p>XML 파일(log4j2.xml)을 작성하고, WEB-INF/classes 하위에 포함될 수 있도록 위치시킨다.<br>Log4j 2가 초기화될 때 자동으로 위 설정 파일을 읽어들인다.</p><h4 id=xml-파일-정의>XML 파일 정의</h4><p>Log4j 2에서는 XML 파일의 최상위 요소가 <strong>&lt;Configuration></strong> 으로 변경되었다.<br>&lt;Configuration> 요소 아래에 Logger, Appender, Layout 설정 등과 관련한 하위 요소를 정의한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;Configuration&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- Appender, Layout 설정 --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;Appenders&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Console</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;console&#34;</span> <span style=color:#c4a000>target=</span><span style=color:#4e9a06>&#34;SYSTEM_OUT&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;PatternLayout/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Console&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;File</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;file&#34;</span> <span style=color:#c4a000>fileName=</span><span style=color:#4e9a06>&#34;./logs/file/sample.log&#34;</span> <span style=color:#c4a000>append=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;PatternLayout</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%d %5p [%c] %m%n&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/File&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/Appenders&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- Logger 설정 --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;Loggers&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Logger</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;egovLogger&#34;</span> <span style=color:#c4a000>level=</span><span style=color:#4e9a06>&#34;DEBUG&#34;</span> <span style=color:#c4a000>additivity=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;AppenderRef</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;console&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;AppenderRef</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;file&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Logger&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Rootlevel</span><span style=color:#a40000>=&#34;ERROR&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;AppenderRef</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;console&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Root&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/Loggers&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/Configuration&gt;</span>
</span></span></code></pre></div><h4 id=참고자료>참고자료</h4><p><a href=http://logging.apache.org/log4j/2.x/manual/configuration.html>Log4j 2 Configuration</a><br><a href=http://logging.apache.org/log4j/2.x/manual/configuration.html#XML>XML Syntax</a><br><a href=http://logging.apache.org/log4j/2.x/manual/configuration.html#JSON>JSON Syntax</a></p><h3 id=logger-설정>Logger 설정</h3><p>Logger는 로깅 작업을 수행하는 Log4j 주체로, Logger 설정을 제외한 모든 로깅 기능이 이 Logger를 통해 처리된다.<br>사용자는 어플리케이션 내에서 사용할 Logger를 정의해야 하며, Log Level과 Appender 설정에 따라 출력 대상과 위치가 결정된다.</p><h4 id=logger-선언과-정의>Logger 선언과 정의</h4><p>Root Logger를 포함한 모든 Logger는 상위 요소인 <strong>&lt;Loggers></strong> 아래에 선언한다.<br>Root Logger는 <strong>&lt;Root></strong> 요소로, 일반 Logger는 <strong>&lt;Logger></strong> 요소로 정의한다.<br>Logger는 하나 이상 정의할 수 있으며, Root 요소를 반드시 정의해야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;Loggers&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Logger&gt;</span>...<span style=color:#204a87;font-weight:700>&lt;/Logger&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Root&gt;</span>...<span style=color:#204a87;font-weight:700>&lt;/Root&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/Loggers&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;Loggers&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- attribute: name(Logger명), level(Log Level), additivity(중복로깅여부, true or false) --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- element: AppenderRef(Appender명) --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Logger</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;X.Y&#34;</span> <span style=color:#c4a000>level=</span><span style=color:#4e9a06>&#34;INFO&#34;</span> <span style=color:#c4a000>additivity=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;AppenderRef</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;console&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>  
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Logger&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Logger</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;X&#34;</span> <span style=color:#c4a000>level=</span><span style=color:#4e9a06>&#34;DEBUG&#34;</span> <span style=color:#c4a000>additivity=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;AppenderRef</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;console&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>  
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Logger&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Rootlevel</span><span style=color:#a40000>=&#34;ERROR&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;AppenderRef</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;console&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Root&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/Loggers&gt;</span>
</span></span></code></pre></div><p>위에서 AppenderRef 요소에 지정한 &ldquo;console&rdquo; Appender가 없는 경우, 정상적인 로깅이 수행될 수 없다.</p><h4 id=logger-호출>Logger 호출</h4><p>Logger는 코드 내에서 다음과 같은 방법으로 호출할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>egovframe.sample</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.apache.logging.log4j.LogManager</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.apache.logging.log4j.Logger</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>LoggerTest</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// (1) Logger Name이 &#34;egovframe.sample.LoggerTest&#34;인 Logger 설정을 따르는 Logger 객체 생성
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>Logger</span> <span style=color:#000>logger1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LogManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>();</span>     
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// (2) 위와 동일             
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>Logger</span> <span style=color:#000>logger2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LogManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>LoggerTest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>  
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// (3) Logger Name이 &#34;X&#34;인 Logger설정을 따르는 Logger 객체 생성
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>Logger</span> <span style=color:#000>logger3</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LogManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;X&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>(1), (2)과 같이 Logger Name에 해당하는 Logger가 설정 파일에 없는 경우, 다음 Logger Hierarchy 규칙에 따라 결정된다.<br>결과적으로 (1), (2)에서 생성된 Logger 객체는 Root Logger 설정을 따른다.</p><h4 id=logger-hierarchy>Logger Hierarchy</h4><p>사용자가 호출한 Logger 객체가 어떤 설정을 따르는지 이해하기 위해서는 Logger Hierarchy를 알고 있어야 한다.<br>내부적으로 설정 파일에 정의된 각 Logger 설정에 따라 LoggerConfig 오브젝트가 생성되며,<br>Logger Name에 따라 오브젝트 간 부모-자식 관계가 성립한다. 즉 부모 Logger의 설정을 자식 Logger가 상속받는다.<br>예를 들어 &ldquo;X.Y&rdquo; Logger의 부모는 &ldquo;X"이고, &ldquo;X&rdquo; Logger의 부모는 Root Logger(최상위)이다.</p><p>다음은 Hierarchy 규칙과 예시이다.</p><ol><li>호출한 Logger Name과 동일한 Logger가 있는 경우, 해당 Logger 설정을 따른다.</li><li>동일한 Logger는 없지만, Parent Logger가 존재하는 경우, Parent Logger 설정을 따른다.</li><li>Parent Logger도 존재하지 않는 경우, Root Logger 설정을 따른다.</li></ol><table><thead><tr><th>Logger Name</th><th>Assigned LoggerConfig</th><th>Level</th><th>Java Code</th><th>Description</th></tr></thead><tbody><tr><td>root</td><td>root</td><td>ERROR</td><td>LogManager.getLogger(“root”);</td><td>설정 파일의 Root 설정을 따름</td></tr><tr><td>X</td><td>X</td><td>DEBUG</td><td>LogManager.getLogger(“X”);</td><td>설정 파일의 X Logger 설정을 따름</td></tr><tr><td>X.Y</td><td>X.Y</td><td>INFO</td><td>LogManager.getLogger(“X.Y”);</td><td>설정 파일의 X.Y Logger 설정을 따름</td></tr><tr><td>X.Y.Z</td><td>X.Y</td><td>INFO</td><td>LogManager.getLogger(“X.Y.Z”);</td><td>X.Y.Z Logger 설정이 없으므로, 부모인 X.Y 설정을 따름</td></tr><tr><td>X.YZ</td><td>X</td><td>DEBUG</td><td>LogManager.getLogger(“X.YZ”);</td><td>X.YZ Logger 설정이 없으므로, 부모인 X 설정을 따름</td></tr><tr><td>Y</td><td>root</td><td>ERROR</td><td>LogManager.getLogger(“Y”);</td><td>Y Logger 설정이 없으므로, 부모인 Root 설정을 따름</td></tr></tbody></table><h4 id=log-level>Log Level</h4><p>Log4j 2는 FATAL, ERROR, WARN, INFO, DEBUG, TRACE의 Log Level을 제공한다.<br>각각 trace(), debug(), info(), warn(), error(), fatal()라는 로깅 메서드를 이용해 로그를 출력할 수 있다.<br>로그 레벨은 다음과 같다. (FATAL > ERROR > WARN > INFO > DEBUG > TRACE)</p><table><thead><tr><th>로그 레벨</th><th>설명</th></tr></thead><tbody><tr><td>FATAL</td><td>아주 심각한 에러가 발생한 상태를 나타냄. 시스템적으로 심각한 문제가 발생해서 어플리케이션 작동이 불가능할 경우가 해당하는데, 일반적으로는 어플리케이션에서는 사용할 일이 없음.</td></tr><tr><td>ERROR</td><td>요청을 처리하는중 문제가 발생한 상태를 나타냄.</td></tr><tr><td>WARN</td><td>처리 가능한 문제이지만, 향후 시스템 에러의 원인이 될 수 있는 경고성 메시지를 나타냄.</td></tr><tr><td>INFO</td><td>로그인, 상태변경과 같은 정보성 메시지를 나타냄.</td></tr><tr><td>DEBUG</td><td>개발 시 디버그 용도로 사용한 메시지를 나타냄.</td></tr><tr><td>TRACE</td><td>디버그 레벨이 너무 광범위한 것을 해결하기 위해서 좀더 상세한 상태를 나타냄.</td></tr></tbody></table><p>어플리케이션 수행 중 Log Level을 변경할 수도 있다. 이 때 Logger Configuration을 변경하는 것이므로, Logger 설정 정보를 참조하는 메서드를 호출할 수 있도록 org.apache.logging.log4j.Logger를 org.apache.logging.log4j.core.Logger로 캐스팅해야 한다.</p><p>Log Level 변경하려면 변경할 Level값을 파라미터로 setLevel() 메서드를 호출한다.<br>setLevel() 호출 이후부터 Log Level이 변경되며, 지정된 로그레벨 이하의 Log Event는 무시된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>egovframe.sample</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.apache.logging.log4j.LogManager</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.apache.logging.log4j.Logger</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>LoggerTest</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Logger</span> <span style=color:#000>logger</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LogManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#8f5902;font-style:italic>// Root Logger 설정을 따름, Log Level: ERROR
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>apache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>logging</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>log4j</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>core</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>Logger</span> <span style=color:#000>targetLogger</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>apache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>logging</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>log4j</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>core</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>Logger</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#000>targetLogger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 전 - debug&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 출력됨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>targetLogger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 전 - error&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 출력 안됨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#000>targetLogger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setLevel</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Level</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>DEBUG</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// DEBUG, INFO, WARN, ERROR, FATAL 출력 가능
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>targetLogger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 후 - debug&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 출력됨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>targetLogger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;변경 후 - error&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 출력됨	
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>자바에서는 C와 같이 전처리기의 기능이 없기 때문에 #ifdef DEBUG와 같은 형태와 같이 디버깅 때와 릴리즈 때의 디버깅코드를 각각 별도로 생성할 수가 없다. 따라서 Log4j의 이러한 기능은 로그관리에 있어서 상당히 편리하다.</p><h4 id=참고자료-1>참고자료</h4><p>자세한 설정은 <a href=http://logging.apache.org/log4j/2.x/manual/configuration.html#Loggers>Log4j 2 Logger</a> 매뉴얼을 참고하도록 한다.</p><h3 id=appender-설정>Appender 설정</h3><p>Appender는 로그가 출력되는 위치를 나타낸다.<br>XXXAppender로 끝나는 클래스들의 이름을 보면, 출력 위치를 어느 정도 짐작할 수 있다.</p><p>Log4j 2는 Console, File, RollingFile, Socket, DB 등 다양한 로그 출력 위치와 방법을 지원한다.<br>기존 Log4j 1.x와 크게 달라진 점은 Appender 종류를 class 속성값으로 구분한 것과 달리, Log4j 2에서는 태그로 구분한다.</p><h4 id=appender-선언과-정의>Appender 선언과 정의</h4><p>본 페이지에서는 자주 사용되는 Console, File, RollingFile, JDBC Appender에 대해서만 설명한다.<br>출력 위치에 따라 Appender 종류와 설정 태그가 달라지며, 아래 표는 각 Appender 정의 태그와 출력 위치이다.</p><table><thead><tr><th>Appenders</th><th>태그명</th><th>출력 위치</th></tr></thead><tbody><tr><td><strong>ConsoleAppender</strong></td><td><code>&lt;Console></code></td><td>콘솔에 출력</td></tr><tr><td><strong>FileAppender</strong></td><td><code>&lt;File></code></td><td>파일에 출력</td></tr><tr><td><strong>RollingFileAppender</strong></td><td><code>&lt;RollingFile></code></td><td>조건에 따라 파일에 출력</td></tr><tr><td><strong>JDBCAppender</strong></td><td><code>&lt;JDBC></code></td><td>RDB Table에 출력</td></tr></tbody></table><p>모든 Appender 요소는 상위 요소인 <strong>&lt;Appenders></strong> 아래에 선언한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;Appenders&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Console&gt;</span>...<span style=color:#204a87;font-weight:700>&lt;/Console&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;File&gt;</span>...<span style=color:#204a87;font-weight:700>&lt;/File&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;RollingFile&gt;</span>...<span style=color:#204a87;font-weight:700>&lt;/RollingFile&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;JDBC&gt;</span>...<span style=color:#204a87;font-weight:700>&lt;/JDBC&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/Appenders&gt;</span>
</span></span></code></pre></div><p>Appender 요소는 name 속성값을 가지며, name 속성에 Appender 이름을 지정한다. name 속성값은 Logger가 로그 출력에 사용할 Appender를 참조하기 위해 사용한다. 또한 Appender 요소의 하위 요소로 로그 출력 패턴인 Layout을 정의한다.<br>아래는 ConsoleAppender와 PatternLayout을 사용한 샘플코드이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;Appenders&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;Console</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;console&#34;</span> <span style=color:#c4a000>target=</span><span style=color:#4e9a06>&#34;SYSTEM_OUT&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;PatternLayout</span> <span style=color:#204a87;font-weight:700>/&gt;</span> <span style=color:#8f5902;font-style:italic>&lt;!-- 디폴트 패턴 적용, %d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Console&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/Appenders&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;Loggers&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Logger</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;egovLogger&#34;</span> <span style=color:#c4a000>level=</span><span style=color:#4e9a06>&#34;DEBUG&#34;</span> <span style=color:#c4a000>additivity=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;AppenderRef</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;console&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Logger&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Rootlevel</span><span style=color:#a40000>=&#34;ERROR&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;AppenderRef</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;console&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Root&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/Loggers&gt;</span>
</span></span></code></pre></div><h4 id=appender-종류>Appender 종류</h4><p>다음은 각 Appender 정의 시 필요한 기본 설정에 대한 설명이다.</p><h5 id=consoleappender>ConsoleAppender</h5><p>로그를 콘솔에 출력하기 위한 Appender</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- attribute: name(Appender명), target(출력방향지정, &#34;SYSTEM_OUT&#34; or &#34;SYSTEM_ERR&#34;(default)), follow, ignoreExceptions --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- element: Layout(출력패턴설정), Filters --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;Console</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;console&#34;</span> <span style=color:#c4a000>target=</span><span style=color:#4e9a06>&#34;SYSTEM_OUT&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;PatternLayout</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%d %5p [%c] %m%n&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/Console&gt;</span>
</span></span></code></pre></div><h5 id=fileappender>FileAppender</h5><p>로그를 파일에 출력하기 위한 Appender</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- attribute: name(Appender명), fileName(target파일명), append(이어쓰기여부, true(default) or false), locking, immediateFlush, ignoreExceptions, bufferedIO --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- element: Layout(출력패턴설정), Filters --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- append=&#34;false&#34;이면 매번 로깅 시 기존 로그 파일을 clear하고 새로 로깅 --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;File</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;file&#34;</span> <span style=color:#c4a000>fileName=</span><span style=color:#4e9a06>&#34;./logs/file/sample.log&#34;</span> <span style=color:#c4a000>append=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;PatternLayout</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%d %5p [%c] %m%n&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/File&gt;</span>	
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;File</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mdcFile&#34;</span> <span style=color:#c4a000>fileName=</span><span style=color:#4e9a06>&#34;./logs/file/mdcSample.log&#34;</span> <span style=color:#c4a000>append=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- Thread Context Map(also known as MDC) 객체의 key와 매칭되는 value를 로깅 - %X{key} --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- ex) ThreadContext.put(“testKey”, “testValue”);인 경우, 레이아웃 패턴 %X{testKey}에 의해 “testValue” 로깅 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;PatternLayout</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%d %5p [%c] [%X{class} %X{method} %X{testKey}] %m%n&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/File&gt;</span>
</span></span></code></pre></div><h5 id=rollingfileappender>RollingFileAppender</h5><p>TriggeringPolicy와 RolloverStrategy에 따라 로그를 파일에 출력하기 위한 Appender로,<br>FileAppender는 지정한 파일에 로그가 계속 남으므로 한 파일의 크기가 지나치게 커질 수 있고, 계획적인 로그관리가 불가능해진다.<br>그러나 RollingFileAppender는 파일의 크기 또는 파일 백업 인덱스 등의 지정을 통해서 특정 크기 이상으로 파일 크기가 커지게 되면,<br>기존파일(target)을 백업파일(history)로 바꾸고, 다시 처음부터 로깅을 시작한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- attribute: name(Appender명), fileName(target파일명), filePattern(history파일명), append, immediateFlush, ignoreExceptions, bufferedIO --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- element: Layout(출력패턴설정), Filters, Policy(file rolling 조건 설정), Strategy(file name과 location 관련 설정) --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;RollingFile</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;rollingFile&#34;</span> <span style=color:#c4a000>fileName=</span><span style=color:#4e9a06>&#34;./logs/rolling/rollingSample.log&#34;</span> <span style=color:#c4a000>filePattern=</span><span style=color:#4e9a06>&#34;./logs/rolling/rollingSample.%i.log&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;PatternLayout</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%d %5p [%c] %m%n&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Policies&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>&lt;!-- size 단위: Byte(default), KB, MB, or GB --&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;SizeBasedTriggeringPolicy</span> <span style=color:#c4a000>size=</span><span style=color:#4e9a06>&#34;1000&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Policies&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- 기존 maxIndex 속성이 Strategy 엘리먼트로 변경됨 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- index는 min(default 1)부터 max(default 7)까지 증가, 아래에는 max=&#34;3&#34;으로 settting --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- fileIndex=&#34;min&#34;이므로 target file의 size가 1000 byte를 넘어가면, fileIndex가 1(min)인 history file에 백업 (fixed window strategy) --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- 그 다음 1000 byte를 넘어가면, rollingSample.1.log을 rollingSample.2.log 파일에 복사하고, target 파일을 rollingSample.1.log에복사한 후 target 파일에 새로 로깅 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;DefaultRolloverStrategy</span> <span style=color:#c4a000>max=</span><span style=color:#4e9a06>&#34;3&#34;</span> <span style=color:#c4a000>fileIndex=</span><span style=color:#4e9a06>&#34;min&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/RollingFile&gt;</span>
</span></span></code></pre></div><ul><li>DailyRollingFileAppender<br>기존 DailyRollingFileAppender가 삭제되고, RollingFileAppender에서 &lt;TimeBasedTriggeringPolicy> 엘리먼트로 설정 가능하도록 변경되었다. 설정한 날짜 또는 조건에 맞춰 로깅을 수행하며, interval 속성을 이용해 rolling 간격을 지정할 수 있다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;RollingFile</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;rollingFile&#34;</span> <span style=color:#c4a000>fileName=</span><span style=color:#4e9a06>&#34;./logs/rolling/dailyRollingSample.log&#34;</span> <span style=color:#c4a000>filePattern=</span><span style=color:#4e9a06>&#34;./logs/daily/dailyRollingSample.log.%d{yyyy-MM-dd-HH-mm-ss}&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;PatternLayout</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%d %5p [%c] %m%n&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;Policies&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>&lt;!-- interval(default 1)이므로 1초 간격으로 rolling 수행 --&gt;</span> 
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;TimeBasedTriggeringPolicy</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/Policies&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/RollingFile&gt;</span>
</span></span></code></pre></div><h5 id=jdbcappender>JDBCAppender</h5><p>로그를 RDB에 출력하기 위한 Appender로,<br>Connection 객체를 제공하기 위한 JNDI DataSource 혹은 Connection Factory Method를 함께 정의해야한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- attribute: name(Appender명), tableName(RDB Table명), columnConfigs, filter, bufferSize, ignoreExceptions, connectionSource --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- element: DataSource(jndi datasource 정보), ConnectionFactory(Connection Factory 정보), Column(Table Column명) --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- 테이블명이 db_log인 테이블에 로깅됨 --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;JDBC</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;db&#34;</span> <span style=color:#c4a000>tableName=</span><span style=color:#4e9a06>&#34;db_log&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- DB Connection을 제공해줄 클래스와 메서드명 정의 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- JDBCAppender가 EgovConnectionFactory.getDatabaseConnection() 메서드를 호출 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;ConnectionFactory</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.logging.db.EgovConnectionFactory&#34;</span> <span style=color:#c4a000>method=</span><span style=color:#4e9a06>&#34;getDatabaseConnection&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>&lt;!-- log event가 insert될 컬럼 설정, insert될 값은 PatternLayout의 pattern 사용 --&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;Column</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;eventDate&#34;</span> <span style=color:#c4a000>isEventTimestamp=</span><span style=color:#4e9a06>&#34;true&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;Column</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;level&#34;</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%p&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;Column</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;logger&#34;</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%c&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;Column</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;message&#34;</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%m&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;Column</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;exception&#34;</span> <span style=color:#c4a000>pattern=</span><span style=color:#4e9a06>&#34;%ex{full}&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/JDBC&gt;</span>
</span></span></code></pre></div><p>표준프레임워크에서는 Connection Factory 역할을 하는 EgovConnectionFactory를 제공하고 있으며, 어플리케이션에서 설정한 dataSource 빈을 주입받아 싱글톤을 생성한다. 이를 위해 다음과 같이 빈정의를 추가해야한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;egovConnectionFactory&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.logging.db.EgovConnectionFactory&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>WAS에서 제공하는 DataSource를 사용하려면, 위 &lt;ConnectionFactory> 부분을 &lt;DataSource jndiName=”…” />으로 변경한다.</p><h4 id=참고자료-2>참고자료</h4><p>각 Appender 요소에서 정의할 수 있는 하위 요소와 속성이 다르므로, 자세한 설정은 각 매뉴얼을 참조하도록 한다.</p><p><a href=http://logging.apache.org/log4j/2.x/manual/appenders.html>Log4j 2 Appneders</a><br><a href=http://logging.apache.org/log4j/2.x/manual/appenders.html#ConsoleAppender>ConsoleAppender</a><br><a href=http://logging.apache.org/log4j/2.x/manual/appenders.html#FileAppender>FileAppender</a><br><a href=http://logging.apache.org/log4j/2.x/manual/appenders.html#RollingFileAppender>RollingFileAppender</a><br><a href=http://logging.apache.org/log4j/2.x/manual/appenders.html#JDBCAppender>JDBCAppender</a></p><h3 id=layout-설정>Layout 설정</h3><p>Layout은 발생한 로그 이벤트의 포맷을 지정하고, 원하는 형식으로 로그를 출력할 수 있다.<br>Appenders 설정과 마찬가지로 Log4j 2에서는 Layout을 class 속성이 아닌 태그로 구분한다.</p><p>출력 형식에 따라 Layout의 종류가 달라지며, 아래와 같은 Layouts을 제공한다.</p><table><tr><td colspan=6>내용</td></tr><tr><td>HTMLLayout</td><td><b>PatternLayout</b></td><td>RFC5424Layout</td><td>SerializedLayout</td><td>SyslogLayout</td><td>XMLLayout</td></tr></table><p>본페이지는 위의 Layouts 중 일반적으로 디버깅에 가장 적합한 PatternLayout만 설명한다.</p><h4 id=patternlayout-선언과-정의>PatternLayout 선언과 정의</h4><p>PatternLayout은 Appender 요소의 하위 요소로 정의한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;Console&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>&lt;!-- 디폴트 패턴 적용, &#34;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&#34; --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;PatternLayout/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;/Console&gt;</span>
</span></span></code></pre></div><p>&lt;PatternLayout/>을 선언하면 디폴트 pattern이 적용되며, pattern 속성을 이용하여 일자, 시간, 클래스, 로거명, 메시지 등 여러 정보를 선택하여 다양한 조합의 로그 메시지를 출력할 수 있다.</p><h5 id=patternlayout의-pattern>PatternLayout의 pattern</h5><p>%로 시작하고 %뒤에는 format modifiers와 conversion character로 정의한다.<br>예) %d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</p><table><thead><tr><th>패턴</th><th>설명</th></tr></thead><tbody><tr><td>c, logger</td><td>로깅 이벤트를 발생시키기 위해 선택한 로거의 이름을 출력</td></tr><tr><td>C, class</td><td>로깅 이벤트가 발생한 클래스의 풀네임명을 출력</td></tr><tr><td>M, method</td><td>로깅 이벤트가 발생한 메서드명을 출력</td></tr><tr><td>F, file</td><td>로깅 이벤트가 발생한 클래스의 파일명을 출력</td></tr><tr><td>l, location</td><td>로깅 이벤트가 발생한 클래스의 풀네임명.메서드명(파일명:라인번호)를 출력</td></tr><tr><td>d, date</td><td>로깅 이벤트의 일자와 시간을 출력,\\SimpleDateFormat클래스에 정의된 패턴으로 출력 포맷 지정가능</td></tr><tr><td>L, line</td><td>로깅 이벤트가 발생한 라인 번호를 출력</td></tr><tr><td>m, msg, message</td><td>로그문에서 전달된 메시지를 출력</td></tr><tr><td>n</td><td>줄바꿈</td></tr><tr><td>p, level</td><td>로깅 이벤트의 레벨을 출력</td></tr><tr><td>r, relative</td><td>로그 처리시간 (milliseconds)</td></tr><tr><td>t, thread</td><td>로깅 이벤트가 발생한 스레드명을 출력</td></tr><tr><td>%%</td><td>%를 출력하기 위해 사용하는 패턴</td></tr></tbody></table><h4 id=참고자료-3>참고자료</h4><p><a href=http://logging.apache.org/log4j/2.x/manual/layouts.html>Log4j 2 Layouts</a><br><a href=http://logging.apache.org/log4j/2.x/manual/layouts.html#PatternLayout>PatternLayout</a></p><h2 id=참고자료-4>참고자료</h2><p><a href=http://logging.apache.org/index.html>Apache Logging Services Project</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-873e8aee6851d9defe18d5318375c4ea>14 - Id Generation 서비스</h1><div class=lead>ID Generation 서비스는 UUID, Sequence, Table 기반의 고유 ID 생성을 지원하며, UUID는 MAC/IP 주소 또는 랜덤 방식으로, Sequence는 DB 시퀀스를 사용해 ID를 생성한다. Table ID Generation은 별도의 테이블을 사용해 ID를 관리하며, Strategy 설정을 통해 ID 생성 규칙을 지정할 수 있다. 다양한 설정을 통해 ID를 쉽게 생성하고 관리할 수 있도록 지원한다.</div><h1 id=id-generation-서비스>Id Generation 서비스</h1><h2 id=개요>개요</h2><p>시스템을 개발할 때 필요한 유일한 ID를 생성하기 위해 사용하도록 서비스한다.</p><h2 id=주요-개념>주요 개념</h2><h3 id=universally-unique-identifieruuid>Universally Unique Identifier(UUID)</h3><p>UUID는 OSF(Open Software Foundation)에 의해 제정된 고유식별자(Identifier)에 대한 표준이다. UUID는 16-byte (128-bit)의 숫자로 구성된다.</p><p>UUID를 표현하는 방식에 대한 특별한 규정은 없으나, 일반적으로 아래와 같이 16진법으로 8-4-4-4-12 형식으로 표현한다.</p><p><code>550e8400-e29b-41d4-a716-446655440000</code></p><p>UUID 표준은 아래 문서에 기술되어 있다.</p><ul><li><a href="http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=2229">ISO/IEC 11578:1996 &ldquo;Information technology &ndash; Open Systems Interconnection &ndash; Remote Procedure Call (RPC)&rdquo;</a></li><li><a href=http://www.itu.int/ITU-T/studygroups/com17/oid.html>ITU-T Rec. X.667 | ISO/IEC 9834-8:2005</a></li><li><a href=http://tools.ietf.org/html/rfc4122>IETF Proposed Standard RFC 4122</a></li></ul><p>UUID는 다음 5개의 Version이 존재한다.</p><ul><li>Version 1 (MAC Address)<ul><li>UUID를 생성시키는 컴퓨터의 MAC 어드레스와 시간 정보를 이용하여 UUID를 생성한다.</li><li>컴퓨터의 MAC 어드레스를 이용하므로 어떤 컴퓨터에서 생성했는지 정보가 남기 때문에 보안에 문제가 있다.</li></ul></li><li>Version 2 (DCE Security)<ul><li>POSIX UID를 이용하여 UUID를 생성한다.</li></ul></li><li>Version 3 (MD5 Hash)<ul><li>URL로부터 MD5를 이용하여 UUID를 생성한다.</li></ul></li><li>Version 4 (Random)<ul><li>Random Number를 이용하여 UUID를 생성한다.</li></ul></li><li>Version 5 (SHA-1 Hash)<ul><li>SHA-1 Hashing을 이용하여 UUID를 생성한다.</li></ul></li></ul><h2 id=설명>설명</h2><p>ID 생성 방식으로는 <a href=#Universally-Unique-Identifier(UUID)>UUID</a>를 생성하는 <a href=#UUID-Generation-Service>UUID Generation Service</a>와 sequence를 활용하는 <a href=#Sequence-Id-Generation-Service>Sequence Id Generation Service</a>, 그리고 키제공을 위한 테이블을 지정하여 생성하는 <a href=#Table-Id-Generation-Service>Table Id Generation Service</a> 3가지가 있다.</p><h3 id=uuid-generation-service>UUID Generation Service</h3><p>새로운 ID를 생성하기 위해 UUID 생성 알고리즘을 이용하여 16 바이트 길이의 ID를 생성한다.</p><p>String 타입의 ID 생성과 BigDecimal 타입의 ID 생성 두가지 유형 ID 생성을 지원한다.</p><p>지원하는 방법은 설정에 따라서 <a href=#Mac-Address-Base-Service>Mac Address Base Service</a>, <a href=#IP-Address-Base-Service>IP Address Base Service</a>, <a href=#No-Address-Base-Service>No Address Base Service</a> 세가지 유형이 있다.</p><h4 id=mac-address-base-service>Mac Address Base Service</h4><p>MAC Address를 기반으로 유일한 Id를 생성하는 UUIdGenerationService</p><h5 id=configuration>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;UUIdGenerationService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.egovframe.rte.fdl.idgnr.impl.EgovUUIdGnrServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;address&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;value&gt;</span>00:00:F0:79:19:5B<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h5 id=sample-source>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;UUIdGenerationService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>EgovIdGnrService</span> <span style=color:#000>uUidGenerationService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testUUIdGeneration</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uUidGenerationService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextStringId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uUidGenerationService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextBigDecimalId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=ip-address-base-service>IP Address Base Service</h4><p>IP Address를 기반으로 유일한 Id를 생성하는 UUIdGenerationService</p><h5 id=configuration-1>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;UUIdGenerationServiceWithIP&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.egovframe.rte.fdl.idgnr.impl.EgovUUIdGnrServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;address&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;value&gt;</span>100.128.120.107<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h5 id=sample-source-1>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;UUIdGenerationServiceWithIP&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>EgovIdGnrService</span> <span style=color:#000>uUIdGenerationServiceWithIP</span><span style=color:#ce5c00;font-weight:700>;</span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testUUIdGenerationIP</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uUIdGenerationServiceWithIP</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextStringId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uUIdGenerationServiceWithIP</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextBigDecimalId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=no-address-base-service>No Address Base Service</h4><p>IP Address 설정없이 <code>Math.random()</code>을 이용하여 주소정보를 생성하고 유일한 Id를 생성하는 UUIdGenerationService</p><h5 id=configuration-2>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;UUIdGenerationServiceWithoutAddress&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.egovframe.rte.fdl.idgnr.impl.EgovUUIdGnrServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h5 id=sample-source-2>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;UUIdGenerationServiceWithoutAddress&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>EgovIdGnrService</span> <span style=color:#000>uUIdGenerationServiceWithoutAddress</span><span style=color:#ce5c00;font-weight:700>;</span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testUUIdGenerationNoAddress</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uUIdGenerationServiceWithoutAddress</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextStringId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uUIdGenerationServiceWithoutAddress</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextBigDecimalId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=sequence-id-generation-service>Sequence Id Generation Service</h3><p>새로운 ID를 생성하기 위해 Database의 SEQUENCE를 사용하는 서비스이다. 서비스를 이용하는 시스템에서 Query를 지정하여 아이디를 생성할 수 있도록 하고 <a href=#Basic-Type-Service>Basic Type Service</a>와 <a href=#BigDecimal-Type-Service>BigDecimal Type Service</a> 두가지를 지원한다.</p><h4 id=basic-type-service>Basic Type Service</h4><p>기본타입 ID를 제공하는 서비스로 <code>int</code>, <code>short</code>, <code>byte</code>, <code>long</code> 유형의 ID를 제공한다.</p><h5 id=db-schema>DB Schema</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SEQUENCE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>idstest</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>MINVALUE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h5 id=configuration-3>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;primaryTypeSequenceIds&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.egovframe.rte.fdl.idgnr.impl.EgovSequenceIdGnrServiceImpl&#34;</span> <span style=color:#c4a000>destroy-method=</span><span style=color:#4e9a06>&#34;destroy&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;query&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT idstest.NEXTVAL FROM DUAL&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h5 id=sample-source-3>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;primaryTypeSequenceIds&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>EgovIdGnrService</span> <span style=color:#000>primaryTypeSequenceIds</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testPrimaryTypeIdGeneration</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//int
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>primaryTypeSequenceIds</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextIntegerId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//short
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>primaryTypeSequenceIds</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextShortId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//byte
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>primaryTypeSequenceIds</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextByteId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//long
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>primaryTypeSequenceIds</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextLongId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=bigdecimal-type-service>BigDecimal Type Service</h4><p>BigDecimal ID를 제공하는 서비스로 <a href=#Basic-Type-Service>기본타입 ID 제공 서비스</a> 설정에 추가적으로 <code>useBigDecimals</code>을 <code>true</code>로 설정하여 BigDecimal 사용하도록 한다.</p><h5 id=db-schema-1>DB Schema</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SEQUENCE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>idstest</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>MINVALUE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h5 id=configuration-4>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;bigDecimalTypeSequenceIds&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.egovframe.rte.fdl.idgnr.impl.EgovSequenceIdGnrServiceImpl&#34;</span> <span style=color:#c4a000>destroy-method=</span><span style=color:#4e9a06>&#34;destroy&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;query&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT idstest.NEXTVAL FROM DUAL&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;useBigDecimals&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h5 id=sample-source-4>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;bigDecimalTypeSequenceIds&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>EgovIdGnrService</span> <span style=color:#000>bigDecimalTypeSequenceIds</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testBigDecimalTypeIdGeneration</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//BigDecimal
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>bigDecimalTypeSequenceIds</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextBigDecimalId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=database-별-설정>Database 별 설정</h4><h5 id=oracle>Oracle</h5><ul><li>DB Schema</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SEQUENCE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>sequence</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>START</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>WITH</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>start</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>INCREMENT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>BY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>increment</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>MINVALUE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>min</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>MAXVALUE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>max</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><ul><li>Query</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>sequence</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NEXTVAL</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DUAL</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h5 id=hsql>HSQL</h5><ul><li>DB Schema</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SEQUENCE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>sequence</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#a40000>{</span><span style=color:#204a87>INTEGER</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>|</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>BIGINT</span><span style=color:#a40000>}</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>START</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>WITH</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>start</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>INCREMENT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>BY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>increment</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><ul><li>Query</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NEXT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>VALUE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FOR</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>sequence</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DUAL</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic>-- HSQL DB는 DUAL 테이블을 제공하지 않기 때문에 하나의 row를 가진 DUAL 테이블을 수동으로 생성해야 한다.
</span></span></span></code></pre></div><h5 id=ibm-db2>IBM DB2</h5><ul><li>DB Schema</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SEQUENCE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>sequence</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>START</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>WITH</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>start</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>INCREMENT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>BY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>increment</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>MINVALUE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>min</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>MAXVALUE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>max</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><ul><li>Query</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NEXT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>VALUE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FOR</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>sequence</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SYSIBM</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>SYSDUMMY1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h5 id=sybase>Sybase</h5><ul><li>Sybase는 Sequence를 지원하지 않는다.</li></ul><h5 id=ms-sql-server>MS SQL Server</h5><ul><li>MS SQL Server는 Sequence를 지원하지 않는다.</li></ul><h5 id=mysql>MySQL</h5><ul><li>MySQL은 Sequence를 지원하지 않는다.</li></ul><h3 id=table-id-generation-service>Table Id Generation Service</h3><p>새로운 아이디를 얻기 위해 별도의 테이블을 생성, 키값과 키값에 해당하는 아이디값을 입력하여 관리를 제공하는 서비스이다.</p><p>table_name(<code>CHAR</code> 또는 <code>VARCHAR</code>타입), next_id(<code>integer</code> 또는 <code>DECIMAL</code> type)와 같이 두 칼럼을 필요로 한다.</p><p>별도의 테이블에 설정된 정보만을 사용하여 제공하는 <a href=#Basic-Service>Basic Service</a>, prefix와 채울 문자열을 지정하여 String ID를 생성할 수 있는 <a href=#Strategy-Base-Service>Strategy Base Service</a>를 제공한다.</p><h4 id=basic-service>Basic Service</h4><p>테이블에 지정된 정보에 의해서 아이디를 생성하는 서비스로 사용하고자 하는 시스템에서 테이블을 생성해서 사용할 수 있다.</p><h5 id=db-schema-2>DB Schema</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ids</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>table_name</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>varchar</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>16</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> 
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>next_id</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>DECIMAL</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>table_name</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>INSERT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ids</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>VALUES</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;id&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#39;0&#39;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic>-- ID Generation 서비스를 쓰고자 하는 시스템에서 미리 생성해야 할 DB Schema 정보이다.
</span></span></span></code></pre></div><h5 id=configuration-5>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;basicService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.egovframe.rte.fdl.idgnr.impl.EgovTableIdGnrServiceImpl&#34;</span> <span style=color:#c4a000>destroy-method=</span><span style=color:#4e9a06>&#34;destroy&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;blockSize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;10&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;table&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;ids&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;tableName&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><ul><li>blockSize<ul><li>Id Generation 내부적으로 사용하는 정보로 ID 요청시마다 DB접속을 하지 않기 위한 정보<ul><li>지정한 횟수 마다 DB 접속 처리</li></ul></li></ul></li><li>table<ul><li>생성하는 테이블 정보로 사용처에서 테이블명 변경 가능</li></ul></li><li>tableName<ul><li>사용하고자 하는 아이디 개별 인식을 위한 키 값<ul><li>테이블 별로 아이디가 필요하기에 <code>tableName</code>이라고 지정함</li></ul></li></ul></li></ul><h5 id=sample-source-5>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;basicService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>EgovIdGnrService</span> <span style=color:#000>basicService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testBasicService</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//int
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>basicService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextIntegerId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//short
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>basicService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextShortId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//byte
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>basicService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextByteId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//long
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>basicService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextLongId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//BigDecimal
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>basicService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextBigDecimalId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>//String
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNotNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>basicService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextStringId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=strategy-base-service>Strategy Base Service</h4><p>아이디 생성을 위한 룰을 등록하고 룰에 맞는 아이디를 생성할 수 있도록 지원하는 서비스이다.</p><p>위의 <a href=#Basic-Service>Basic Service</a>에서 추가적으로 Strategy 정보 설정을 추가하여 사용 할 수 있다.</p><p>단, 이 서비스는 <code>String</code> 타입의 <code>ID</code>만을 제공한다.</p><h5 id=db-schema-3>DB Schema</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>idttest</span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>table_name</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>varchar</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>16</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> 
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>next_id</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>DECIMAL</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>table_name</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>INSERT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>idttest</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>VALUES</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;test&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#39;0&#39;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic>-- ID Generation 서비스를 쓰고자 하는 시스템에서 미리 생성해야 할 DB Schema 정보이다.
</span></span></span></code></pre></div><h5 id=configuration-6>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;Ids-TestWithGenerationStrategy&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.egovframe.rte.fdl.idgnr.impl.EgovTableIdGnrServiceImpl&#34;</span> <span style=color:#c4a000>destroy-method=</span><span style=color:#4e9a06>&#34;destroy&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;strategy&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;strategy&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;blockSize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;table&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;idttest&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;tableName&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;test&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>		
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;strategy&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.egovframe.rte.fdl.idgnr.impl.strategy.EgovIdGnrStrategyImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;prefix&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;TEST-&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cipers&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;5&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;fillChar&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;*&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><ul><li>strategy<ul><li>아래에 정의된 MixPrefix 의 bean name 설정</li></ul></li><li>prefix<ul><li>아이디의 앞에 고정적으로 붙이고자 하는 설정값 지정</li></ul></li><li>cipers<ul><li>prefix를 제외한 아이디의 길이 지정</li></ul></li><li>fillChar<ul><li>0을 대신하여 표현되는 문자</li></ul></li></ul><h5 id=sample-source-6>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Ids-TestWithGenerationStrategy&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>EgovIdGnrService</span> <span style=color:#000>idsTestWithGenerationStrategy</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testIdGenStrategy</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#000>initializeNextLongId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;test&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// prefix : TEST-, cipers : 5, fillChar :*)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span>
</span></span><span style=display:flex><span>      <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;TEST-****&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>idsTestWithGenerationStrategy</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextStringId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-ed65074198e9c6ea1b6512924e35cf7f>15 - Property</h1><div class=lead>Property는 시스템 설정 정보를 외부에서 관리하여 유연성과 확장성을 높이는 기능으로, 동적 갱신이 가능한 Property Service와 정적 설정인 Property Source를 제공한다.</div><h1 id=property>Property</h1><p>Property는 시스템의 설치 환경에 관련된 정보나, 잦은 정보의 변경이 요구되는 경우 외부에서 그 정보를 관리하게 함으로써 시스템의 유연성을 높이기 위해서 제공하는 것으로 Property Service와 Property Source를 제공하고 있다.
Property Service와 Property Source는 각각의 특성과 용도에 따라 시스템의 설정 정보를 관리한다.
이와 같은 기능을 통해 전자정부프레임워크는 시스템의 유연성과 확장성을 높여준다.</p><ul><li>Property Service</li><li>특징: 코드 상에서 key를 통해 해당 값을 가져오는 방식으로, 외부 파일이 변경될 경우 이를 반영하여 값을 갱신할 수 있다.</li><li>장점: 시스템 운영 중에도 설정 값을 동적으로 변경할 수 있어 유연성이 높다.</li><li>사용 예시: 데이터베이스 연결 정보, API 키 등 자주 변경될 수 있는 설정 값 관리.</li><li>Property Source</li><li>특징: XML 또는 코드 상에서 key를 통해 값을 가져올 수 있지만, 외부 파일이 변경되어도 즉시 반영되지 않는다.</li><li>단점: 설정 값 변경 시 시스템을 재시작해야 변경 사항이 반영됩니다.</li><li>사용 예시: 상대적으로 변경이 적은 설정 값 관리, 예를 들어 애플리케이션의 기본 설정 값.</li><li>Property 파일 사용 방법:</li><li>별도의 Property 파일을 만들어 Spring Bean 설정 파일에 파일의 위치를 입력하여 사용할 수 있다.</li><li>외부 설정 파일에 기재된 프로퍼티 내용은 어플리케이션 운영 중에 추가 및 변경이 가능하다.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-75f53001d45aa5ab4bbec0f5902a1e78>16 - Property Service</h1><div class=lead>Property Service는 시스템 설정 정보를 외부 파일이나 Spring Bean 설정 파일에서 관리하여 유연성을 제공하는 서비스이다. <strong>Bean 설정 파일</strong>을 사용하여 간단하게 설정할 수 있지만, 변경 시 어플리케이션 재시작이 필요하다. <strong>외부 설정 파일</strong>을 사용하면 운영 중에도 설정 정보를 수정할 수 있으며, 실시간 갱신이 가능하다.</div><h1 id=property-service>Property Service</h1><h2 id=개요>개요</h2><p>Property Service 는 시스템의 설치 환경에 관련된 정보나, 잦은 정보의 변경이 요구되는 경우 외부에서 그 정보를 관리하게 함으로써 시스템의 유연성을 높이기 위해서 제공하는 것으로 Spring Bean 설정 파일에 관리하고자 하는 정보를 입력(<strong>Bean 설정 파일 사용</strong>) 하거나 외부 파일에 정보 입력 후에 Bean 설정 파일에서 그 파일 위치를 입력하여 이용(<strong>외부 설정 파일 사용</strong>)할 수 있다.</p><h2 id=bean-설정-파일-사용>Bean 설정 파일 사용</h2><p>간단하게 설정하고자 할 때 사용할 수 있는 방법으로 별도의 외부파일을 두지 않고 Spring Bean 설정 파일을 이용할 수 있다. 하지만 어플리케이션 운영 중에 Property 정보 변경은 불가능 하고 변경처리 시 어플리케이션을 재기동해야 한다. 사용하기 위해서는 bean property의 Name에 <strong>properties</strong>라고 입력하고 map entry의 <strong>key</strong>에 관리하고자 하는 키, <strong>value</strong>에 관리하고자 하는 값을 입력하여 설정한다.</p><h3 id=configuration>Configuration</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;propertyService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.property.impl.EgovPropertyServiceImpl&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#c4a000>destroy-method=</span><span style=color:#4e9a06>&#34;destroy&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;properties&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;map&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;entry</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;AAAA&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;1234&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/map&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>			
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><ul><li>propertyService Bean을 추가할 경우 messageSource Bean도 함께 설정해 주어야 한다.</li><li>아래의 코드를 추가 설정한다.</li></ul><h3 id=messagesource>messageSource</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;messageSource&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.context.support.ReloadableResourceBundleMessageSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;basenames&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>classpath:/message/message-common<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>classpath:/egovframework/rte/fdl/idgnr/messages/idgnr<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>classpath:/egovframework/rte/fdl/property/messages/properties<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cacheSeconds&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>60<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h3 id=sample-source>Sample Source</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;propertyService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>EgovPropertyService</span> <span style=color:#000>propertyService</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testPropertiesService</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1234&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>propertyService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;AAAA&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=제공유형별-설정사용-방법>제공유형별 설정/사용 방법</h3><table><thead><tr><th>제공유형</th><th>설정 방법</th><th>사용 방법</th></tr></thead><tbody><tr><td>String</td><td>key=“A” value=“ABC”</td><td>propertyService.getString(“A”)</td></tr><tr><td>boolean</td><td>key=“B” value=“true”</td><td>propertyService.getBoolean(“B”)</td></tr><tr><td>int</td><td>key=“C” value=“123”</td><td>propertyService.getInt(“C”)</td></tr><tr><td>long</td><td>key=“D” value=“123”</td><td>propertyService.getLong(“D”)</td></tr><tr><td>short</td><td>key=“E” value=“123”</td><td>propertyService.getShort(“E”)</td></tr><tr><td>float</td><td>key=“F” value=“123”</td><td>propertyService.getFloat(“F”)</td></tr><tr><td>Vector</td><td>key=“G” value=“123,456”</td><td>propertyService.getVector(“G”)</td></tr></tbody></table><h3 id=외부-설정-파일-사용>외부 설정 파일 사용</h3><p>별도의 Property 파일을 만들어서 사용하는 방법으로 Spring Bean 설정 파일에는 파일의 위치를 입력하여 이용할 수 있다. 외부 설정 파일에 기재된 프로퍼티 내용은 어플리케이션 운영 중에 추가 및 변경 가능하다.</p><h4 id=configuration-1>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;propertyService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.property.impl.EgovPropertyServiceImpl&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#c4a000>destroy-method=</span><span style=color:#4e9a06>&#34;destroy&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;extFileName&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;set&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;map&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;entry</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;encoding&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;entry</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;filename&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;file:./src/**/refresh-resource.properties&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/map&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;value&gt;</span>classpath*:properties/resource.properties<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/set&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>			
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><ul><li>MAP을 이용해서 encoding 정보를 입력하는 방법과 파일 위치만을 기재하는 방법 두가지 설정방법 있음</li></ul><h4 id=properties-파일>properties 파일</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#c4a000>AAAA</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>1234</span>
</span></span></code></pre></div><h4 id=sample-source-1>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;propertyService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>EgovPropertyService</span> <span style=color:#000>propertyService</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testPropertiesService</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1234&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>propertyService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;AAAA&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=실시간-갱신-방법>실시간 갱신 방법</h4><ol><li>외부파일에 기재된 property 내용을 수정한다.</li><li>propertyService.refreshPropertyFiles()를 호출한다.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-7ac4088d3e9e9bd3b6a413622ed0bc69>17 - Property Source</h1><div class=lead>Property Source는 Spring에서 properties 파일이나 DB 테이블에서 key-value 형식의 설정 값을 가져올 수 있도록 하는 기능이다. <strong>Property-placeholder</strong>는 XML 설정 파일에서 <code>${}</code>를 사용해 외부 설정 값을 참조하며, Spring 3.1 이후에는 <strong>PropertySourcesPlaceholderConfigurer</strong>가 사용된다. <strong>DB PropertySource</strong>는 DB 테이블에서 설정 값을 가져오는 기능을 제공하며, <code>DBPropertySourceInitializer</code>를 통해 WAS 기동 시 설정 값을 로드할 수 있다.</div><h1 id=property-source>Property Source</h1><h2 id=개요>개요</h2><p>Property Source는 property place-holder를 이용하여 xml의 bean설정에서 key값을 통해 가져올 수 있으며 코드상에서는 Environment를 이용하여 해당값을 가져올 수 있다.</p><p>기본적으로 properties파일을 통한 기능을 제공하고 있으며 추가적인 설정을 통해 DB의 테이블에서 property값을 가져오는 PropertySource를 제공하고 있다. 또한 사용자가 추가로 PropertySource를 정의할 수 있다.</p><h2 id=property-placeholder와-propertysource>Property-placeholder와 PropertySource</h2><h3 id=property-placeholder>Property-placeholder</h3><p>bean을 정의할 때 <code>${…}</code>의 내용을 property placeholder를 이용하여 대체할 수 있었다.
해당 코드는 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;context:property-placeholder</span> <span style=color:#c4a000>location=</span><span style=color:#4e9a06>&#34;com/bank/config/datasource.properties&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.apache.commons.dbcp.BasicDataSource&#34;</span> <span style=color:#c4a000>destroy-method=</span><span style=color:#4e9a06>&#34;close&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;driverClass&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;${database.driver}&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;jdbcUrl&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;${database.url}&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;username&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;${database.username}&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;password&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;${database.password}&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>Spring 3.1이전에는 <code>&lt;context:property-placeholder></code>를 정의하면 PropertyPlaceholderConfigurer를 사용하였다. 그러나 Spring 3.1이후부터 PropertySourcesPlaceholderConfigurer를 내부에서 사용하고 있으며 위에서 ${database.*}값을 datasource.properties에서 찾지 못하면 Environment의 Property를 사용하도록 하고 있다.
PropertySource는 Environment를 통해 접근 가능하다. 즉, 사용자가 정의한 PropertySource 또한 Spring 3.1부터 property-placeholder를 통해 사용할 수 있는 것이다.</p><h3 id=사용자-정의-propertysource>사용자 정의 PropertySource</h3><p>Spring 3.1에서는 사용자가 직접 PropertySource를 정의할 수 있는 방법을 제시한다.
ApplicationContextInitializer인터페이스와 web.xml에 contextInitializerClasses서블릿 컨텍스트 파라미터, Environment를 이용하여 정의가 가능하다.</p><p>ApplicationContextInitializer인터페이스를 구현하여 ApplicationContext초기화 로직을 직접 등록할 수 있으며 이 때 contextInitializerClasses 서블릿 컨텍스트 파라미터에 이 구현클래스를 등록한다.</p><p>web.xml의 정의 예이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;context-param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>contextInitializerClasses<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>com.bank.MyInitializer<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/context-param&gt;</span>
</span></span></code></pre></div><p>이 때 ApplicationContextInitializer 구현 클래스인 MyInitializer 예이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>MyInitializer</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>ApplicationContextInitializer</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ConfigurableWebApplicationContext</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>initialize</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ConfigurableWebApplicationContext</span> <span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>PropertySource</span> <span style=color:#000>ps</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MyPropertySource</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEnvironment</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getPropertySources</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>addFirst</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ps</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// perform any other initialization of the context ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>위와 같이 등록하면 ApplicationContext가 로딩되거나 refresh되는 시점에 ApplicationContextInitializer구현체가 동작한다.
ApplicationContextInitializer구현체의 initialize메소드에서 사용자가 정의한 PropertySource(PropertySource를 상속)를 Environment내부의 propertySources에 (getPropertySources함수를 이용하여) 추가한다.</p><p>사용자 정의 PropertySource를 등록하면 Environment를 통해 직접 Property를 가져오는 방법이나 Property-placeholder를 통해서 모두 해당 Property를 가져올 수 있다.</p><h3 id=db-propertysource>DB PropertySource</h3><p>전자정부 3.0에서는 DB의 테이블에서 Property값을 가져오는 DBPropertySource를 제공하고 있다.</p><h3 id=db-propertysource이용을-위한-설정>DB PropertySource이용을 위한 설정</h3><p>DB기반의 PropertySource를 적용하기 위해서는 다음과 같이 설정한다.</p><ul><li>DB TABLE과 데이터 생성<ul><li>칼럼명을 PKEY, PVALUE로 갖는 DB TABLE을 생성한다.</li></ul></li><li>BEAN 정의<ul><li>dataSource와 dbPropertySource를 빈으로 정의한 xml을 설정한다.</li></ul></li><li>web.xml설정<ul><li>web.xml에 위에서 정의한 xml path와 DBPropertySourceInitializer를 설정한다.</li></ul></li></ul><h4 id=db설정>DB설정</h4><p>WAS가 기동될 때 DB를 연결하여 테이블에서 property값들을 가져올 수 있도록 하는 xml을 설정한다. DB property값을 담을 table을 만든다. 이 때, 칼럼명은 PKEY, PVALUE로 만들도록 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PROPERTY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>PKEY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>PRIMARY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>KEY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>PVALUE</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>VARCHAR</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>NULL</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> 
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>commit</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>INSERT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PROPERTY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>PKEY</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PVALUE</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>VALUES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;egov.test.sample01&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;db-property-sample01&#39;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>INSERT</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PROPERTY</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>PKEY</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PVALUE</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>VALUES</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;egov.test.sample02&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;db-property-sample02&#39;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> 
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> 
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>commit</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>다음은 db설정 xml의 예이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>xmlns:p=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/p&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>xmlns:jdbc=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/jdbc&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>xmlns:context=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>			http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.2.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;jdbc:embedded-database</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;HSQL&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;jdbc:script</span> <span style=color:#c4a000>location=</span><span style=color:#4e9a06>&#34;classpath:db/ddl.sql&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;jdbc:script</span> <span style=color:#c4a000>location=</span><span style=color:#4e9a06>&#34;classpath:db/dml.sql&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/jdbc:embedded-database&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;dbPropertySource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.property.db.DbPropertySource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;constructor-arg</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;dbPropertySource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;constructor-arg</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SELECT PKEY, PVALUE FROM PROPERTY&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><h4 id=webxml설정>web.xml설정</h4><p>WAS 기동 시에 DB값을 가져오도록 web.xml에 추가설정이 필요하다. egov에서 제공해주는 DBPropertySourceInitializer를 추가해주고, 앞에서 설정한 xml의 path를 설정해준다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;context-param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>contextInitializerClasses<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>egovframework.rte.fdl.property.db.initializer.DBPropertySourceInitializer<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/context-param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;context-param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>propertySourceConfigLocation<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>classpath:/initial/propertysource-context.xml<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/context-param&gt;</span>
</span></span></code></pre></div><h3 id=db-propertysource접근>DB PropertySource접근</h3><h4 id=xml에서-dbpropertysource이용>xml에서 DBPropertySource이용</h4><p>xml에서 정의된 PropertySource를 사용하기 위해서 property-placeholder만 설정해주면 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;context:property-placeholder/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 메시지소스빈 설정 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;propertyTest&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egov.sample.property.PropertyTest&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sample01&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;${egov.test.sample01}&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sample02&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;${egov.test.sample02}&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h4 id=코드상에서-dbpropertysource이용>코드상에서 DBPropertySource이용</h4><p>코드상에서 PropertySource에 접근하기 위해서는 egov 3.0부터 제공하는 Environment abstraction을 이용한다. 자세한 내용은 Environment를 참조하도록 한다.</p><h2 id=참고자료>참고자료</h2><p><a href=http://spring.io/blog/2011/02/15/spring-3-1-m1-unified-property-management/>Spring 3.1 M1: Unified Property Management</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-0fa8fe95609d5a31fe5b8d4849bae91e>18 - Environment</h1><div class=lead>표준프레임워크 3.0부터 Spring 3.1의 Environment 인터페이스를 통해 Profile과 Property에 접근할 수 있다.</div><h1 id=environment>Environment</h1><h2 id=개요>개요</h2><p>표준프레임워크 3.0부터는 (Spring 3.1부터) Environment interface를 제공한다.</p><p>Environment는 다음 기능의 접근을 제공한다.</p><ul><li>Profile</li><li>Property</li></ul><p>Environment는 ApplicationContext를 통해서 접근이 가능하며 다음과 같이 가져올 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>ApplicationContext</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>GenericApplicationContext</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>Environment</span> <span style=color:#000>env</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEnvironment</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=profile-접근>Profile 접근</h3><ul><li><a href=../foundation-layer-core/ioc-container-bean-definition-profiles.md>Profile에 대한 자세한 설명</a></li></ul><p>Profile은 등록할 bean들이 정의되어있는 논리적인 그룹을 말한다. Bean은 XML또는 Annotation을 통해 정의된 Profile값 중 활성화된 Profile로 할당된다.
이 때 현재 사용하는 Profile을 활성화하는 것이 바로 Environment의 역할이다. 또한 Profile은 default값으로 설정이 되어있어야 한다.</p><p>Spring에서 Profile을 활성화 할 때 내부에서 Environment를 쓰고 있으며 활성화하는 방법은 코드상 변환, 명시적 설정, Annotation설정 등이 있다.</p><p>Environment를 이용하여 다음과 같이 사용할 경우 Profile이 dev로 정의되어있는 bean들이 활성화된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>GenericXmlApplicationContext</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>GenericXmlApplicationContext</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEnvironment</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>setActiveProfiles</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;dev&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>load</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;classpath:/com/bank/config/xml/*-config.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>refresh</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>혹은 여러 개의 프로파일을 활성화 시킬 수도 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEnvironment</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>setActiveProfiles</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;profile1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;profile2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>web.xml의 servlet 설정에서 다음과 같이 명시적으로 쓸 수도 있다. 다음의 경우 profile이 production으로 정의되어있는 bean들이 활성화된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>dispatcher<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span style=color:#204a87;font-weight:700>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;init-param&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>spring.profiles.active<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>production<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/init-param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/servlet&gt;</span>
</span></span></code></pre></div><h3 id=property-접근>Property 접근</h3><p>Environment abstract에서는 PropertySource의 계층구조를 통해 통합검색 기능을 지원하고 있다.</p><p>다음은 Environment를 통해 PropertySource에 접근할 수 있는 예를 보여준다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>ApplicationContext</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>GenericApplicationContext</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>Environment</span> <span style=color:#000>env</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEnvironment</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>containsFoo</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>env</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>containsProperty</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;foo&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Does my environment contain the &#39;foo&#39; property? &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>containsFoo</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>PropertySource에서는 key-value쌍의 속성값에 접근할 수 있도록 기능을 제공하며 기본(default) Environment에는 두 개의 PropertySource객체로 구성되어있다.</p><ul><li>JVM 시스템 Properties (JVM system properties)</li><li>시스템 환경변수 (Systen environment variables)</li></ul><p>Environment에서 PropertySource를 Hierarchical(계층구조)의 우선순위대로 검색한다.
위의 default environment에서 JVM 시스템 properties가 시스템 환경변수보다 우선순위가 높으므로 JVM 시스템 Properties에서 검색을 하고 다음 시스템 환경변수에서 Property값을 찾을 것이다.</p><p>위의 두 기본 PropertySource외에 사용자 정의 PropertySource를 만들 수 있다.</p><p>다음은 사용자가 정의한 MyPropertySource를 Environment의 Hierarchical PropertySource에 추가하기 위한 코드이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>ConfigurableApplicationContext</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>GenericApplicationContext</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>MutablePropertySources</span> <span style=color:#000>sources</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEnvironment</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getPropertySources</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>sources</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addFirst</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MyPropertySource</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><p>위의 코드에서 MyPropertySource는 가장 높은 우선순위로 Environment에 추가된다.
만약 이전 코드와 같이 “foo”의 Property값을 가져오는 경우, MyPropertySource에 값이 있다면 그 값이 반환될 것이다.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-7c2a46d9ea16ca5fa9efa63966f2d0d6>19 - Cache Service</h1><div class=lead>전자정부 프레임워크에서 EhCache를 사용한 캐시 서비스를 제공하며, Spring 3.1 이전에는 EhCache의 CacheManager를 직접 사용하고 이후 버전에서는 CacheManager Abstraction으로 캐시 사용을 유연하게 지원한다.</div><h1 id=cache-service>Cache Service</h1><h2 id=개요>개요</h2><p>전자정부 프레임워크에서 Cache Service는 <a href=http://ehcache.sourceforge.net/>EhCache</a>를 선정하여 가이드한다.</p><p>Spring 버전 3.1 이전에서는 EhCache에서 제공하는 CacheManager를 직접 사용한다. 3.1 이후 버전에서는 CacheManager Abstraction을 제공함으로써 Cache를 유연하게 사용할 수 있게 되었다. 아래에서는 EhCache의 설명과 Spring 3.1 이전의 EhCache 사용법에 대하여 알아본다.</p><h2 id=설명>설명</h2><p>EhCache를 이용하기 위한 기본 설정 및 기본 사용법에 대해서 설명한다.</p><h3 id=bootstrap-source>Bootstrap Source</h3><p>Cache를 사용하기 위해서 Cache Manager를 생성하는 방법을 샘플을 통해서 설명한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//클래스 패스를 이용하여 설정파일 읽어서 Cache Manager 생성하기.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>URL</span> <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getClass</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getResource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ehcache-default.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>manager</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CacheManager</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>위에서 getResource를 통해서 읽어들이는 /ehcache-default.xml 의 파일 내용은 다음과 같다.</p><h3 id=configuration>Configuration</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;ehcache&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;diskStore</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;user.dir/second&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleMem&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;3&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>eternal=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>timeToIdleSeconds=</span><span style=color:#4e9a06>&#34;360&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>timeToLiveSeconds=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>diskPersistent=</span><span style=color:#4e9a06>&#34;false&#34;</span>  
</span></span><span style=display:flex><span>           <span style=color:#c4a000>memoryStoreEvictionPolicy=</span><span style=color:#4e9a06>&#34;LRU&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;/cache&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/ehcache&gt;</span>
</span></span></code></pre></div><h3 id=basic-usage-source>Basic Usage Source</h3><p>위에서 정의한 Cache Manager에서 Cache를 얻어서 기본적인 쓰고 읽고 지우는 것에 대한 샘플은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// cache Name을 가지고 cache 얻기
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleMem&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 1.Cache에 데이터 입력
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 2.Cache로부터 입력한 데이터 읽기
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Element</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 3. Cache에서 데이터 삭제
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>remove</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><ul><li>manager.getCache<ul><li>Manager를 이용하여 해당하는 Cache 얻기</li></ul></li><li>cache.put<ul><li>Cache에 자료 입력 ( 같은 키 값에 대해서 다른 value를 입력하면 수정처리됨 )</li></ul></li><li>cache.get<ul><li>Cache에서 자료 읽기</li></ul></li><li>cache.remove<ul><li>Cache에서 자료 삭제.</li></ul></li></ul><h2 id=cache-algorithm>Cache Algorithm</h2><p>Cache는 메모리를 이용하는 것을 기본으로 하기에 꼭 필요한 자료만을 관리하도록 보관 사이즈를 지정한다. 보관 사이즈를 넘어설 경우 불필요한 자료부터 삭제처리하는데 필요한 자료에 대한 판단은 알고리즘을 통해서 한다. 지원되는 알고리즘은 <code>LRU</code>, <code>FIFO</code>, <code>LFU</code> 세가지 이고 각각에 대한 설정및 사용법은 아래와 같다.</p><h3 id=lru-algorithm>LRU Algorithm</h3><p>최근에 이용한 것을 남기는 알고리즘으로 설정은 아래와 같이 한다.</p><h4 id=configuration-1>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleMem&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;3&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>memoryStoreEvictionPolicy=</span><span style=color:#4e9a06>&#34;LRU&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위의 설정에서 최대 보관 엔트리 갯수(maxElementsInMemory)는 3, 알고리즘은 LRU 로 설정된 것을 확인할 수 있다. 이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>   <span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleMem&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// 4. Put New element in cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key4&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value4&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>    	
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// 5. get key2 but can&#39;t key2 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Can&#39;t get key2&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span></code></pre></div><h3 id=fifo-algorithm>FIFO Algorithm</h3><p>먼저 입력된것을 제거하는 알고리즘으로 설정은 아래와 같이 한다.</p><h4 id=configuration-2>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleMemFIFO&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;3&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>memoryStoreEvictionPolicy=</span><span style=color:#4e9a06>&#34;FIFO&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위의 설정에서 최대 보관 엔트리 갯수(maxElementsInMemory)는 3, 알고리즘은 FIFO 로 설정된 것을 확인할 수 있다. 이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-1>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleMemFIFO&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value2&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value3&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 4. Put New element in cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key4&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value4&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>    	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 5. get key1 but can&#39;t key1 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Can&#39;t get key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span></code></pre></div><h3 id=lfu-algorithm>LFU Algorithm</h3><p>가장 적게 이용된 것을 제거하는 알고리즘으로 설정은 아래와 같이 한다.</p><h4 id=configuration-3>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleMemLFU&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;3&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>memoryStoreEvictionPolicy=</span><span style=color:#4e9a06>&#34;LFU&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위의 설정에서 최대 보관 엔트리 갯수(maxElementsInMemory)는 3, 알고리즘은 LFU 로 설정된 것을 확인할 수 있다. 이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-2>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleMemLFU&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value2&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value3&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 4. Put New element in cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key4&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value4&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>    	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 5. get key2 but can&#39;t key3 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Can&#39;t get key3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span></code></pre></div><h2 id=cache-size--device>Cache Size & Device</h2><p>Cache에서 관리해야 하는 정보의 사이즈 설정 및 저장 디바이스 관련 설정을 할 수 있다.</p><h3 id=cache-device>Cache Device</h3><p>디바이스 관련 세팅은 메모리 관리 cache의 디스크 관리로의 이동관련 설정으로 메모리 관리 오브젝트 수가 넘었을때 Disk로 이동여부, flush 호출시 파일로 저장 여부에 대한 설정이 있다. 이에 대한 설정 예시는 다음과 같다.</p><h4 id=configuration-4>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleDisk&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>diskPersistent=</span><span style=color:#4e9a06>&#34;true&#34;</span>  
</span></span><span style=display:flex><span>       <span style=color:#a40000>...</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/cache&gt;</span>
</span></span></code></pre></div><ul><li>overflowToDisk<ul><li>메모리 관리 오브젝트 넘었을때 Disk로 이동 여부 ( true,false )</li></ul></li><li>diskPersistent<ul><li>flush시에 파일로 저장 여부 ( trun , false )</li></ul></li></ul><p>이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-3>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Ehcache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleDisk&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 1. Put a content in Cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 2. Get that item from Cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Element</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getValue</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 3. flush 를 한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>flush</span><span style=color:#ce5c00;font-weight:700>();</span>		
</span></span><span style=display:flex><span><span style=color:#000>File</span> <span style=color:#000>dataFile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDiskStorePath</span><span style=color:#ce5c00;font-weight:700>()+</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>separator</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;sampleDisk.data&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 4. 파일로 저장 확인
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;File exists&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>dataFile</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exists</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><p>위의 샘플에서 flush 수행시 파일로 저장되는 것을 확인 할 수 있고, 메모리 관리 오브젝트 Disk이동 여부는 아래의 Cache Size의 예에서 확인한다.</p><h3 id=cache-size>Cache Size</h3><p>사이즈 관련 설정은 메모리에서 관리해야 할 최대 오브젝트 수, 디스크에서 관리하는 최대 오브젝트 수에 대한 설정이 있다. 이에 대한 설정 예시는 다음과 같다.</p><h4 id=configuration-5>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleDisk&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;3&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>maxElementsOnDisk=</span><span style=color:#4e9a06>&#34;2&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#a40000>...</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/cache&gt;</span>
</span></span></code></pre></div><ul><li>maxElementsInMemory<ul><li>메모리에서 관리하는 최대 오브젝트 수</li></ul></li><li>maxElementsOnDisk<ul><li>디스크에서 관리하는 최대 오브젝트 수</li></ul></li></ul><p>이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-4>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleDisk&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 1. Put 3 contents in Cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value2&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value3&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 2. Put Fourth content in Cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key4&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value4&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMemoryStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>//Memory에는 세개 유지함
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDiskStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span>   <span style=color:#8f5902;font-style:italic>//Disk로 하나 넘어감.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 3. Put 5~7 contens in Cache.    
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key5&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value5&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key6&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value6&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key7&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value7&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Disk Max Size에 관계 없이 모두 넘어감
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMemoryStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>//Memory에는 세개 유지함
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDiskStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span>   <span style=color:#8f5902;font-style:italic>//Disk에는 2개를 넘어서서 4개 유지함.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 메모리것을 디스크로 이동시킴
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>flush</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Disk의 Max Size 대로 변경됨.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMemoryStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>//Memory에는 없어짐.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDiskStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span>   <span style=color:#8f5902;font-style:italic>//Disk에는 DiskMaxSize 대로 2개만 남김.
</span></span></span></code></pre></div><p>위의 예를 보면 cache.put에 의해서는 Disk의 MaxSize에 관계없이 계속 Memory에서 Disk로 넘어가지만 flush를 수행하면 최대 디스크 보관수만을 남기는 것을 확인 할 수 있다.</p><h2 id=distributed-cache>Distributed Cache</h2><p>Ehcache는 Distributed Cache를 지원하는 방법으로 RMI,JGROUP,JMS등을 지원한다. 그 중에서 JGROUP와 ActiveMQ를 이용한 JMS 지원 설정 및 사용 방법을 설명한다. 자세한 설명은 <a href=https://www.ehcache.org/documentation/>Ehcache Documentation</a> 참고.</p><h3 id=using-jgroups>Using JGroups</h3><p>JGroups는 multicast 기반의 커뮤니케이션 툴킷으로 그룹을 생성하고 그룹멤버간에 메세지를 주고 받을 수 있도록 지원한다. 관련한 자세한 정보는 <a href=http://www.jgroups.org/>사이트</a>참조</p><h4 id=configuration-6>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cacheManagerPeerProviderFactory</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;net.sf.ehcache.distribution.jgroups.JGroupsCacheManagerPeerProviderFactory&#34;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#c4a000>properties=</span><span style=color:#4e9a06>&#34;connect=UDP(mcast_addr=224.10.10.10;mcast_port=5555;ip_ttl=32;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                    mcast_send_buf_size=150000;mcast_recv_buf_size=80000):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                    PING(timeout=2000;num_initial_members=6):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                    MERGE2(min_interval=5000;max_interval=10000):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                    FD_SOCK:VERIFY_SUSPECT(timeout=1500):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                    pbcast.NAKACK(gc_lag=10;retransmit_timeout=3000):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                    UNICAST(timeout=5000):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                    pbcast.STABLE(desired_avg_gossip=20000):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                    FRAG:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                    pbcast.GMS(join_timeout=5000;join_retry_timeout=2000;shun=false;print_local_addr=false)&#34;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#c4a000>propertySeparator=</span><span style=color:#4e9a06>&#34;::&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cacheSync&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>eternal=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>timeToIdleSeconds=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>timeToLiveSeconds=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;cacheEventListenerFactory</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;net.sf.ehcache.distribution.jgroups.JGroupsCacheReplicatorFactory&#34;</span>
</span></span><span style=display:flex><span>                                <span style=color:#c4a000>properties=</span><span style=color:#4e9a06>&#34;replicateAsynchronously=false, replicatePuts=true,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                            replicateUpdates=true, replicateUpdatesViaCopy=false,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                            replicateRemovals=true&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/cache&gt;</span>
</span></span></code></pre></div><p>이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-5>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 위의 설정파일을 정보 읽어오기
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>URL</span> <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getResource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ehcache-distributed-jgroups.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 두개의 Cache Manager 생성
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>manager1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CacheManager</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>manager2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CacheManager</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span> <span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>manager1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CACHE_SYNC</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Integer</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;value&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>		
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 리플리케이션을 위한 시간 필요함.     
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Thread</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>currentThread</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>sleep</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 리플리케이션이 되어 manager2에도 동일한 Cache 정보 입력됨 확인.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>manager1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CACHE_SYNC</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getKeys</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>manager2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CACHE_SYNC</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getKeys</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=using-activemq>Using ActiveMQ</h3><p>ActiveMQ는 JMS 메세징 서비스를 제공하는 오픈 소스이다. 관련한 자세한 정보는 <a href=http://activemq.apache.org/>사이트</a> 참조</p><h4 id=configuration-7>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cacheManagerPeerProviderFactory</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;net.sf.ehcache.distribution.jms.JMSCacheManagerPeerProviderFactory&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>properties=</span><span style=color:#4e9a06>&#34;initialContextFactoryName=egovframework.rte.fdl.cache.distribute.TestActiveMQInitialContextFactory,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            providerURL=tcp://localhost:61616,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            replicationTopicConnectionFactoryBindingName=topicConnectionFactory,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            getQueueConnectionFactoryBindingName=queueConnectionFactory,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            replicationTopicBindingName=ehcache,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            getQueueBindingName=ehcacheGetQueue&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>propertySeparator=</span><span style=color:#4e9a06>&#34;,&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;CacheAsync&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>eternal=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>timeToIdleSeconds=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>timeToLiveSeconds=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;cacheEventListenerFactory</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;net.sf.ehcache.distribution.jms.JMSCacheReplicatorFactory&#34;</span>
</span></span><span style=display:flex><span>                                <span style=color:#c4a000>properties=</span><span style=color:#4e9a06>&#34;replicateAsynchronously=true, 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                            replicatePuts=true,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                            replicateUpdates=true,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                            replicateUpdatesViaCopy=true,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                            replicateRemovals=true,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                            asynchronousReplicationIntervalMillis=1000&#34;</span>
</span></span><span style=display:flex><span>                                <span style=color:#c4a000>propertySeparator=</span><span style=color:#4e9a06>&#34;,&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/cache&gt;</span>
</span></span></code></pre></div><p>이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-6>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>URL</span> <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getResource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ehcache-distributed-activemq.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>manager1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CacheManager</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>manager2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CacheManager</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>cacheName</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;CacheAsync&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span> <span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>manager1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;CacheAsync&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Integer</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;value&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>		
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// replication 되는데 일정 시간이 필요함.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Thread</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>currentThread</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>sleep</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1000</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>manager1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;CacheAsync&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getKeys</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>manager2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;CacheAsync&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getKeys</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h2 id=spring-integration>Spring Integration</h2><p>Spring 3.1 이전 버전에서 Ehcache를 이용하는 방법에 대해서 설정 및 설정을 이용한 기본 Cache 서비스에 대해서 설명한다.</p><h3 id=configuration---spring-application-context>Configuration - Spring Application Context</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;ehcache&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.cache.ehcache.EhCacheFactoryBean&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cacheManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.cache.ehcache.EhCacheManagerFactoryBean&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;configLocation&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;classpath:ehcache-default.xml&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>    
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>위와 같이 설정하면 Manager를 통하지 않고서 cache를 얻을 수 있다. ConfigLocation에 정의된 ehcache-default.xml은 Cache Basic의 Configuration에 설명한 설정파일과 동일한 것이다.</p><h3 id=sample-source-7>Sample Source</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ehcache&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>Ehcache</span> <span style=color:#000>gCache</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// cache Name을 가지고 cache 찾기
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Ehcache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>gCache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCacheManager</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleMem&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>    	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>Element</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>위의 예를 보면 ehcache를 이용하여 Ehcache를 가지고 오고 getCacheManager()를 통해서 이름을 통한 cache 정보를 읽어오는 것을 확인할 수 있다. 그 이후에는 위에서 설명한 것과 동일한 방식으로 사용하는 것을 확인 할 수 있다.</p><h2 id=참고자료>참고자료</h2><p><a href=https://www.ehcache.org//>EhCache</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-cc5466f92b441fa89a1d6f77abf6d366>20 - EhCache</h1><div class=lead>전자정부 프레임워크에서 EhCache를 사용한 캐시 서비스를 제공하며, Spring 3.1 이전에는 EhCache의 CacheManager를 직접 사용하고 이후 버전에서는 CacheManager Abstraction으로 캐시 사용을 유연하게 지원한다.</div><h1 id=ehcache>EhCache</h1><h2 id=개요>개요</h2><p>전자정부 프레임워크에서 Cache Service는 <a href=http://ehcache.sourceforge.net/>EhCache</a>를 선정하여 가이드한다.</p><p>Spring 버전 3.1 이전에서는 EhCache에서 제공하는 CacheManager를 직접 사용한다. 3.1 이후 버전에서는 CacheManager Abstraction을 제공함으로써 Cache를 유연하게 사용할 수 있게 되었다. 아래에서는 EhCache의 설명과 Spring 3.1이전의 EhCache 사용법에 대하여 알아본다.</p><h2 id=설명>설명</h2><p>EhCache를 이용하기 위한 기본 설정 및 기본 사용법에 대해서 설명한다.</p><h3 id=bootstrap-source>Bootstrap Source</h3><p>Cache를 사용하기 위해서 Cache Manager를 생성하는 방법을 샘플을 통해서 설명한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//클래스 패스를 이용하여 설정파일 읽어서 Cache Manager 생성하기.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>URL</span> <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getClass</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getResource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ehcache-default.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>manager</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CacheManager</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>위에서 getResource를 통해서 읽어들이는 /ehcache-default.xml 의 파일 내용은 다음과 같다.</p><h3 id=configuration>Configuration</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;ehcache&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;diskStore</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;user.dir/second&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleMem&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;3&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>eternal=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>timeToIdleSeconds=</span><span style=color:#4e9a06>&#34;360&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>timeToLiveSeconds=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>diskPersistent=</span><span style=color:#4e9a06>&#34;false&#34;</span>  
</span></span><span style=display:flex><span>           <span style=color:#c4a000>memoryStoreEvictionPolicy=</span><span style=color:#4e9a06>&#34;LRU&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;/cache&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/ehcache&gt;</span>
</span></span></code></pre></div><h3 id=basic-usage-source>Basic Usage Source</h3><p>위에서 정의한 Cache Manager에서 Cache를 얻어서 기본적인 쓰고 읽고 지우는 것에 대한 샘플은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// cache Name을 가지고 cache 얻기
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleMem&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 1.Cache에 데이터 입력
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 2.Cache로부터 입력한 데이터 읽기
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Element</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 3. Cache에서 데이터 삭제
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>remove</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><ul><li>manager.getCache<ul><li>Manager를 이용하여 해당하는 Cache 얻기</li></ul></li><li>cache.put<ul><li>Cache에 자료 입력 ( 같은 키 값에 대해서 다른 value를 입력하면 수정처리됨 )</li></ul></li><li>cache.get<ul><li>Cache에서 자료 읽기</li></ul></li><li>cache.remove<ul><li>Cache에서 자료 삭제</li></ul></li></ul><h2 id=cache-algorithm>Cache Algorithm</h2><p>Cache는 메모리를 이용하는 것을 기본으로 하기에 꼭 필요한 자료만을 관리하도록 보관 사이즈를 지정한다. 보관 사이즈를 넘어설 경우 불필요한 자료부터 삭제처리하는데, 필요한 자료에 대한 판단은 알고리즘을 통해서 한다. 지원되는 알고리즘은 LRU, FIFO, LFU 세 가지이고 각각에 대한 설정 및 사용법은 아래와 같다.</p><h3 id=lru-algorithm>LRU Algorithm</h3><p>최근에 이용한 것을 남기는 알고리즘으로 설정은 아래와 같이 한다.</p><h4 id=configuration-1>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleMem&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;3&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>memoryStoreEvictionPolicy=</span><span style=color:#4e9a06>&#34;LRU&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위의 설정에서 최대 보관 엔트리 갯수(maxElementsInMemory)는 3, 알고리즘은 LRU 로 설정된 것을 확인할 수 있다. 이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleMem&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 4. Put New element in cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key4&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value4&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>    	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 5. get key2 but can&#39;t key2 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Can&#39;t get key2&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span></code></pre></div><h3 id=fifo-algorithm>FIFO Algorithm</h3><p>먼저 입력된것을 제거하는 알고리즘으로 설정은 아래와 같이 한다.</p><h4 id=configuration-2>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleMemFIFO&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;3&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>memoryStoreEvictionPolicy=</span><span style=color:#4e9a06>&#34;FIFO&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위의 설정에서 최대 보관 엔트리 갯수(maxElementsInMemory)는 3, 알고리즘은 FIFO 로 설정된 것을 확인할 수 있다. 이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-1>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>   <span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleMemFIFO&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value2&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value3&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span>   <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// 4. Put New element in cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key4&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value4&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>    	
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// 5. get key1 but can&#39;t key1 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>assertNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Can&#39;t get key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span></code></pre></div><h3 id=lfu-algorithm>LFU Algorithm</h3><p>가장 적게 이용된 것을 제거하는 알고리즘으로 설정은 아래와 같이 한다.</p><h4 id=configuration-3>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleMemLFU&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;3&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>memoryStoreEvictionPolicy=</span><span style=color:#4e9a06>&#34;LFU&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위의 설정에서 최대 보관 엔트리 갯수(maxElementsInMemory)는 3, 알고리즘은 LFU 로 설정된 것을 확인할 수 있다. 이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-2>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleMemLFU&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value2&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value3&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 4. Put New element in cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key4&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value4&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>    	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 5. get key2 but can&#39;t key3 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Can&#39;t get key3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span></code></pre></div><h2 id=cache-size--device>Cache Size & Device</h2><p>Cache에서 관리해야 하는 정보의 사이즈 설정 및 저장 디바이스 관련 설정을 할 수 있다.</p><h3 id=cache-device>Cache Device</h3><p>디바이스 관련 설정은 메모리 관리 cache의 디스크 관리로의 이동관련 설정으로 메모리 관리 오브젝트 수가 넘었을때 Disk로 이동여부, flush 호출시 파일로 저장 여부에 대한 설정이 있다. 이에 대한 설정 예시는 다음과 같다.</p><h4 id=configuration-4>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleDisk&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>diskPersistent=</span><span style=color:#4e9a06>&#34;true&#34;</span>  
</span></span><span style=display:flex><span>       <span style=color:#a40000>...</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/cache&gt;</span>
</span></span></code></pre></div><ul><li>overflowToDisk<ul><li>메모리 관리 오브젝트 넘었을때 Disk로 이동 여부 (<code>true</code>, <code>false</code>)</li></ul></li><li>diskPersistent<ul><li>flush시에 파일로 저장 여부 (<code>true</code>, <code>false</code>)</li></ul></li></ul><p>이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-3>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Ehcache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleDisk&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 1. Put a content in Cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 2. Get that item from Cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Element</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getValue</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 3. flush 를 한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>flush</span><span style=color:#ce5c00;font-weight:700>();</span>		
</span></span><span style=display:flex><span><span style=color:#000>File</span> <span style=color:#000>dataFile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDiskStorePath</span><span style=color:#ce5c00;font-weight:700>()+</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>separator</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;sampleDisk.data&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 4. 파일로 저장 확인
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;File exists&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>dataFile</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exists</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><p>위의 샘플에서 flush 수행시 파일로 저장되는 것을 확인 할 수 있고, 메모리 관리 오브젝트 Disk이동 여부는 아래의 Cache Size의 예에서 확인한다.</p><h3 id=cache-size>Cache Size</h3><p>사이즈 관련 설정은 메모리에서 관리해야 할 최대 오브젝트 수, 디스크에서 관리하는 최대 오브젝트 수에 대한 설정이 있다. 이에 대한 설정 예시는 다음과 같다.</p><h4 id=configuration-5>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sampleDisk&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;3&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>maxElementsOnDisk=</span><span style=color:#4e9a06>&#34;2&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#a40000>...</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/cache&gt;</span>
</span></span></code></pre></div><ul><li>maxElementsInMemory<ul><li>메모리에서 관리하는 최대 오브젝트 수</li></ul></li><li>maxElementsOnDisk<ul><li>디스크에서 관리하는 최대 오브젝트 수</li></ul></li></ul><p>이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-4>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleDisk&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 1. Put 3 contents in Cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key2&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value2&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value3&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 2. Put Fourth content in Cache.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key4&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value4&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMemoryStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>//Memory에는 세개 유지함
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDiskStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span>   <span style=color:#8f5902;font-style:italic>//Disk로 하나 넘어감.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 3. Put 5~7 contens in Cache.    
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key5&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value5&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key6&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value6&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key7&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value7&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Disk Max Size에 관계 없이 모두 넘어감
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMemoryStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>//Memory에는 세개 유지함
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDiskStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span>   <span style=color:#8f5902;font-style:italic>//Disk에는 2개를 넘어서서 4개 유지함.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 메모리것을 디스크로 이동시킴
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>flush</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Disk의 Max Size 대로 변경됨.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMemoryStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>//Memory에는 없어짐.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDiskStoreSize</span><span style=color:#ce5c00;font-weight:700>());</span>   <span style=color:#8f5902;font-style:italic>//Disk에는 DiskMaxSize 대로 2개만 남김.
</span></span></span></code></pre></div><p>위의 예를 보면 cache.put에 의해서는 Disk의 MaxSize에 관계없이 계속 Memory에서 Disk로 넘어가지만 flush를 수행하면 최대 디스크 보관수만을 남기는 것을 확인 할 수 있다.</p><h2 id=distributed-cache>Distributed Cache</h2><p>Ehcache는 Distributed Cache를 지원하는 방법으로 RMI, JGROUP, JMS등을 지원한다. 그 중에서 JGROUP와 ActiveMQ를 이용한 JMS 지원 설정 및 사용 방법을 설명한다. 자세한 설명은 <a href=https://www.ehcache.org/documentation/>Ehcache Documentation</a> 참고.</p><h3 id=using-jgroups>Using JGroups</h3><p>JGroups는 multicast 기반의 커뮤니케이션 툴킷으로 그룹을 생성하고 그룹멤버간에 메세지를 주고 받을 수 있도록 지원한다. 관련한 자세한 정보는 <a href=http://www.jgroups.org/>사이트</a> 참고</p><h4 id=configuration-6>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;cacheManagerPeerProviderFactory</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;net.sf.ehcache.distribution.jgroups.JGroupsCacheManagerPeerProviderFactory&#34;</span>
</span></span><span style=display:flex><span>                                     <span style=color:#c4a000>properties=</span><span style=color:#4e9a06>&#34;connect=UDP(mcast_addr=224.10.10.10;mcast_port=5555;ip_ttl=32;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                     mcast_send_buf_size=150000;mcast_recv_buf_size=80000):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                     PING(timeout=2000;num_initial_members=6):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                     MERGE2(min_interval=5000;max_interval=10000):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                     FD_SOCK:VERIFY_SUSPECT(timeout=1500):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                     pbcast.NAKACK(gc_lag=10;retransmit_timeout=3000):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                     UNICAST(timeout=5000):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                     pbcast.STABLE(desired_avg_gossip=20000):
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                     FRAG:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                     pbcast.GMS(join_timeout=5000;join_retry_timeout=2000;shun=false;print_local_addr=false)&#34;</span>
</span></span><span style=display:flex><span>                                     <span style=color:#c4a000>propertySeparator=</span><span style=color:#4e9a06>&#34;::&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cacheSync&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>eternal=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>timeToIdleSeconds=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>timeToLiveSeconds=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;cacheEventListenerFactory</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;net.sf.ehcache.distribution.jgroups.JGroupsCacheReplicatorFactory&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#c4a000>properties=</span><span style=color:#4e9a06>&#34;replicateAsynchronously=false, replicatePuts=true,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06> 												replicateUpdates=true, replicateUpdatesViaCopy=false,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06> 												replicateRemovals=true&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/cache&gt;</span>
</span></span></code></pre></div><p>이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-5>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 위의 설정파일을 정보 읽어오기
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>URL</span> <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getResource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ehcache-distributed-jgroups.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 두개의 Cache Manager 생성
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>manager1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CacheManager</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>manager2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CacheManager</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span> <span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>manager1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CACHE_SYNC</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Integer</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;value&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>		
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 리플리케이션을 위한 시간 필요함.     
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Thread</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>currentThread</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>sleep</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 리플리케이션이 되어 manager2에도 동일한 Cache 정보 입력됨 확인.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>manager1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CACHE_SYNC</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getKeys</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>manager2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CACHE_SYNC</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getKeys</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=using-activemq>Using ActiveMQ</h3><p>ActiveMQ는 JMS 메세징 서비스를 제공하는 오픈 소스이다. 관련한 자세한 정보는 <a href=http://activemq.apache.org/>사이트</a> 참조</p><h4 id=configuration-7>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;cacheManagerPeerProviderFactory</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;net.sf.ehcache.distribution.jms.JMSCacheManagerPeerProviderFactory&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>properties=</span><span style=color:#4e9a06>&#34;initialContextFactoryName=egovframework.rte.fdl.cache.distribute.TestActiveMQInitialContextFactory,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                providerURL=tcp://localhost:61616,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                replicationTopicConnectionFactoryBindingName=topicConnectionFactory,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                getQueueConnectionFactoryBindingName=queueConnectionFactory,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                replicationTopicBindingName=ehcache,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                getQueueBindingName=ehcacheGetQueue&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>propertySeparator=</span><span style=color:#4e9a06>&#34;,&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;CacheAsync&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>eternal=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>timeToIdleSeconds=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>timeToLiveSeconds=</span><span style=color:#4e9a06>&#34;1000&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;false&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>           <span style=color:#204a87;font-weight:700>&lt;cacheEventListenerFactory</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;net.sf.ehcache.distribution.jms.JMSCacheReplicatorFactory&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#c4a000>properties=</span><span style=color:#4e9a06>&#34;replicateAsynchronously=true, 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                                replicatePuts=true,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                                replicateUpdates=true,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                                replicateUpdatesViaCopy=true,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                                replicateRemovals=true,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                                                asynchronousReplicationIntervalMillis=1000&#34;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#c4a000>propertySeparator=</span><span style=color:#4e9a06>&#34;,&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/cache&gt;</span>
</span></span></code></pre></div><p>이 설정을 이용하여 설정에 대한 결과를 확인하는 소스는 다음과 같다.</p><h4 id=sample-source-6>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>URL</span> <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getResource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ehcache-distributed-activemq.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>manager1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CacheManager</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>manager2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CacheManager</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>cacheName</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;CacheAsync&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span> <span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>manager1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;CacheAsync&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Integer</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;value&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>		
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// replication 되는데 일정 시간이 필요함.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Thread</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>currentThread</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>sleep</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1000</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>manager1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;CacheAsync&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getKeys</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>manager2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEhcache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;CacheAsync&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getKeys</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h2 id=spring-integration>Spring Integration</h2><p>Spring 3.1 이전 버전에서 Ehcache를 이용하는 방법에 대해서 설정 및 설정을 이용한 기본 Cache 서비스에 대해서 설명한다.</p><h3 id=configuration---spring-application-context>Configuration - Spring Application Context</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;ehcache&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.cache.ehcache.EhCacheFactoryBean&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cacheManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.cache.ehcache.EhCacheManagerFactoryBean&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;configLocation&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;classpath:ehcache-default.xml&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>    
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>위와 같이 설정하면 Manager를 통하지 않고서 cache를 얻을 수 있다. ConfigLocation에 정의된 ehcache-default.xml은 Cache Basic의 Configuration에 설명한 설정파일과 동일한 것이다.</p><h3 id=sample-source-7>Sample Source</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ehcache&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>Ehcache</span> <span style=color:#000>gCache</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// cache Name을 가지고 cache 찾기
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Ehcache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>gCache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCacheManager</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;sampleMem&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>    	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Element</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>Element</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cache</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>위의 예를 보면 ehcache를 이용하여 Ehcache를 가지고 오고 getCacheManager()를 통해서 이름을 통한 cache 정보를 읽어오는 것을 확인할 수 있다. 그 이후에는 위에서 설명한 것과 동일한 방식으로 사용하는 것을 확인 할 수 있다.</p><h2 id=참고자료>참고자료</h2><p><a href=http://ehcache.sourceforge.net/>EhCache</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-9d59ad3d457799d79e6b66ebd9c22c8f>21 - Cache Abstraction</h1><div class=lead>Cache를 설정하여 CacheManager를 통해 Cache에 접근하는 방법에 대하여 알아보고, 자바메소드를 Caching하는 @Cacheable에 대하여 알아본다.</div><h1 id=cache-abstraction>Cache Abstraction</h1><h2 id=개요>개요</h2><p>Spring 3.1부터 Cache Service는 Cache 추상화(CacheManager Interface)와 Cache 추상화를 Java메소드에 제공할 수 있는 @Cacheable을 제공한다. Cache 추상화는 Spring의 트랜잭션기능과 유사하게 코드의 변화를 최소화하면서 Proxy를 통해 동작하게끔 한다. Cache 구현체가 아닌 Cache추상화만을 제공하며 실제 Cache Data저장소는 EhCache와 ConcurrentMap을 지원한다.</p><ul><li>Cache Configuration<ul><li>Cache설정을 통하여 어떠한 Cache Data저장소를 쓸 것인지 결정할 수 있다. (EhCache/ConcurrentMap)</li></ul></li><li>Cache Manager<ul><li>CacheManager를 통해 설정과 상관없이 동일한 코드로 Cache에 접근할 수 있다.</li></ul></li><li>Cache Annotation<ul><li>메소드의 Cache Annotation을 통해 쉽게 Cache데이터를 저장/삭제할 수 있다.</li></ul></li></ul><h2 id=설명>설명</h2><p>Cache를 설정하여 CacheManager를 통해 Cache에 접근하는 방법에 대하여 알아보고, 자바메소드를 Caching하는 @Cacheable에 대하여 알아본다.</p><h3 id=cache-configuration>Cache Configuration</h3><h4 id=ehcache>EhCache</h4><ul><li><a href=./cache-ehcache.md>EhCache</a> 참조</li></ul><p>Spring에서는 EhCache를 지원하는 CacheManager로써 EhCacheCacheManager를 제공한다. &lt;EhCache 설정></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache:annotation-driven</span> <span style=color:#c4a000>cache-manager=</span><span style=color:#4e9a06>&#34;cacheManager&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- EhCache를 저장소로 사용하는 Cache Manager --&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;cacheManager&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.cache.ehcache.EhCacheCacheManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cacheManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;ehcache&#34;</span><span style=color:#204a87;font-weight:700>&gt;&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Ehcache library setup --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;ehcache&#34;</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.cache.ehcache.EhCacheManagerFactoryBean&#34;</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>p:config-location=</span><span style=color:#4e9a06>&#34;classpath:springframework/cache/ehcache/ehcache.xml&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>Ehcache.xml에서 defaultCache저장소와 추가 Cache저장소의 설정을 한다. EhCache는 비록 ConcurrentMap보다 속도는 느리지만 Cache관리기능 측면에서 유용하여 EhCache를 추천한다.</p><ul><li>프로젝트에서는 Cache의 사용에 대하여 개발자의 가이드가 필요하다. 업무별/서비스별 Cache저장소를 분리하여 Cache데이터를 관리하도록 하며, 적용케이스에 대하여 가이드 하여야 한다.</li></ul><p><code>&lt;ehcache.xml></code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;ehcache</span><span style=color:#a40000>…</span><span style=color:#204a87;font-weight:700>&gt;</span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;defaultCache</span> 
</span></span><span style=display:flex><span>            <span style=color:#c4a000>maxElementsInMemory=</span><span style=color:#4e9a06>&#34;10000&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>eternal=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>timeToIdleSeconds=</span><span style=color:#4e9a06>&#34;120&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>timeToLiveSeconds=</span><span style=color:#4e9a06>&#34;120&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>overflowToDisk=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>diskSpoolBufferSizeMB=</span><span style=color:#4e9a06>&#34;30&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>maxElementsOnDisk=</span><span style=color:#4e9a06>&#34;10000000&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>diskPersistent=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>diskExpiryThreadIntervalSeconds=</span><span style=color:#4e9a06>&#34;120&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>memoryStoreEvictionPolicy=</span><span style=color:#4e9a06>&#34;LRU&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>statistics=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;ehcache&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:#a40000>…</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><h4 id=concurrentmap>ConcurrentMap</h4><p>Spring에서는 ConcurrentMap을 지원하는 SimpleCacheManager를 제공한다.</p><p><code>&lt;CacheManager설정></code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache:annotation-driven</span> <span style=color:#c4a000>cache-manager=</span><span style=color:#4e9a06>&#34;cacheManager&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>&lt;!-- ConcurrentMap을 저장소로 사용하는 Cache Manager --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;cacheManager&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.cache.support.SimpleCacheManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span> 
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;caches&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span> 
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;set&gt;</span> 
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.cache.concurrent.ConcurrentMapCacheFactoryBean&#34;</span> <span style=color:#c4a000>p:name=</span><span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>    
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.cache.concurrent.ConcurrentMapCacheFactoryBean&#34;</span> <span style=color:#c4a000>p:name=</span><span style=color:#4e9a06>&#34;books&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>   
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;/set&gt;</span> 
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h4 id=cache-annotation을-위한-annotation-driven-설정>Cache Annotation을 위한 annotation-driven 설정</h4><p>Cache Annotation으로 Cache를 적용하기 위해서는 반드시 <code>&lt;cache:annotatioin-driven></code>을 붙여주어야한다. 이 네임스페이스는 AOP를 사용해서 캐시 기능을 다양한 방법으로 설정할 수 있는 옵션을 제공한다. 이 설정은 Transaction에 사용되는 <code>&lt;tx:annotation-driven></code>과 비슷하다.</p><table><thead><tr><th>속성</th><th>기본값</th><th>설명</th></tr></thead><tbody><tr><td>cache-manager</td><td>cacheManager</td><td>사용할 CacheManager의 이름. CacheManager의 Bean id가 cacheManager가 아닐 경우, 설정해야한다.</td></tr><tr><td>mode</td><td>proxy</td><td>스프링 AOP를 사용하는 설정이며, “aspect”를 사용할 수도 있다.</td></tr><tr><td>proxy-target-class</td><td>false</td><td>false인 경우, JDK의 인터페이스 기반 프록시를 사용한다. true를 사용하면 클래스 기반 프록시를 사용한다.</td></tr><tr><td>order</td><td>Ordered.LOWEST_PRECEDENCE</td><td>@Cacheable/@CacheEvict메소드의 Cache advice가 적용되는 순서</td></tr></tbody></table><ul><li><code>&lt;cache:annotation-driven/></code>은 오로지 이것이 정의된 동일 ApplicationContext안의 bean에서 @Cacheable과 @CacheEvict을 찾는다. 즉, <code>&lt;cache:annotation-driven></code>을 DispatcherServlet을 위한 WebApplicationContext에 선언했을 때 @Cacheable/@CacheEvict는 controller내부에서만 식별된다.</li></ul><h3 id=cachemanager를-통한-cache접근>CacheManager를 통한 Cache접근</h3><p>ehCache, concurrentMap의 설정과 상관없이 코드상으로 동일한 CacheManager인터페이스로 bean을 주입받아 사용할 수 있다.</p><p><code>&lt;CacheManager 의 사용></code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.cache.CacheManager</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Autowired</span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>CacheManager</span> <span style=color:#000>cacheManager</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>Cache</span> <span style=color:#000>cache</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cacheManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCache</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;cache명&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=cacheable>@Cacheable</h3><p>자바 메소드에 <code>@Cacheable</code>을 설정함으로써 Caching할 수 있다. 타겟 메소드가 호출되었을 때, 캐시에 해당 메서드가 이미 동일한 인자로 있는지 확인하고, 만약 있다면 메소드를 호출하지 않고 캐시해둔 결과를 Proxy에서 반환하게 된다.</p><p>Java Method에 적용가능한 Cache Annotation은 다음과 같다.</p><ul><li><code>@Cacheable</code><ul><li>Cache에 메소드 데이터를 생성한다.</li></ul></li><li><code>@CacheEvict</code><ul><li>Cache에 메소드 데이터를 삭제한다.</li></ul></li></ul><h4 id=cacheable-사용방법>@Cacheable 사용방법</h4><p>별다른 조건 없이 호출되는 모든 인자를 caching하고자 할 때는 아래와 같이 cache명만 쓰면 된다. 이 코드는 Cache이름이 “books”인 cache저장소를 사용하였다. 메소드가 호출될 때 매번 “books”에 Cache데이터를 확인하고 이미 실행된 적이 있는지를 확인한다. 만약 “books”에 데이터가 있으면 그 값을 반환하게 된다.</p><h5 id=기본>기본</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Cacheable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;books&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Book</span> <span style=color:#000>findBook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ISBN</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>checkWarehouse</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>includeUsed</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><p>Cache되는 저장소를 여러 개 정의할 수도 있다. 아래의 코드에서는 findBook메소드 호출 시 “books”와 “isbns” 두 군데에 캐시데이터가 저장된다.</p><p><code>&lt;여러 cache 저장소에 caching></code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Cacheable</span><span style=color:#ce5c00;font-weight:700>({</span> <span style=color:#4e9a06>&#34;books&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;isbns&#34;</span> <span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Book</span> <span style=color:#000>findBook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ISBN</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{...}</span>
</span></span></code></pre></div><h5 id=cache-abstraction-key생성>Cache Abstraction Key생성</h5><p>Cache는 키-값으로 저장되며, 캐시된 메소드를 호출시마다 키를 통해 값을 가져오므로 캐시를 찾을 수 있는 키가 생성되어야 한다. 별도의 커스텀 키가 정의되지 않으면 default로 다음과 같은 알고리즘 기반의 KeyGenerator를 사용하여 Key를 생성한다.</p><ul><li>매개변수가 아무것도 없으면 0을 반환한다.</li><li>매개변수가 하나면, 그 인스턴스를 반환한다.</li><li>매개변수가 둘 이상이면, 모든 매개변수의 Hash로 계산된 키를 반환한다.</li></ul><p>이 외에 다른 기본키를 생성하려면 org.springframework.cache.KeyGenerator 인터페이스를 구현하면 된다.</p><h5 id=custom-key-추가>Custom key 추가</h5><p><code>@Cacheable</code>을 적용한 메소드의 인자가 여러개일 때 Key로 사용할 것을 SpEL로 명시할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Cacheable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;books&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#isbn&#34;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Book</span> <span style=color:#000>findBook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ISBN</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>checkWarehouse</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>includeUsed</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Cacheable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;books&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#isbn.rawNumber&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Book</span> <span style=color:#000>findBook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ISBN</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>checkWarehouse</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>includeUsed</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Cacheable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;books&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;T(someType).hash(#isbn)&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Book</span> <span style=color:#000>findBook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ISBN</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>checkWarehouse</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>includeUsed</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><h5 id=conditional-추가>Conditional 추가</h5><p>Conditional을 주어서 그 값이 true이면 caching을 하고, false이면 caching을 하지 않기 때문에 호출 시 매번 메소드 내부가 실행된다. Conditional에서는 SpEL사용이 가능하며 Condition과 Unless를 쓸 수 있다. condition과는 달리 unless는 메소드의 결과값 반환 시점에 결과값을 확인하여 caching여부를 결정하게 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Cacheable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;book&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>condition</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#name.length &lt; 32&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Book</span> <span style=color:#000>findBook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Cacheable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;book&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>condition</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#name.length &lt; 32&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>unless</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#result.hardback&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Book</span> <span style=color:#000>findBook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><p>Conditional에 쓰는 SpEL의 설명은 다음과 같다.</p><table><thead><tr><th>명칭</th><th>위치</th><th>설명</th><th>예제</th></tr></thead><tbody><tr><td>methodName</td><td>root객체</td><td>호출되는 메소드명</td><td>#root.methodName</td></tr><tr><td>method</td><td>root객체</td><td>호출되는 메소드</td><td>#root.method.name</td></tr><tr><td>target</td><td>root객체</td><td>호출되는 타겟 오브젝트</td><td>#root.target</td></tr><tr><td>targetClass</td><td>root객체</td><td>호출되는 타겟 클래스</td><td>#root.targetClass</td></tr><tr><td>args</td><td>root객체</td><td>타겟을 호출 시 사용되는 인자들(배열)</td><td>#root.args[0]</td></tr><tr><td>caches</td><td>root객체</td><td>현재 메소드가 실행되는 캐시들의 집합</td><td>#root.caches[0].name</td></tr><tr><td>argument name</td><td>평가 context</td><td>메소드 인자명을 사용할 수 없을 때 대신 a&lt;#arg>로 대체하여 사용할 수 있다. #arg는 0부터 시작하는 인자의 인덱스를 나타난다.</td><td>iban 또는 a0 (p&lt;#arg>로도 사용가능)</td></tr><tr><td>result</td><td>평가 context</td><td>메소드 호출 결과. unless와 cache evict표현에서만 사용가능하다.</td><td>#result</td></tr></tbody></table><h3 id=cacheevict>@CacheEvict</h3><p><code>@CacheEvict</code>는 <code>@Cacheable</code>과 반대로 cache저장소의 데이터를 제거함으로써 사용하지 않는 데이터를 정리하는데 유용하다. <code>@CacheEvict</code>는 캐시 삭제를 수행할 메서드에 선언한다. <code>@CacheEvict</code>도 여러 개의 캐시를 명시할 수 있으며, key와 condition을 사용할 수 있다. 또한 allEntries 속성은 키 값으로 Cache Entry 하나만 비우는 것이 아니라 캐시영역의 모든 Entries를 비우도록 한다. 이 경우에는 키를 명시하더라도 이를 무시하고 모든 Entries를 비우게 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@CacheEvict</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;books&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>allEntries</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>loadBooks</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>InputStream</span> <span style=color:#000>batch</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=cacheput>@CachePut</h3><p>메소드의 흐름을 방해하지 않고 Cache에 저장하거나 업데이트를 해야 하는 경우, <code>@CachePut</code>을 사용한다. 즉, 메소드는 항상 실행되고 그 결과가 캐시에 저장된다. <code>@CachePut</code>은 <code>@Cacheable</code>과 동일한 옵션을 제공하며, Cache에 저장하는 것보다는 메소드의 흐름을 최적화하는데 사용되어야 한다.</p><p><code>@Cacheable</code>과 함께 사용하는 것은 일반적으로 권장하지 않는다.</p><h3 id=caching>@Caching</h3><p>다수의 Cache annotation을 쓰고자 할 때 <code>@Caching</code>을 쓴다. <code>@Cacheable</code>, <code>@CacheEvic</code>, <code>@CachePut</code>을 지원한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Caching</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>evict</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#5c35cc;font-weight:700>@CacheEvict</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;primary&#34;</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#5c35cc;font-weight:700>@CacheEvict</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;secondary&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>key</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;#p0&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Book</span> <span style=color:#000>importBooks</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>deposit</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Date</span> <span style=color:#000>date</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=xml기반-caching설정>XML기반 Caching설정</h3><p>Java메소드에 Annotation을 붙이는 대신 XML로 caching할 메소드를 정의할 수 있다. 아래에서는 CacheManager bean설정을 생략하였다. BookService 패키지의 하위 메소드 중 findBook 메소드에 cacheable이 적용되며 loadBooks 메소드에 cacheEvict가 적용되었다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- the service we want to make cacheable --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;x.y.service.DefaultBookService&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- cache definitions --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;cache:advice</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;cacheAdvice&#34;</span> <span style=color:#c4a000>cache-manager=</span><span style=color:#4e9a06>&#34;cacheManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;cache:caching</span> <span style=color:#c4a000>cache=</span><span style=color:#4e9a06>&#34;books&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;cache:cacheable</span> <span style=color:#c4a000>method=</span><span style=color:#4e9a06>&#34;findBook&#34;</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;#isbn&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;cache:cache-evict</span> <span style=color:#c4a000>method=</span><span style=color:#4e9a06>&#34;loadBooks&#34;</span> <span style=color:#c4a000>all-entries=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/cache:caching&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/cache:advice&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- apply the cacheable behavior to all BookService interfaces --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;aop:config&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;aop:advisor</span> <span style=color:#c4a000>advice-ref=</span><span style=color:#4e9a06>&#34;cacheAdvice&#34;</span> <span style=color:#c4a000>pointcut=</span><span style=color:#4e9a06>&#34;execution(* x.y.BookService.*(..))&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/aop:config&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>// CacheManager설정 생략
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li><a href=http://docs.spring.io/spring/docs/3.2.6.RELEASE/spring-framework-reference/htmlsingle/>Spring Framework - Reference Document / cache</a></li><li><a href=https://spring.io/blog/2011/02/23/spring-3-1-m1-cache-abstraction>Spring Team Blog - Caching</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-b6b0beb973ec1663ffc23dab63bad20e>22 - Marshalling/Unmarshallig 서비스</h1><div class=lead>Marshalling/Unmarshalling 서비스는 Java 객체를 XML로 변환(Marshalling)하거나, XML을 Java 객체로 변환(Unmarshalling)하는 기술이다. Spring은 이를 위해 다양한 OXM 툴(JAXB, Castor, XMLBeans 등)을 지원하며, 이 기능을 활용해 객체와 XML 간의 데이터 매핑을 쉽게 처리할 수 있다. Castor와 XMLBeans를 이용한 샘플 코드는 각각 XML 문서로 데이터를 저장하고 다시 객체로 변환하는 과정으로 구성되어 있다.</div><h1 id=marshallingunmarshallig-서비스>Marshalling/Unmarshallig 서비스</h1><h2 id=개요>개요</h2><p>Object/XML Mapping, 줄여서 O/X mapping은 Object를 XML문서로 변환하는데 이를 <strong>XML Mashalling</strong> 또는 <strong>Marshalling</strong> 이다. 반대로 XML문서를 Object로 변환하는 것은 <strong>Unmarshalling</strong> 이다.</p><h2 id=설명>설명</h2><h3 id=spring-web-service-oxm>Spring Web Service OXM</h3><pre tabindex=0><code>Client &lt;------ XML ------&gt; Server
</code></pre><p>WS는 Server와 Client 두 대상 간의 데이터를 주고받는 기술 중 하나이다. 정보를 요청하는쪽이 Client이다.(Client는 Server가 될 수도 있고 일반 사용자가 될 수도 있다.) 요청한 정보를 받아서 알맞게 처리 후 결과값을 리턴하는 쪽이 Server이다.</p><pre tabindex=0><code>Client(OXM) &lt;------ XML(WSDL) ------&gt; (OXM)Server
</code></pre><p>WS는 XML(WSDL)형식으로 데이터를 주고받는다. 따라서 이 XML를 객체화 하거나 객체를 XML화 해야 한다. 그것이 Marshalling,Unmarshalling이다. OXM Utill은 JAXB,Castor,XMLBeans,JiBX,XStream..등 여러 가지가 있다.</p><h3 id=marshalling>Marshalling</h3><p>Spring의 모든 marshalling 추상 클래스들은 <a href=http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/oxm/Marshaller.html>org.springframework.oxm.Marshaller</a> interface를 implemention 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>Marshaller</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>   * Marshals the object graph with the given root into the provided Result.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>   */</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>marshal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>graph</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Result</span> <span style=color:#000>result</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>XmlMappingException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>IOException</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>PARAMETER</th><th>설 명</th></tr></thead><tbody><tr><td>Object</td><td>XML문서구조와 같은 Java 객체</td></tr><tr><td>javax.xml.transform.Result</td><td>XML 출력과 관련된 객체들이 반드시 구현해야 할 Interface</td></tr></tbody></table><ul><li>java.xml.transform.Result는 XML 출력과 관련된 객체들이 반드시 구현해야 할 Interface다.</li><li>구현 객체와 XML표현은 다음과 같이 매칭된다.</li></ul><table><thead><tr><th>javax.xml.transform.Result</th><th>XML표현</th></tr></thead><tbody><tr><td>javax.xml.transform.dom.DOMResult</td><td>org.w3c.dom.Node</td></tr><tr><td>javax.xml.transform.sax.SAXResult</td><td>org.xml.sax.ContentHandler</td></tr><tr><td>javax.xml.transform.stream.StreamResult</td><td>java.io.OutputStream java.io.File 또는 java.io.Writer</td></tr></tbody></table><h3 id=unmarshalling>Unmarshalling</h3><p>Spring의 모든 Unmarshalling 추상 클래스들은 <a href=http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/oxm/Unmarshaller.html>org.springframework.oxm.Unmarshaller</a> interface를 implemention 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>Unmarshaller</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>   * Unmarshals the given provided Source into an object graph.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>   */</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Object</span> <span style=color:#000>unmarshal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Source</span> <span style=color:#000>source</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>XmlMappingException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>IOException</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>PARAMETER</th><th>설 명</th></tr></thead><tbody><tr><td>javax.xml.transform.Source</td><td>XML source or transformation instructions 등을 매개변수로 받는 StreamSource 객체</td></tr></tbody></table><ul><li>java.xml.transform.Source는 XML 입력과 관련된 객체들이 반드시 구현해야 할 Interface다.</li><li>구현 객체와 XML표현은 다음과 같이 매칭된다.</li></ul><table><thead><tr><th>javax.xml.transform.Source</th><th>XML표현</th></tr></thead><tbody><tr><td>javax.xml.transform.dom.DOMSource</td><td>org.w3c.dom.Node</td></tr><tr><td>javax.xml.transform.sax.SAXSource</td><td>org.xml.sax.InputSource org.xml.sax.XMLReader</td></tr><tr><td>javax.xml.transform.stream.StreamSource</td><td>java.io.File java.io.InputStream 또는 java.io.Reader</td></tr></tbody></table><h3 id=marshaller-와-unmarshaller-사용하기>Marshaller 와 Unmarshaller 사용하기</h3><p><a href=http://static.springframework.org/spring-ws/sites/1.5/apidocs/index.html>Spring&rsquo;s OXM</a>은 다양한 Java-XML Binding 오픈소스를 지원한다. 여기서는 오픈소스 <a href=http://www.castor.org/>Castor</a>와 <a href=http://xmlbeans.apache.org/>XMLBeans</a>를 사용하여 구현한 가이드프로그램을 제시한다.</p><h4 id=castor>Castor</h4><p>Castor XML mapping은 XML Binding 오픈소스 프레임워크이다. Castor는 java object에서 XML문서, XML문서에서 java object로 변환을 지원한다. mapping file을 사용하여 좀더 수월하게 Castor를 사용할 수 있지만 그 외 추가적인 구성은 할 필요가 없다. 좀 더 많은 OpenSource Castor 정보를 원한다면 <a href=http://www.castor.org/>Castor web site</a>와 <a href=http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/oxm/castor/package-summary.html>org.springframework.oxm.castor</a> <strong>package</strong>를 참조하면 된다.</p><h5 id=create-binding-classes>Create binding classes</h5><ul><li>XML Schemas를 작성한다.(text.xsd)</li><li>다음을 실행하면 스키마에 따라 -package에 지정된 패키지로 클래스들이 생성된다.</li><li>java org.exolab.castor.builder.SourceGenerator -i text.xsd -package gen.xyz</li></ul><table><thead><tr><th>ARGS</th><th>설 명</th></tr></thead><tbody><tr><td>text.xsd</td><td>참조할 xml 스키마</td></tr><tr><td>gen.xyz</td><td>xml 스키마를 사용하여 Generation한 Java class package</td></tr></tbody></table><h5 id=configuration>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;divertcastor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.divert.DivertCastor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;marshaller&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;castorMarshaller&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;unmarshaller&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;castorMarshaller&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;castorMarshaller&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.oxm.castor.CastorMarshaller&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><table><thead><tr><th>PROPERTIES</th><th>설 명</th></tr></thead><tbody><tr><td>marshaller</td><td><a href=http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/oxm/castor/CastorMarshaller.html>org.springframework.oxm.castor.CastorMarshaller</a></td></tr><tr><td>unmarshaller</td><td><a href=http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/oxm/castor/CastorMarshaller.html>org.springframework.oxm.castor.CastorMarshaller</a></td></tr></tbody></table><h5 id=sample-source>Sample Source</h5><p><strong>Java Object의 데이타를 XML문서로 DataBinding Sample Source</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;castorMarshaller&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Marshaller</span> <span style=color:#000>marshaller</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testMarshalling</span><span style=color:#ce5c00;font-weight:700>()</span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#000>FileOutputStream</span> <span style=color:#000>os</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>       <span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>book2Writers</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span>       <span style=color:#000>book2Writers</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;J,J.R 툴킨&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>       <span style=color:#000>book2Writers</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;J.J.T 툴킨&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>       <span style=color:#000>BookMg</span> <span style=color:#000>bookMg2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>BookMg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;9780446618502&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;반지의 제왕&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>book2Writers</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>       <span style=color:#000>os</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;CasterBook.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>       <span style=color:#000>marshaller</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>marshal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>bookMg2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>StreamResult</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> 
</span></span><span style=display:flex><span>     <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessage</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>	<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>err</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>fail</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testMarshalling failed!&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>     <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ol><li>writer를 작가명을 매개변수로 하여 생성한다. (아래 Writer.java 코드 참조)</li><li>bookMg를 ISDN,책명,writer를 매개변수로 하여 생성한다. (아래 BookMg.java 코드 참조)</li><li>FileOutputSream을 Caster_Book.xml를 매개변수로 하여 Stream를 생성한다.</li><li>Result을 생성한 FileOutputStream을 매개변수로 하여 StreamResult를 생성한다.</li><li>marshaller.marshal를 사용하여 marshalling을 하는데 매개변수로는 bookMg와 StreamResult로 한다.</li><li>실행후 JavaObject bookMg에 저장한 값이 CasterBook.xml로 Binding 된것을 확인한다. (아래 CasterBook.xml 코드 참조)</li></ol><p>Writer.java</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>Writer</span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>Name</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// 생성자
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// 작가명
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>Name</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>Name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Name</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// 작가명 수정
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>Name</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>Name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Name</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// 작가명 리턴 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getName</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>Name</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>BookMg.java</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>BookMg</span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>title</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>writers</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>BookMg</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// 생성자
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#a40000>@</span> <span style=color:#000>isbn</span> <span style=color:#000>책번호</span>
</span></span><span style=display:flex><span>  <span style=color:#a40000>@</span> <span style=color:#000>title</span> <span style=color:#000>책제목</span>
</span></span><span style=display:flex><span>  <span style=color:#a40000>@</span> <span style=color:#000>writers</span> <span style=color:#000>작가리스트</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>BookMg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>title</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>writers</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isbn</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>title</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>title</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>writers</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>writers</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>// 생성자
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#a40000>@</span> <span style=color:#000>isbn</span> <span style=color:#000>책번호</span>
</span></span><span style=display:flex><span>  <span style=color:#a40000>@</span> <span style=color:#000>title</span> <span style=color:#000>책제목</span>
</span></span><span style=display:flex><span>  <span style=color:#a40000>@</span> <span style=color:#000>writer</span> <span style=color:#000>작가</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>BookMg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>title</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Writer</span> <span style=color:#000>writer</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isbn</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>title</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>title</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>writers</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>LinkedList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span>    <span style=color:#000>writers</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>writer</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>// 책번호 설정
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> <span style=color:#a40000>@</span> <span style=color:#000>isbn</span> <span style=color:#000>책번호</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setIsbn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isbn</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>// 책번호 리턴 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getIsbn</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>isbn</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>// 책제목 설정
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> <span style=color:#a40000>@</span> <span style=color:#000>title</span> <span style=color:#000>책제목</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setTitle</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>title</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>title</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>title</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>// 책제목 리턴
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getTitle</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>title</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>// 작가리스트 설정
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> <span style=color:#a40000>@</span> <span style=color:#000>writers</span> <span style=color:#000>작가리스트</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setWriters</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>writers</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>writers</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>writers</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>// 작가리스트 리턴 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>getWriters</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>writers</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> <span style=color:#8f5902;font-style:italic>// 작가리스트에 작가 추가
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> <span style=color:#a40000>@</span> <span style=color:#000>writer</span> <span style=color:#000>작가</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>addWriter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Writer</span> <span style=color:#000>writer</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>writers</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>writer</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>CasterBook.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;book-mg&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;isbn&gt;</span>9780446618502<span style=color:#204a87;font-weight:700>&lt;/isbn&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;writers</span> <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>  <span style=color:#c4a000>xsi:type=</span><span style=color:#4e9a06>&#34;java:egovframework.rte.fdl.divert.Writer&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;name&gt;</span>J,J.R 툴킨<span style=color:#204a87;font-weight:700>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/writers&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;writers</span> <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>  <span style=color:#c4a000>xsi:type=</span><span style=color:#4e9a06>&#34;java:egovframework.rte.fdl.divert.Writer&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;name&gt;</span>J.J.T 툴킨<span style=color:#204a87;font-weight:700>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/writers&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;title&gt;</span>반지의 제왕2<span style=color:#204a87;font-weight:700>&lt;/title&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/book-mg&gt;</span>
</span></span></code></pre></div><p>**##### <strong>XML문서를 JavaObject로 DataBinding Sample Source</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;castorMarshaller&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Unmarshaller</span> <span style=color:#000>unmarshaller</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testUnmarshalling</span><span style=color:#ce5c00;font-weight:700>()</span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#000>FileInputStream</span> <span style=color:#000>is</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>try</span> 
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>is</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;CasterBook.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>bookMg</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>BookMg</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>unmarshaller</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>unmarshal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>StreamSource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>is</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#000>writers</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>bookMg</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getWriters</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Iterator</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>writers</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>iterator</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasNext</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#ce5c00;font-weight:700>)</span> 
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#000>Writer</span> <span style=color:#000>writer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Writer</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>next</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>catch</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FileNotFoundException</span> <span style=color:#000>fnde</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>fnde</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>catch</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>finally</span> 
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>is</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> 
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>     <span style=color:#204a87;font-weight:700>try</span>
</span></span><span style=display:flex><span>     <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>is</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>     <span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>catch</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>     <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>     <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>   <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ol><li>FileInputSream을 CasterBook.xml를 매개변수로 하여 Stream를 생성한다. (위 CasterBook.xml 코드 참조)</li><li>생성한 FileInputSream을 매개변수로 하여 StreamSource를 생성한다.</li><li>marshaller.marshal를 사용하여 unmarshalling을 하는데 매개변수로는 StreamSource로 한다.</li><li>unmarshalling한 결과 bookMg를 얻어 작가 리스트를 얻는다.</li></ol><h4 id=xmlbeans>XMLBeans</h4><p>XMLBeans는 스키마 기반으로 XML 인포셋 전체에 커서 기반으로 접근할 수 있도록 하는 XML-Java binding tool이다. BEA Systems에 의해 개발되었으며 2003년에 아파치 프로젝트에 기증 되었다. 좀 더 많은 정보는 <a href=http://xmlbeans.apache.org/>XMLBeans web site</a> 와 <a href=http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/oxm/xmlbeans/package-summary.html>org.springframework.oxm.xmlbeans</a> package를 참조 하면 된다.</p><h5 id=create-binding-jar>Create binding jar</h5><ul><li>XML Schemas를 작성한다.(text.xsd)</li><li>다음을 실행하면 스키마에 따라 jar 파일이 생성된다.</li><li>scomp -out text.jar text.xsd</li></ul><table><thead><tr><th>ARGS</th><th>설 명</th></tr></thead><tbody><tr><td>text.jar</td><td>binding classes jar</td></tr><tr><td>text.xsd</td><td>참조할 xml 스키마</td></tr></tbody></table><h5 id=configuration-1>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;divertxmlbeans&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.divert.DivertXMLBeans&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;marshaller&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;xmlBeansMarshaller&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;unmarshaller&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;xmlBeansMarshaller&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;xmlBeansMarshaller&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.oxm.xmlbeans.XmlBeansMarshaller&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><table><thead><tr><th>PROPERTIES</th><th>설 명</th></tr></thead><tbody><tr><td>marshaller</td><td><a href=http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/oxm/xmlbeans/XmlBeansMarshaller.html>org.springframework.oxm.xmlbeans.XmlBeansMarshaller</a></td></tr><tr><td>unmarshaller</td><td><a href=http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/oxm/xmlbeans/XmlBeansMarshaller.html>org.springframework.oxm.xmlbeans.XmlBeansMarshaller</a></td></tr></tbody></table><h5 id=sample-source-1>Sample Source</h5><p><strong>Java Object의 데이터를 XML문서로 DataBinding Sample Source</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;xmlBeansMarshaller&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Marshaller</span> <span style=color:#000>marshaller</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testMarshalling</span><span style=color:#ce5c00;font-weight:700>()</span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>FileOutputStream</span> <span style=color:#000>os</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span> 
</span></span><span style=display:flex><span>  <span style=color:#000>userDoc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>UserinfoDocument</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>Factory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>newInstance</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#000>userElement</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>userDoc</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addNewUserinfo</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#000>userElement</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;홍길동&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#000>userElement</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setAge</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>31</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#000>userElement</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setPhone</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>022770918</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#000>xmlOptions</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>XmlOptions</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#000>xmlOptions</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSavePrettyPrint</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#000>xmlOptions</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSavePrettyPrintIndent</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#000>xmlOptions</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCharacterEncoding</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;euc-kr&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>try</span> 
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>os</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;XMLBeanGen.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>marshaller</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>marshal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>userDoc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>StreamResult</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>catch</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>ee</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#000>ee</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>   <span style=color:#000>fail</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testMarshalling failed!&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>finally</span> 
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>os</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> 
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>try</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	 <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>       <span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>catch</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>e3</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>       <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  	 <span style=color:#000>e3</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	 <span style=color:#000>fail</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testMarshalling failed!&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>       <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ol><li>UserDoc 인스턴스를 생성한다.</li><li>사용자정보를 저장할 userElement를 추가한다.</li><li>setName을 사용하여 사용자명을 저장한다.</li><li>setAge를 사용하여 나이를 저장한다.</li><li>setPhone를 사용하여 전화번호를 저장한다.</li><li>FileOutputSream을 XMLBeanGen.xml을 매개변수로 하여 생성한다. (아래 XMLBeanGen.xml 코드 참조)</li><li>marshaller.marshal를 Document객체와 StreamResult를 매개변수로 하여한다.</li></ol><p>XMLBeanGen.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;userinfo&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;name&gt;</span>홍길동<span style=color:#204a87;font-weight:700>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;age&gt;</span>31<span style=color:#204a87;font-weight:700>&lt;/age&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;phone&gt;</span>022770918<span style=color:#204a87;font-weight:700>&lt;/phone&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/userinfo&gt;</span>
</span></span></code></pre></div><p><strong>XML문서를 JavaObject로 DataBinding Sample Source</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;xmlBeansMarshaller&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Unmarshaller</span> <span style=color:#000>unmarshaller</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testUnmarshalling</span><span style=color:#ce5c00;font-weight:700>()</span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>FileInputStream</span> <span style=color:#000>is</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>try</span> 
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>is</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;XMLBeanGen.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>userDoc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UserinfoDocument</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>unmarshaller</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>unmarshal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>StreamSource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>is</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>	<span style=color:#000>userElement</span> <span style=color:#ce5c00;font-weight:700>=</span>  <span style=color:#000>userDoc</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUserinfo</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>     <span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>catch</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FileNotFoundException</span> <span style=color:#000>fnde</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>fnde</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#000>fail</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testUnmarshalling failed!&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>catch</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>finally</span> 
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>is</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>try</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	   <span style=color:#000>is</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>catch</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	  <span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	  <span style=color:#000>fail</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testUnmarshalling failed!&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ol><li>FileInputStream를 XMLBeanGen.xml을 매개변수로 하여 생성한다. (위 XMLBeanGen.xml 코드 참조)</li><li>생성한 FileInputStream를 매개변수로 하여 StreamSource생성한다.</li><li>unmarshaller.unmarshal를 생성한 StreamSource를 매개변수로 unmashalling을 하여 document객체를 얻는다.</li><li>document객체에서 사용자정보를 얻는다.</li></ol><h2 id=참고자료>참고자료</h2><ul><li><a href=http://castor.codehaus.org/>http://castor.codehaus.org/</a></li><li><a href=http://xmlbeans.apache.org/documentation/tutorial_getstarted.html>http://xmlbeans.apache.org/documentation/tutorial_getstarted.html</a></li></ul><h2 id=예제>예제</h2><ul><li><a href=../../runtime-example/individual-example/foundation-layer/marshalling-unmarshalling-example.md>marshalling/unmarshalling 예제</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-f2fa98b6113670e3960783cd6a21c139>23 - XML Manipulation Service</h1><div class=lead>XML Manipulation 서비스는 XML 문서의 생성, 읽기, 쓰기, 수정 등을 위한 기능을 제공하며, DOM과 SAX 두 가지 파서 방식을 지원한다. DOM은 트리 구조로 XML 문서를 다루고, SAX는 이벤트 기반으로 처리한다. 이 서비스를 통해 XML 문서의 요소 추가, 삭제, 수정, XPath 검색 및 Validation 검사 등의 작업을 수행할 수 있다.</div><h1 id=xml-manipulation-service>XML Manipulation Service</h1><h2 id=개요>개요</h2><p>XML Manipulation 서비스는 XML을 생성하고, 읽고, 쓰는 등과 같은 기능과 조작 기능을 제공하는 서비스이다.
XML(Extensible Markup Language)은 W3C에서 다른 특수 목적의 마크업 언어를 만드는 용도에서 권장되는 다목적 마크업 언어이다.XML은 SGML의 단순화된 부분집합이지만, 수많은 종류의 데이터를 기술하는데 적용할 수 있다.XML은 주로 다른 시스템, 특히 인터넷에 연결된 시스템끼리 데이터를 쉽게 주고받을 수 있게 하여 HTML의 한계를 극복할 목적으로 만들어졌다. XML은 W3C에서 다른 특수 목적의 마크업 언어를 만드는 용도에서 권장되는 다목적 마크업 언어이다. XML은 SGML의 단순화된 부분집합이지만, 수많은 종류의 데이터를 기술하는데 적용할 수 있다.</p><h2 id=설명>설명</h2><h3 id=xml-parser>XML Parser</h3><p>XML 문서를 읽어 들이는 역할을 수행하는 파서는 두 가지 종류가 있다. XML 파일의 내용을 트리 구조로 한번에 읽어 들여 객체를 생성하여 처리하는 <a href=http://www.w3.org/DOM/>DOM(Document Object Model)</a> 과 각각의 태그와 내용 등이 인식될 때마다 XML 문서를 읽어 들이는 <a href=http://www.saxproject.org/>SAX(Simple API for XML)</a>라는 기술이다.</p><h4 id=domdocument-object-model>DOM(Document Object Model)</h4><h5 id=요약>요약</h5><p>XML 문서는 <strong>요소(element)</strong>,<strong>속성(attribute)</strong>,<strong>Text</strong> 등으로 구성된 트리 구조의 계층적인 정보이다. ⇒DOM을 이용하면 XML 문서의 각 요소들에 대하여 트리 구조의 객체를 읽어 들인다. DOM은 XML 문서를 나타내는 각각의 객체들에 대한 표준 인터페이스이다. DOM 파서는 XML 문서로부터 DOM 구조를 생성하는 역할을 한다.</p><p><img src=../images/xml-manipulation-service-dom.png alt=xml-manipulation-service-dom></p><h5 id=sample-source>Sample Source</h5><h6 id=1-xml-문서에-대한-document-객체-생성>1) XML 문서에 대한 Document 객체 생성</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>DocumentBuilderFactory</span> <span style=color:#000>factory</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>DocumentBuilderFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>newInstance</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>DocumentBuilder</span> <span style=color:#000>parser</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>facory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>newDocumentBuilder</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>Document</span> <span style=color:#000>dc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>parser</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>parse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;XML파일명&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>Element</span> <span style=color:#000>root</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>xmldoc</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDocumentElemnt</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>root</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><ul><li>DocumentBuilderFactory 인스턴스를 생성</li><li>생성한 DocumentBuilderFactory를 통해서 parse를 생성</li><li>DocumentBuilder의 parse() 메서드를 호출하여 XML 문서를 로드</li><li>문서의 루트 요소 획득</li></ul><h6 id=2-바로-밑의-자식-요소들-추출--node-인터페이스에서-상속한-getfirstchildgetnextsibling을-자식-요소들-중-첫-번째-요소와-이-요소의-형제-요소들을-추출한다>2) 바로 밑의 자식 요소들 추출 : Node 인터페이스에서 상속한 getFirstChild(),getNextSibling()을 자식 요소들 중 첫 번째 요소와 이 요소의 형제 요소들을 추출한다.</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Element</span> <span style=color:#000>root</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDocumentElement</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Node</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>root</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFirstChild</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextSibling</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>문서의 루트 요소 획득</li><li>getFirstChild(),getNextSibling()을 자식 요소들 중 첫 번째 요소와 이 요소의 형제 요소들을 추출</li></ul><h6 id=3-요소명만-추출--공백을-나타내는-텍스트-노드는-제외하고-요소명만-출력하려면-추출된-노드의-타입을-점검하여-nodeelement_node인-경우에만-노드-명을-출력한다>3) 요소명만 추출 : 공백을 나타내는 텍스트 노드는 제외하고 요소명만 출력하려면 추출된 노드의 타입을 점검하여 Node.ELEMENT_NODE인 경우에만 노드 명을 출력한다.</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Element</span> <span style=color:#000>root</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDocumentElement</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Node</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>root</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFirstChild</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextSibiling</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeType</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>Node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ELEMENT_NODE</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>문서의 루트 요소 획득</li><li>노드의 타입을 점검하여 Node.ELEMENT_NODE인 경우에만 노드 명을 출력</li></ul><h6 id=4-모든-자식-요소-추출--각각의-자식-노드에-대해서도-getnode메서드를-호출하여-자식의-자식-노드들도-추출한다재귀함수-기법을-활용한다>4) 모든 자식 요소 추출 : 각각의 자식 노드에 대해서도 getNode()메서드를 호출하여 자식의 자식 노드들도 추출한다.재귀함수 기법을 활용한다.</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Element</span> <span style=color:#000>root</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>xmldoc</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDocumentElement</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>getNode</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>root</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>getNode</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Node</span> <span style=color:#000>n</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Node</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>n</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFirstChild</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextSibling</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeType</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>Node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ELEMENT_NODE</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>      <span style=color:#000>getNode</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>노드의 자식(child)노드를 찾아간다</li><li>getNode()메서드를 호출하여 자식의 자식 노드들도 추출</li></ul><h6 id=5-공백-이외의-텍스트만-추출--공백을-나타내는-텍스트-노드를-제외하고-요소의-내용에-대한-텍스트-노드를-추출하려면-다음과-같은-조건식으로-제어문을-사용한다>5) 공백 이외의 텍스트만 추출 : 공백을 나타내는 텍스트 노드를 제외하고 요소의 내용에 대한 텍스트 노드를 추출하려면 다음과 같은 조건식으로 제어문을 사용한다.</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>getNode</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Node</span> <span style=color:#000>n</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Node</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>n</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFirstChild</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>ch</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextSibling</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeType</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>Node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ELEMENT_NODE</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>      <span style=color:#000>getNode</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 텍스트를 처리한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>else</span> <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeType</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>Node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>TEXT_NODE</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeValue</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>trim</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeValue</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>Ordered List Item</li></ul><h6 id=6-1-노드들의-타입에-따른-parsing--각-노드-타입에-따라-처리하고-추출된-xml-문서의-내용을-하나의-문자열로-리턴하는-메서드이다>6-1) 노드들의 타입에 따른 Parsing : 각 노드 타입에 따라 처리하고 추출된 XML 문서의 내용을 하나의 문자열로 리턴하는 메서드이다.</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>xmlString</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>printString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Node</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>type</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeType</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>switch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>type</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>case</span> <span style=color:#000>Node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>DOCUMENT_NODE</span><span style=color:#ce5c00;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#000>printString</span><span style=color:#ce5c00;font-weight:700>(((</span><span style=color:#000>Document</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getDocumentElement</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>break</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>case</span> <span style=color:#000>Node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ELEMENT_NODE</span><span style=color:#ce5c00;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#000>xmlString</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#4e9a06>&#34;&lt;&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeName</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#000>NamedNodeMap</span> <span style=color:#000>attrs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAttributes</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>attrs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLength</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#000>Node</span> <span style=color:#000>attr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>attrs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>item</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>      <span style=color:#000>xmlString</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#4e9a06>&#34; &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>attr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeName</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;=&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>attr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeValue</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;&#39;&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>xmlString</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#4e9a06>&#34;&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>NodeList</span> <span style=color:#000>children</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getChildNodes</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>children</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>children</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLength</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>children</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>item</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>break</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>case</span> <span style=color:#000>Node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CDATA_SECTION_NODE</span><span style=color:#ce5c00;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#000>xmlString</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#4e9a06>&#34;&lt;![CDATA[&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeValue</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;]]&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>break</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>case</span> <span style=color:#000>Node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>TEXT_NODE</span><span style=color:#ce5c00;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#000>xmlString</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeValue</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>trim</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>break</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>case</span> <span style=color:#000>Node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>PROCESSING_INSTRUCTION_NODE</span><span style=color:#ce5c00;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#000>xmlString</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#4e9a06>&#34;&lt;?&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeName</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34; &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeValue</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;?&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>break</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>type</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>Node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ELEMENT_NODE</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>xmlString</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#4e9a06>&#34;&lt;/&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>node</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNodeName</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>xmlString</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h6 id=6-2-노드들의-타입에-따른-parsing--node-인터페이스에서-지원되는-getnodetype이라는-메서드를-사용하여-인식된-자식-노드가-어떠한-타입-노드인지에-따라-처리한다>6-2) 노드들의 타입에 따른 Parsing : Node 인터페이스에서 지원되는 getNodeType()이라는 메서드를 사용하여 인식된 자식 노드가 어떠한 타입 노드인지에 따라 처리한다.</h6><table><thead><tr><th>NODE TYPE</th><th>설 명</th></tr></thead><tbody><tr><td>Node.DOCUMENT_NODE</td><td>DocumentElement 객체 정보를 가지고 printString()을 호출</td></tr><tr><td>Node.ELEMENT_NODE</td><td>요소명,속성정보(NAME,VALUE)을 추출하여 xmlString에 저장하고 자손 요소 정보를 가지고 pringString()을 호출</td></tr><tr><td>Node.CDATA_SECTION_NODE</td><td>추출된 VALUE에 &lt;!CDATA[와]]>을 추가</td></tr><tr><td>Node.TEXT_NODE</td><td>VALUE만 추출</td></tr><tr><td>Node.PROCESSING_INSTRUCTION_NODE</td><td>추출된 값에 &lt;? 와 ?>을 추가</td></tr></tbody></table><h4 id=saxsimple-api-for-xml>SAX(Simple API for XML)</h4><h5 id=요약-1>요약</h5><p>XML 문서를 읽어 들이는 응용 프로그램 API 로서 XML 문서를 하나의 긴 문자열로 간주한다. SAX는 문자열을 앞에서 부터 차례로 읽어 가면서 요소,속성이 인식될 때 마다 <strong>EVENT</strong>를 발생시킨다.</p><p>각각의 EVENT가 발생 될 떄 마다 수행하고자 하는 기능을 <strong>이벤트 핸들러 기술</strong>을 이용하여 구현한다.</p><h5 id=sax-프로그램구현-과정>SAX 프로그램구현 과정</h5><p><img src=../images/xml-manipulation-sax-program.png alt=xml-manipulation-sax-program></p><ol><li>발생될 이벤트에 대한 핸들러(이벤트 처리 객체)를 개발한다.</li><li>SAX 객체를 생성한다.</li><li>미리 구현한 핸들러를 등록하면서 XML 문서를 읽어 들인다.</li></ol><h5 id=sample-source-1>Sample Source</h5><p><img src=../images/xml-manipulation-sax-sample.png alt=xml-manipulation-sax-sample></p><ul><li>어떠한 기능의 핸들러를 구현할 것인가에 따라 다음 인터페이스들을 필요에 따라 상속한다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>xml</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>sax</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ContentHandlder</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>xml</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>sax</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>DTDHandler</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>xml</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>sax</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>EntityResolver</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>xml</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>sax</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ErrorHandler</span>
</span></span></code></pre></div><ul><li>org.xml.sax.ContentHandler : 이 핸들러는 SAX의 핵심으로,일반적인 문서 이벤트를 처리한다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>characters</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>char</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>start</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>length</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>endDocument</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#8f5902;font-style:italic>// 문서의 끝이 인식되면 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>endElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>namespaceURI</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>localName</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>qName</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>                   <span style=color:#8f5902;font-style:italic>// 요소의 종료가 인식되면 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>endPrefixMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>prefix</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// prefix-URI 이름 공간의 종료가 인식되면 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>ignorableWhitspace</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>char</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>ch</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>start</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>length</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>                   <span style=color:#8f5902;font-style:italic>// 요소 내용에서 무시 가능한 공백을 인식되면 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>processingInstruction</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>target</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// PI가 인식되면 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setDocumentLocator</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Locator</span> <span style=color:#000>locator</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// 이벤트가 발생된 위치 정보를 알려 주는 객체 전달 시 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>skippedEntity</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Strig</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// 스킵된 엔티티가 인식되면 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>startDocument</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#8f5902;font-style:italic>// 문서의 시작이 인식되면 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>startElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>namespaceURI</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>localName</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>qName</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>Attributes</span> <span style=color:#000>atts</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>                   <span style=color:#8f5902;font-style:italic>// 요소의 시작이 인식되면 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>startPrefixMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>prefix</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>uri</span><span style=color:#ce5c00;font-weight:700>)</span> 
</span></span><span style=display:flex><span>                   <span style=color:#8f5902;font-style:italic>// &#34;prefix-URI 이름 공간의 시작이 인식되면 호출된다.&#34; 가 인식되면 호출된다.
</span></span></span></code></pre></div><ul><li>org.xml.sax.DTDHandler : 기본적인 파싱에 있어 요구되는 DTD 이벤트를 핸들링하기 위해 호출된다. 즉 표기법과 파싱되지 않는 엔티티(entity)선언을 만날 때 호출 된다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>notationDecl</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>publicId</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>systemId</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// DTD 선언 이벤트가 인식되면 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>unparsedEntityDecl</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>publicId</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>systemId</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>notationName</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>                  <span style=color:#8f5902;font-style:italic>// 파싱되지 않는 엔티티 선언 이벤트가 인식되면 호출된다.
</span></span></span></code></pre></div><ul><li>org.xml.sax.EntityResolver : 외부 엔티티를 참조하기 위하여 호출된다. 만일 문서에 외부 엔티티 참조가 없다면, 이 인터페이스는 필요 없다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>InputSource</span> <span style=color:#000>resolveEntity</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>publicId</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>String</span> <span style=color:#000>systemId</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// 확장 엔티티 처리와 관련된 기능을 처리한다.
</span></span></span></code></pre></div><ul><li>org.xml.sax.ErrorHandler : 에러를 처리하기 위해 사용된다. 파서는 모든 경고와 에러를 처리하기 위해 이 핸들러가 호출된다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>error</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>SAXParseException</span> <span style=color:#000>exception</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// 복구 가능한 오류 발생시 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>fatalError</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>SAXParseException</span> <span style=color:#000>exception</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// 복구 불가능한 오류 발생시 호출된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>warning</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>SAXParseException</span> <span style=color:#000>exception</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic>// 경고 오류 발생시 오출된다.
</span></span></span></code></pre></div><ul><li>DefaultHandler 클래스 : 필요한 메서드만을 오버라이딩 하여 구현할 수 있도록 이 인터페이스를 모두 상속하여 각 인터페이스에 정의되어 있는 abstract메서들을 오버라이딩한 DefaulatHandler 클래스를 사용한다.</li></ul><p><img src=../images/xml-manipulation-sax-defaulthandler.png alt=xml-manipulation-sax-defaulthandler></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//DefaultHandler를 상속하여 구현한 핸들러 클래스
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>SampleHandler</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>DefaultHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>startDocument</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;XML이 시작되었습니다.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>endDocument</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;XML이 종료되었습니다.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>SAX 객체 생성 : DOM 객체 생성 방법과 비슷하게 SAX 객체도 SAXParseFactory 객체 생성 후에 SAXParser 객체를 생성한다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>SAXParserFactory</span> <span style=color:#000>spf</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>SAXParserFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>newInstance</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>SAXParser</span> <span style=color:#000>sp</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>spf</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>newSAXParser</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><ul><li>핸들러 등록과 XML 문서 읽기 : 핸들러 클래스의 객체와 SAXParser의 객체를 생성한 후에 다음과 같이 여러 개로 오버로딩 된 메서드를 중에서 하나를 선택하여 XML을 SAX 객체로 읽어 들인다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>parse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>File</span> <span style=color:#000>f</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>DefaultHandler</span> <span style=color:#000>dh</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>parse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>InputStream</span> <span style=color:#000>is</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>DefaultHandler</span> <span style=color:#000>dh</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>parse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>InputStream</span> <span style=color:#000>is</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>DefaultHandler</span> <span style=color:#000>dh</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>parse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>uri</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>DefaultHandler</span> <span style=color:#000>dh</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 핸들러를 등록하면서 XML 문서를 읽는 예
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>SampleHandler</span> <span style=color:#000>sh</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>SampleHandler</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 문서를 읽어들린다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>sp</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>parse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;text.xml&#34;</span><span style=color:#ce5c00;font-weight:700>),</span><span style=color:#000>sh</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=xml-manipulation>XML Manipulation</h3><h4 id=configuration>Configuration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;xmlCofig&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.xml.EgovXmlset&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;domconcrete&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;domconcreteCont&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;saxconcrete&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;saxconcreteCont&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;domconcreteCont&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.xml.EgovConcreteDOMFactory&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;saxconcreteCont&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.xml.EgovConcreteSAXFactory&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><table><thead><tr><th>PROPERTIES</th><th>설 명</th></tr></thead><tbody><tr><td>domconcrete</td><td>EgovDOMValidatorService 생성하는 Concrete Class</td></tr><tr><td>saxconcrete</td><td>EgovSAXValidatorService 생성하는 Concrete Class</td></tr></tbody></table><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;context:property-placeholder</span> <span style=color:#c4a000>location=</span><span style=color:#4e9a06>&#34;classpath*:spring/egovxml.properties&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;xmlconfig&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.xml.XmlConfig&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	 <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;xmlpath&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;${egovxmlsaved.path}&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><table><thead><tr><th>PROPERTIES</th><th>설 명</th></tr></thead><tbody><tr><td>xmlpath</td><td>XML문서 생성 Directory 위치 지정</td></tr></tbody></table><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#c4a000>//</span> <span style=color:#4e9a06>XML 기본저장 디렉토리</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>egovxmlsaved.path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>C:\\Temp\\
</span></span></span></code></pre></div><p>egovxml.properties 내용 예시</p><h4 id=sample-source-2>Sample Source</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/** abstractXMLFactoryService 상속한 Class **/</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;domconcreteCont&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>EgovConcreteDOMFactory</span> <span style=color:#000>domconcrete</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/** abstractXMLFactoryService 상속한 Class **/</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;saxconcreteCont&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>EgovConcreteSAXFactory</span> <span style=color:#000>saxconcrete</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/** AbstractXMLUtility 상속한 DOMValidator **/</span>
</span></span><span style=display:flex><span><span style=color:#000>EgovDOMValidatorService</span> <span style=color:#000>domValidator</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/** AbstractXMLUtility 상속한 SAXValidator **/</span>
</span></span><span style=display:flex><span><span style=color:#000>EgovSAXValidatorService</span> <span style=color:#000>saxValidator</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span></code></pre></div><h5 id=dom-service-생성>DOM Service 생성</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>ModuleTest</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>UnsupportedException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>domValidator</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>domconcrete</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CreateDOMValidator</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;fileName :&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>fileName</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#000>domValidator</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setXMLFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>fileName</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=sax-service-생성>SAX Service 생성</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>ModuleTest</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>UnsupportedException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>saxValidator</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>saxconcrete</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CreateSAXValidator</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;fileName :&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>fileName</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#000>saxValidator</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setXMLFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>fileName</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=well-formed-validation-검사>well-formed, Validation 검사</h5><p>XML문서의 well-formed 검사를 하면서 Validation검사도 동시에 실행(선택)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>WellformedValidate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>isvalid</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>AbstractXMLUtility</span> <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>ValidatorException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>parse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>isvalid</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>isvalid</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Validation 문서입니다.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>else</span>
</span></span><span style=display:flex><span>        <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;well-formed 문서입니다.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>PARAMETER</th><th>설 명</th></tr></thead><tbody><tr><td>isvalid</td><td>Validation 검사여부</td></tr></tbody></table><h5 id=xpath-조회>XPATH 조회</h5><p>검색하고자하는 Element나 Attribute등을 검색식(표현식)을 통해 조회</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>XPathResult</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>AbstractXMLUtility</span> <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Document</span> <span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>JDOMException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>List</span> <span style=color:#000>list</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getResult</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;//*[@*]&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>viewEelement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>PARAMETER</th><th>설 명</th></tr></thead><tbody><tr><td>expr</td><td>Validation 검색식</td></tr><tr><td>doc</td><td>Document 객체</td></tr></tbody></table><h5 id=xml-생성>XML 생성</h5><p>입력받은 Element를 사용하여 XML문서를 생성</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>createNewXML</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>AbstractXMLUtility</span> <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Document</span> <span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>EleName</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>List</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>JDOMException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>TransformerException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>FileNotFoundException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createNewXML</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EleName</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>PARAMETER</th><th>설 명</th></tr></thead><tbody><tr><td>doc</td><td>Document 객체</td></tr><tr><td>EleName</td><td>Root 명</td></tr><tr><td>list</td><td>생성 Element List</td></tr><tr><td>path</td><td>생성될 XML문서 경로</td></tr></tbody></table><h5 id=element-추가>Element 추가</h5><p>입력받은 Element를 XML문서에 추가</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>addElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>AbstractXMLUtility</span> <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Document</span> <span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>EleName</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>List</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>JDOMException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>TransformerException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>FileNotFoundException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EleName</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>PARAMETER</th><th>설 명</th></tr></thead><tbody><tr><td>doc</td><td>Document 객체</td></tr><tr><td>EleName</td><td>Root 명</td></tr><tr><td>list</td><td>생성 Element List</td></tr><tr><td>path</td><td>생성될 XML문서 경로</td></tr></tbody></table><h5 id=textnode-element-추가>TextNode Element 추가</h5><p>입력받은 Text Element를 XML문서에 추가</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>addTextElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>AbstractXMLUtility</span> <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Document</span> <span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#000>String</span> <span style=color:#000>elemName</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>List</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>JDOMException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>TransformerException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>FileNotFoundException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addTextElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>elemName</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>PARAMETER</th><th>설 명</th></tr></thead><tbody><tr><td>doc</td><td>Document 객체</td></tr><tr><td>EleName</td><td>Root 명</td></tr><tr><td>list</td><td>생성 Element List</td></tr><tr><td>path</td><td>생성될 XML문서 경로</td></tr></tbody></table><h5 id=textnode-element-수정>TextNode Element 수정</h5><p>입력받은 Text Element로 수정</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>updTextElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>AbstractXMLUtility</span> <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Document</span> <span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>List</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>JDOMException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>TransformerException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>FileNotFoundException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updTextElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>PARAMETER</th><th>설 명</th></tr></thead><tbody><tr><td>doc</td><td>Document 객체</td></tr><tr><td>list</td><td>생성 Element List</td></tr><tr><td>path</td><td>생성될 XML문서 경로</td></tr></tbody></table><h5 id=element-삭제>Element 삭제</h5><p>입력받은 Element을 삭제</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>delElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>AbstractXMLUtility</span> <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Document</span> <span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>EleName</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>JDOMException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>TransformerException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>FileNotFoundException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>delElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EleName</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>PARAMETER</th><th>설 명</th></tr></thead><tbody><tr><td>doc</td><td>Document 객체</td></tr><tr><td>EleName</td><td>Element 명</td></tr><tr><td>path</td><td>생성될 XML문서 경로</td></tr></tbody></table><h5 id=element-수정>Element 수정</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>updElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>AbstractXMLUtility</span> <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Document</span> <span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#000>String</span> <span style=color:#000>oldElement</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>newElement</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>JDOMException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>TransformerException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>FileNotFoundException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>used</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updElement</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>doc</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>oldElement</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>newElement</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>PARAMETER</th><th>설 명</th></tr></thead><tbody><tr><td>doc</td><td>Document 객체</td></tr><tr><td>oldElement</td><td>수정할 Element 명</td></tr><tr><td>newElement</td><td>수정 Element 명</td></tr><tr><td>path</td><td>생성될 XML문서 경로</td></tr></tbody></table><h4 id=가이드프로그램-실행순서>가이드프로그램 실행순서</h4><ol><li>실행관리 Repository에서 egovframework.rte.fdl.xml-1.0.0-SNAPSHOT.jar를 Classpath 설정한다.</li><li>spring폴더를 생성 후 Classpath 설정한다.</li><li>실행관리 Repository에서 egovxmlCfg.xml와 egovxml.properties 2파일은 반드시 spring폴더로 복사한다.</li><li>egovxmlCfg.xml 내용은 egovxml.properties 파일의 위치를 바꿔 설정한다.</li><li>egovxml.properties의 egovxmlsaved.path를 바꿔 설정한다.</li><li>테스트에 필요한 context-test.xml,context-xmltest.xml를 spring폴더 또는 설정한위치로 복사한다.</li><li>설정이 완료된 후 ControlXMLTest.java를 실행한다.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-7c3001300ac721267c952903b511f5c8>24 - Object Pooling Service</h1><div class=lead>Object Pooling 서비스는 객체를 미리 생성해 Pool에서 재사용하여 성능을 향상시키는 방식이다. <strong>ObjectPool</strong> 인터페이스는 객체 할당과 반환을 처리하며, <strong>PooledObjectFactory</strong>는 객체의 생성, 유효성 검사, 재초기화 등의 생애주기 관리를 담당한다. <strong>BaseObjectPool</strong>과 <strong>BasePooledObjectFactory</strong>는 이들을 추상적으로 구현한 클래스들로, 다양한 객체 풀링을 지원한다.</div><h1 id=object-pooling-service>Object Pooling Service</h1><h2 id=개요>개요</h2><p>객체에 대한 Pooling 기능을 제공하는 서비스이다. 객체의 생성 비용이 크고,생성 횟수가 많으면, 평균적으로 사용되는 객체의 수가 적은 경우,성능을 향상시키기 위해서 사용한다.
<strong>Object Pool</strong>은 소프트웨어 디자인 패턴으로서, 객체를 필요에 따라 생성하고 파괴하는 방식이 아닌,적절한 개수의 객체를 미리 사용 가능한 상태로 생성하여 이를 이용하는 방식이다.Client는 Pool에 객체를 요청하여 객체를 얻은 후, 업무를 수행한다. 얻어온 객체를 이용하여 업무 수행을 끝마친 후, 객체를 파괴하는 것이 아니라 Pool에게 돌려주어 다른 Client가 사용할 수 있도록 한다. <strong>Object Pooling</strong>은 객체 생성 비용이 크고,객체 생성 횟수가 많으며,평균적으로 사용되는 객체의 수가 적은 경우,높은 성능의 향상을 가져다 준다.</p><h2 id=설명>설명</h2><h3 id=objectpool>ObjectPool</h3><p><strong>ObjectPool</strong>은 아래와 같은 interface이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>ObjectPool</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Object</span> <span style=color:#000>borrowObject</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>returnObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>borrowed</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p><a href=https://commons.apache.org/proper/commons-pool/apidocs/org/apache/commons/pool2/ObjectPool.html>ObjectPool</a> interface를 구현하여 코드를 작성하여 사용한다.</p><h4 id=baseobjectpool>BaseObjectPool</h4><p><strong>ObjectPool</strong>을 구현한 추상 클래스이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>BaseObjectPool</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>ObjectPool</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#000>T</span> <span style=color:#000>borrowObject</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>returnObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>T</span> <span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>invalidateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>T</span> <span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>getNumIdle</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>UnsupportedOperationException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>getNumActive</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>UnsupportedOperationException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>clear</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>UnsupportedOperationException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>UnsupportedOperationException</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>addObject</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>UnsupportedOperationException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>UnsupportedOperationException</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>close</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>closed</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>isClosed</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>closed</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>assertOpen</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>IllegalStateException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>isClosed</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>IllegalStateException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Pool not open&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>volatile</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>closed</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>METHOD</th><th>설 명</th></tr></thead><tbody><tr><td>borrowObject</td><td>객체 할당</td></tr><tr><td>returnObject</td><td>객체 반환</td></tr><tr><td>invalidateObject</td><td>객체 할당 시 유효성검사</td></tr><tr><td>getNumIdle</td><td>Idle 상태 객체 수 리턴</td></tr><tr><td>getNumActive</td><td>Active 상태 객체 수 리턴</td></tr><tr><td>clear</td><td>객체 삭제</td></tr><tr><td>addObject</td><td>Pool에 객체 추가</td></tr><tr><td>isClosed</td><td>객체 close여부 판단</td></tr><tr><td>assertOpen</td><td>객체가 사용가능한 상태판단</td></tr></tbody></table><h4 id=keyedobjectpool>KeyedObjectPool</h4><p><a href=https://commons.apache.org/proper/commons-pool/apidocs/org/apache/commons/pool2/KeyedObjectPool.html>KeyedObjectPool</a>은 이기종(異機種) 객체들로 구성된 pool 구현을 위한 interface</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>KeyedObjectPool</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Object</span> <span style=color:#000>borrowObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>returnObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span> <span style=color:#000>borrowed</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>METHOD</th><th>설 명</th></tr></thead><tbody><tr><td>borrowObject</td><td>객체 할당</td></tr><tr><td>returnObject</td><td>객체 반환</td></tr></tbody></table><h3 id=pooledobjectfactory>PooledObjectFactory</h3><p><strong>org.apache.commons.pool</strong> package는 Object Pool객체 생성과 pool로부터 생성되는 object의 created와 destoryed 부분을 분리하여 구현 할 수 있도록 지원한다. <strong>PooledObjectFactory</strong>는 pooled object의 생존주기 관리를 위한 interface이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>PooledObjectFactory</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>makeObject</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>destroyObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>validateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>activateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>passivateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span></code></pre></div><table><thead><tr><th>METHOD</th><th>설 명</th></tr></thead><tbody><tr><td>makeObject</td><td>객체 생성</td></tr><tr><td>activateObject</td><td>Pool로 부터 객체를 할당 받을 때 호출된다(재초기화 할 때 이용).</td></tr><tr><td>passivateObject</td><td>Pool로 객체를 반환할 때 호출된다(초기화 할 때 이용).</td></tr><tr><td>validateObject</td><td>객체가 유효한지 측정하기 위해 호출된다.</td></tr><tr><td>destroyObject</td><td>객체를 삭제할 때 호출된다.</td></tr></tbody></table><p>ObjectPool 구현한 프로그램은 PoolableObjectFactory를 구현한 프로그램을 받아들이도록 구현한다면, 다양하고 독특한 ObjectPool을 구현 할 수 있다.</p><h4 id=basepooledobjectfactory>BasePooledObjectFactory</h4><p><strong>PooledObjectFactory</strong>를 구현한 추상 클래스이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>BasePooledObjectFactory</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>PooledObjectFactory</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#000>T</span> <span style=color:#000>create</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>wrap</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>T</span> <span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>makeObject</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>wrap</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>create</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>destroyObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span>  <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>validateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>activateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>passivateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=keyedpooledobjectfactory>KeyedPooledObjectFactory</h4><p><strong>KeyedObjectPools</strong>를 위한 <strong>PooledObjectFactory</strong>이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>KeyedPooledObjectFactory</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>K</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>makeObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>destroyObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>validateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>activateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>passivateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><table><thead><tr><th>METHOD</th><th>설 명</th></tr></thead><tbody><tr><td>makeObject</td><td>객체 생성</td></tr><tr><td>activateObject</td><td>Pool로 부터 객체를 할당 받을 때 호출된다(재초기화 할 때 이용).</td></tr><tr><td>passivateObject</td><td>Pool로 객체를 반환할 때 호출된다(초기화 할 때 이용).</td></tr><tr><td>validateObject</td><td>객체가 유효한지 측정하기 위해 호출된다.</td></tr><tr><td>destroyObject</td><td>객체를 삭제할 때 호출된다.</td></tr></tbody></table><h4 id=basekeyedpoolableobjectfactory>BaseKeyedPoolableObjectFactory</h4><p><strong>KeyedPoolableObjectFactory</strong>를 구현한 추상 클래스이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>BaseKeyedPooledObjectFactory</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>K</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>KeyedPooledObjectFactory</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>K</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#000>V</span> <span style=color:#000>create</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>wrap</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>V</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>makeObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>wrap</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>create</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>destroyObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>validateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>activateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>passivateObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>K</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>PooledObject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>V</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>p</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-84c2fb373aae4cd68c3c5492c4ab3b68>25 -</h1><p>Encryption/Decryption과 crypto 간소화를 crypto라는 목록에 넣기 위해 생성.
좌측 네비게이션 바에는 보이지만, 클릭과 url접근은 안 됨.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-61d529344b33b9334e383405abfd7356>26 - Encryption/Decryption Service</h1><div class=lead>암호화는 평문을 암호문으로 변환해 메시지를 보호하며, 복호화는 이를 다시 평문으로 복원하는 과정으로, 암호계는 관용암호와 공개키 시스템으로 구분된다.</div><h1 id=encryptiondecryption-service>Encryption/Decryption Service</h1><h2 id=개요>개요</h2><p>암호화는 시큐리티에 대처하는 가장 강력한 수단이다. 이때 본래의 메시지를 평문(Plan Text,Clear Text)이라고 부르고, 암호화된 메시지는 암호문(Cipher Text,Cryptogram)이라고 부른다.
암호화(Encryption,Ciphering)는 메시지의 내용이 불명확하도록 평문을 재구성하여 암호문을 만드는 것인데, 이 때 사용되는 메시지의 재구성 방법을 암호화 알고리즘(Encryption Algorithm)이라고 부른다. 암호화 알고리즘에서는 암호화의 비밀성을 높이기 위해 키(Key)를 사용하기도 한다.
복호화(Decyption,decipheing)란 암호화의 역과정으로, 불명확한 메시지로부터 본래의 메시지를 환원하는 과정이다. 일반적으로 복호화에도 암호화에 사용된 것과 동일한 알고리즘이 사용된다.
그리고 암호화 기법을 적용하는 암호화 및 복호화 과정으로 구성된 시스템을 암호계(Crypto System)라고 부른다. 암호계에는 키나 알고리즘이 포함되는데 하나의 비밀키(Private Key,Secret Key)를 암호화와 복호화에 모두 사용하는 관용암호계(Conventional Crypto System) 와 비밀키와 공개키를 사용하는 공개키(Public Key System)시스템으로 구분된다.</p><h2 id=설명>설명</h2><h3 id=jasyptjava-simplified-encryption>JASYPT(Java simplified encryption)</h3><p>Jasypt는 오픈소스 Java library로 개발자는 암호화관련 깊은 지식이 없어도 암복화 프로그램을 개발할 수 있도록 지원한다. 여기서 설명하는 부분은 암복화 모듈로 사용한 <acronym title="Application Programming Interface">API</acronym> 중심으로 설명하겠다.</p><h4 id=encryption-binaries>Encryption binaries</h4><p>Jasypt은 binaries(byte[] objects) 암호화를 위해 <strong>org.jasypt.encryption.pbe.PBEByteEncryption</strong> interface를 구현한 <strong>org.jasypt.encryption.pbe.StandardPBEByteEncryptor</strong>를 제공한다.</p><h5 id=configuration>Configuration</h5><p>PBE (Password Based Encryption) operations인 <strong>org.jasypt.encryption.pbe.StandardPBEByteEncryptor</strong>는 암호와 키를 필요하는데 알고리즘인데 설정하는 방법은 아래와 같다</p><ul><li>package에서 제공하는 기본 설정값 사용(암호는 제외)</li><li>org.jasypt.encryption.pbe.config.PBEConfig 설정</li><li>setAlgorithm(&mldr;), setProvider(&mldr;), setProviderName(&mldr;), setPassword(&mldr;), setKeyObtentionIterations(&mldr;) or setSaltGenerator(&mldr;) methods 설정</li></ul><h5 id=initialization>Initialization</h5><p>암호화 하기전에 encrptor는 초기화(intialized)되어야 한다. 초기화는 아래와 같다.</p><ul><li>initialize() 메소드를 호출.</li><li>encrypt(&mldr;) 또는 decrypt(&mldr;) 메소드가 처음 호출.(initialize() 메소드가 호출 하지 않아도 초기화됨)</li><li>encryptor가 초기화가 된 후에 설정이 바뀌어 다시 initialize() 메소드를 호출하면 AlreadyInitializedException 이 발생.</li></ul><h5 id=usage>Usage</h5><ul><li>메시지 암호화할 경우 encrypt(..) 메소드 호출</li><li>메시지 복호화할 경우 decrypt(..) 메소드 호출</li></ul><h4 id=encrypting-texts>Encrypting texts</h4><p>Jasypt은 texts 암호화를 위해 <strong>org.jasypt.encryption.pbe.PBEStringEncryptor</strong> interface를 구현한 <strong>org.jasypt.encryption.pbe.StandardPBEStringEncryptor</strong>를 제공한다.</p><h5 id=basics>Basics</h5><p>Jasypt는 text 암호화에 byte(binary) 암호화 방법을 사용한다.</p><ul><li>모든 결과(암호화) 문자열은 기본적으로 BASE64로 encode되고 US-ASCII 문자셋으로 안전하게 저장된다.</li><li>setStringOutputType 메소드를 사용하여 encoding 방식을 선택 할 수 있다.</li></ul><h5 id=configuration-1>Configuration</h5><p>PBE(Password Based Encryption) operations인 <strong>org.jasypt.encryption.pbe.StandardPBEStringEncryptor</strong>는 암호와 키를 필요하는데 알고리즘인데 설정하는 방법은 아래와 같다</p><ul><li>package에서 제공하는 기본 설정값 사용(암호는 제외)</li><li>org.jasypt.encryption.pbe.config.PBEConfig 설정</li><li>setAlgorithm(&mldr;), setProvider(&mldr;), setProviderName(&mldr;), setPassword(&mldr;), setKeyObtentionIterations(&mldr;) or setSaltGenerator(&mldr;) methods 설정</li></ul><h5 id=initialization-1>Initialization</h5><p>암호화 하기전에 encrptor는 초기화(intialized)되어야 한다. 초기화는 아래와 같다.</p><ul><li>initialize() 메소드를 호출.</li><li>encrypt(&mldr;) 또는 decrypt(&mldr;) 메소드가 처음 호출.(initialize() 메소드가 호출 하지 안아도 초기화됨)</li><li>encryptor가 초기화가 된 후에 설정이 바뀌어 다시 initialize() 메소드를 호출하면 AlreadyInitializedException 이 발생.</li></ul><h5 id=usage-1>Usage</h5><ul><li>메시지 암호화할 경우 encrypt(..) 메소드 호출</li><li>메시지 복호화할 경우 decrypt(..) 메소드 호출</li></ul><h4 id=encrypting-passwords>Encrypting passwords</h4><p>Jasypt는 외부로 부터 공격받을 수 있는 데이타베이스 암호나 시스템 암호를 암호화할 수 있도록 지원한다.</p><h5 id=jasypts-standardbytestringdigester를-사용한-digest-생성-절차>Jasypt&rsquo;s Standard[Byte|String]Digester를 사용한 Digest 생성 절차</h5><ol><li>명시된 salt size는 생성된다(<a href=http://www.jasypt.org/api/jasypt/1.8/org/jasypt/salt/SaltGenerator.html>org.jasypt.salt.SaltGenerator</a> 참고). size가 0일 경우는 salt는 사용되지 않는다.
보다 높은 보안을 위해서는 salt는 기본으로 random으로 생성(like <a href=http://www.jasypt.org/api/jasypt/1.8/org/jasypt/salt/RandomSaltGenerator.html>org.jasypt.salt.RandomSaltGenerator</a>)한다.</li><li>salt bytes는 메시지 시작부분에 덧붙여진다.</li><li>Hash function은 salt와 메시지 전체에 적용되고, function 결과들은 명시한 iterations 만큼 반복된다.</li><li>랜덤으로 salt를 생성하면 undigested salt는 hash 결과 시작부분에 덧붙여진다.</li></ol><p><img src=../images/crypto-encryption-decryption-jasypts-Standard.png alt="alt text"></p><h4 id=encrypting-numbers>Encrypting numbers</h4><p>Jasypt은 numbers 암호화를 위해 <strong>org.jasypt.encryption.pbe.PBEBingIntegerEncryptor</strong> 와 <strong>org.jasypt.encryption.pbe.PBEBingDecimalEncryptor</strong> interface를 구현한 <strong>org.jasypt.encryption.pbe.StandardPBEBigIntegerEncryptor</strong> 와 <strong>org.jasypt.encryption.pbe.StandardPBEBigDecimalEncryptor</strong>을 제공한다.</p><h5 id=basics-1>Basics</h5><p>Jasypt는 number 암호화에 byte(binary) 암호화 방식을 사용한다.(Text 암호화 방식과 같다.)</p><h5 id=configuration-2>Configuration</h5><p>PBE (Password Based Encryption) operations인 <strong>org.jasypt.encryption.pbe.StandardPBEByteEncryptor</strong>는 암호와 키를 필요하는데 알고리즘인데 설정하는 방법은 아래와 같다.</p><ul><li>package에서 제공하는 기본 설정값 사용(암호는 제외)</li><li>org.jasypt.encryption.pbe.config.PBEConfig 설정</li><li>setAlgorithm(&mldr;), setProvider(&mldr;), setProviderName(&mldr;), setPassword(&mldr;), setKeyObtentionIterations(&mldr;) or setSaltGenerator(&mldr;) methods 설정</li></ul><h5 id=initialization-2>Initialization</h5><p>암호화 하기전에 encrptor는 초기화(intialized)되어야 한다. 초기화는 아래와 같다.</p><ul><li>initialize() 메소드를 호출.</li><li>encrypt(&mldr;) 또는 decrypt(&mldr;) 메소드가 처음 호출.(initialize() 메소드가 호출 하지 안아도 초기화됨)</li><li>encryptor가 초기화가 된 후에 설정이 바뀌어 다시 initialize() 메소드를 호출하면 AlreadyInitializedException 이 발생.</li></ul><h5 id=usage-2>Usage</h5><ul><li>메시지 암호화할 경우 encrypt(..) 메소드 호출</li><li>메시지 복호화할 경우 decrypt(..) 메소드 호출</li></ul><h4 id=using-jasypt-with-jce-providers>Using Jasypt with JCE providers</h4><p>Jasypt는 암호 기반 알고리즘외에 어떠한 알고리즘도 java의 security.provider를 구현한 JCE provider를 사용한다면 사용할 수 있다.</p><h5 id=how-can-you-use-your-own-providers-in-jasypt>How can you use your own providers in jasypt?</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>Security</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addProvider</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>BouncyCastleProvider</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>StandardPBEStringEncryptor</span> <span style=color:#000>mySecondEncryptor</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>StandardPBEStringEncryptor</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>mySecondEncryptor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setProviderName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;BC&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// jce provider name
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>mySecondEncryptor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setAlgorithm</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;PBEWITHSHA256AND128BITAES-CBC-BC&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>mySecondEncryptor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setPassword</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>myPassword</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>mySecondEncryptedText</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>mySecondEncryptor</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>myText</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>        
</span></span><span style=display:flex><span><span style=color:#000>StandardStringDigester</span> <span style=color:#000>digester</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>StandardStringDigester</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>digester</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setProvider</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>BouncyCastleProvider</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>// create jce provider instance 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>digester</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setAlgorithm</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;WHIRLPOOL&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>digest</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>digester</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>digest</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>message</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><h3 id=aria-블록암호-알고리즘>ARIA 블록암호 알고리즘</h3><p>ARIA는 경량 환경 및 하드웨어 구현을 위해 최적화된, Involutional SPN 구조를 갖는 범용 블록 암호 알고리즘이다.</p><ul><li>블록 크기 : 128비트</li><li>키 크기 : 128/192/256비트(AES와 동일 규격)</li><li>전체 구조 : Involutional Substitution-Permutation Network</li><li>라운드 수 : 12/14/16(키 크기에 따라 결정됨)</li></ul><p>ARIA는 경량 환경 및 하드웨어에서의 효율성 향상을 위해 개발되었으며, ARIA가 사용하는 대부분의 연산은 XOR과 같은 단순한 바이트 단위 연산으로 구성되어 있습니다. ARIA라는 이름은 Academy(학계),Research Institute(연구소),Agency(정부 기관)의 첫 글자들을 딴 것으로, ARIA 개발에 참여한 학.연.관의 공동 노력을 표현하고 있다.</p><h4 id=표준화-동향>표준화 동향</h4><p>ARIA는 지난 2004년에 국가표준기본법에 의거, 지식경제부에 의하여 국가표준(KS)으로 지정되었다.</p><ul><li>표준번호 : KSX1213:2004</li><li>부 문 : X-정보산업 &lt; 정보기술(IT)응용</li><li>표 준 명 : 128비트 블록 암호 알고리즘 ARIA(128 bit block encryption algorithm ARIA)</li><li>이 력 : 2004년 12월 30일 제정</li><li>적용범위: 이 규격은 가변 크기의 암호키를 사용하여 128bit 블록 단위로 데이터의 암호화, 복호화를 수행하는 블록 암호 알고리즘을 규정</li></ul><h4 id=안전성과-효율성>안전성과 효율성</h4><p>ARIA는 블록 암호에 대한 알려진 모든 공격에 대한 내성을 갖도록 설계되었다. 일차적으로 설계자들에 의한 내부적인 안전성 분석을 거친 뒤에, 객관적인 안전성 및 효율성 평가를 위하여 NESSIE(New European Schemes for Signatures, Integrity and Encryption)의 주관 기관인 벨기에 루벤 대학으로부터 평가를 받았다. ARIA는 하드웨어 구현 및 8비트 환경에서 뛰어난 효율성을 가지고 있어 IC 카드, VPN 장비 등 다양한 환경에 적용이 가능합니다. 또한 소프트 웨어 구현에서도 벨기에 루벤 대학의 효율성 평가에서 Camellia보다 빠르고 AES에 근접하는 성능을 보였다.</p><h4 id=aria-효율성-비교단위-cyclebyte>ARIA 효율성 비교(단위: cycle/byte)</h4><table><thead><tr><th>CPU</th><th>ARIA</th><th>AES</th><th>Camellia</th><th>SEED</th></tr></thead><tbody><tr><td>Pentium III</td><td>37.3</td><td>23.3</td><td>33.4</td><td>42.4</td></tr><tr><td>Pentium IV</td><td>49.0</td><td>30.5</td><td>83.9</td><td>81.3</td></tr></tbody></table><p>이 효율성 비교표는 NESSIE의 효율성 분석 보고서와 루벤 대학의 ARIA 분석 보고서에 근거하여 작성되었다. ARIA는 128비트 키 길이의 경우 루벤 대학의 평가의 대상이었던 ver. 0.8에 비해 라운드 수가 10에서 12로 증가 하였기 때문에 사이클 수를 평가 자료의 120%로 산출하였으며, 두 보고서가 같은 기관에서 (루벤 대학의 COSIC 그룹) 수행되었으나 양쪽 자료가 정확히 같은 환경에서 수행된 것은 아니기 때문에 두 보고서의 AES, Camellia에 대한 데이터로부터 양쪽 플랫폼의 성능비를 산출하여 SEED의 속도를 추정하였다.</p><h3 id=가이드프로그램guide-program>가이드프로그램(Guide Program)</h3><h4 id=configuration-3>Configuration</h4><p>암복호화 서비스를 사용하기 위해서는 다음과 같이 패스워드에 대한 hash 값 기록이 필요하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Message digest algorithm using EgovPasswordEncoder..</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>crypto.password.algorithm</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>SHA-256</span>
</span></span><span style=display:flex><span><span style=color:#a40000> </span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># hashed password (ex: egovframe (SHA-256) =&gt; gdyYs/IZqY86VcWhT8emCYfqY1ahw2vtLG+/FzNqtrQ=)</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>crypto.hashed.password</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>gdyYs/IZqY86VcWhT8emCYfqY1ahw2vtLG+/FzNqtrQ=</span>
</span></span></code></pre></div><ul><li>crypto.password.algorithm : 패스워드 인코더에 사용될 hash function 알고리즘 (default : SHA-256)</li><li>crypto.hashed.password : 패스워드에 대한 hash value (egovframework.rte.fdl.cryptography.EgovPasswordEncoder의 main 메소드에 의해 해당 값을 얻어 기록한다.)</li></ul><p>그리고 이를 사용하기 위해 다음과 같이 property-placeholder 설정이 필요하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;context:property-placeholder</span> 
</span></span><span style=display:flex><span><span style=color:#c4a000>location=</span><span style=color:#4e9a06>&#34;classpath*:/META-INF/spring/crypto_config.properties,classpath*:/META-INF/spring/password.properties&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- recommended location method is using file prefix.. ex) &#34;file:/home/properties/crypto_config.properties&#34; --&gt;</span>
</span></span></code></pre></div><p>※ 위 property 파일과 이를 사용하기 위한 property-placeholder를 사용하지 않고 아래의 xml 설정에 직접 기록하여도 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;passwordEncoder&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cryptography.EgovPasswordEncoder&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;algorithm&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;${crypto.password.algorithm}&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span><span style=color:#8f5902;font-style:italic>&lt;!-- default : SHA-256 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hashedPassword&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;${crypto.hashed.password}&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;ARIACryptoService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cryptography.impl.EgovARIACryptoServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;passwordEncoder&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;passwordEncoder&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;blockSize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;1025&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span><span style=color:#8f5902;font-style:italic>&lt;!-- default : 1024 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;digestService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cryptography.impl.EgovDigestServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;algorithm&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SHA-256&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span><span style=color:#8f5902;font-style:italic>&lt;!-- default : SHA-256 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;plainDigest&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span><span style=color:#8f5902;font-style:italic>&lt;!-- default : false --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;generalCryptoService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cryptography.impl.EgovGeneralCryptoServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;passwordEncoder&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;passwordEncoder&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;algorithm&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;PBEWithSHA1AndDESede&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span><span style=color:#8f5902;font-style:italic>&lt;!-- default : PBEWithSHA1AndDESede --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;blockSize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;1024&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span><span style=color:#8f5902;font-style:italic>&lt;!-- default : 1024 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h5 id=example>Example</h5><table><thead><tr><th>bean</th><th>class</th><th>설 명</th></tr></thead><tbody><tr><td>passwordEncoder</td><td>EgovPasswordEncoder</td><td>Hash function 알고리즘 및 hashed된 패스워드 보관 (다른 암복호화 서비스 bean에 의해 사용됨)</td></tr><tr><td>ARIACryptoService</td><td>EgovARIACryptoServiceImpl</td><td>ARIA 알고리즘을 통한 암복호화 서비스 제공</td></tr><tr><td>digestService</td><td>EgovDigestServiceImpl</td><td>Digest Service(Hash function) 서비스 제공</td></tr><tr><td>generalCryptoService</td><td>EgovGeneralCryptoServiceImpl</td><td>ARIA 이외의 알고리즘(JASYPT 기반)을 통한 암복호화 서비스 제공</td></tr></tbody></table><h4 id=aria-알고리즘-sample-source>ARIA 알고리즘 Sample Source</h4><h5 id=encryption-texts-guide-program>Encryption texts Guide Program</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ARIACryptoService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>EgovCryptoService</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testString</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>testString</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;This is a testing...\nHello!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;한글 테스트입니다...&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;!@#$%^&amp;*()_+|~{}:\&#34;&lt;&gt;?-=\\`[];&#39;,./&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>str</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>testString</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>byte</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>encrypted</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>str</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBytes</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>byte</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>decrypted</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>decrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>encrypted</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>str</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>decrypted</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UnsupportedEncodingException</span> <span style=color:#000>uee</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>uee</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fail</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=encryption-file-guide-program>Encryption File Guide Program</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ARIACryptoService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>EgovCryptoService</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testFile</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>String</span> <span style=color:#000>filePath</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/META-INF/spring/file/test.hwp&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>File</span> <span style=color:#000>srcFile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getResource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filePath</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getFile</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#000>File</span> <span style=color:#000>trgtFile</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>File</span> <span style=color:#000>decryptedFile</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>trgtFile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createTempFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;tmp&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;encrypted&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>trgtFile</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>deleteOnExit</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>srcFile</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>trgtFile</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>decryptedFile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createTempFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;tmp&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;decrypted&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>decryptedFile</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>deleteOnExit</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>decrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>trgtFile</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>decryptedFile</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Decrypted file not same!!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> 
</span></span><span style=display:flex><span>          <span style=color:#000>checkFileWithHashFunction</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>srcFile</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>decryptedFile</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#000>fail</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessage</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=digest-sample-source>Digest Sample Source</h4><h5 id=encryption-digest-guide-program>Encryption Digest Guide Program</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;digestService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>EgovDigestService</span> <span style=color:#000>digestService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testDigest</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>String</span> <span style=color:#000>data</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;egovframe&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>byte</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>digested</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>digestService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>digest</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBytes</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>digestService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>matches</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBytes</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>digested</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=general-알고리즘-sample-source>General 알고리즘 Sample Source</h4><h5 id=encryption-texts-guide-program-1>Encryption texts Guide Program</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;generalCryptoService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>EgovCryptoService</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testString</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>testString</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;This is a testing...\nHello!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;한글 테스트입니다...&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;!@#$%^&amp;*()_+|~{}:\&#34;&lt;&gt;?-=\\`[];&#39;,./&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>str</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>testString</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>byte</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>encrypted</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>str</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBytes</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>byte</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>decrypted</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>decrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>encrypted</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>str</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>decrypted</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UnsupportedEncodingException</span> <span style=color:#000>uee</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>uee</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#000>fail</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=encryption-bigdecimal-guide-program>Encryption BigDecimal Guide Program</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;generalCryptoService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>EgovCryptoService</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testBigDecimal</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>BigDecimal</span> <span style=color:#000>big</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>BigDecimal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>123456</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>BigDecimal</span> <span style=color:#000>encrypted</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>big</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>BigDecimal</span> <span style=color:#000>decrypted</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>decrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>encrypted</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>big</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>decrypted</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=encryption-file-guide-program-1>Encryption File Guide Program</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;generalCryptoService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>EgovCryptoService</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testFile</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>String</span> <span style=color:#000>filePath</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/META-INF/spring/file/test.hwp&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>File</span> <span style=color:#000>srcFile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getResource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filePath</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getFile</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>File</span> <span style=color:#000>trgtFile</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>File</span> <span style=color:#000>decryptedFile</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>trgtFile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createTempFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;tmp&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;encrypted&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>trgtFile</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>deleteOnExit</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>//trgtFile = new File(&#34;C:/test.enc&#34;);
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>//System.out.println(&#34;Temp file : &#34; + trgtFile.toString());
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>        <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>srcFile</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>trgtFile</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>decryptedFile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createTempFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;tmp&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;decrypted&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>decryptedFile</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>deleteOnExit</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>//decryptedFile = new File(&#34;C:/test.dec.hwp&#34;);
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>        <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>decrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>trgtFile</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>decryptedFile</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Decrypted file not same!!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>checkFileWithHashFunction</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>srcFile</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>decryptedFile</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#000>fail</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessage</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#000>fail</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessage</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=web-encryption-guide-program>Web Encryption Guide Program</h5><p>ARIA 알고리즘으로 암/복호화시 Byte[] 형태로 결과가 나오기 때문에, Base64를 통해 추가로 인코딩/디코딩 해야 한다. Base64 이용시 Apache Commons Codec의 Base64 클래스를 이용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.apache.commons.codec.binary.Base64</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>strValue</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;TEXT&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>byte</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>text</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>strValue</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBytes</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>base64enc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Base64</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encodeBase64String</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>text</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>urlText</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>URLEncoder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encode</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>base64enc</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//Decryption
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;\n\nDecoding Test!!!&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>URLDecoder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>decode</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>urlText</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>byte</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>base64dec</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Base64</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>decodeBase64</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>byte</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>dectext</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>decrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>base64dec</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>pom.xml에 아래 내용을 추가한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>commons-codec<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>commons-codec<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>1.9<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><p><a href=https://seed.kisa.or.kr/kisa/algorithm/EgovAriaInfo.do>ARIA 블록암호 알고리즘</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-b1405ccc47f742a5c71d53d85d4d1251>27 - Crypto 간소화 서비스</h1><div class=lead>표준프레임워크 3.8부터 ARIA 알고리즘을 기반으로 XML Schema와 properties 파일을 통해 간편하게 암/복호화 설정과 중요한 정보 보호를 지원한다.</div><h1 id=crypto-간소화-서비스>Crypto 간소화 서비스</h1><h2 id=개요>개요</h2><p>표준프레임워크 3.8 부터 ARIA 블록암호 알고리즘 기반 암/복호화 설정을 간소화 할 수 있는 방법을 제공한다.
내부적으로 필요한 설정을 가지고 있고, <acronym title="Extensible Markup Language">XML</acronym> Schema를 통해 필요한 설정만을 추가할 수 있도록 제공한다.
또한 globals.properties 설정 파일의 중요 정보 Url, UserName, Password 항목을 암/복호화 처리 할 수 있도록 제공한다.
그외에 정보는 properties 파일에 암호화 데이터 설정후 #{egovEnvCryptoService.decrypt(&rsquo;…&rsquo;)} 복호화 기능을 제공한다.</p><h2 id=xml-namespace-및-schema-설정>XML namespace 및 schema 설정</h2><p>설정 간소화 기능을 사용하기 위해서는 다음과 같은 xml 선언이 필요하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:egov-crypto=</span><span style=color:#4e9a06>&#34;http://maven.egovframe.go.kr/schema/egov-crypto&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		http://maven.egovframe.go.kr/schema/egov-crypto http://maven.egovframe.go.kr/schema/egov-crypto/egov-crypto-4.2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><h2 id=crypto-config-설정>Crypto Config 설정</h2><p>Security에 대한 기본 설정 정보를 제공한다.
<strong>algorithmKey</strong>, <strong>algorithmKeyHash</strong> 값을 하단 <b>[Crypto algorithmKey, algorithmKeyHash 생성]에 의해 생성된 값을 입력</b>한다.
algorithmKey, algorithmKeyHash 키의 노출을 피하고 싶다면 설정 파일에서 해당 항목 삭제 후
하단 [WAS VM arguments 환경 변수 등록(옵션)]을 참고하여 진행한다.</p><p>예:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;egov-crypto:config</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;egovCryptoConfig&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>initial=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>crypto=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>algorithm=</span><span style=color:#4e9a06>&#34;SHA-256&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>algorithmKey=</span><span style=color:#4e9a06>&#34;(생성값)&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>algorithmKeyHash=</span><span style=color:#4e9a06>&#34;(생성값)&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>cryptoBlockSize=</span><span style=color:#4e9a06>&#34;1024&#34;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h3 id=속성-설명>속성 설명</h3><table><thead><tr><th>속성</th><th>설명</th><th>필수여부</th><th>비고</th></tr></thead><tbody><tr><td>initial</td><td>globals.properties 연계 Url, UserName, Password 값 로드 여부(true, false)</td><td>필수</td><td></td></tr><tr><td>crypto</td><td>계정 암호화 여부(true, false)</td><td>필수</td><td></td></tr><tr><td>algorithm</td><td>계정 암호화 알고리즘</td><td>필수</td><td></td></tr><tr><td>algorithmKey</td><td>계정 암호화키 키</td><td>필수</td><td></td></tr><tr><td>algorithmKeyHash</td><td>계정 암호화 키 해쉬값</td><td>필수</td><td></td></tr><tr><td>cryptoBlockSize</td><td>계정 암호화키 블록사이즈</td><td>필수</td><td></td></tr><tr><td>cryptoPropertyLocation</td><td>설정파일 암복호화 경로</td><td>선택</td><td>default=“classpath:/egovframework/egovProps/globals.properties”</td></tr></tbody></table><h2 id=crypto-algorithmkey-algorithmkeyhash-생성>Crypto algorithmKey, algorithmKeyHash 생성</h2><p>Crypto Config 설정에 algorithmKey, algorithmKeyHash 인코딩 키 생성 방법을 제공한다.
<strong>하단 코드에서 계정암호화키 키 값을 원하는 값으로 설정한다.</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.slf4j.Logger</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.slf4j.LoggerFactory</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.egovframe.rte.fdl.cryptography.EgovPasswordEncoder</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovEnvCryptoAlgorithmCreateTest</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Logger</span> <span style=color:#000>LOGGER</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LoggerFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovEnvCryptoAlgorithmCreateTest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//계정암호화키 키
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>algorithmKey</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;(사용자정의 값)&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//계정암호화 알고리즘(MD5, SHA-1, SHA-256)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>algorithm</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;SHA-256&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//계정암호화키 블럭사이즈
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>algorithmBlockSize</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1024</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>main</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>EgovEnvCryptoAlgorithmCreateTest</span> <span style=color:#000>cryptoTest</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>EgovEnvCryptoAlgorithmCreateTest</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>EgovPasswordEncoder</span> <span style=color:#000>egovPasswordEncoder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>EgovPasswordEncoder</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>egovPasswordEncoder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setAlgorithm</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cryptoTest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>algorithm</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;------------------------------------------------------&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;알고리즘(algorithm) : &#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>cryptoTest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>algorithm</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;알고리즘 키(algorithmKey) : &#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>cryptoTest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>algorithmKey</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;알고리즘 키 Hash(algorithmKeyHash) : &#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>egovPasswordEncoder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encryptPassword</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cryptoTest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>algorithmKey</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;알고리즘 블럭사이즈(algorithmBlockSize)  :&#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>cryptoTest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>algorithmBlockSize</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=환경설정-파일globalsproperties-암호화>환경설정 파일(globals.properties) 암호화</h2><h3 id=환경설정-파일globalsproperties의-데이터베이스-연결-항목url-username-password-인코딩-값-생성>환경설정 파일(globals.properties)의 데이터베이스 연결 항목(Url, UserName, Password) 인코딩 값 생성</h3><p>환경설정 파일에서 데이터베이스 연결 항목(Url, UserName, Password) 인코딩 키 생성 방법을 제공한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- EgovEnvCryptoUserTest.java 설정 파일 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- context-crypto-test.xml --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:egov-crypto=</span><span style=color:#4e9a06>&#34;http://maven.egovframe.go.kr/schema/egov-crypto&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>		http://maven.egovframe.go.kr/schema/egov-crypto http://maven.egovframe.go.kr/schema/egov-crypto/egov-crypto-4.1.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;messageSource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.context.support.ResourceBundleMessageSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;useCodeAsDefaultMessage&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>true<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;basenames&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>classpath:/egovframework/egovProps/globals<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;egov-crypto:config</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;egovCryptoConfig&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>initial=</span><span style=color:#4e9a06>&#34;false&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>crypto=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>algorithm=</span><span style=color:#4e9a06>&#34;SHA-256&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>algorithmKey=</span><span style=color:#4e9a06>&#34;(사용자정의 값)&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>algorithmKeyHash=</span><span style=color:#4e9a06>&#34;(생성값)&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>cryptoBlockSize=</span><span style=color:#4e9a06>&#34;1024&#34;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 데이터베이스 연결 항목(Url, UserName, Password) 인코딩 값 생성 JAVA
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.slf4j.Logger</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.slf4j.LoggerFactory</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.context.ApplicationContext</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.context.support.ClassPathXmlApplicationContext</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.egovframe.rte.fdl.cryptography.EgovEnvCryptoService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.egovframe.rte.fdl.cryptography.impl.EgovEnvCryptoServiceImpl</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovEnvCryptoUserTest</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Logger</span> <span style=color:#000>LOGGER</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LoggerFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovEnvCryptoUserTest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>main</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>arrCryptoString</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>{</span> 
</span></span><span style=display:flex><span>			<span style=color:#4e9a06>&#34;userId&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>         <span style=color:#8f5902;font-style:italic>//데이터베이스 접속 계정 설정
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#4e9a06>&#34;userPassword&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>   <span style=color:#8f5902;font-style:italic>//데이터베이스 접속 패드워드 설정
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#4e9a06>&#34;url&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>            <span style=color:#8f5902;font-style:italic>//데이터베이스 접속 주소 설정
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#4e9a06>&#34;databaseDriver&#34;</span>  <span style=color:#8f5902;font-style:italic>//데이터베이스 드라이버
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#ce5c00;font-weight:700>};</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;------------------------------------------------------&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>		
</span></span><span style=display:flex><span>		<span style=color:#000>ApplicationContext</span> <span style=color:#000>context</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ClassPathXmlApplicationContext</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]{</span><span style=color:#4e9a06>&#34;classpath:/context-crypto-test.xml&#34;</span><span style=color:#ce5c00;font-weight:700>});</span>
</span></span><span style=display:flex><span>		<span style=color:#000>EgovEnvCryptoService</span> <span style=color:#000>cryptoService</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getBean</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovEnvCryptoServiceImpl</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;------------------------------------------------------&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>label</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>for</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>arrCryptoString</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>		
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>==</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>label</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;사용자 아이디&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>==</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>label</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;사용자 비밀번호&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>==</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>label</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;접속 주소&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>==</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>label</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;데이터 베이스 드라이버&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>				<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#4e9a06>&#34; 원본(orignal):&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>arrCryptoString</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]);</span>
</span></span><span style=display:flex><span>				<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#4e9a06>&#34; 인코딩(encrypted):&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>cryptoService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>encrypt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>arrCryptoString</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]));</span>
</span></span><span style=display:flex><span>				<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;------------------------------------------------------&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IllegalArgumentException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;[&#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>()+</span><span style=color:#4e9a06>&#34;] IllegalArgumentException : &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessage</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;[&#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>()+</span><span style=color:#4e9a06>&#34;] Exception : &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessage</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=환경설정-파일globalsproperties-인코딩-값-설정>환경설정 파일(globals.properties) 인코딩 값 설정</h3><ul><li>앞에서 생성된 데이터베이스 연결 항목(Url, UserName, Password)을 (생성값)에 입력</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#a40000>......</span>
</span></span><span style=display:flex><span><span style=color:#a40000> </span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#mysql</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>Globals.mysql.DriverClassName</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>(생성값)</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>Globals.mysql.Url</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>(생성값)</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>Globals.mysql.UserName</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>(생성값)</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>Globals.mysql.Password</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>(생성값)</span>
</span></span><span style=display:flex><span><span style=color:#a40000> </span>
</span></span><span style=display:flex><span><span style=color:#a40000>......</span>
</span></span></code></pre></div><h3 id=context-datasourcexml-파일의-데이터베이스-연결-항목url-username-password-디코딩-연결-설정>context-datasource.xml 파일의 데이터베이스 연결 항목(Url, UserName, Password) 디코딩 연결 설정</h3><p>데이터베이스 설정 파일에서 데이터베이스 연결 항목을 디코딩 하는 설정 방법을 제공한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:util=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/util&#34;</span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>	http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>......
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- MySQL --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>profile=</span><span style=color:#4e9a06>&#34;mysql&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>  
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;dataSource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.apache.commons.dbcp2.BasicDataSource&#34;</span> <span style=color:#c4a000>destroy-method=</span><span style=color:#4e9a06>&#34;close&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;driverClassName&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;#{egovEnvCryptoService.decrypt(&#39;${Globals.mysql.DriverClassName}&#39;)}&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;url&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;#{egovEnvCryptoService.getUrl()}&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;username&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;#{egovEnvCryptoService.getUsername()}&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;password&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;#{egovEnvCryptoService.getPassword()}&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>......
</span></span></code></pre></div><h3 id=was-vm-arguments-환경-변수-등록옵션>WAS VM arguments 환경 변수 등록(옵션)</h3><ul><li>간소화 설정 파일에서 algorithmKey, algorithmKeyHash 키의 노출을 피하고 싶다면<ul><li>간소화 설정 파일에서 algorithmKey, algorithmKeyHash 키를 삭제 하고 WAS VM arguments 환경 변수를 등록 한다.</li><li>globals.properties 설정 파일의 중요 정보 Url, UserName, Password 항목에 대해 암/복호화 처리 할 수 있도록 제공한다.</li></ul></li></ul><pre tabindex=0><code>-Degov.crypto.algorithmKey=&#34;(사용자정의 값)&#34; -Degov.crypto.algorithmKeyHash=&#34;(생성값)&#34;
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-e086468a93ab6c492f08115014a8f597>28 - FTP Service</h1><div class=lead>Apache Commons Net을 사용하여 FTP 서비스를 제공하며, FTP 클라이언트를 통해 파일 업로드, 다운로드, 삭제, 디렉토리 생성 등의 기능을 구현할 수 있다. FTP 사용 예제 및 파일 전송 설정 방법을 함께 제공한다.</div><h1 id=ftp-service>FTP Service</h1><h2 id=개요>개요</h2><p><strong>전자정부 표준프레임워크</strong>는 <acronym title="File Transfer Protocol">FTP</acronym> 서비스제공을 위해 Apache Commons Net™ [단순 클라이언트측의 기본적인 Internet Protocol의 구현의 FTP기능을 편리하게 제공]을 오픈 소스로 채택하였다.</p><p>Apache Commons Net™은 Network utility collection 이다.
Apache Commons Net™은 단순 클라이언트측의 기본적인 Internet Protocol을 구현함으로서 기본적인 프로토콜 access가 목적이기 때문에 부분적으로 object-orient 규칙에 위배가 되는 사항이 있다는 것을 참고적으로 알고 있어야 한다.</p><h3 id=ftp정의>FTP정의</h3><pre tabindex=0><code>FTP란 FTP (File Transfer Protocol) 파일 전송 프로토콜로 FTP[에프 티 피]는 인터넷상의 컴퓨터들 간에 파일을 교환하기 위한 표준 프로토콜로서 가장 간단한 방법이기도 하다.
화면에 표시할 수 있는 웹 페이지와 관련 파일들을 전송하는 HTTP, 전자우편을 전송하는 SMTP 등과 같이, FTP 역시 인터넷의 TCP/IP 응용 프로토콜 중의 하나이다.
FTP는 웹 페이지 파일들을 인터넷상에서 모든 사람이 볼 수 있도록 하기 위해 저작자의 컴퓨터로부터 서버로 옮기는 과정에서 사용된다.
또한, 다른 서버들로부터 자신의 컴퓨터로 프로그램이나 파일들을 다운로드 하는 데에도 많이 사용된다. 
사용자 입장에서는 간단한 명령을 이용하여 FTP를 쓰거나, 또는 그래픽 사용자 인터페이스를 제공하는 상용 프로그램을 쓸 수도 있다. 
보통은 웹 브라우저도 웹 페이지로부터 선택한 프로그램을 다운로드 하는데 FTP를 사용한다. 
FTP를 사용하여 서버에 있는 파일을 지우거나 이름을 바꾸거나 옮기거나 복사하는 등 갱신작업을 할 수도 있다. 
FTP 서버에는 로그온을 해야하지만, 익명의 FTP를 사용하여 모든 사람들에게 공개된 파일들을 쉽게 접근할 수 있도록 하고 있다. 
FTP는 보통 TCP/IP에 함께 제공되는 일련의 프로그램 속에 포함되어 있다.
</code></pre><h2 id=설명>설명</h2><h3 id=apache-commons-net>Apache Commons Net™</h3><p>Apache Commons Net™ 프로젝트(<a href=http://commons.apache.org/net/>http://commons.apache.org/net/</a>)에서 지원하는 프로토콜은 다음과 같다.</p><ul><li><acronym title="File Transfer Protocol">FTP</acronym>/FTPS</li><li><acronym title="File Transfer Protocol">FTP</acronym> over <acronym title="Hyper Text Transfer Protocol">HTTP</acronym> (experimental)</li><li>NNTP</li><li><acronym title="Simple Mail Transfer Protocol">SMTP</acronym>(S)</li><li><acronym title="Post Office Protocol 3">POP3</acronym>(S)</li><li><acronym title="Internet Message Access Protocol">IMAP</acronym>(S)</li><li>Telnet</li><li>TFTP</li><li>Finger</li><li>Whois</li><li>rexec/rcmd/rlogin</li><li>Time (rdate) and Daytime</li><li>Echo</li><li>Discard</li><li>NTP/SNTP</li></ul><p>Apache Commons Net - org.apache.commons.net.ftp 의 동작흐름에 대하여 간략히 설명한다.</p><p>논리적 흐름도는 아래와 같다.</p><pre tabindex=0><code>1. FTP Client를 생성
2. FTP Server에 Connect 서버에 연결한다
3. 응답이 정상적인지 확인한다.
4. FTP Server 로그인한다
5. 접속하여 여러가지 작업(list, get, put....등등)
6. FTP Server 로그아웃한다
7. FTP Server disconnect
</code></pre><p>다음은 사용예제는 FTP에 접속하여 리스트를 볼수 있는 예제이다.</p><h4 id=사용예제>사용예제</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#000>FileInputStream</span> <span style=color:#000>inputStream</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>main</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>FTPClient</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// 계정 로그인
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FTPClient</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// 한글파일명 때문에 디폴트 인코딩을 euc-kr로 한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setControlEncoding</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;euc-kr&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// Test 서버 정보
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Commons NET FTP Client Test Program&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Start GO&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// Novell TEST서버에 접속
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>connect</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;ftp.novell.com&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Connected to ||||||||||||||||||||||...........&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// 응답코드가 비정상일 경우 종료함
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>reply</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getReplyCode</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>FTPReply</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isPositiveCompletion</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>reply</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>disconnect</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;FTP server refused connection&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getReplyString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>// timeout을 설정
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSoTimeout</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10000</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>// 로그인
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>login</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;anonymous login success...&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>// 각종 정보를 처리 (Put / Get / Append등)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>logout</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;해당 ftp 로그인 실패하였습니다.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exit</span><span style=color:#ce5c00;font-weight:700>(-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>finally</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isConnected</span><span style=color:#ce5c00;font-weight:700>()){</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>disconnect</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>catch</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>ioe</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=파일-리스트-보기>파일 리스트 보기</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>FTPFile</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>ftpfiles</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>listFiles</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ftpfiles</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span> <span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>ftpfiles</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>FTPFile</span> <span style=color:#000>file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ftpfiles</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span><span style=display:flex><span>		<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>// 파일정보
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getName</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>// 파일명 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getSize</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>// 파일사이즈
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=파일-다운로드-get>파일 다운로드 (get)</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>File</span> <span style=color:#000>get_file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;c:\\temp\\test.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>FileOutputStream</span> <span style=color:#000>outputstream</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>get_file</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieveFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/public/test.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>outputstream</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>outputstream</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=파일-업로드-put>파일 업로드 (put)</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>File</span> <span style=color:#000>put_file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;c:\\temp\\test.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>inputStream</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>put_file</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>storeFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/public/test.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>inputStream</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>inputStream</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=파일-업로드-append>파일 업로드 (append)</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>File</span> <span style=color:#000>append_file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;c:\\temp\\test.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>inputStream</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>append_file</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>appendFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/public/test.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>inputStream</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>inputStream</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=파일-이름변경-rename>파일 이름변경 (rename)</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>rename</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/public/바꾸기전.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;/public/바꾼후.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h4 id=파일-삭제-delete>파일 삭제 (delete)</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>deleteFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/public/삭제할.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h4 id=dircetory-생성>Dircetory 생성</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>makeDirectory</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/public/test&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h4 id=os-커맨드-입력하기>OS 커맨드 입력하기</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>sendCommand</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FTPCommand</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>MAKE_DIRECTORY</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#4e9a06>&#34;/public/test&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h4 id=파일-및-전송상태-설정>파일 및 전송상태 설정</h4><ul><li>파일 타입 : <acronym title="File Transfer Protocol">FTP</acronym>.BINARY_FILE_TYPE, <acronym title="File Transfer Protocol">FTP</acronym>.ASCII_FILE_TYPE, 등 설정 - 파일 전송 형태 : <acronym title="File Transfer Protocol">FTP</acronym>.STREAM_TRANSFER_MODE, COMPRESSED_TRANSFER_MODE 등 설정</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/* 파일 타입*/</span>
</span></span><span style=display:flex><span><span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFileType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FTP</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>BINARY_FILE_TYPE</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/* 파일 전송 형태 */</span>
</span></span><span style=display:flex><span><span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFileTransferMode</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FTP</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>COMPRESSED_TRANSFER_MODE</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/* Mail - IMAP[S] Client 사용 */</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>IMAPMail</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>main</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>err</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span>
</span></span><span style=display:flex><span>              <span style=color:#4e9a06>&#34;Usage: IMAPMail &lt;imap server hostname&gt; &lt;username&gt; &lt;password&gt; [TLS]&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>          <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>      <span style=color:#000>String</span> <span style=color:#000>server</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span><span style=display:flex><span>      <span style=color:#000>String</span> <span style=color:#000>username</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span><span style=display:flex><span>      <span style=color:#000>String</span> <span style=color:#000>password</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span><span style=display:flex><span>      <span style=color:#000>String</span> <span style=color:#000>proto</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>?</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>IMAPClient</span> <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>proto</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Using secure protocol: &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>proto</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>          <span style=color:#000>imap</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>IMAPSClient</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>proto</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// implicit
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>imap</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>IMAPClient</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>      <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Connecting to server &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>server</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34; on &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDefaultPort</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>      <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setDefaultTimeout</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>60000</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>      <span style=color:#8f5902;font-style:italic>// suppress login details
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>      <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addProtocolCommandListener</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PrintCommandListener</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>connect</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>RuntimeException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Could not connect to server.&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>login</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>username</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>              <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>err</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Could not login to server. Check password.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>              <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>disconnect</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>              <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>          <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>          <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSoTimeout</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>6000</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>          <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>capability</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>          <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>select</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;inbox&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>          <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>examine</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;inbox&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>          <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>status</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;inbox&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]{</span><span style=color:#4e9a06>&#34;MESSAGES&#34;</span><span style=color:#ce5c00;font-weight:700>});</span>
</span></span><span style=display:flex><span>          <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>logout</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>          <span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>disconnect</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>imap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getReplyString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>          <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>          <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>return</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=commons-net-2x-to-commons-net-30>Commons Net 2.x to Commons Net 3.0</h2><p>Version 3.0의 binary는 호환이 보장 되지만 소스코드는 아래와 같은 내용이 변경되었다.</p><p>사용되지 않는 여러 상수들이 제거되었으며, binary 호환성에 영향을 주지않는 exception, public methods 들은 더이상 IOException 을 throw 하지 않도록 보완/수정되었다.</p><ul><li>TelnetClient#addOptionHandler(TelnetOptionHandler)</li><li>TelnetClient#deleteOptionHandler(int)</li></ul><h2 id=참고자료>참고자료</h2><p><a href=http://commons.apache.org/net/>Jakarta Commons Net</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-7f2afaabbb1c4dc1cf2e636f4e61cbb5>29 - Mail 서비스</h1><div class=lead>Jakarta Commons Email API를 사용하여 메일 발송을 쉽게 처리하며, 텍스트 메일, 파일 첨부, URL 첨부, HTML 메일, 인증 처리 등의 기능을 제공한다. 이를 통해 간단한 코드로 다양한 형식의 메일 발송을 구현할 수 있다.</div><h1 id=mail-서비스>Mail 서비스</h1><h2 id=개요>개요</h2><p><strong>전자정부 프레임워크</strong>에서는 이메일 발송을 쉽게 처리하기 위해 Jakarta Commons Email <acronym title="Application Programming Interface">API</acronym>를 사용하고 있는데 Commons Email은 내부적으로 Java Mail API와 JavaBeans Activation API 를 제공하여 오픈 소스로 채택하였다</p><p>Apache Commons-Email은 Java Mail API를 근간으로 좀더 심플하게 메일을 보내는 방안을 제시한다.</p><p>Commons Email API는 메일 발송을 처리해주는 SimpleEmail, HtmlEmail과 같은 클래스를 제공하고 있으며, 이들 클래스를 사용하여 일반 텍스트메일, <acronym title="HyperText Markup Language">HTML</acronym> 메일, 첨부 메일 등을 매우 간단(simple)하게 발송할 수 있다.</p><p>Email Sample Code는 다음과 같다.</p><ul><li>간단히 텍스트만 보내기</li><li>파일 첨부하기</li><li>URL을 통해 첨부하기</li><li>HTML 이메일 보내기</li><li>인증 처리하기</li></ul><h2 id=설명>설명</h2><h3 id=1-간단히-텍스트만-보내기>1. 간단히 텍스트만 보내기</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovSimpleMail</span> <span style=color:#ce5c00;font-weight:700>{</span> 
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>main</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[])</span><span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>MailException</span> <span style=color:#ce5c00;font-weight:700>{</span>   
</span></span><span style=display:flex><span>	  <span style=color:#000>SimpleEmail</span> <span style=color:#000>email</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>SimpleEmail</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	  <span style=color:#8f5902;font-style:italic>// setHostName에 실제 메일서버정보
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>	  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCharset</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;euc-kr&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 한글 인코딩  
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>	  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHostName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;mail.myserver.com&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//SMTP서버 설정
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	  <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addTo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;jdoe@somewhere.org&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;John Doe&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 수신자 추가
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EmailException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	  <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFrom</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;me@apache.org&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Me&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 보내는 사람
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EmailException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSubject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Test message&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 메일 제목
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setContent</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;simple 메일 Test입니다&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;text/plain; charset=euc-kr&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	  <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>send</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EmailException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>org.apache.commons.mail.SimpleEmail 은 가장 중심이 되는 org.apache.commons.mail.Email을 상속받아 setMsg(java.lang.String msg)만을 구현한 가장 기본적인 클래스이다.</p><ul><li>SMTP서버 지정 : setHostName(java.lang.String aHostName)</li><li>받는 사람의 메일주소 : addTo(java.lang.String email) or addTo(java.lang.String email, java.lang.String name)</li><li>보내는 사람의 메일주소 : setFrom(java.lang.String email) or setFrom(java.lang.String email, java.lang.String name)</li><li>여러 사람에게 메일을 보낼 경우 : addTo 함수의 추가</li></ul><p>setSubject(java.lang.String subject)와 setMsg(java.lang.String msg)로 메일 제목과 내용을 입력한 후 send() 함수로 전송한다.</p><p>email.setCharset(“euc-kr”)을 사용해서 메일의 캐릭터셋이 euc-kr 이라고 지정하고 있는데, 이를 표시하지 않으면 메일 제목이나 보내는 사람 이름등에 있는 한글이 깨지게 되니 주의해야한다.</p><h3 id=2-파일-첨부하기>2. 파일 첨부하기</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovEmailAttachment</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>main</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[])</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>MailException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>// 첨부할 attachment 정보를 생성합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		  <span style=color:#000>EmailAttachment</span> <span style=color:#000>attachment</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>EmailAttachment</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>attachment</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setPath</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;C:\\xxxx.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>attachment</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setDisposition</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EmailAttachment</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ATTACHMENT</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>attachment</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setDescription</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;첨부 관련 TEST입니다&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>attachment</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;xxxx.jpg&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>// 기본 메일 정보를 생성합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		  <span style=color:#000>MultiPartEmail</span> <span style=color:#000>email</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MultiPartEmail</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCharset</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;euc-kr&#34;</span><span style=color:#ce5c00;font-weight:700>);</span><span style=color:#8f5902;font-style:italic>// 한글 인코딩
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHostName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;mail.myserver.com&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addTo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;egov@egov.org&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;전자정부&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> 
</span></span><span style=display:flex><span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFrom</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;egovto@egov.org&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Me&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSubject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;전자 정부 첨부 파일 TEST입니다&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setMsg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;여기는 첨부관련 내용을 입력합니다&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>// 생성한 attachment를 추가합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>attach</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>attachment</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>// 메일을 전송합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>send</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EmailException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>첨부파일을 보낼려면 org.apache.commons.mail.EmailAttachment 클래스와 org.apache.commons.mail.MultiPartEmail 이메일을 사용하면 된다.</p><p>파일 경로와 파일 설명등을 추가하여 setName(java.lang.String name)을 통해 첨부되는 파일명을 설정한다. 그후 MultiPartEmail 을 통해 SimpleEmail 처럼 기본 메일정보를 설정한다.</p><p>그리고 MultiPartEmail의 attach() 함수를 통해 첨부 파일을 추가하여 전송한다.</p><p>만약 첨부파일이 두개 이상이라면 EmailAttachment 를 여러개 생성하여 파일 정보를 설정 한 후 attach()를 통해 추가해 준다.</p><p>EmailAttachment 객체를 생성한 뒤 email.attach()를 사용해서 첨부할 파일을 추가해주기만 하면 된다. 실제 파일명은 한글이 포함되더라도, EmailAttachment.setName() 메소드를 사용해서 파일명을 변경해서 전송할 수도 있다. 주의할 점은 1.0 버전의 Commons Email은 파일명을 한글로 전달할 경우, 파일명이 올바르게 전달되지 않고 깨져서 간단하는 점이다. (파일 자체는 올바르게 전송된다.) 따라서 1.0 버전의 Common Email을 사용하여 파일을 전송할 때에는 알파벳과 숫자로만 구성된 이름의 파일을 전송한다.</p><h3 id=3-url을-통해-첨부하기>3. URL을 통해 첨부하기</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovEmailAttachmentUrl</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>main</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[])</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>MailException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>MalformedURLException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>// 첨부할 URL정보 및 파일 기본 정보를 설정합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		  <span style=color:#000>EmailAttachment</span> <span style=color:#000>attachment</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>EmailAttachment</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>attachment</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setURL</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>URL</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;http://www.apache.org/images/asf_logo_wide.gif&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>attachment</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setDisposition</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EmailAttachment</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ATTACHMENT</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>attachment</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setDescription</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Apache logo&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>attachment</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Apache logo&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>// 기본 메일 정보를 생성합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		  <span style=color:#000>MultiPartEmail</span> <span style=color:#000>email</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MultiPartEmail</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHostName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;mail.myserver.com&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addTo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;jdoe@somewhere.org&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;John Doe&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFrom</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;me@apache.org&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Me&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSubject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;The logo&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setMsg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Here is Apache&#39;s logo&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>// attachment를 추가합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>attach</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>attachment</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>// 메일을 전송합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		  <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>send</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EmailException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>파일 경로 정보를 setURL(java.net.<acronym title="Uniform Resource Locator">URL</acronym>) 으로 설정할 뿐 위의 첨부파일과 동일하다.</p><h3 id=4-html-이메일-보내기>4. HTML 이메일 보내기</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovHtmlEmailSend</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>main</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>args</span><span style=color:#ce5c00;font-weight:700>[])</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>MailException</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>MalformedURLException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// 기본 메일 정보를 생성합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>HtmlEmail</span> <span style=color:#000>email</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HtmlEmail</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHostName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;mail.myserver.com&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addTo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;xxxx@somewhere.org&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;xxxx&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFrom</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;me@apache.org&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Me&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSubject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Test email with inline image&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// 삽입할 이미지와 그 Content Id를 설정합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>URL</span> <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>URL</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;http://www.apache.org/images/asf_logo_wide.gif&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>cid</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>embed</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Apache logo&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// HTML 메세지를 설정합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHtmlMsg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;&lt;html&gt;The apache logo - &lt;img src=\&#34;cid:&#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>cid</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#4e9a06>&#34;\&#34;&gt;&lt;/html&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// HTML 이메일을 지원하지 않는 클라이언트라면 다음 메세지를 뿌려웁니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setTextMsg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Your email client does not support HTML messages&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// 메일을 전송합니다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>send</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EmailException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        	<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>email.setHtmlMsg()를 사용하여 메일 내용을 입력할 때 캐릭터셋을 별도로 지정하지 않아도 한글이 깨지지 않는다.</p><h3 id=5인증처리>5.인증처리</h3><p>만약 <acronym title="Simple Mail Transfer Protocol">SMTP</acronym> 서버가 인증을 요구한다면 org.apache.commons.mail.Email 의 setAuthentication(java.lang.String username, java.lang.String password)를 통해 해결할 수 있다</p><p>이 함수는 JavaMail API의 DefaultAuthenticator 클래스를 생성하여 사용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>SimpleEmail</span> <span style=color:#000>email</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>SimpleEmail</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCharset</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;euc-kr&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHostName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;mail.somehost.com&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setAuthentication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;madvirus&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;password&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><h3 id=예제-sample-실행>예제 Sample 실행</h3><ol><li>utilappSample.zip(<a href="https://www.egovframe.go.kr/wiki/lib/exe/fetch.php?media=egovframework:rte2:fdl:egovframework.rex.utilappsample.zip">egovframework.rex.utilappsample.zip</a>) 파일을 다운로드 받는다.</li><li>이클립스에서 다운로드 받은 폴더를 선택하여 프로젝트를 Import 한다.</li><li>lib에 라이브러리 파일이 있는지 확인한다.
src 폴더 아래에 Index.jsp를 선택하여 마우스 오른쪽 클릭하여 Run As > Run On Server를 실행한다.</li><li>Console 창에서 정상적으로 Tomcat이 실행된 것을 확인한다.</li></ol><h5 id=샘플-utilappsample의-indexjsp-실행하였을-경우-브라우져에서-실행되는-화면>샘플 utilappSample의 Index.jsp 실행하였을 경우 브라우져에서 실행되는 화면</h5><p><img src=../images/mail-service-browser-screenshot.png alt=mail-sample-browser-sceenshot></p><h2 id=참고-자료>참고 자료</h2><p><a href=https://commons.apache.org/proper/commons-email/userguide.html>Apache Commons-Email UserGuide</a></p><h2 id=예제>예제</h2><p><a href=../../runtime-example/individual-example/foundation-layer/mail-example.md>mail-example</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-ec0d8ed21d02034b674e59129d4279ec>30 - Compress/Decompress Service</h1><div class=lead>전자정부 표준프레임워크는 Jakarta Commons Compress를 통해 다양한 압축 방식(tar, zip, bzip2 등)을 지원하는 편리한 API를 제공한다.</div><h1 id=compressdecompress-service>Compress/Decompress Service</h1><h2 id=개요>개요</h2><p><strong>전자정부 프레임워크</strong>에서는 다양한 압축방식을 개발자들에게 편리한 API를 제공하는 Jakarta Commons의 Compress를 오픈소스로 채택하였다.</p><p>Jakarta Commons의 Compress에서 지원하는 tar, zip and bzip2 파일등을 지원한다.</p><p>현재 Commons Compress API 에서는 아래의 Packages를 제공하고 있다.</p><ul><li>org.apache.commons.compress.archivers</li><li>org.apache.commons.compress.archivers.ar</li><li>org.apache.commons.compress.archivers.cpio</li><li>org.apache.commons.compress.archivers.jar</li><li>org.apache.commons.compress.archivers.tar</li><li>org.apache.commons.compress.archivers.zip</li><li>org.apache.commons.compress.changes</li><li>org.apache.commons.compress.compressors</li><li>org.apache.commons.compress.compressors.bzip2</li><li>org.apache.commons.compress.compressors.gzip</li><li>org.apache.commons.compress.utils</li></ul><p>보다 자세한 사항은 <a href=http://commons.apache.org/compress/apidocs/index.html>Commons Compress API</a>를 참고하기 바란다.</p><h2 id=설명>설명</h2><p><strong>압축</strong>이란 파일에 저장되어 있는 정보를 압축하여 보다 적은 기억 공간에 동일한 정보를 저장하는 기술이다.</p><pre tabindex=0><code>일반적으로 정보에 포함되어 있는 중복된 내용을 삭제하거나 보다 적은 길이의 코드를 사용하여 정보를 표현하는 방법을 사용하여 저장에 필요한 공간의 크기를 줄인다. 
이런 과정을 압축이라고 하며, 압축된 정보를 사용하기 위해서 다시 원래의 상태로 복원하는 과정을 압축해제라고 한다.
압축 방법에는 손실이 없는 압축 방법과 손실이 있는 압축 방법이 있다.
먼저 프로그램과 데이터 등과 같은 정보는 반드시 손실이 없는 압축 방법을 사용하여야 한다.
손실이 없는 압축 방법이라고 하는 것은 압축된 정보를 다시 복원한 경우에 압축되기 이전의 상태와 동일한 내용과 크기를 가지게 되는 압축 방법을 말한다.
하지만 이미지나 음성 등과 같은 경우에는 손실이 있는 압축 방법을 사용할 수 있다.
이미지나 음성에는 방대한 양의 정보가 존재하고 이들 정보 중에 일부가 사라진다 하더라도 사람이 눈이나 귀로 그 차이를 구별할 수 없기 때문이다.
손실이 있는 압축 방법이라고 하는 것은 압축된 정보를 다시 복원하더라도 압축되기 이전의 상태 혹은 크기와 동일하지 않은 내용을 가질 수 있는 압축 방법을 뜻한다.
</code></pre><p>간단히 여기서는 자주 사용하는 압축파일의 종류는 아래의 참조 링크를 참고한다.</p><ul><li><a href=./compression-file-types.md>압축파일의 종류</a></li></ul><h2 id=사용-예제>사용 예제</h2><p>다음은 테스트코드 EgovZipTestCase의 testZipArchiveCreation() 메소드로 org.apache.commons.compress.archivers 패키지에 속한 ArchiveInputStream 클래스를 사용하여 compress/decompress로 구성되어 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovZipTestCase</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>EgovAbstractTestCase</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>/*
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * Zip을 사용한 압축(Archive) TEST
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * 두개의 파일(test1.xml, test2.xml)을 사용하여  압축하여 bla.zip으로 압축함
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testZipArchiveCreation</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Archive
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>File</span> <span style=color:#000>output</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>dir</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;bla.zip&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>File</span> <span style=color:#000>file1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;test1.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>File</span> <span style=color:#000>file2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;test2.xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>OutputStream</span> <span style=color:#000>out</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>output</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>ArchiveOutputStream</span> <span style=color:#000>os</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArchiveStreamFactory</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>createArchiveOutputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;zip&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>            <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>putArchiveEntry</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ZipArchiveEntry</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testdata/test1.xml&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>            <span style=color:#000>IOUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>copy</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file1</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>closeArchiveEntry</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>            <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>putArchiveEntry</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ZipArchiveEntry</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testdata/test2.xml&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>            <span style=color:#000>IOUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>copy</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file2</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>closeArchiveEntry</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>            <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Unarchive the same
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>List</span> <span style=color:#000>results</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>InputStream</span> <span style=color:#000>is</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>output</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>ArchiveInputStream</span> <span style=color:#000>in</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArchiveStreamFactory</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>createArchiveInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;zip&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>is</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>            <span style=color:#000>File</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createTempFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;dir-result&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#000>result</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>delete</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>            <span style=color:#000>result</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>mkdir</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>            <span style=color:#000>ZipArchiveEntry</span> <span style=color:#000>entry</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>while</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>entry</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ZipArchiveEntry</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>in</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextEntry</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#000>File</span> <span style=color:#000>outfile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>result</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCanonicalPath</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;/result/&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>entry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>                <span style=color:#000>outfile</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParentFile</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>mkdirs</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>                <span style=color:#000>OutputStream</span> <span style=color:#000>out</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>outfile</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>                <span style=color:#000>IOUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>copy</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>in</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>                <span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>                <span style=color:#000>results</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>outfile</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>            <span style=color:#000>in</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>results</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>File</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>results</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>result</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>        <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>results</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>result</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>다음은 위에서 압축한 파일을 압축해제(Unarchive)하는 테스트 코드이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testZipUnarchive</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>File</span> <span style=color:#000>input</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;bla.zip&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>InputStream</span> <span style=color:#000>is</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>input</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>ArchiveInputStream</span> <span style=color:#000>in</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArchiveStreamFactory</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>createArchiveInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;zip&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>is</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>ZipArchiveEntry</span> <span style=color:#000>entry</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ZipArchiveEntry</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>in</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNextEntry</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>OutputStream</span> <span style=color:#000>out</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>dir</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>entry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getName</span><span style=color:#ce5c00;font-weight:700>()));</span>
</span></span><span style=display:flex><span>    <span style=color:#000>IOUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>copy</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>in</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#000>in</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li><a href=http://commons.apache.org/compress/index.html>Apache Commons Compress</a></li><li><a href=http://commons.apache.org/compress/apidocs/index.html>Commons Compress API</a></li></ul><h2 id=예제>예제</h2><ul><li><a href=../../runtime-example/individual-example/foundation-layer/compress-decompress-example.md>Compress/Decompress 예제</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-94023eb3edf6dc77385ba876d0a09a45>31 - 압축 파일의 종류</h1><div class=lead>다양한 압축 파일 형식과 그 사용 방식에 대해 설명하며, 각 형식의 특징과 관련 프로그램을 안내한다.</div><h1 id=압축-파일의-종류>압축 파일의 종류</h1><table><thead><tr><th>압축 파일</th><th>설명</th></tr></thead><tbody><tr><td>.alz</td><td>이스트소프트에서 개발한 압축 형식입니다. 분할 압축을 할 경우 확장자는 (ALZip 으로 생성) alz, a00, a01…형식으로 생성됨.</td></tr><tr><td>.ace</td><td>ACE, WinAce에서 이용하는 압축 형식입니다. 분할 압축을 할 경우 확장자는 ace, c00, c01, … 형식으로 생성됨.</td></tr><tr><td>.arc</td><td>DOS용 프로그램 pkarc.com, pkxarc.com에서 사용되는 압축 형식.</td></tr><tr><td>.arj</td><td>DOS용 프로그램 arj.exe, 윈도우용 프로그램 WinArj에서 이용하는 압축 형식. 분할 압축을 할 경우 확장자는 arj, a01, a02,… 형식으로 생기게 됨.</td></tr><tr><td>.b64</td><td>인터넷에서 문서를 주고 받을 때 사용하는 형식으로 BASE64MIME 형식으로 인코딩된 파일임.</td></tr><tr><td>.bh</td><td>BinHex Format. E-Mail로 이진(binary) 형태의 파일을 보내기 위해 사용하는 형식임.</td></tr><tr><td>.bhx</td><td>인터넷에서 문서를 주고 받을 때 사용하는 형식으로 BASE64MIME 형식으로 인코딩된 파일임.</td></tr><tr><td>.bin</td><td>Macintosh용이며, MacBinary Format. Aladdin StuffIt Expander에서 지원함.</td></tr><tr><td>.bz2</td><td>UNIX용의 bzip2에서 사용하는 압축 형식입니다. 파일 하나만 압축할 수 있으므로 주로 .tar와 함께 사용되며 이 경우 .tar.bz2의 확장자를 갖음. (bzip2로 생성)</td></tr><tr><td>.cab</td><td>Microsoft Cabinet 파일. 마이크로소프트에서 사용하는 압축 형식임.</td></tr><tr><td>.ear</td><td>내부적으로 zip 압축 알고리즘을 사용하는 파일 형식임.</td></tr><tr><td>.enc</td><td>E-Mail로 이진(binary) 형태의 파일을 보내기 위해 사용하는 형식임.</td></tr><tr><td>.gz</td><td>UNIX용의 gzip에서 사용하는 압축 형식. 파일 하나만 압축할 수 있으므로 주로 .tar와 함께 사용되며 이 경우 .tar.gz의 확장자를 갖고 줄여서 .tgz 확장자를 사용하기도 함.</td></tr><tr><td>.ha</td><td>PPMC를 개선한 압축 파일 형식.</td></tr><tr><td>.hqx</td><td>맥에서 제작된 파일을 인터넷에서 문서를 주고 받을 때 사용하는 형식임. (BinHex로 생성)</td></tr><tr><td>.ice</td><td>DOS용 프로그램 ice.exe에서 사용하는 압축 형식임. 실제 파일 내용은 lha와 동일함.</td></tr><tr><td>.img</td><td>Disk image를 저장해둔 파일로, Falk Huth에 의해 만들어진 img.exe라는 프로그램을 이용하여 파일들을 추출해 낼 수 있음.</td></tr><tr><td>.jar</td><td>자바의 jar.exe에서 사용하는 압축 형식. 내부적으로 zip 압축 알고리즘을 사용함.</td></tr><tr><td>.lha, .lzh</td><td>DOS용 프로그램 lha.exe, lharc.exe에서 사용하던 압축 형식. Lempel-Ziv 알고리즘을 사용함.</td></tr><tr><td>.mim</td><td>인터넷에서 문서를 주고 받을 때 사용하는 형식.</td></tr><tr><td>.pak</td><td>DOS용 프로그램 pak.exe에서 사용하던 압축 형식.</td></tr><tr><td>.rar</td><td>DOS용 프로그램 rar.exe와 윈도우용 프로그램 winrar.exe에서 사용하는 압축 형식. 분할 압축을 할 경우 확장자는 rar, r00, r01,… 형식으로 생기게 됨.</td></tr><tr><td>.sit</td><td>Macintosh에서 이용되는 압축 Format. WinArj, Aladdin StuffIt Expander, WinPack 등의 윈도우용 압축 프로그램에서 이를 지원함.</td></tr><tr><td>.tar</td><td>UNIX 명령 tar를 이용해 생성되는 파일 형식으로 실제로는 압축은 되지 않고 여러 파일을 하나로 묶어주기만 함. 보통 tar로 묶은 후 gz으로 압축하며 이 경우 .tar.gz의 확장자를 갖고 줄여서 .tgz 확장자를 사용하기도 함.</td></tr><tr><td>.tgz</td><td>UNIX에서 tar로 묶은 파일을 gzip으로 압축한 파일 형식.</td></tr><tr><td>.uue</td><td>UU Encoded Format. E-Mail로 이진(binary) 형태의 파일을 보내기 위해 사용하는 형식.</td></tr><tr><td>.war</td><td>내부적으로 zip 압축 알고리즘을 사용하는 파일 형식.</td></tr><tr><td>.xxe</td><td>XXEncode Format. E-Mail로 이진(binary) 형태의 파일을 보내기 위해 사용하는 형식.</td></tr><tr><td>.z</td><td>UNIX용의 compress, uncompress에서 사용하는 파일 형식.</td></tr><tr><td>.zip</td><td>도스용 프로그램 pkzip.exe, pkunzip.exe에서 사용하는 파일 형식.</td></tr><tr><td>.zoo</td><td>DOS용 프로그램 zoo.exe에서 사용되는 파일 형식.</td></tr><tr><td>.001</td><td>rzjoin으로 분할된 파일 형식. 압축이 아닌 단순히 001, 002…… 순서로만 분할된 파일.</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-c2b94522480c18c5837e202209c61411>32 - File Upload/Download 서비스</h1><div class=lead>Commons FileUpload를 사용해 파일 업로드 API를 제공하며, 멀티 파일 업로드 문제와 해결 방법을 설명한다.</div><h1 id=file-uploaddownload-서비스>File Upload/Download 서비스</h1><h2 id=개요>개요</h2><p><strong>전자정부 프레임워크</strong>에서는 다양한 파일 업로드 API를 제공하는 Commons FileUpload를 오픈 소스로 채택하였다.</p><p>Spring 에서는 <a href=http://commons.apache.org/fileupload/>Commons FileUpload</a>를 사용하여 싱글 파일 업로드에 대하여 가이드 하고 있다.
현재 Spring에서 싱글 파일 업로드에 대해서 매우 좋은 api를 제공해주고 있으나 <strong>멀티플 파일 업로드</strong>시에 동일한 이름의 여러 개의 파일을 올리려고 할 때 오류가 발생한다.</p><p>오류 사항에 대해서는 <a href=file-upload-service-multi-file-support.md>multipart multi file upload</a> 지원 문제를 참고.</p><p>본 매뉴얼에서는 싱글 파일 업로드 보다 <strong>멀티플 파일 업로드</strong>를 가능하도록 그 대안에 대하여 설명하고자 한다.</p><h2 id=설명>설명</h2><h4 id=데이터-전송방식>데이터 전송방식</h4><p>데이터를 전송하는 방식에는 GET 방식과 POST 방식, 그리고 ENCTYPE 속성의 &ldquo;multipart/form-data"이 있다.</p><ul><li>GET<ul><li>URL에 폼데이터가 노출되기 때문에 입력 내용의 길이 제한이 있고 256byte~4096byte 까지의 데이터를 전송할 수 있다.</li></ul></li><li>POST<ul><li>URL에 노출되지 않고 데이터를 전송하기 때문에 입력 내용의 길이에 제한을 받지 않는다.</li></ul></li></ul><p>이렇게 데이터를 전송하는데 아무 문제 없을 것 처럼 보이지만, 이 둘은 보낼 수 있는 데이터 양에 한계가 있다.</p><p>파일이나 용량이 큰 데이터를 전송할 때 문제가 생기는 것이다.</p><p>그 때 쓰는 폼 데이터 전송방식이 바로 <strong>ENCTYPE</strong> 속성의 <strong>multipart/form-data</strong> 이다.</p><p><strong>전자정부 프레임워크</strong>에서는 스프링에서 제공하는 Apache Commons FileUpload API를 이용하여 파일 업로드를 처리하는 <a href=http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/multipart/commons/CommonsMultipartResolver.html>CommonsMultipartResolver</a> 클래스를 제공하고 다음과 같이 설정파일에 CommonsMultipartResolver를 빈으로 등록하여 준다.</p><p>Apache Commens FileUpload 에서 싱글 파일 업로드에 대해서 매우 좋은 api를 제공해주고 있다. 하지만 멀티플 파일 업로드시 동일한 이름의 여러 개의 파일을 올리려고 할 때 오류가 발생한다.</p><p>여러 개의 파일을 올리려고 할 때 오류가 발생하는 문제에 대해서는 <a href=file-upload-service-multi-file-support.md>multipart multi file upload 지원 문제</a>를 참고.</p><p>Spring에서 multipart를 사용한 파일 업로드에 대해서는 <a href=http://static.springframework.org/spring/docs/2.5.x/reference/mvc.html#mvc-multipart>Spring&rsquo;s multipart (fileupload) support</a> 에서 자세하게 가이드 하였으므로 본 메뉴얼에서는 다루지 않는다.</p><p>기능 실행에 대한 이해를 돕기 위해 컨텐츠와 함께 컨텐츠에서 제시한 샘플 코드를 포함하고 있는 이클립스 프로젝트 형태의 웹 애플리케이션 샘플 프로젝트를 다운로드할 수 있다.</p><h3 id=file-upload--download>File Upload / Download</h3><p>File Upload / Download 에 대한 설명은 아래 상세 페이지를 참고하라.</p><ul><li><a href=./file-upload-service.md>File Upload</a></li><li><a href=./file-upload-service-multi-file-support.md>multipart multi file upload 지원 문제</a></li><li><a href=./file-download-service.md>File Download</a></li><li><a href=./file-download-service-tomcat-encoding.md>Tomcat에서 한글이 깨지는 문제 해결</a></li></ul><h3 id=예제-sample-실행>예제 Sample 실행</h3><ol><li>utilappSample.zip(<a href="https://www.egovframe.go.kr/wiki/lib/exe/fetch.php?media=egovframework:rte2:fdl:utilappsample.zip">utilappsample.zip</a>) 파일을 다운로드 받는다.</li><li>이클립스에서 다운로드 받은 폴더를 선택하여 프로젝트를 Import 한다.</li><li>lib에 라이브러리 파일이 있는지 확인한다.</li><li>src 폴더 아래에 Index.jsp를 선택하여 마우스 오른쪽 클릭하여 Run As > Run On Server를 실행한다.</li><li>Console 창에서 정상적으로 Tomcat이 실행된 것을 확인한다.</li><li>본 샘플에서는 CommonsMultipartResolver를 보완한 MultiCommonsMultipartResolver를 사용하고 있으나 <strong>CommonsMultipartResolver</strong> 사용을 권장함.</li></ol><p>multiple files with a single file(한단 샘플)에서 사용한 JavaScript를 사용하여 추가 시 다른 form name을 추가하여 처리하는 방식을 가이드 하였으니 참고하기 바란다.</p><p><strong>샘플 utilappSample의 Index.jsp 실행하였을 경우 브라우저에서 실행되는 화면</strong></p><p><img src=../images/file-updown-service-sample-screenshot.png alt=file-updown-service-sample-screenshot></p><h2 id=참고자료>참고자료</h2><ul><li><a href=http://static.springframework.org/spring/docs/2.5.x/reference/mvc.html#mvc-multipart>Spring&rsquo;s multipart (fileupload) support {mvc-multipart}</a></li><li><a href=http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/multipart/commons/CommonsMultipartResolver.html>Spring&rsquo;s multipart (fileupload) support {CommonsMultipartResolver.html}</a></li><li><a href=http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/multipart/MultipartResolver.html>Spring&rsquo;s multipart (fileupload) support {RequestFacade}</a></li><li><a href=http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/multipart/MultipartHttpServletRequest.html>Spring&rsquo;s multipart (fileupload) support {MultipartHttpServletRequest}</a></li><li><a href=http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/multipart/commons/CommonsFileUploadSupport.html>Spring&rsquo;s multipart (fileupload) support {CommonsFileUploadSupport}</a></li><li><a href=http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/servlet/mvc/SimpleFormController.html>Spring&rsquo;s multipart (fileupload) support {CommonsFileUploadSupport}</a></li><li><a href=http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/multipart/commons/CommonsFileUploadSupport.html#parseFileItems(java.util.List,%20java.lang.String)>Spring&rsquo;s multipart (fileupload) support {parseFileItems}</a></li><li><a href=http://commons.apache.org/fileupload/>commons.apache.org {fileupload}</a></li><li><a href=http://commons.apache.org/fileupload/faq.html#empty-parse>commons.apache.org{empty-parse}</a></li></ul><h2 id=예제>예제</h2><ul><li><a href=../../runtime-example/individual-example/foundation-layer/file-upload-example.md>파일업로드 예제</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-f71855a42083daa14eb35bd2ff9a44a9>33 - File Upload Service</h1><div class=lead>파일 업로드를 위한 Spring의 CommonsMultipartResolver 설정 및 구현 방법을 설명하며, JSP 폼과 컨트롤러를 통해 파일을 업로드하는 예제를 제공한다. 파일 저장 경로는 properties 파일에서 설정하며, 다중 파일 업로드 시 폼 이름을 다르게 설정해야 한다.</div><h1 id=file-upload-service>File Upload Service</h1><h2 id=개요>개요</h2><p>업로드는 한 컴퓨터 시스템에서 다른 시스템으로 파일을 전송하는 것을 말하는데, 대개 작은 컴퓨터에서 큰 컴퓨터로 옮길 때 이런 용어를 사용한다. 네트웍 사용자의 관점에서 보면, 파일을 업로드하는 것은 그 파일을 받을 수 있도록 설정된 다른 컴퓨터에 파일을 보내는 것이다. 전자게시판 상의 다른 사용자와 이미지 파일을 공유하기를 원하는 사람들은 그 전자게시판에 파일을 업로드하면 된다.</p><p>그러면 반대편 입장에 있는 사람은 그 파일을 다운로드하게 되는데, 여기서 다운로드는 대개 큰 컴퓨터에서 작은 컴퓨터로 파일을 전송하는 것을 의미한다. 인터넷 사용자의 입장에서의 다운로드란 다른 컴퓨터에서 파일을 받는 것이다.</p><h2 id=설명>설명</h2><p>파일 업로드 기능을 구현하기 위해서는 먼저 빈 설정 파일에 다음과 같이 <strong>MultiCommonsMultipartResolver</strong>를 정의해야한다. 본 가이드에서는 Apache Commons FileUpload에서 재공하는 CommonsMultipartResolver를 사용하기를 권장한다. CommonsMultipartResolver를 수정하여 사용할 경우 많은 부분에 시간과 노력이 들어갈 것이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Custom MultiFile resolver --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;local.MultiCommonsMultipartResolver&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.util.web.resolver.MultiCommonsMultipartResolver&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;maxUploadSize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;100000000&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;maxInMemorySize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;100000000&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>[권장]만약 스프링에서 제공하는 Apache Commons FileUpload API를 이용하여 파일 업로드를 처리하는 CommonsMultipartResolver를 사용하려고 하면 빈 설정파일에 다음과 같이 정의한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- MULTIPART RESOLVERS --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- regular spring resolver --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;spring.RegularCommonsMultipartResolver&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.multipart.commons.CommonsMultipartResolver&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;maxUploadSize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;100000000&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;maxInMemorySize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;100000000&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>또한 해당 컨트롤러의 property로 파일의 업로드 위치를 지정해주고 컨트롤러에서 setter 메소드를 통해 지정된 파일 업로드 위치를 불러올 수 있다. 사용예는 다음과 같다.</p><h4 id=fileuploadpropertiesproperties>fileUploadProperties.properties</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#8f5902;font-style:italic># windows NT일 경우  </span>
</span></span><span style=display:flex><span><span style=color:#c4a000>file.upload.path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>C:\\temp</span>
</span></span><span style=display:flex><span><span style=color:#a40000> </span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Unix일 경우</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>file.upload.path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>/usr/file/upload</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;fileUploadProperties&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>Properties</span> <span style=color:#000>fileUploadProperties</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>..</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>..</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>..</span>
</span></span><span style=display:flex><span>	<span style=color:#000>String</span> <span style=color:#000>uploadPath</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>fileUploadProperties</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getProperty</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;file.upload.path&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>File</span> <span style=color:#000>saveFolder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uploadPath</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>..</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>..</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>..</span>
</span></span></code></pre></div><p>파일 업로드를 위해 <strong>JSP</strong>파일의 입력 폼 타입을 file로 지정하고 form의 enctype을 multipart/form-data로 지정한다. 예시는 다음과 같다. 이때 <strong>CommonsMultipartResolver</strong>를 사용할 경우 form의 name을 다르게 설정하여야 한다. 중복된 이름을 사용할 경우 에러가 발생한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form</span> <span style=color:#c4a000>method</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;post&#34;</span> <span style=color:#c4a000>action</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;&lt;c:url value=&#39;/upload/genericMulti.do&#39;/&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>enctype</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;multipart/form-data&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Type:
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;type&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;genericFileMulti&#34;</span> <span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;60&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>File1:
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;file&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;file[]&#34;</span> <span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;60&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>File2:
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;file&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;file[]&#34;</span> <span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;60&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Upload&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>form</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>다음은 파일 업로드를 위해 Controller를 구현한 모습이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;genericFileUploadController&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>GenericFileUploadController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;multipartResolver&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>CommonsMultipartResolver</span> <span style=color:#000>multipartResolver</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;fileUploadProperties&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>Properties</span> <span style=color:#000>fileUploadProperties</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@SuppressWarnings</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;unchecked&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/upload/genericMulti.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>multipartProcess</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Model</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>final</span> <span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>startTime</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>nanoTime</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/*
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * validate request type
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> */</span>
</span></span><span style=display:flex><span><span style=color:#000>Assert</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>state</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span> <span style=color:#204a87;font-weight:700>instanceof</span> <span style=color:#000>MultipartHttpServletRequest</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>		<span style=color:#4e9a06>&#34;request !instanceof MultipartHttpServletRequest&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>MultipartHttpServletRequest</span> <span style=color:#000>multiRequest</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MultipartHttpServletRequest</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/*
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * validate text input
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> */</span>
</span></span><span style=display:flex><span><span style=color:#000>Assert</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>state</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;type&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>equals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;genericFileMulti&#34;</span><span style=color:#ce5c00;font-weight:700>),</span>
</span></span><span style=display:flex><span>		<span style=color:#4e9a06>&#34;type != genericFileMulti&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/*
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * extract files
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> */</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>MultipartFile</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>files</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>multiRequest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFileMap</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>Assert</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>notNull</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>files</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;files is null&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>Assert</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>state</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>files</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;0 files exist&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/*
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * process files
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> */</span>
</span></span><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>uploadPath</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>fileUploadProperties</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getProperty</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;file.upload.path&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>File</span> <span style=color:#000>saveFolder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uploadPath</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 디렉토리 생성
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>saveFolder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exists</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>saveFolder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isFile</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>saveFolder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>mkdirs</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>Iterator</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Entry</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>MultipartFile</span><span style=color:#ce5c00;font-weight:700>&gt;&gt;</span> <span style=color:#000>itr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>files</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>entrySet</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>iterator</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>MultipartFile</span> <span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>List</span> <span style=color:#000>fileInfoList</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>filePath</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>while</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>itr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasNext</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Entry</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>MultipartFile</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>entry</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>itr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>next</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;[&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>entry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getKey</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;]&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>entry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getValue</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>equals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getOriginalFilename</span><span style=color:#ce5c00;font-weight:700>()))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>filePath</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>uploadPath</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;\\&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getOriginalFilename</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>transferTo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filePath</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>FileInfoVO</span> <span style=color:#000>fileInfoVO</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInfoVO</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>fileInfoVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFilePath</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filePath</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>fileInfoVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFileName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getOriginalFilename</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#000>fileInfoVO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFileSize</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getSize</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#000>fileInfoList</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>fileInfoVO</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 여기서는 DB에 파일관련 정보를 저장하지 않고 단순히 success 페이지로 포워딩 하여 재확인 가능토록 함
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;fileInfoList&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>fileInfoList</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;uploadPath&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>uploadPath</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>final</span> <span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>estimatedTime</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>nanoTime</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>startTime</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>estimatedTime</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34; &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>getClass</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getSimpleName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;success&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>Tomcat에서는 일반적으로 웹 어플리케이션이 GET과 POST 방식으로 파라미터를 넘겨 받을 때 request.setCharacterEncoding()을 통한 문자셋 인코딩이 필요하다.</p><h2 id=예제>예제</h2><ul><li><a href=../../runtime-example/individual-example/foundation-layer/file-upload-example.md>파일업로드 예제</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-8998679c03b5ede655abd4d93e0cd464>34 - Spring mvc Multipart Multi file upload 지원 문제</h1><div class=lead>Spring MVC 2.5.5에서 동일한 이름의 여러 파일을 업로드할 때 발생하는 MultipartResolver 오류 문제를 설명한다.</div><h1 id=spring-mvc-multipart-multi-file-upload-지원-문제>Spring mvc Multipart Multi file upload 지원 문제</h1><h2 id=개요>개요</h2><p>Spring mvc 2.5.5 Multipart Multi file upload 지원부분에서 동일한 이름의 여러개의 파일을 올리려고 할 때 에러가 발생한다. 본 가이드에서는 이러한 문제가 발생하여 아직 Spring쪽에서 답변이 없는 상황이다. 이부분에 대하여 개발시 참고 하기바란다.</p><h2 id=설명>설명</h2><p>업로드 갯수를 고려하지 않고 동적으로 upload 폼을 추가할 경우 오류 메시지가 나온다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>web</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multipart</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>MultipartException</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>Multiple</span> <span style=color:#000>files</span> <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>field</span> <span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>files</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000>found</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>not</span> <span style=color:#000>supported</span> <span style=color:#000>by</span> <span style=color:#000>MultipartResolver</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>web</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multipart</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>commons</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CommonsFileUploadSupport</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>parseFileItems</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CommonsFileUploadSupport</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>java</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>254</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>web</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multipart</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>commons</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CommonsMultipartResolver</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>parseRequest</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CommonsMultipartResolver</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>java</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>166</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>web</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multipart</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>commons</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CommonsMultipartResolver</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>resolveMultipart</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CommonsMultipartResolver</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>java</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>149</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>web</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>servlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>DispatcherServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>checkMultipart</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DispatcherServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>java</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>1015</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>web</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>servlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>DispatcherServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>doDispatch</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DispatcherServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>java</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>851</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>web</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>servlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>DispatcherServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>doService</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DispatcherServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>java</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>807</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>web</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>servlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>FrameworkServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>processRequest</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FrameworkServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>java</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>571</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>web</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>servlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>FrameworkServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>doPost</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FrameworkServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>java</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>511</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>javax</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>servlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>http</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>HttpServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>service</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>java</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>637</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>javax</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>servlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>http</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>HttpServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>service</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>java</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>717</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><p>이러한 문제에 대해서 아래의 참고 자료를 참고하기 바란다.</p><h2 id=참고자료>참고자료</h2><ul><li>(deplicated) Implementing single and multiple file multipart uploads using Spring 2.5</li><li>(deplicated) 동일한 form name upload 문제</li><li>(deplicated) spring mvc 2.5.5 multipart multi file upload 지원</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-3df8eb811559145f371e10cdef440c86>35 - File Download Service</h1><div class=lead>파일 다운로드 기능을 구현한 DownloadController 예제와 JSP 페이지 설정을 설명한다.</div><h1 id=file-download-service>File Download Service</h1><h2 id=개요>개요</h2><p>여기서 다운로드는 대개 큰 컴퓨터에서 작은 컴퓨터로 파일을 전송하는 것을 의미한다. 인터넷 사용자의 입장에서의 다운로드란 다른 컴퓨터에서 파일을 받는 것이다.</p><h2 id=설명>설명</h2><p>EgovFrameWork에서는 파일 다운로드를 하기위한 DownloadController 클래스를 간단하게 구현하여 보았다.</p><p><strong>DownloadController</strong> 클래스 예시</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;downloadController&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DownloadController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Resource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;fileUploadProperties&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Properties</span> <span style=color:#000>fileUploadProperties</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/download/downloadFile.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>downloadFile</span><span style=color:#ce5c00;font-weight:700>(</span>
</span></span><span style=display:flex><span>			<span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;requestedFile&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>requestedFile</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>uploadPath</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>fileUploadProperties</span>
</span></span><span style=display:flex><span>				<span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getProperty</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;file.upload.path&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>File</span> <span style=color:#000>uFile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uploadPath</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>requestedFile</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>fSize</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>uFile</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>fSize</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#000>BufferedInputStream</span> <span style=color:#000>in</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>BufferedInputStream</span><span style=color:#ce5c00;font-weight:700>(</span>
</span></span><span style=display:flex><span>					<span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileInputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uFile</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>// String mimetype = servletContext.getMimeType(requestedFile);
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>String</span> <span style=color:#000>mimetype</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;text/html&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setBufferSize</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>fSize</span><span style=color:#ce5c00;font-weight:700>);</span><span style=color:#000>d</span>
</span></span><span style=display:flex><span>			<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setContentType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>mimetype</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHeader</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Content-Disposition&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;attachment; filename=\&#34;&#34;</span>
</span></span><span style=display:flex><span>					<span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>requestedFile</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;\&#34;&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setContentLength</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>fSize</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#000>FileCopyUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>copy</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>in</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getOutputStream</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>			<span style=color:#000>in</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getOutputStream</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>flush</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getOutputStream</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>//setContentType을 프로젝트 환경에 맞추어 변경
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setContentType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;application/x-msdownload&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>PrintWriter</span> <span style=color:#000>printwriter</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getWriter</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#000>printwriter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;&lt;html&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>printwriter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;h2&gt;Could not get file name:&lt;br&gt;&#34;</span>
</span></span><span style=display:flex><span>					<span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>requestedFile</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;&lt;/h2&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>printwriter</span>
</span></span><span style=display:flex><span>					<span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;center&gt;&lt;h3&gt;&lt;a href=&#39;javascript: history.go(-1)&#39;&gt;Back&lt;/a&gt;&lt;/h3&gt;&lt;/center&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>printwriter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;&lt;br&gt;&lt;br&gt;&lt;br&gt;&amp;copy; webAccess&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>printwriter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;&lt;/html&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>printwriter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>flush</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#000>printwriter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>jsp 페이지로 간단하게 구현된 예시</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ page contentType=&#34;text/html; charset=utf-8&#34; pageEncoding=&#34;utf-8&#34;%&gt;
&lt;%@ taglib prefix=&#34;c&#34; uri=&#34;http://java.sun.com/jsp/jstl/core&#34;%&gt;
&lt;!DOCTYPE html PUBLIC &#34;-//W3C//DTD XHTML 1.0 Transitional//EN&#34; &#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;
&lt;html xmlns=&#34;http://www.w3.org/1999/xhtml&#34;&gt;
&lt;head&gt;
&lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=utf-8&#34; /&gt;
&lt;title&gt;Success&lt;/title&gt;
&lt;/head&gt;
 
&lt;body&gt;
 
&lt;h1&gt;Success&lt;/h1&gt;
 
&lt;p&gt;All good&lt;/p&gt;
 
&lt;c:forEach var=&#34;file&#34; items=&#34;${fileInfoList}&#34; varStatus=&#34;status&#34;&gt;
 
순번 : &lt;c:out value=&#34;${status.count}&#34; /&gt;
	&lt;br /&gt;
uploadedFilePath : &lt;c:out value=&#34;${file.filePath}&#34; /&gt;
	&lt;br /&gt;
파일명 : &lt;a
		href=&#34;#&#34; onclick=&#34;window.open(encodeURI(&#39;&lt;c:url value=&#39;/download/downloadFile.do?&#39;/&gt;requestedFile=${file.fileName}&#39;))&#34;&gt;&lt;c:out
		value=&#34;${file.fileName}&#34; /&gt;&lt;/a&gt;
	&lt;br /&gt;
파일사이즈 : &lt;c:out value=&#34;${file.fileSize}&#34; /&gt;
	&lt;br /&gt;
	&lt;p /&gt;
&lt;/c:forEach&gt;
 
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>Tomcat에서는 일반적으로 웹 어플리케이션이 GET과 POST 방식으로 파라미터를 넘겨 받을 때 request.setCharacterEncoding()을 통한 문자셋 인코딩이 필요하다.</p><p>파일을 다운로드시 한글이 깨지는 문제가 발생할 경우 제우스나 WebLogic의 경우는 JSP 페이지에 아래와 같이 넣어주면 한글 깨지는 문제가 해결된다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ page contentType=&#34;text/html; charset=utf-8&#34; pageEncoding=&#34;utf-8&#34;%&gt;
</code></pre><p>Tomcat에서는 한글이 깨지는 문제가 발생하는데 아래의 링크를 참조</p><ul><li><a href=file-download-service-tomcat-encoding.md>Tomcat 한글 설정하기</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-8bb315c720fa1ab79f7343724d863de4>36 - Tomcat 한글 설정하기</h1><div class=lead>Tomcat에서 문자셋 인코딩을 하여 한글이 깨지는 문제를 해결할 수 있다.</div><h1 id=tomcat-한글-설정하기>Tomcat 한글 설정하기</h1><h2 id=개요>개요</h2><p>Tomcat에서 문자셋 인코딩을 하여 한글이 깨지는 문제를 해결할 수 있다.</p><h2 id=설명>설명</h2><p>일반적으로 웹 어플리케이션이 GET과 POST 방식으로 파라미터를 넘겨 받을 때 request.setCharacterEncoding()을 통한 문자셋 인코딩이 필요하다.</p><h4 id=tomcat-4x>Tomcat 4.x</h4><pre tabindex=0><code>단순히 JSP 혹은 서블릿의 최 상단에 request.setCharacterEncoding(&#34;euc-kr&#34;);을 하면 된다. 

GET과 POST 방식에 상관없이 인코딩을 해준다. 
</code></pre><h4 id=tomcat-5x>Tomcat 5.x</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>POST 방식은 request.setCharacterEncoding(&#34;euc-kr&#34;);로 계속 하면된다. 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>하지만 GET 방식은 server.xml의 <span style=color:#204a87;font-weight:700>&lt;Connector&gt;</span> 설정 부분을 바꿔줘야만 한다. 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;Connector</span> <span style=color:#c4a000>port=</span><span style=color:#4e9a06>&#34;8080&#34;</span> 
</span></span><span style=display:flex><span><span style=color:#c4a000>maxThreads=</span><span style=color:#4e9a06>&#34;150&#34;</span> <span style=color:#c4a000>minSpareThreads=</span><span style=color:#4e9a06>&#34;25&#34;</span> <span style=color:#c4a000>maxSpareThreads=</span><span style=color:#4e9a06>&#34;75&#34;</span> 
</span></span><span style=display:flex><span><span style=color:#c4a000>enableLookups=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#c4a000>redirectPort=</span><span style=color:#4e9a06>&#34;8443&#34;</span> <span style=color:#c4a000>acceptCount=</span><span style=color:#4e9a06>&#34;100&#34;</span> 
</span></span><span style=display:flex><span><span style=color:#c4a000>debug=</span><span style=color:#4e9a06>&#34;0&#34;</span> <span style=color:#c4a000>connectionTimeout=</span><span style=color:#4e9a06>&#34;20000&#34;</span> 
</span></span><span style=display:flex><span><span style=color:#c4a000>disableUploadTimeout=</span><span style=color:#4e9a06>&#34;true&#34;</span> <span style=color:#c4a000>URIEncoding=</span><span style=color:#4e9a06>&#34;euc-kr&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>위에서 URIEncoding=&#34;euc-kr&#34; 부분이다.
</span></span></code></pre></div><p>결론적으로 Tomcat 4.x와 Tomcat 5.x 는 모두 request.setCharacterEncoding()이 필요하다는 사실에는 변함이 없다.</p><h4 id=한글-파라미터를-가진-링크를-만들-때>한글 파라미터를 가진 링크를 만들 때</h4><p>JSP페이지에서 링크를 생성할 때, 한글이 됐든 공백이나 특수문자를 가진 영어가 됐든, 순수하게 영어와 숫자, 밑줄 등으로만 이뤄진게 아닌 모든 파라미터를 넘길 때는 무조건 URLEncoding을 해야한다고 봐도 된다.</p><p>Web Container에 따라 URLEncoding을 안하고 넘겨도 작동하는 경우가 있는데, 동일한 웹 컨테이너라도 버전에 따라 한글을 제대로 인식하지 못하는 경우도 있고, 또 다른 컨테이너에서는 URLEncoding이 안된 한글을 전혀 인식하지 못할 수도 있다.</p><p>그러므로 무조건 표준을 따라서 java.net.URLEncoder.encode()메 소드를 사용해 인코딩해서 넘기도록 한다. 디코드 작업은 request.setCharacterEncoding()에 의해서 자동으로 이뤄지므로 해줄것이 없다. (Tomcat 3.x대- JSP Spec 1.1 -에서는 request.setCharacterEncoding()이 없으므로 String.getBytes()를 이용해 직접 디코딩을 해줘야만 했다)</p><h4 id=-include-filetestjspf-에서의-한글>&lt;%@ include file=&ldquo;test.jspf&rdquo;%> 에서의 한글</h4><p>위와 같이 test.jspf를 static include 할 경우에 test.jspf에 있는 한글이 모두 깨질 수 있다. test.jspf에도 한글 설정이 필요한데, 이 경우에는 test.jspf의 최 상단에 다음을 추가하면 된다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@page pageEncoding=&#34;euc-kr&#34;%&gt;
</code></pre><ul><li>static include : JSP 페이지를 컴파일하는 시점에 해당 jspf 파일의 내용을 문자열 그대로 현재 jsp에 삽입하여 컴파일 하는 것. static include 방식에서 include 되는 대상 jsp의 확장자는 .jspf로 하는 것이 표준이다. .jspf 는 단독 실행을 위한 것이 아니라 항상 다른 JSP에 포함되어 쓰이는 목적으로 만들어졌기 때문에 완전한 JSP의 형태를 갖추고 있지 않다.</li><li>&lt;jsp:include page=””/> 이 방식은 동적 include 방식으로, JSP 페이지가 실행되는 중간에 page에 지정된 jsp를 실행한 결과를 삽입하는 방식이다. 이 방식에서는 include 되는 JSP 페이지가 원래부터 페이지 인코딩 정보 등을 포함한 완전한 JSP 형태를 갖추고 있어야만 한다.</li></ul><h2 id=참고자료>참고자료</h2><ul><li><a href=https://okky.kr/articles/57865>Tomcat/JSP와 한글</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-8d079c8cc0e72c9a0744b0f6a3d6a3a1>37 - File Handling</h1><div class=lead>Excel 다운로드를 위한 파일 처리 서비스를 적용한 예제 코드와 설정을 제공한다.</div><h1 id=file-handling>File Handling</h1><h2 id=개요>개요</h2><p>File Handling 서비스를 적용해서 Excel 다운로드 하기 위한 Excel 정보를 설정한다.</p><p><a href=./excel.md>Excel</a> 서비스에 적용되어 있다.</p><h2 id=설명>설명</h2><h3 id=source>Source</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>FileObject</span> <span style=color:#000>writtenFile</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>manager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>resolveFile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>baseDir</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>propertyPath</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>FileContent</span> <span style=color:#000>writtenContents</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>writtenFile</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getContent</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>InputStream</span> <span style=color:#000>is</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>writtenContents</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getInputStream</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>BufferedReader</span> <span style=color:#000>reader</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>BufferedReader</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>InputStreamReader</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>is</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>StringBuffer</span> <span style=color:#000>sb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>StringBuffer</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>line</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>line</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>reader</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>readLine</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>sb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>append</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>line</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>is</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-3ede9acf599a89c19ffb34a721b03d69>38 - Excel Service</h1><div class=lead>Excel 서비스는 Apache POI를 사용해 Excel 파일 다운로드 및 업로드를 지원하며, 3.0 버전에서는 메소드 리팩토링과 MyBatis 지원을 추가했다.</div><h1 id=excel-service>Excel Service</h1><h2 id=개요>개요</h2><p>Excel 파일 포맷을 다룰 수 있는 자바 라이브러리를 제공하여, 사용자들이 데이터를 Excel 파일 포맷으로 다운받거나, 대량의 Excel 데이터를 시스템에 올릴 수 있도록 지원하기 위한 서비스이다.
Excel 서비스는 <strong>Apache POI</strong> 오픈소스를 사용하여 구현하였으며 <strong>주요 Excel 접근</strong> 기능 외에 <strong>Excel 다운로드</strong>, <strong>Excel 파일 업로드</strong> 등의 기능이 있다.
Excel 서비스 3.0 버전에서는 기존 버전을 refactoring 하였다.
기존의 메소드(xls, xlsx)를 지원하는 메소드들의 이름을 하나로 하여 Parameter 방식으로 구분자를 추가하였다.
또한, 기존의 iBatis 뿐만 아니라 MyBatis도 지원하는 클래스를 추가하였다.</p><h2 id=설명>설명</h2><h3 id=주요기능>주요기능</h3><h4 id=excel-파일-생성>Excel 파일 생성</h4><p>엑셀 파일을 생성하여 지정된 위치에 저장하는 기능을 제공한다.</p><p>Workbook 인스턴스를 생성하여 Excel sheet를 추가 생성할 수 있다.</p><p>엑셀 버전에 따라 엑셀 97~2003버전(xls)인 HSSFWorkbook, 엑셀 2007이상(xlsx)의 XSSFWorkbook 클래스를 사용할 수 있으며, 각 클래스별 사용 법(method)는 동일하다.</p><h5 id=sample-source>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>sheetName1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;first sheet&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>sheetName2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;second sheet&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>StringBuffer</span> <span style=color:#000>sb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>StringBuffer</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 엑셀 필요버전에 맞는 확장자를 선택하면 됨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>sb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>append</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>fileLocation</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>append</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>append</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testWriteExcelFile.xls&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>sb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>append</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>fileLocation</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>append</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>append</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testWriteExcelFile.xlsx&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Workbook을 필요버전에 맞는 클래스를 선택하면 됨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Workbook</span> <span style=color:#000>wb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HSSFWorkbook</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#8f5902;font-style:italic>// xls 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Workbook</span> <span style=color:#000>wb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>SXSSFWorkbook</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#8f5902;font-style:italic>//xlsx 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span><span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createSheet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheetName1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createSheet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheetName2</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createSheet</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=excel-파일-수정>Excel 파일 수정</h4><p>엑셀 파일 내 셀의 내용을 변경하고 저장한다.</p><p>저장된 엑셀파일을 로드할 수 있으며 지정한 sheet에 row와 cell 객체를 생성하여 텍스트를 저장하고 수정할 수 있다.</p><h5 id=sample-source-1>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// xls엑셀 파일 로드
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Workbook</span> <span style=color:#000>wb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>excelService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>loadWorkbook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// xlsx엑셀 파일 로드
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>XSSFWorkbook</span> <span style=color:#000>wb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>wb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>excelService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>loadWorkbook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testModifyCellContents after loadWorkbook....&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>Sheet</span> <span style=color:#000>sheet</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getSheetAt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>Font</span> <span style=color:#000>f2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createFont</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>CellStyle</span> <span style=color:#000>cs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createCellStyle</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>cs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createCellStyle</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>cs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFont</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>f2</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setWrapText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>Row</span> <span style=color:#000>row</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createRow</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>rownum</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHeight</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000>x349</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>Cell</span> <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cellnum</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// xls 엑셀방식일 경우
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CELL_TYPE_STRING</span><span style=color:#ce5c00;font-weight:700>);</span>  
</span></span><span style=display:flex><span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HSSFRichTextString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>content</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// xlsx 엑셀방식일 경우
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>XSSFCell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CELL_TYPE_STRING</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>XSSFRichTextString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>content</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellStyle</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cs</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setColumnWidth</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>((</span><span style=color:#0000cf;font-weight:700>50</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#0000cf;font-weight:700>8</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#ce5c00;font-weight:700>((</span><span style=color:#204a87;font-weight:700>double</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#0000cf;font-weight:700>1</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>20</span><span style=color:#ce5c00;font-weight:700>)));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>FileOutputStream</span> <span style=color:#000>out</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>write</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=excel-문서-속성-수정>Excel 문서 속성 수정</h4><p>엑셀 파일 문서의 속성(Header, Footer)을 수정한다.</p><p>Header 및 Footer 클래스로 엑셀문서의 Header와 Footer의 값과 속성을 설정할 수 있다.</p><h5 id=sample-source-2>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 엑셀 파일 로드
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Workbook</span> <span style=color:#000>wb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>excelService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>loadWorkbook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// xls 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Workbook</span> <span style=color:#000>wb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>excelService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>loadWorkbook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>XSSFWorkbook</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>// xlsx 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;testModifyCellContents after loadWorkbook....&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>Sheet</span> <span style=color:#000>sheet</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createSheet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;doc test sheet&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>Row</span> <span style=color:#000>row</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createRow</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>Cell</span> <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HSSFRichTextString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Header/Footer Test&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> <span style=color:#8f5902;font-style:italic>// xls 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>XSSFRichTextString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Header/Footer Test&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> <span style=color:#8f5902;font-style:italic>// xlsx 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Header
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Header</span> <span style=color:#000>header</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getHeader</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>header</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCenter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Center Header&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>header</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setLeft</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Left Header&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>header</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setRight</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HSSFHeader</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>font</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Stencil-Normal&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Italic&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>HSSFHeader</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>fontSize</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#0000cf;font-weight:700>16</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;Right Stencil-Normal Italic font and size 16&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// xls 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>header</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setRight</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>XSSFOddHeader</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>stripFields</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;&amp;IRight Stencil-Normal Italic font and size 16&#34;</span><span style=color:#ce5c00;font-weight:700>));</span> <span style=color:#8f5902;font-style:italic>// xlsx 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Footer
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// xls 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Footer</span> <span style=color:#000>footer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFooter</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>footer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCenter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HSSFHeader</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>font</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Fixedsys&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Normal&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>HSSFHeader</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>fontSize</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#0000cf;font-weight:700>12</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;- 1 -&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// xlsx 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Footer</span> <span style=color:#000>footer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>XSSFOddFooter</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFooter</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>footer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCenter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>XSSFOddHeader</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>stripFields</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Fixedsys&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>footer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setLeft</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Left Footer&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>footer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setRight</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Right Footer&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 엑셀 파일 저장
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>FileOutputStream</span> <span style=color:#000>out</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>write</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=셀-내용-추출>셀 내용 추출</h4><p>엑셀 파일을 읽어 특정 셀의 값을 얻어온다.</p><p>HSSFCell 클래스의 getRichStringCellValue, getNumericCellValue, getStringCellValue 등 다양한 type의 Cell 내용을 추출할 수 있다.</p><h5 id=sample-source-3>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Workbook</span> <span style=color:#000>wbT</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>excelService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>loadWorkbook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// xls 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Workbook</span> <span style=color:#000>wbT</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>excelService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>loadWorkbook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>XSSFWorkbook</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>// xlsx 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Sheet</span> <span style=color:#000>sheetT</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wbT</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getSheet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;cell test sheet&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>100</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Row</span> <span style=color:#000>row</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createRow</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>j</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>j</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>j</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Cell</span> <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>j</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HSSFRichTextString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;row &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;, cell &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>j</span><span style=color:#ce5c00;font-weight:700>));</span> <span style=color:#8f5902;font-style:italic>// xls 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>XSSFRichTextString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;row &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;, cell &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>j</span><span style=color:#ce5c00;font-weight:700>));</span> <span style=color:#8f5902;font-style:italic>// xlsx 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellStyle</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cs</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=셀-속성-추출>셀 속성 추출</h4><p>특정 셀의 속성(폰트, 사이즈 등)을 수정한다.</p><p>HSSFFont, HSSFCellStyle 등의 클래스를 이용하여 셀의 폰트, 사이즈 등의 셀 속성을 수정할 수 있다.</p><h5 id=sample-source-4>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 엑셀 파일 로드
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Workbook</span> <span style=color:#000>wb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>excelService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>loadWorkbook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// xls 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Workbook</span> <span style=color:#000>wb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>excelService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>loadWorkbook</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>XSSFWorkbook</span><span style=color:#ce5c00;font-weight:700>());</span> <span style=color:#8f5902;font-style:italic>//xlsx 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span><span style=color:#000>Sheet</span> <span style=color:#000>sheet</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createSheet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;cell test sheet2&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setColumnWidth</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#0000cf;font-weight:700>200</span><span style=color:#ce5c00;font-weight:700>);</span>	<span style=color:#8f5902;font-style:italic>// column Width
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span><span style=color:#000>CellStyle</span> <span style=color:#000>cs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createCellStyle</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>Font</span> <span style=color:#000>font</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createFont</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>font</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFontHeight</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#0000cf;font-weight:700>16</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>font</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setBoldweight</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>font</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFontName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;fixedsys&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>cs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFont</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>font</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>cs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setAlignment</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CellStyle</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ALIGN_RIGHT</span><span style=color:#ce5c00;font-weight:700>);</span>	<span style=color:#8f5902;font-style:italic>// cell 정렬
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>cs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setWrapText</span><span style=color:#ce5c00;font-weight:700>(</span> <span style=color:#204a87;font-weight:700>true</span> <span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>100</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>HSSFRow</span> <span style=color:#000>row</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createRow</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHeight</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#0000cf;font-weight:700>300</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// row의 height 설정
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>j</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>j</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>j</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>HSSFCell</span> <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createCell</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>j</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HSSFRichTextString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;row &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;, cell &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>j</span><span style=color:#ce5c00;font-weight:700>));</span> <span style=color:#8f5902;font-style:italic>// xls 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>XSSFRichTextString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;row &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;, cell &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>j</span><span style=color:#ce5c00;font-weight:700>));</span> <span style=color:#8f5902;font-style:italic>// xlsx 버전
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCellStyle</span><span style=color:#ce5c00;font-weight:700>(</span> <span style=color:#000>cs</span> <span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 엑셀 파일 저장
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>FileOutputStream</span> <span style=color:#000>out</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileOutputStream</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>write</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=공통-템플릿-사용>공통 템플릿 사용</h4><p>공통 템플릿을 사용하여 일관성을 유지한다. jXLS 오픈소스를 사용하여 작성된 템플릿에 지정된 값을 저장한다.</p><h5 id=sample-source-5>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>PersonHourVO</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>persons</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>PersonHourVO</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span><span style=color:#000>PersonHourVO</span> <span style=color:#000>person</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PersonHourVO</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Yegor Kozlov&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;YK&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setMon</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setTue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setWed</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setThu</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setFri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSat</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>7</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSun</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>persons</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>);</span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>PersonHourVO</span> <span style=color:#000>person1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PersonHourVO</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>person1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Gisella Bronzetti&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;GB&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setMon</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setTue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setWed</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setThu</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>5</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>person1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSun</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>persons</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person1</span><span style=color:#ce5c00;font-weight:700>);</span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>beans</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span><span style=color:#000>beans</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;persons&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>persons</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>XLSTransformer</span> <span style=color:#000>transformer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>XLSTransformer</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>transformer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>transformXLS</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>beans</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>sbResult</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><h5 id=excel-template>Excel Template</h5><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;jx:forEach var=&#34;persons&#34; items=&#34;${persons}&#34;&gt;
${persons.name}	${persons.id}	${persons.mon}	${persons.tue}	${persons.wed}	${persons.thu}	${persons.fri}	${persons.sat}	${persons.sun}	$[C4+D4+E4+F4+G4+H4+I4]
&lt;/jx:forEach&gt;
		Total Hrs:	$[SUM(C4)]	$[SUM(D4)]	$[SUM(E4)]	$[SUM(F4)]	$[SUM(G4)]	$[SUM(H4)]	$[SUM(I4)]	$[SUM(J4)]
</code></pre><p><img src=../images/excel-service-template.png alt=excel-service-template></p><h5 id=template-적용결과>Template 적용결과</h5><p><img src=../images/excel-service-template-result.png alt=excel-service-template-result></p><h3 id=excel-다운로드>Excel 다운로드</h3><h5 id=configuration>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;categoryExcelView&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.excel.download.CategoryExcelView&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>XSSF 형태의 다운로드의 경우 다음의 View를 등록하여 사용한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;bean id=&#34;CategoryPOIExcelView&#34; class=&#34;egovframework.rte.fdl.excel.download.CategoryPOIExcelView&#34; /&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>--&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.BeanNameViewResolver&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;order&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;0&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h5 id=sample-source-6>Sample Source</h5><p>Controller 클래스 작성 Map 사용</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/sale/listExcelCategory.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>selectCategoryList</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>lists</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>mapCategory</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;0000000001&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Sample Test&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;This is initial test data.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;useyn&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Y&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;reguser&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;test&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>lists</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;0000000002&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;test Name&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;test Deso1111&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;useyn&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Y&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;reguser&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;test&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>lists</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>mapCategory</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>map</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span>	<span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;category&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>lists</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;categoryExcelView&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;categoryMap&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>VO 사용</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/sale/listExcelVOCategory.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>selectCategoryVOList</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>UsersVO</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>lists</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>UsersVO</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>UsersVO</span> <span style=color:#000>users</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>UsersVO</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//Map&lt;String, String&gt; mapCategory = new HashMap&lt;String, String&gt;();
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;0000000001&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Sample Test&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setDescription</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;This is initial test data.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setUseYn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Y&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setRegUser</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;test&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>lists</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;0000000002&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;test Name&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setDescription</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;test Deso1111&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setUseYn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Y&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setRegUser</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;test&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>lists</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>map</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span>	<span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;category&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>lists</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;categoryExcelView&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;categoryMap&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>View 클래스 작성(xls 버전)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>CategoryExcelView</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractExcelView</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Logger</span> <span style=color:#000>LOGGER</span>  <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LoggerFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CategoryExcelView</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>buildExcelDocument</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HSSFWorkbook</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>req</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>resp</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>HSSFCell</span> <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument start !!!&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>HSSFSheet</span> <span style=color:#000>sheet</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createSheet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;User List&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setDefaultColumnWidth</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>12</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// put text in first cell
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;User List&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// set header information
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;use_yn&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;reg_user&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument cast&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;)</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;categoryMap&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>categories</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;)</span> <span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;category&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>isVO</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>categories</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        	<span style=color:#000>Object</span> <span style=color:#000>obj</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>categories</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        	<span style=color:#000>isVO</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obj</span> <span style=color:#204a87;font-weight:700>instanceof</span> <span style=color:#000>UsersVO</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>categories</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>isVO</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>	<span style=color:#8f5902;font-style:italic>// VO
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>        		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument VO : {} started!!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        		<span style=color:#000>UsersVO</span> <span style=color:#000>category</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UsersVO</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>categories</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDescription</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUseYn</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getRegUser</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument VO : {} end!!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        	 <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>	<span style=color:#8f5902;font-style:italic>// Map
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>        		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument Map : {} started!!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        		<span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>category</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;)</span> <span style=color:#000>categories</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;useyn&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;reguser&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument Map : {} end!!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        	 <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>View 클래스 작성(xlsx 버전)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>CategoryPOIExcelView</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractPOIExcelView</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Logger</span> <span style=color:#000>LOGGER</span>  <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LoggerFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CategoryPOIExcelView</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>buildExcelDocument</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>XSSFWorkbook</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>req</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>resp</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>XSSFCell</span> <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument start !!!&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>XSSFSheet</span> <span style=color:#000>sheet</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>wb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createSheet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;User List&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setDefaultColumnWidth</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>12</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// put text in first cell
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;User List&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// set header information
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;use_yn&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;reg_user&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument cast&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;)</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;categoryMap&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>categories</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;)</span> <span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;category&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>isVO</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>categories</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        	<span style=color:#000>Object</span> <span style=color:#000>obj</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>categories</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        	<span style=color:#000>isVO</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obj</span> <span style=color:#204a87;font-weight:700>instanceof</span> <span style=color:#000>UsersVO</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>categories</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>isVO</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>	<span style=color:#8f5902;font-style:italic>// VO
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>        		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument VO : {} started!!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        		<span style=color:#000>UsersVO</span> <span style=color:#000>category</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UsersVO</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>categories</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getId</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDescription</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getUseYn</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getRegUser</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	            <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument VO : {} end!!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        	 <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>	<span style=color:#8f5902;font-style:italic>// Map
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>        		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument Map : {} started!!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        		<span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>category</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;)</span> <span style=color:#000>categories</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;useyn&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>cell</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sheet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 	            <span style=color:#000>setText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>category</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;reguser&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 	            <span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### buildExcelDocument Map : {} end!!&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        	 <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=excel-업로드>Excel 업로드</h3><h5 id=configuration-1>Configuration</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;excelService&#34;</span>	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.excel.impl.EgovExcelServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mapClass&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.excel.upload.EgovExcelTestMapping&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sqlSessionTemplate&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;sqlSessionTemplate&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;excelBigService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.excel.impl.EgovExcelServiceImpl&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mapClass&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.excel.upload.EgovExcelTestMapping&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mapBeanName&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;mappingBean&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;sqlMapClient&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;sqlMapClient&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;mappingBean&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.excel.upload.EgovExcelBigTestMapping&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>class : egovframework.rte.fdl.excel.impl.EgovExcelServiceImpl</li><li>propertyPath : xml형식의 엑셀 형식정보 위치</li><li>mapClass : 개발자가 작성한 VO와 Query의 mapping을 위한 클래스</li><li>mapBeanName : Excel Cell과 VO를 mapping 구현 Bean name (mapClass보다 우선함)</li><li>sqlMapClient : ibatis의 sqlMapClient(ibatis 사용시 적용)</li><li>sqlSessionTemplate : mybatis의 sqlSessionTemplate(mybatis 사용시 적용)</li></ul><h5 id=sample-source-7>Sample Source</h5><p>VO 클래스 작성</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EmpVO</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>Serializable</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>BigDecimal</span> <span style=color:#000>empNo</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>empName</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>job</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>BigDecimal</span> <span style=color:#000>getEmpNo</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>empNo</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setEmpNo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>BigDecimal</span> <span style=color:#000>empNo</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  	<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>empNo</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>empNo</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getEmpName</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>empName</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setEmpName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>empName</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>empName</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>empName</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getJob</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>job</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setJob</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>job</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>job</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>job</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>엑셀과 Query의 mapping을 위한 VO클래스</li></ul><p>Mapping 클래스 작성</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EgovExcelTestMapping</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>EgovExcelMapping</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Logger</span> <span style=color:#000>LOGGER</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LoggerFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLogger</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovExcelTestMapping</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>EmpVO</span> <span style=color:#000>mappingColumn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Row</span> <span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Cell</span> <span style=color:#000>cell0</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    	        <span style=color:#000>Cell</span> <span style=color:#000>cell1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    	        <span style=color:#000>Cell</span> <span style=color:#000>cell2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCell</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>EmpVO</span> <span style=color:#000>vo</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>EmpVO</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setEmpNo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>BigDecimal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell0</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNumericCellValue</span><span style=color:#ce5c00;font-weight:700>()));</span>
</span></span><span style=display:flex><span>		<span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setEmpName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovExcelUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell1</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>		<span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setJob</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovExcelUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cell2</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;########### vo is {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEmpNo</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;########### vo is {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEmpName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#000>LOGGER</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;########### vo is {}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getJob</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>엑셀과 VO의 mapping을 위한 mapping클래스</li><li><strong>EgovExcelMapping</strong> 클래스를 상속받아서 <strong>mappingColumn</strong> 메소드를 오버라이드하여 구현</li><li><strong>HSSFCell</strong> 클래스에서 엑셀 값을 추출하여 Query를 실행시키기 위한 VO와 mapping</li></ul><h5 id=query>Query</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;sqlMap</span> <span style=color:#c4a000>namespace=</span><span style=color:#4e9a06>&#34;EmpBatchInsert&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;typeAlias</span> <span style=color:#c4a000>alias=</span><span style=color:#4e9a06>&#34;empVO&#34;</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.excel.vo.EmpVO&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;insert</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;insertEmpUsingBatch&#34;</span> <span style=color:#c4a000>parameterClass=</span><span style=color:#4e9a06>&#34;empVO&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>&lt;![CDATA[
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			insert into EMP (
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				EMP_NO,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				EMP_NAME,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				JOB
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			) values (
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				#empNo#,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				#empName#,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				#job#
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>			)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>		]]&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/insert&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/sqlMap&gt;</span>
</span></span></code></pre></div><h2 id=예제>예제</h2><ul><li><a href=../../runtime-example/individual-example/foundation-layer/excel-example.md>엑셀 예제</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-3fac5957c584f8f9d6af21400598019b>39 - String Util Service</h1><div class=lead>EgovStringUtil, EgovNumericUtil, EgovDateUtil, EgovObjectUtil 등의 서비스는 문자열, 숫자, 날짜, 객체 생성 등을 쉽게 다룰 수 있도록 다양한 기능을 제공한다. 이를 통해 패턴 매칭, 데이터 형식 변환, 숫자 계산, 날짜 계산, 객체 인스턴스화 등의 작업을 효율적으로 수행할 수 있다.</div><h1 id=string-util-service>String Util Service</h1><h2 id=개요>개요</h2><p>시스템을 개발할 때 필요한 문자열 데이터를 다루기 위해 다양한 기능을 사용하도록 서비스한다. 문자열을 다루는 <strong>EgovStringUtil Service</strong>와 숫자를 다루는 <strong>EgovNumericUtil Service</strong>, 날짜형식을 다루는 <strong>EgovDateUtil Service</strong> 그리고 객체 생성 등의 <strong>EgovObjectUtil Service</strong> 4가지가 있다.</p><h2 id=설명>설명</h2><h3 id=1-egovstringutil-service>1. EgovStringUtil Service</h3><h4 id=pattern-matching>Pattern matching</h4><p>String이 특정 Pattern(정규표현식)에 부합하는지 검사한다.</p><h5 id=sample-source>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testPatternMatch</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// pattern match 성공
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>String</span> <span style=color:#000>str</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;abc-def&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>pattern</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;*-*&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isPatternMatching</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>str</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>pattern</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// pattern match 실패
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>str</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;abc&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isPatternMatching</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>str</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>pattern</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=formatting>Formatting</h4><p>다양한 타입의 데이터를 특정 String형식(Format)으로 변환한다.</p><h5 id=sample-source-1>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testTypeConversion</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// int =&gt; string
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>integer2string</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// long =&gt; string
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1000000000&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>long2string</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1000000000</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// float =&gt; string
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;34.5&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>float2string</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>34</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>5f</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// double =&gt; string
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;34.5&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>double2string</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>34</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>5</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// string =&gt; int
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>string2integer</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>string2integer</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// string =&gt; float
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Float</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>34</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>5f</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>Float</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>string2float</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;34.5&#34;</span><span style=color:#ce5c00;font-weight:700>)));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Float</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>5f</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>Float</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>string2float</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>5f</span><span style=color:#ce5c00;font-weight:700>)));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// string =&gt; double
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Double</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>34</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>5</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>Double</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>string2double</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;34.5&#34;</span><span style=color:#ce5c00;font-weight:700>)));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Double</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>34</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>5</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>Double</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>string2double</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>34</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>5</span><span style=color:#ce5c00;font-weight:700>)));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// string =&gt; long
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100000000</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>string2long</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;100000000&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>100000000</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>string2long</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>100000000</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=substring>Substring</h4><p>전체 String 중 일부를 가져온다.</p><h5 id=sample-source-2>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testToSubString</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>String</span> <span style=color:#000>source</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;substring test&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;test&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toSubString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>source</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;string&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toSubString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>source</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>9</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=trim>Trim</h4><p>전체 String 중 앞뒤에 존재하는 공백 문자(white character)를 제거한다.</p><h5 id=sample-source-3>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testStringTrim</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>String</span> <span style=color:#000>str</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;  substring  &#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;substring&#34;</span>  <span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>trim</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>str</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;substring  &#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ltrim</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>str</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;  substring&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>rtrim</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>str</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=concatenate>Concatenate</h4><p>두 String을 붙여서 하나의 String을 생성한다.</p><h5 id=sample-source-4>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testConcat</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>String</span> <span style=color:#000>str1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;substring&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>String</span> <span style=color:#000>str2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;test&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;substringtest&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovStringUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>concat</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>str1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>str2</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=find>Find</h4><p>전체 String 중 특정 String Pattern이 있는지 찾는다.</p><h5 id=sample-source-5>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testFindPattern</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>String</span> <span style=color:#000>pattern</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;\\d{4}-\\d{1,2}-\\d{1,2}&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// 일치하는 pattern 을 찾는다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>Matcher</span> <span style=color:#000>matcher</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Pattern</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>compile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>pattern</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>matcher</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009-02-03&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>    	
</span></span><span style=display:flex><span>  <span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>matcher</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>find</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// 일치하는 pattern 을 찾는다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>matcher</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Pattern</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>compile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>pattern</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>matcher</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;abcdef2009-02-03abcdef&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>matcher</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>find</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// 일치하는 pattern 을 찾지 못한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>matcher</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Pattern</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>compile</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>pattern</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>matcher</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;abcdef2009-02-A3abcdef&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertFalse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>matcher</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>find</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=2-egovnumericutil-service>2. EgovNumericUtil Service</h3><p>숫자체크, 더하기, 빼기, 곱하기, 나누기, 올림, 내림 기능</p><h4 id=숫자체크-기능>숫자체크 기능</h4><p>주어진 문자열이 숫자형식인지 검사한다.</p><h5 id=sample-source-6>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testIsNumber</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertFalse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isNumber</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;abc&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertFalse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isNumber</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;!@&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertFalse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isNumber</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;ab-123&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isNumber</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;-123&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertTrue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isNumber</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1234&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=더하기-기능>더하기 기능</h4><p>두 문자열 값의 덧셈을 실행한다.</p><h5 id=sample-source-7>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testPlus</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;400&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>      <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>plus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;249&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;400.0000&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>plus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;248.2469&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;400.000&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>plus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;248.2469&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;399.9654&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>plus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;248.2123&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;399.966&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>plus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;248.2123&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_UP</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;399.965&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>plus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;248.2123&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_DOWN</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;399.97&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>   <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>plus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;248.2123&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_HALF_UP</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=빼기-기능>빼기 기능</h4><p>두 문자열 값의 뺄셈을 실행한다.</p><h5 id=sample-source-8>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testMinus</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;89&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>       <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>minus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;240&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;151&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;96.4938&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>minus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;248.2469&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;96.49380&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>minus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;248.2469&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;96.4592&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>minus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;248.2123&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;96.460&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>   <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>minus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;248.2123&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_UP</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;96.459&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>   <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>minus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;248.2123&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_DOWN</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;96.46&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>    <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>minus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;248.2123&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_HALF_UP</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=곱하기-기능>곱하기 기능</h4><p>두 문자열 값의 곱셈을 실행한다.</p><h5 id=sample-source-9>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testMultiply</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;180&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>       <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multiply</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;189.6135&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multiply</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15.23&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12.45&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;189.61350&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multiply</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15.23&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12.45&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;189.614&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>   <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multiply</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15.23&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12.45&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_UP</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;189.613&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>   <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multiply</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15.23&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12.45&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_DOWN</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;189.61&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>    <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multiply</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15.23&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12.45&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_HALF_UP</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=나누기-기능>나누기 기능</h4><p>두 문자열 값의 나눗셈을 실행한다.</p><h5 id=sample-source-10>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testDivide</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1.25&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>divide</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#000>Class</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>exceptionClass</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  	<span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1.2232931726907630522088353413655&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>divide</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15.23&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12.45&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  	<span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;### Exception : &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>  	<span style=color:#000>exceptionClass</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Class</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>&gt;)</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>finally</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  	<span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ArithmeticException</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>exceptionClass</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1.22&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>divide</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15.23&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12.45&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1.224&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>divide</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15.23&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12.45&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_UP</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1.223&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>divide</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15.23&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12.45&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_DOWN</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1.22&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>divide</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;15.23&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;12.45&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_HALF_UP</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=올림-내림-기능>올림, 내림 기능</h4><p>주어진 값의 반올림, 올림, 내림을 실행한다.</p><h5 id=sample-source-11>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testScale</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.754&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setScale</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_UP</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.753&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setScale</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_DOWN</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.753&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setScale</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;151.7531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovNumericUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ROUND_HALF_UP</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=3-egovdateutil-service>3. EgovDateUtil Service</h3><p>날짜계산, 현재일자 조회, 요일, 날짜형식체크 기능</p><h4 id=날짜계산-기능>날짜계산 기능</h4><p>주어진 날짜에 해당 년,월 또는 일자를 더하여 계산된 일자를 조회한다.</p><h5 id=sample-source-12>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testCalcDate</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20100114&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCalcDateAsString</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>300</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;day&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2010&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>      <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCalcYearAsString</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>300</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;day&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;01&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>        <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCalcMonthAsString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>300</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;day&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;14&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>        <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCalcDayAsString</span>  <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>300</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;day&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2010</span><span style=color:#ce5c00;font-weight:700>,</span>        <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCalcYearAsInt</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>300</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;day&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span>           <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCalcMonthAsInt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>300</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;day&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>14</span><span style=color:#ce5c00;font-weight:700>,</span>          <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCalcDayAsInt</span>  <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>300</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;day&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>시작일자와 종료일자 및 두 시간 사이의 일자/밀리초 수를 계산한다.</p><h5 id=sample-source-13>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testDayCount</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>90</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayCount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090101&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20090401&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>90</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayCountWithFormatter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090101&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20090401&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;yyyyMMdd&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>182</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayCountWithFormatter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2008/12/01&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;2009/06/01&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;yyyy/MM/dd&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testTimeCount</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>86400000</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getTimeCount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090401&#34;</span><span style=color:#ce5c00;font-weight:700>,</span>       <span style=color:#4e9a06>&#34;20090402&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>60000</span><span style=color:#ce5c00;font-weight:700>,</span>    <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getTimeCount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090301000000&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20090301000100&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>3600000</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getTimeCount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090301000000&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20090301010000&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=현재일자-조회-기능>현재일자 조회 기능</h4><p>현재 일자를 조회한다.</p><h5 id=sample-source-14>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testCurrentDate</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getInstance</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>YEAR</span><span style=color:#ce5c00;font-weight:700>),</span>         <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCurrentYearAsInt</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getInstance</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>MONTH</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span>    <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCurrentMonthAsInt</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getInstance</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>DAY_OF_MONTH</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCurrentDayAsInt</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getInstance</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>HOUR_OF_DAY</span><span style=color:#ce5c00;font-weight:700>),</span>  <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCurrentHourAsInt</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getInstance</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>MINUTE</span><span style=color:#ce5c00;font-weight:700>),</span>       <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCurrentMinuteAsInt</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=요일-기능>요일 기능</h4><p>입력 일자의 해당 요일을 조회한다.</p><h5 id=sample-source-15>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testGetDayOfWeek</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;일&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekAsString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;03&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;22&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;월&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekAsString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;03&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;23&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;화&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekAsString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;03&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;24&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;수&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekAsString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;03&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;25&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;목&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekAsString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;03&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;26&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;금&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekAsString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;03&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;27&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;토&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekAsString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;2009&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;03&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;28&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>두 일자 사이에 해당 요일의 수를 조회한다.</p><h5 id=sample-source-16>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testGetDayOfWeek</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekCount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090301&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20090331&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;일요일&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>,</span>  <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekCount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090301&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20090331&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;토요일&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>22</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekCount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090101&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20090531&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;일&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>52</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekCount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090101&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20091231&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;일&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>52</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekCount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090101&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20091231&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;금&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>52</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDayOfWeekCount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090101&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;20091231&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;토&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=날짜-형식-체크-기능>날짜 형식 체크 기능</h4><p>해당 날짜의 형식이 적합성을 조회한다.</p><h5 id=sample-source-17>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testDateFormatCheck</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// 형식이 틀린경우 ParseException 발생
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>Class</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>exceptionClass</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  	<span style=color:#000>dateFormatCheck</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>EgovDateUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>dateFormatCheck</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;20090300&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  	<span style=color:#000>exceptionClass</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Class</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>&gt;)</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>finally</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  	<span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ParseException</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>exceptionClass</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=4-egovobjectutil-service>4. EgovObjectUtil Service</h3><p>클래스명으로 객체를 생성하며 객체는 파라미터가 없는 기본 생성자 또는 파라미터가 존재하는 생성자 등 다양한 형태로 객체를 인스턴스화 할 수 있다.</p><h4 id=instantiate-기능>Instantiate 기능</h4><p>파라미터가 없는 기본 생성자로 객체를 인스턴스화 한다.</p><h5 id=sample-source-18>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testInstantiate</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>String</span> <span style=color:#000>className</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;java.lang.String&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Object</span> <span style=color:#000>object</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>EgovObjectUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>instantiate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>className</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#000>String</span> <span style=color:#000>string</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>object</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>string</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;eGovFramework&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Framework&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>string</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>substring</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=instantiate-기능---생성자의-파라미터-포함>Instantiate 기능 - 생성자의 파라미터 포함</h4><p>파라미터가 존재하는 형태의 생성자로 객체를 인스턴스화 한다.</p><h5 id=sample-source-19>Sample Source</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Test</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>testInstantiateParamConstructor</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>String</span> <span style=color:#000>className</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;java.lang.StringBuffer&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>types</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]{</span><span style=color:#4e9a06>&#34;java.lang.String&#34;</span><span style=color:#ce5c00;font-weight:700>};</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>values</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[]{</span><span style=color:#4e9a06>&#34;전자정부 공통서비스&#34;</span><span style=color:#ce5c00;font-weight:700>};</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#000>StringBuffer</span> <span style=color:#000>sb</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>StringBuffer</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>EgovObjectUtil</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>instantiate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>className</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>types</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>values</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#000>sb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>append</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34; 및 개발프레임워크 구축 사업&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>		
</span></span><span style=display:flex><span>  <span style=color:#000>assertEquals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;전자정부 공통서비스 및 개발프레임워크 구축 사업&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>sb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li><a href=http://jakarta.apache.org/regexp/>Jakarta Regexp</a></li></ul></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/eGovFramework/egovframe-docs aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2016&ndash;2024
<span class=td-footer__authors>eGovFrame | <a href="https://www.egovframe.go.kr/home/sub.do?menuNo=23">Apache 2.0</a> |</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href="https://www.egovframe.go.kr/home/sub.do?menuNo=77" target=_blank rel=noopener>개인정보 보호 정책</a></span></div></div></div></footer></div><script src=/egovframe-docs/js/main.min.4eb19af2236072614b7d308c10176f918f1b447443492377d98b5b2c5e44aac3.js integrity="sha256-TrGa8iNgcmFLfTCMEBdvkY8bRHRDSSN32YtbLF5EqsM=" crossorigin=anonymous></script>
<script defer src=/egovframe-docs/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script>
<script src=/egovframe-docs/js/tabpane-persist.js></script></body></html>