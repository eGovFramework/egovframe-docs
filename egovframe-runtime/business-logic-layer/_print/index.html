<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=ko class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://eGovFramework.github.io/egovframe-docs/egovframe-runtime/business-logic-layer/><link rel=alternate type=application/rss+xml href=https://eGovFramework.github.io/egovframe-docs/egovframe-runtime/business-logic-layer/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/egovframe-docs/favicons/favicon.ico><link rel=apple-touch-icon href=/egovframe-docs/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/egovframe-docs/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/egovframe-docs/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/egovframe-docs/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/egovframe-docs/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/egovframe-docs/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/egovframe-docs/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/egovframe-docs/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/egovframe-docs/favicons/android-192x192.png sizes=192x192><title>업무처리 | 표준프레임워크 개발가이드</title><meta name=description content="업무처리 서비스는 업무 프로그램의 업무 로직을 담당하는 서비스로 업무 흐름제어, 에러 처리 등의 기능을 제공한다."><meta property="og:title" content="업무처리"><meta property="og:description" content="업무처리 서비스는 업무 프로그램의 업무 로직을 담당하는 서비스로 업무 흐름제어, 에러 처리 등의 기능을 제공한다."><meta property="og:type" content="website"><meta property="og:url" content="https://eGovFramework.github.io/egovframe-docs/egovframe-runtime/business-logic-layer/"><meta itemprop=name content="업무처리"><meta itemprop=description content="업무처리 서비스는 업무 프로그램의 업무 로직을 담당하는 서비스로 업무 흐름제어, 에러 처리 등의 기능을 제공한다."><meta name=twitter:card content="summary"><meta name=twitter:title content="업무처리"><meta name=twitter:description content="업무처리 서비스는 업무 프로그램의 업무 로직을 담당하는 서비스로 업무 흐름제어, 에러 처리 등의 기능을 제공한다."><link rel=preload href=/egovframe-docs/scss/main.min.91a6c15c7b322e5048cc8b945675ac980b8d9488c3d6a4487f1aacf27b341387.css as=style integrity="sha256-kabBXHsyLlBIzIuUVnWsmAuNlIjD1qRIfxqs8ns0E4c=" crossorigin=anonymous><link href=/egovframe-docs/scss/main.min.91a6c15c7b322e5048cc8b945675ac980b8d9488c3d6a4487f1aacf27b341387.css rel=stylesheet integrity="sha256-kabBXHsyLlBIzIuUVnWsmAuNlIjD1qRIfxqs8ns0E4c=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/egovframe-docs/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="60" height="25" viewBox="0 0 60 25" enable-background="new 0 0 60 25"><image id="image0" width="60" height="25" x="0" y="0" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAZCAYAAABtnU33AAAAIGNIUk0AAHomAACAhAAA+gAAAIDo AAB1MAAA6mAAADqYAAAXcJy6UTwAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAAHCAAABwgAc0P m54AAAHcelRYdFJhdyBwcm9maWxlIHR5cGUgeG1wAAA4jYVUQZLjIAy86xX7BCyBBM/x2vg2VXPc 528Lj23imIypOAlI6lZLiP59fdMffywlksWyzJZ1taCrJos6cfD/umg18TNZmXXSqJuyJpn3/dN6 Y+ZAVxhs/nWXlOOaAocouhkcOYhyldA+LDXMHHyBAiO4ypw4Rop6w98PnUO2iBVkBuZm7eFqMOLa IIw3maT44o0kCGOD8V73IPgWKwgL2pZ5dQA/vrjcGcWoiUxUsFFaagUqVDD8MYAuDGwo4QwhxEug flmmXlRX6j2pxqheYuM31NMV6WZwDp4gV6Tmqn/CuqBQpQzWDwpqpRHa4bTj/Q7Xp+Ya6TPeMLkf H6/aiXevylmbXbs5elESVIle/ORBN12kxgZADSHEAmaTmqbUjDVakaXJ+THIBU099inmnAIaIsN1 QZ87fVwHT3BvEKlorAl9s1xa0u9OzwlfoH6VdKFGVXBhJwiYgDX1OIfZ3eo9OA1TKo8pCa7UC9Dh QSOXQQWPFplT9rJY4+uXiE4sa5e3JTY2H8PQDac8Ow5gOmv6jPMKE30KlSZBbD11wACAeoSR4X0O 8dZPon0QUT+J+jF6Gfsgjepne6/fJ7yf0H9Fc2ZpNW51UwAAAAFvck5UAc+id5oAAAyuSURBVFjD tZd/kFXlecc/z3vOub932R/sroKC+GuUNWOMxNq0UTDGtqZ2iHLXSttEO9GkMaBi0KBWz4yGKKBW MU0wWm20Gu9V04mGaJoWNErjTMyodRGMCkXk18ICu3vv3XvPed+nf5zLdTUSTWd8/rrz3vf5/X3e 53uEg4iCCKiGoV/N5UvWpL846tgZYc4+4qpv/KZULHoD5bLlo4kkJpEr79p4U0PNYRFBPRZPrZdq U5EH7/9a7+piseSVywMf1eb/S8xB/wlDDyDOZhfncvkvGhG68oU+8YIVAMVy2X10N5qYBMEEA5m2 7i+ZVPZiCTKXZDt6L1AvfxJA/9eL8nEme9CEVVUkDGMNw5wPC+rVmoucfXxftbo14wdzNtzy/VkC WiqWvD/E2Q2gLq5X65W9uEalro1aLaqOQlyLANY+83Gne7AOl8vJeS59GoX8oTG6pHPx5edF2pgf O0fg+58DKPav/4M6IqCIZF0cXaeWs1SjYlzbNxdTfQxg7Q18rHBuiSqiYehrKemYhqEPoLcsXam3 3Dw8sTBvLv/+T19f8YOnAA7cL5VKXqlU8hSVxJ5KGIYtnTAMjWry3+UrN7yx8I7XPvMBQUgYqglD NcWStpBTLKk3O1Q/VJ1gTw2qUiypN3uN+gfOZq9Rn6aflr427xw41+RBeddvGBptBqvLlv5al918 H8C2cFUO4M1bV/3D67fes/6Arr7PAe+z9365fOWGNxbc+dpZAMVQU8WSemGoH4y099ueUMT3Hr9P v6k3sUgHzn0B1SuuyNJrvozz3pRrw/94t8sy3Vq9C6Cyp24BnHOvOTFT7gvvy0h40TgirF7x8LyG pHNzR195kDB0K1Y8MVnEZq+8cu7bAN9c/nQ+Q6b3psWnbxIRRV3y4M0s2/LAgC0Dl6zSYLT2alfQ OaMPguN/+OX0I4jo/Ef0bAmY5Rz//vA8eQWg+IROHd/24t7sMSfPNgHd4WflgeJzOo0051Pj/rLI ULGkXihiz12vp0mKT+Yq3PuASMUHoFeuor09ZHS8pt++5lS5dukr+FEfmsp6gQwCHN09bAF8MTsw fPeiwXwE8F/LH/6CpHPldJDjUU5Oz4MftAeFeRjvTGAeQFv+sNMUWQR8/j0AKAOogGjsV3uCrpk3 K5r3M965F96nTzdSHGsCfprtg8puzv+b1frH/3a2jPiTWFhoO7mi8HW/QF/xGX1OUiyZdAwXj2ym C1hSHhBbfFlnkOLx7DS6a9s5FFhiNLyiC1jE6Kglm83iy6UApII+RKNq3W1thucAqmPb3zpm0cXX 0tyXnmcWe2Ko1WvgyRIAEXYrfKKVWBzNxNlsE1YeSAK1/n5vdrjWAzBOLS7+I+DMOMIN79ptTYqF QRYqu9iZmsRMjfgzAI3pULgMoU9jMFmuxzC3ugPU59ziOs0CSJ5LU510V7fSUI8F52zTyYa0zMHz 2omjM6jUVoH5SwCMX0BMdXRvamTifJchHgxLKYB1t5WmisjplVrlqnocXZRJZ2c8tOKJ46oavWyt y4S3r+lIcrSHW9f4bXPChdjVAMphf2NtOCcGiP2hOnF9Mi4OVHm6Z8bkADirMcpyN86nGiNUCDgF AItNF+jSmIvjOqvTBS6UmJ81xrhcLMeSZmrzjSnWhyjbKqegpFLCGQZ1c4jj5+W6O56Fxp2o69Tv fKsTKx5o9Owp08cBJAydhKELw9CVWR8nJbCnOBdXRj1z13lXnnf/WK06hO+fftnedZsQCXJeqjsp nswA2doMwuH7c7+yctP5f3/X1ku+9N0d5wNUqvkYY7rE2mUP/q2cXYuYpkpK4O4fXSDbVPmxWo5K 7FFojLD1kc/JPQKPGw8M3FqeJXeoYcSl6CgOahcRU5yw/McnyMuiPIVltg8cj2MNAI3RzWRyO8Ec iYhDiQcGEuhuCsNMLZjUORZEWqlmfGCr4vpFzEsDiwZqSSDml9a6WYThKr1zzngGexjwpjjXh3hv NoES+blJi/xGDOl2XKO+fXaoj6XsG0YlXxMv9RyASdEhhu3eyOatAGLYqMKpAEZJOeFFADyGasNU x/bwdnNF7DQWY1Ic5YSdsWNDcx5fEDjdAL3gXkm6eHcVka2Im0KMA2nRx47C5FO60unVPabjsSnt bY/oJZcEqmaKYN6Y8OoPGt+fBqCOvc7pIclMmy5PzJbkDooqB+gmzhlYi/opT1THrB3fBmCj0Vdd Lb6skj8i2e0+Qy0/BhHDFgCx1DC8k6sykpijhsE6y2HA2z85TkYB1ON/ROj2MWRxpkdvvPx4rESA Qbx2PG8IXFAqlbyBgQHre9Lb0dbxyd3jlv2x440pJ2RB2xXd0XqcjG4Toa05qztQmZb81sx4VNnS 7IAfVffdHpvMC7aytwPj718bzokvWLXNQ0zN82QM4OH57buBnwMUS9ojDS5E2JZkjGCTBNUjwjBW HhDbtO9EUevTIUBxUI82jiCK6NEMOR9LBt+sQPwKGEfg91KP/5nAWZTg0+vXB4CtxI3h4eHdG+sS jNclOPKQbE13iRac2tFW5R37LS4H4JS3ReSQS5e+0I0qLura2VxCxsCj9yyYsW4iJ/Bd1Sidsai2 6GWxpD0BXE+Gc7LdTK/u4cEWmBxRsgEAf4IhRVA8YqzfxqlRiuedjzFCHscOgxDgeVlEJoP0kk6B ZwIaOoqScZlMGqCvsv/ZadWFM0cqlTNFZF/d5lOqIqJNxwl0K5iEhqp4mx3a11Uw01DGll19XFIY FVWhkCQ0mDpADaGAINaZbGuM0sKNuT6+YQzTa8NYkfewuIMzugBUcV4GROjFMNlkyBKQ9wGlES1H vI04k2bfSBui63B+HTWpI/2gA9hfHhzUgTJuwy22HunEgr7Ls521aTV+M2C32Yj3p77I0SC7AIrF YpMje807g3bt7JluYgrGJfaK/zLaA8yv7aGhyo2aJhA4sdVFg3IQcXWctJGvD7EeuBmPSbaKMRnG fUTqiHlElqx4caKShmEXqYyN43g68L/F/n6hXKbhnC8eopmMqkpdkGwrXl8KojQSqOkW57m88fRE p7oFoL+/X/bye0QF6yedC/KF44E2tZz3UFEen/8zXai2Cd4P+UZzHk4ED58N5WPlgfeMDmgdOBZ4 URcsSNPX/gni4C0Jw2Fd9p2Kb7yTgGc59FABGDEmngR2hBHEFIaNSFcrYZVeI94YgDPRDicZ3ygn OMxLyY3TSbj0QZojkPKa6TiORNj40IA8nhSQTuTDUgUENYJxMXvF4zAAQjXnXcQRAjMMKrtReziA rFxZJx38Ezkzt1nx1yPVLwBs304A0O3au0Wksyedblhrh6zT6a0GOXeUdfFugP37h3cZ8WIDJyE2 YVl8+Be+jcYFQIQOYNeERA4X/QgJJ8XyPOUdHIfOXqM+oTiT5lTy3GkQeQvjfRpAl17ajXUnYt22 ppNfBL7/+XduuvXwKeFXqwBeynwrG6Tah4bAiWwUNTMP+DHGnGSEjQBhODAWq42DVHqauOB1gJmD g+p+93PyYNIAJrWKqcxCmuPyAcho3UsWfMqk2IRPd/dUEl4Q8yfSYLcBXYdyjl51VRu0z0U0j+HV RDv+OX7ApLRZtXnZ7Z/auuJ73875qa/WosaW/vDSMeuiV8Qz059c9vBnH13xxHGeMbOc8N/vejfb nIup22gHwPr+cvKu/x7xgow2A9+B4ehiSbvml/TkdIETEcYPwLal4L9XXwSnAekfHS1vozgR/q7Z 9aIanjeoWYvnpenkKYwsR+Q3cnW4VcPQyNXX/Tpu1J/PZ3N/kcH7paLXpIMUTu33AKan92+0qls8 P/VDMe5R51y1YeVXrXyFbXHUGB0JOnclXUdVcU4PNsRY6yVfZR68BuRShkfJ8K+NMRoqpJpttKJJ 0qKoKO++9IoVkvFDeVYM/zhvk/6n30aPGFYbuebW9Vj7JB3tn6GQ78Tq3QDs2RMA1CGs1KrkAj9X SGfYW6k8s2Hsnds0VHPMwoX12LpV3ZO6jujp6OlXdfd+ZdGfD4fhmgyAOnaKMSMrFx5Tb4VjTJsY 0+xLsRVn7ItgTBsJK+eBv5bXEH5VmMocEWYgXI9wLIB6pNWQaSLBP7DXk7miYEyz745VfgEvM5Uz 4iovlnvluabjYAH7RgW8DeWjfnsvgKxc2dAwNLJ48S/2rbi9WI/tgnpcHxwRc/1AGDZKxUEP4J2x 6m2RDM+oi1cYrlduABgcHIoAnPKkWvvWhElTQa+II/cqQLmIownxeLQxEnjRlZkev7W5NOabY9tZ rsq9keUhvy3hzy7mLt8k1NJPsb4Rc21Lx3Jd7HgJoHyc/GTe63pTVOWv1ONrAP8HnXv5+VCzqmwA AACWZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBMQAC AAAAEQAAAFqHaQAEAAAAAQAAAGwAAAAAAAAASAAAAAEAAABIAAAAAUFkb2JlIEltYWdlUmVhZHkA AAADoAEAAwAAAAEAAQAAoAIABAAAAAEAAAA8oAMABAAAAAEAAAAZAAAAAAcgI+gAAAAldEVYdGRh dGU6Y3JlYXRlADIwMjQtMTItMTVUMDk6MjE6MTErMDA6MDDm9w0tAAAAJXRFWHRkYXRlOm1vZGlm eQAyMDI0LTEyLTE1VDA5OjIxOjExKzAwOjAwl6q1kQAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAy NC0xMi0xNVQwOToyMToxMSswMDowMMC/lE4AAAATdEVYdGV4aWY6Q29sb3JTcGFjZQAxLCCMM8Ni AAAAFXRFWHRleGlmOkV4aWZPZmZzZXQAMTA4LCDt5R1PAAAAGXRFWHRleGlmOlBpeGVsWERpbWVu c2lvbgA2MCwgoYmFBAAAABl0RVh0ZXhpZjpQaXhlbFlEaW1lbnNpb24AMjUsIJHbC1AAAAAedEVY dGV4aWY6U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkefmo5qwAAAASdEVYdHRpZmY6T3JpZW50YXRp b24AMber/DsAAAAQdEVYdHhtcDpDb2xvclNwYWNlADEFDsjRAAAAIHRFWHR4bXA6Q3JlYXRvclRv b2wAQWRvYmUgSW1hZ2VSZWFkeSr/T6AAAAAXdEVYdHhtcDpQaXhlbFhEaW1lbnNpb24AMjE2rgMn zQAAABZ0RVh0eG1wOlBpeGVsWURpbWVuc2lvbgAzMG6tL6oAAAAASUVORK5CYII="/></svg></span><span class=navbar-brand__name>표준프레임워크 개발가이드</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/egovframe-docs/egovframe-development/><span>개발환경(예정)</span></a></li><li class=nav-item><a class="nav-link active" href=/egovframe-docs/egovframe-runtime/><span>실행환경</span></a></li><li class=nav-item><a class=nav-link href=/egovframe-docs/runtime-example/><span>실행환경 예제</span></a></li><li class=nav-item><a class=nav-link href=/egovframe-docs/common-component/><span>공통컴포넌트(예정)</span></a></li><li class="td-light-dark-menu nav-item dropdown"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg><button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown data-bs-display=static aria-label="Toggle theme (auto)"><svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=bd-theme-text><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false><svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false><svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true><svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></li></ul></div><div class="d-none d-lg-block"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>이 섹션의 다중 페이지 출력 화면임.
<a href=# onclick="return print(),!1">여기를 클릭하여 프린트</a>.</p><p><a href=/egovframe-docs/egovframe-runtime/business-logic-layer/>이 페이지의 일반 화면으로 돌아가기</a>.</p></div><h1 class=title>업무처리</h1><div class=lead>업무처리 서비스는 업무 프로그램의 업무 로직을 담당하는 서비스로 업무 흐름제어, 에러 처리 등의 기능을 제공한다.</div><ul><li>1: <a href=#pg-a1ad28fd4b397c83068fbaec01ab2dc5>Exception Handling 서비스</a></li><li>2: <a href=#pg-637402e32c0a2ccb64cfc42125dd1e22>Spring Web Flow(SWF) 개요</a></li><li>3: <a href=#pg-e47afe394a87d2959da12eb7d17cbf43></a></li><li>4: <a href=#pg-2c6e14285bc4b60d61c98f1ba31eb80a>Spring Web Flow의 Hello World 예제</a></li><li>5: <a href=#pg-f8c907836117bbed3d73d0dbf344a9e0></a></li><li>6: <a href=#pg-ba17568ee434f0e939d30d26ceb6e3a5>Spring Web Flow 환경 설정</a></li><li>7: <a href=#pg-40147d8c31847866947057ef75910027>Spring Web Flow와 Spring MVC 연동</a></li><li>8: <a href=#pg-818d8526803f79a4976a65f1bc482a51>Spring Web Flow에서 보안 적용</a></li><li>9: <a href=#pg-6487bc980dc54970dd00c6723ba56f27>Flow가 관리하는 영속성(Flow Managed Persistence)</a></li><li>10: <a href=#pg-0a4da6ff9e481ff6260e0bb53f55d853></a></li><li>11: <a href=#pg-3918366007fbc6c95185b8b03b4c7c85>Flow 정의</a></li><li>12: <a href=#pg-2f738e9ce90749986712abe0ced22328>Web Flow에서 Expression Language (EL) 사용</a></li><li>13: <a href=#pg-ac904c0b2c7c163163c0370f938bf624>Spring Web Flow의 뷰(View) 보여주기</a></li><li>14: <a href=#pg-34033b7af9a64c3302d9433ec626766f>Action 실행</a></li><li>15: <a href=#pg-ec02c2174b3a681e22e139c6a7430d13>Flow 상속</a></li></ul><div class=content><h1 id=업무처리>업무처리</h1><p>업무처리 서비스는 업무 프로그램의 업무 로직을 담당하는 서비스로 업무 흐름제어, 에러 처리 등의 기능을 제공한다.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-a1ad28fd4b397c83068fbaec01ab2dc5>1 - Exception Handling 서비스</h1><div class=lead>전자정부 표준프레임워크 기반 시스템에서 Exception 처리는 AOP를 이용해 비즈니스 로직과 분리된 After throwing advice로 정의되며, Exception에 따른 적절한 대응을 목표로 한다. Exception 발생 시 클래스 정보와 종류는 후처리 로직 적용 여부를 결정하는 중요한 요소이다.</div><h1 id=exception-handling-서비스>Exception Handling 서비스</h1><h2 id=개요>개요</h2><p>전자정부 표준프레임워크 기반의 시스템 개발 시 Exception 처리, 정확히는 Exception별 특정 로직(후처리 로직이라고 부르기도 함)이 흐를 수 있도록 하여 Exception에 따른 적절한 대응이 가능하도록 하고자 하는데 목적이 있다.<br>AOP의 도움을 받아 비즈니스 POJO와 분리되어 After throwing advice로 정의하였다.<br>AOP 관련 내용은 <a href=../foundation-layer-core/aop.md>AOP 모듈</a>을 참조하길 바란다.</p><p>Exception에 대해 이야기 하겠다.<br>Exception 발생 시 Exception 발생 클래스 정보와 Exception 종류가 중요하다.<br>Exception 발생 클래스 정보와 Exception 종류는 모두 후처리 로직의 대상일지 아닐지를 결정하는 데 사용된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>CategoryVO</span> <span style=color:#000>selectCategory</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CategoryVO</span> <span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>CategoryVO</span> <span style=color:#000>resultVO</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>categoryDAO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>selectCategory</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>....</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 넘어온 resultVO가 null 인 경우 EgovBizException 발생 (result.nodata.msg는 메세지 키에 해당됨)
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>resultVO</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>throw</span> <span style=color:#000>processException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;result.nodata.msg&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> 
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic>// 또는 throw processException(&#34;result.nodata.msg&#34;, 발생한 Exception );
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=설명>설명</h2><p>앞에서 언급했던 Exception 후처리 방식과 Exception은 아니지만 후처리 로직(leaveaTrace)을 실행할 하는 방식에 대해 설명하도록 하겠다.<br>간략하게 보면 Exception 후처리 방식은 <strong>AOP(pointCut ⇒ after-throw) ⇒ ExceptionTransfer.transfer() ⇒ ExceptionHandlerService ⇒ Handler</strong> 순으로 실행된다.</p><p>LeavaTrace는 AOP를 이용하는 구조가 아니고 Exception을 발생하지도 않는다. 단지 후처리 로직을 실행하도록 하고자 함에 목적이 있다.<br>실행 순서는 <strong>LeavaTrace ⇒ TraceHandlerService ⇒ Handler</strong> 순으로 실행한다.</p><p>먼저 Exception Handling에 대해 알아보도록 하자.</p><h3 id=aop-config-exceptiontransfer-설정-및-설명>Aop Config, ExceptionTransfer 설정 및 설명</h3><h4 id=bean-설정>Bean 설정</h4><p>Exception 후처리와 leaveaTrace 설정을 위해서 샘플에서는 두 개의 xml 파일을 이용한다. (context-aspect.xml, context-common.xml)</p><p>먼저 Exception 후처리를 위한 부분을 보겠다.<br>Exception Handling을 위한 AOP 설정은 아래와 같다.<br>비즈니스 개발 시 패키지 구조는 바뀌기 때문에 Pointcut은 egov.sample.service.*Impl.*(..))을 수정하여 적용할 수 있다.<br>ExceptionTransfer의 property로 존재하는 exceptionHandlerService는 다수의 HandleManager를 등록 가능하도록 되어 있다.<br>여기서는 defaultExceptionHandleManager을 등록한 것을 볼 수 있다.</p><h5 id=context-aspectxml>context-aspect.xml</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;aop:config&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;aop:pointcut</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;serviceMethod&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;execution(* egov.sample.service.*Impl.*(..))&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;aop:aspect</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;exceptionTransfer&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;aop:after-throwing</span> <span style=color:#c4a000>throwing=</span><span style=color:#4e9a06>&#34;exception&#34;</span>
</span></span><span style=display:flex><span>				<span style=color:#c4a000>pointcut-ref=</span><span style=color:#4e9a06>&#34;serviceMethod&#34;</span> <span style=color:#c4a000>method=</span><span style=color:#4e9a06>&#34;transfer&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/aop:aspect&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/aop:config&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;exceptionTransfer&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cmmn.aspect.ExceptionTransfer&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;exceptionHandlerService&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;defaultExceptionHandleManager&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;defaultExceptionHandleManager&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cmmn.exception.manager.DefaultExceptionHandleManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;patterns&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>**service.*Impl<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;handlers&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;egovHandler&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;egovHandler&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cmmn.exception.handler.EgovServiceExceptionHandler&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>defaultExceptionHandleManager는 setPatterns(), setHandlers() 메소드를 가지고 있다. 상단과 같이 등록된 pattern 정보를 이용하여 Exception 발생 클래스와의 비교하여 ture인 경우 handlers에 등록된 handler를 실행한다.<br>패턴 검사 시 사용되는 pathMatcher는 AntPathMatcher를 이용하고 있다.</p><p>특정 pattern 그룹군을 만든후 patterns에 등록하고 그에 해당하는 후처리 로직을 정의하여 등록할 수 있는 구조이다.</p><h4 id=handler-구현체>Handler 구현체</h4><p>먼저 클래스에 대한 이해가 필요하다.<br>앞단에서 간단하게 설명했지만 다시 정리 하자면 Exception 발생 시 AOP pointcut “After-throwing”에 걸려 ExceptionTransfer 클래스의 transfer가 실행된다.<br>transfer 메소드는 ExceptionHandlerManager의 run 메소드를 실행한다.<br>아래는 구현 예로 DefaultExceptionHandleManager 코드이다.<br><strong>(구현 시 필수사항) 상위클래스는 AbsExceptionHandleManager 이고 인터페이스는 ExceptionHandlerService 이다.</strong><br>구현되는 메소드는 run(Exception exception)인 것을 확인할 수 있다.</p><h5 id=defaultexceptionhandlemanagerjava>DefaultExceptionHandleManager.java</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DefaultExceptionHandleManager</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbsExceptionHandleManager</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>ExceptionHandlerService</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>run</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>exception</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34; DefaultExceptionHandleManager.run() &#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// 매칭조건이 false 인 경우
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>enableMatcher</span><span style=color:#ce5c00;font-weight:700>())</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>pattern</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>patterns</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;pattern = &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>pattern</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;, thisPackageName = &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>thisPackageName</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;pm.match(pattern, thisPackageName) =&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>pm</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>match</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>pattern</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>thisPackageName</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>pm</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>match</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>pattern</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>thisPackageName</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ExceptionHandler</span> <span style=color:#000>eh</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>handlers</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>					<span style=color:#000>eh</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>occur</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>exception</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>getPackageName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>				<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>break</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=customizable-handler-등록>Customizable Handler 등록</h4><p>시나리오 : CustomizableHandler 클래스를 만들어 보고 sample 패키지에 있는 Helloworld 클래스 Exception 시에 CustomizableHandler를 실행한다.<br>먼저 CustomHandler 클래스를 아래와 같이 만든다.<br>ExceptionHandleManager 에서는 occur 메소드를 실행한다.<br><strong>Handler 구현체는 반드시 (필수사항) ExceptionHandler 인터페이스를 구현해야 한다.</strong></p><h5 id=customizablehandlerjava>CustomizableHandler.java</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>CustomizableHandler</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>ExceptionHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Log</span> <span style=color:#000>log</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LogFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLog</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>occur</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>packageName</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34; CustomHandler run...............&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34; CustomHandler 실행 ...  &#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>CustomizableHandler의 등록을 해보도록 하겠다.<br>여기서 주의해야 하는 부분은 patterns에 sample 패키지에 있는 Helloworld 클래스를 지정해주어야 한다는 것이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;exceptionTransfer&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cmmn.aspect.ExceptionTransfer&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;exceptionHandlerService&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;customizableExceptionHandleManager&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;customizableExceptionHandleManager&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cmmn.exception.manager.DefaultExceptionHandleManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;patterns&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>**sample.Helloworld<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;handlers&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;customizableHandler1&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;customizableHandler2&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;customizableHandler3&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;customizableHandler1&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;sample.CustomizableHandler&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;customizableHandler2&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;sample.CustomizableHandler&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;customizableHandler3&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;sample.CustomizableHandler&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>이런식으로 여러개의 Handler를 등록해줄 수 있다.</p><h3 id=leaveatrace-설정-및-설명>leaveaTrace 설정 및 설명</h3><p>Exception이거나 Exception이 아닌 경우에 Trace 후처리 로직을 실행시키고자 할 때 사용한다.<br>설정하는 기본적인 구조는 Exception 후처리하는 방식과 같다. 설정 파일은 context-common.xml 이다.<br>DefaultTraceHandleManager에 TraceHandler를 등록하는 형태로 설정된다.</p><h4 id=bean-설정-1>Bean 설정</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;leaveaTrace&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cmmn.trace.LeaveaTrace&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;traceHandlerServices&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;traceHandlerService&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;traceHandlerService&#34;</span> 	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cmmn.trace.manager.DefaultTraceHandleManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;patterns&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>*<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;handlers&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;defaultTraceHandler&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;antPathMatcher&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.util.AntPathMatcher&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;defaultTraceHandler&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.cmmn.trace.handler.DefaultTraceHandler&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h4 id=tracehandler-확장-개발-sample>TraceHandler 확장 개발 Sample</h4><h5 id=interface-tracehandler를-아래와-같이-implements-한다>Interface TraceHandler를 아래와 같이 implements 한다.</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>egovframework.rte.fdl.cmmn.trace.handler</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.apache.commons.logging.Log</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.apache.commons.logging.LogFactory</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DefaultTraceHandler</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>TraceHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>todo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Class</span> <span style=color:#000>clazz</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span> <span style=color:#000>message</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//수행하고자 하는 처리로직을 넣는 부분...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34; log ==&gt; DefaultTraceHandler run...............&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=leaveatrace-코드상-발생-sample>leaveaTrace 코드상 발생 Sample</h5><p>사용 방법을 다시 상기해보면 아래와 같다.<br>메세지 키(message.trace.msg)를 이용하여 메세지 정보를 넘겨 Handler를 실행한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>CategoryVO</span> <span style=color:#000>selectCategory</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CategoryVO</span> <span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>CategoryVO</span> <span style=color:#000>resultVO</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>categoryDAO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>selectCategory</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>vo</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>//강제로 발생한 ArithmeticException  
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ArithmeticException</span> <span style=color:#000>athex</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>//Exception을 발생하지 않고 후처리 로직 실행.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>leaveaTrace</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;message.trace.msg&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>resultVO</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li><a href="https://www.oreilly.com/radar/?page=1">exception-handling-framework-for-j2ee</a></li><li>Effective Java (Joshua Bloch) : Chapter 8 예외처리</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-637402e32c0a2ccb64cfc42125dd1e22>2 - Spring Web Flow(SWF) 개요</h1><div class=lead>Spring Web Flow는 웹 애플리케이션 내에서 논리적 페이지 흐름을 정의하고 수행하는 컴포넌트로, 단일 사용자의 대화를 비즈니스 프로세스와 함께 구현하여 안내한다. SWF는 Struts, Spring MVC 등과 통합되어 자족적인 페이지 흐름 엔진으로 작동하며, 선언적이고 관리하기 쉬운 방식으로 애플리케이션 흐름을 정의할 수 있다.</div><h1 id=spring-web-flow>Spring Web Flow</h1><h2 id=개요>개요</h2><p>Spring Web Flow(SWF)는 웹 애플리케이션 내 페이지 흐름(flow)의 정의와 수행에 집중하는 Spring 프레임워크 웹 스택의 컴포넌트이다.</p><p>시스템은 다른 위치에서 재사용될 수 있는 자족적 모듈처럼 웹 애플리케이션의 논리적 흐름(flow)을 획득하는 것을 허용한다.<br>이러한 흐름(flow)은 비즈니스 프로세스의 구현을 통해 단일 사용자를 안내하고 단일 사용자 대화를 표현한다.<br>흐름(flow)은 종종 HTTP 요청을 처리하고 상태를 가지며, 트랜잭션 특성을 보이고 동적이고/이거나 장시간 구동될 수 있다.</p><p>Spring Web Flow는 추상화의 좀 더 높은 레벨에 존재하고 Struts, Spring MVC, Portlet MVC, 그리고 JSF와 같은 기본 프레임워크 내에서 자족적인 페이지 흐름(flow) 엔진(page flow engine)처럼 통합된다.<br>SWF는 선언적이고 높은 이식성을 가지며 뛰어난 관리능력을 가지는 형태로 명시적으로 애플리케이션의 페이지 흐름(flow)을 획득하는 기능을 제공한다.</p><h2 id=설명>설명</h2><p>Spring Web Flow는 여타의 API에 대한 몇 가지 요구 의존성을 가진 자족적인 page flow engine처럼 구조화되었다. 모든 의존성은 주의 깊게 관리된다.</p><p>대부분의 사용자들은 좀 더 큰 웹 애플리케이션 개발 프레임워크 내 컴포넌트로 SWF를 끼워 넣을 것이다.<br>SWF는 요청 맵핑과 응답 표현을 다루기 위한 호출 시스템을 기대하는 컨트롤러 기술에 집중한다.<br>이 경우, 이러한 사용자는 환경을 위한 가는(thin) 통합 조각에 의존할 것이다.<br>예를 들어, Servlet 내 수행 흐름(flow)은 SWF에 대한 요청에 대한 할당(dispatch)과 SWF view 선택을 책임지는 표현을 다루는 Spring MVC 통합을 사용한다.<br></p><p>Spring과 마찬가지로, Spring Web Flow는 필요한 부분만 선택적으로 사용할 수 있는 계층화된(layered) 프레임워크로 패키징되어 있다.<br>SWF의 중요한 이득은 어떤 환경에서도 수행될 수 있는 자족적인 컨트롤러의 모듈을 재사용하여 정의할 수 있도록 하는 것이다.</p><p>구체적인 내용을 살펴보기 전에 Hello World를 실행해 보자.</p><ul><li><a href=./getting-started.md>Hello world</a></li></ul><p>Spring Web Flow의 기본 샘플로 Spring Source에서는 Hotel Booking 을 제공하고 있다.<br>우리는 Spring Web Flow 레퍼런스 문서를 기준으로 하고 샘플인 Hotel Booking 을 참고하는 형태로 설명하도록 하겠다.</p><p>Hotel Booking 샘플 데모 : 🌏 <a href=https://web.archive.org/web/20110615224534/http://richweb.springframework.org/swf-booking-faces/spring/intro>http://richweb.springframework.org/swf-booking-faces/spring/intro</a></p><h3 id=swf-configuration>SWF Configuration</h3><ul><li><a href=./setting-system.md>SWF 시스템 설정</a></li><li><a href=./with-spring-mvc.md>Spring Web Flow 와 MVC 연동</a></li><li><a href=./securing-flows.md>Securing Flows</a></li><li><a href=./flow-managed-persistence.md>Flow Managed Persistence</a></li></ul><h3 id=swf>SWF</h3><ul><li><a href=./setting-system.md>Getting Started -Hello world</a></li><li><a href=./flow-definiton.md>Flow Definition</a></li><li><a href=./expression-language.md>Expression Language</a></li><li><a href=./rendering-views.md>Rendering Views</a></li><li><a href=./executing_actions.md>Executing actions</a></li><li><a href=./flow-inheritance.md>Flow Inheritance</a></li></ul><h2 id=참고-자료>참고 자료</h2><ul><li>🌏 <a href=https://docs.spring.io/spring-webflow/docs/2.3.x/reference/html/index.html>Spring Web Flow reference 2.3.x</a></li><li>🌏 <a href=https://web.archive.org/web/20060619222620/http://openframework.or.kr:80/framework_reference/spring-webflow/1.0RC1/html/introduction.html>openframework swf 소개</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-e47afe394a87d2959da12eb7d17cbf43>3 -</h1></div><div class=td-content style=page-break-before:always><h1 id=pg-2c6e14285bc4b60d61c98f1ba31eb80a>4 - Spring Web Flow의 Hello World 예제</h1><div class=lead>Spring Web Flow는 사용자와 서버 간의 대화 형식으로 화면 이동을 정의하며, &ldquo;Hello, Web Flow&rdquo; 화면을 호출하는 간단한 예제와 입력값을 받아 처리하는 예제로 나뉜다. 이 예제를 통해 SWF가 웹 대화형 시나리오에 어떻게 적용되는지 살펴본다.</div><h1 id=hello-world>Hello, World</h1><h2 id=개요>개요</h2><p>처음으로 접하므로 여기서는 Hello World를 찍어 보면서 실행하는 것을 살펴보도록 하겠다.<br>Hello World는 두 가지 버전으로 입력되는 값이 없이 단지 Hello, Web Flow 화면을 호출하는 것과 입력값을 가지고 분기 처리 등 서비스 메소드를 실행 후 결과를 화면으로 보여주는 버젼으로 나누어 설명하겠다. 실행하여 보고자 하는 화면 결과는 아래와 같다.</p><p><img src=../images/helloflow.jpg alt=helloflow></p><h2 id=설명>설명</h2><p>Spring Web Flow는 사용자와 Service를 제공하는 서버 간의 대화하듯한 화면의 이동을 정의하는 것이다.<br>SWF(Spring Web Flow)는 사용자와 화면 간의 대화 형태로 웹 대화형 시나리오를 중심으로 접근한다.</p><p><img src=../images/swfhelloworldcreate.jpg alt=swfhelloworldcreate></p><h2 id=webxml>web.xml</h2><p>webContent/WEB-INF 아래 web.xml을 아래와 같이 작성한다.<br>contextConfigLocation의 값으로 /WEB-INF/config/web-application-config.xml을 설정한다.<br>servlet으로 org.springframework.web.servlet.DispatcherServlet를 등록하고 /spring/* URL 정보를 매핑해준다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;web-app</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://java.sun.com/xml/ns/j2ee&#34;</span> <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>version=</span><span style=color:#4e9a06>&#34;2.4&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- Spring Web 어플리케이션을 위한 메인 설정파일을 등록한다. --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;context-param&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>contextConfigLocation<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>
</span></span><span style=display:flex><span>			/WEB-INF/config/web-application-config.xml
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/context-param&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- Spring Web 어플리케이션 컨테스트를 로딩한다. --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;listener&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span style=color:#204a87;font-weight:700>&lt;/listener-class&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/listener&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- Spring Web 어플리케이션의 맨 앞단 Controller(DispatcherServlet) 를 등록한다. --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>Spring MVC Dispatcher Servlet<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span style=color:#204a87;font-weight:700>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;init-param&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>contextConfigLocation<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;param-value&gt;&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/init-param&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;load-on-startup&gt;</span>0<span style=color:#204a87;font-weight:700>&lt;/load-on-startup&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/servlet&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- 모든 spring 요청에 대한되는 request를 DispatcherServlet 와 매핑하여 처리 할 수 있도록 한다. --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;servlet-mapping&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>Spring MVC Dispatcher Servlet<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;url-pattern&gt;</span>/spring/*<span style=color:#204a87;font-weight:700>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/servlet-mapping&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;welcome-file-list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;welcome-file&gt;</span>index.html<span style=color:#204a87;font-weight:700>&lt;/welcome-file&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/welcome-file-list&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/web-app&gt;</span>
</span></span></code></pre></div><h3 id=web-application-configxml>web-application-config.xml</h3><p>Spring MVC와 Spring Web Flow를 위한 설정 파일은 아래와 같다.</p><p><img src=../images/hellowebconfig.jpg alt=hellowebconfig></p><p>먼저 web-application-config.xml를 살펴보겠다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>xml</span> <span style=color:#000>version</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;1.0&#34;</span> <span style=color:#000>encoding</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#ce5c00;font-weight:700>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>beans</span> <span style=color:#000>xmlns</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#000>xmlns</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>xsi</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#000>xmlns</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#000>xsi</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>schemaLocation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>           http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>           http://www.springframework.org/schema/context
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>           http://www.springframework.org/schema/context/spring-context-2.5.xsd&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span> <span style=color:#000>어플리케이션</span> <span style=color:#000>소스를</span> <span style=color:#000>스캔하여</span> <span style=color:#000>로딩</span> <span style=color:#000>하도록</span> <span style=color:#000>한다</span><span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>component</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>scan</span> <span style=color:#000>base</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>package</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.egovframe.swf.sample.service&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span> <span style=color:#000>편의를</span> <span style=color:#000>위하여</span> <span style=color:#000>Spring</span> <span style=color:#000>MVC</span> <span style=color:#000>설정과</span> <span style=color:#000>Spring</span> <span style=color:#000>Web</span> <span style=color:#000>Flow</span> <span style=color:#000>를</span> <span style=color:#000>위한</span> <span style=color:#000>설정을</span> <span style=color:#000>별도록</span> <span style=color:#000>분리하여</span> <span style=color:#000>가져오도록</span> <span style=color:#000>한다</span><span style=color:#ce5c00;font-weight:700>.--&gt;</span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>resource</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;webmvc-config.xml&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>resource</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;webflow-config.xml&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>beans</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span></code></pre></div><h4 id=webmvc-configxml>webmvc-config.xml</h4><p>Spring MVC를 위한 설정 파일</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>xml</span> <span style=color:#000>version</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;1.0&#34;</span> <span style=color:#000>encoding</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#ce5c00;font-weight:700>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>beans</span> <span style=color:#000>xmlns</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#000>xmlns</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>xsi</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#000>xsi</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>schemaLocation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>           http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span>
</span></span><span style=display:flex><span>	  <span style=color:#000>flowRegistry에</span> <span style=color:#000>등록된</span> <span style=color:#000>flow와</span> <span style=color:#000>요청되는</span> <span style=color:#000>path와</span> <span style=color:#000>매핑해주는</span> <span style=color:#000>역할을</span> <span style=color:#000>수행한다</span><span style=color:#ce5c00;font-weight:700>.</span> 
</span></span><span style=display:flex><span>		<span style=color:#000>예제에선</span> <span style=color:#000>요청되는</span> <span style=color:#ce5c00;font-weight:700>.../</span><span style=color:#000>swfHelloWorld</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>spring</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>sample</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hello</span>  <span style=color:#000>URL</span> <span style=color:#000>정보를</span> <span style=color:#000>이용하여</span> <span style=color:#000>flow</span> <span style=color:#000>내에서</span> <span style=color:#000>sample</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hello</span> <span style=color:#000>ID로</span> <span style=color:#000>찾음</span><span style=color:#ce5c00;font-weight:700>.</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>bean</span> <span style=color:#000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.mvc.servlet.FlowHandlerMapping&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>property</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;order&#34;</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;0&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>property</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;flowRegistry&#34;</span> <span style=color:#000>ref</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;flowRegistry&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>bean</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>bean</span>
</span></span><span style=display:flex><span>		<span style=color:#000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>property</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;order&#34;</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;1&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>property</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;defaultHandler&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		  <span style=color:#ce5c00;font-weight:700>&lt;!--</span> <span style=color:#000>UrlFilenameViewController</span> <span style=color:#000>는</span> <span style=color:#000>spring</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>start</span> <span style=color:#000>으로</span> <span style=color:#000>접근하는</span> <span style=color:#000>path</span> <span style=color:#000>정보를</span> <span style=color:#000>이용하여</span> 
</span></span><span style=display:flex><span>		   <span style=color:#000>View</span> <span style=color:#000>이름을</span> <span style=color:#000>추출하여</span> <span style=color:#000>View를</span> <span style=color:#000>반환하게</span> <span style=color:#000>된다</span><span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#000>여기서는</span> <span style=color:#000>tiles의</span> <span style=color:#000>view를</span> <span style=color:#000>반환하게</span> <span style=color:#000>된다</span><span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>bean</span> <span style=color:#000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.UrlFilenameViewController&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>property</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>bean</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span>
</span></span><span style=display:flex><span>	  <span style=color:#000>Controller에</span> <span style=color:#000>의해</span> <span style=color:#000>반환된</span> <span style=color:#000>View</span> <span style=color:#000>명을</span> <span style=color:#000>tiles로</span> <span style=color:#000>보내</span> <span style=color:#000>tiles에</span> <span style=color:#000>미리</span> <span style=color:#000>정의된</span> <span style=color:#000>화면을</span> <span style=color:#000>보여주도록</span> <span style=color:#000>한다</span><span style=color:#ce5c00;font-weight:700>.</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>bean</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tilesViewResolver&#34;</span> <span style=color:#000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.springframework.js.ajax.AjaxUrlBasedViewResolver&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>property</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewClass&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.mvc.view.FlowAjaxTilesView&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>bean</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span> <span style=color:#000>tiles</span> <span style=color:#000>설정</span> <span style=color:#000>정보를</span> <span style=color:#000>정의한다</span><span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>bean</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tilesConfigurer&#34;</span> <span style=color:#000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.tiles2.TilesConfigurer&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>property</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;definitions&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;/</span><span style=color:#000>WEB</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>INF</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>layouts</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>layouts</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>xml</span><span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;/</span><span style=color:#000>WEB</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>INF</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>views</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>xml</span><span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;/</span><span style=color:#000>WEB</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>INF</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>sample</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>views</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>xml</span><span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;/</span><span style=color:#000>WEB</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>INF</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>sample</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hello</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>views</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>xml</span><span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>property</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>bean</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span> <span style=color:#000>Dispatches</span> <span style=color:#000>requests</span> <span style=color:#000>mapped</span> <span style=color:#000>to</span> <span style=color:#000>POJO</span> <span style=color:#5c35cc;font-weight:700>@Controllers</span> <span style=color:#000>implementations</span><span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>bean</span> <span style=color:#000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Dispatches</span> <span style=color:#000>requests</span> <span style=color:#000>mapped</span> <span style=color:#000>to</span>
</span></span><span style=display:flex><span>		<span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>web</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>servlet</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>mvc</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>Controller</span> <span style=color:#000>implementations</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>bean</span> <span style=color:#000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span>
</span></span><span style=display:flex><span>		<span style=color:#000>requests에</span> <span style=color:#000>맞는</span> <span style=color:#000>등록된</span> <span style=color:#000>FlowHandler</span> <span style=color:#000>구현부를</span> <span style=color:#000>연결해준다</span><span style=color:#ce5c00;font-weight:700>.</span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>bean</span> <span style=color:#000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.mvc.servlet.FlowHandlerAdapter&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>property</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;flowExecutor&#34;</span> <span style=color:#000>ref</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;flowExecutor&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>bean</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span> <span style=color:#000>Custom</span> <span style=color:#000>FlowHandler</span> <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>the</span> <span style=color:#000>hello</span> <span style=color:#000>flow</span><span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>bean</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sample/hello&#34;</span> <span style=color:#000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.egovframe.web.HelloFlowHandler&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>beans</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span></code></pre></div><h4 id=webflow-configxml>webflow-config.xml</h4><p>Web Flow 관련된 설정 파일</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>xml</span> <span style=color:#000>version</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;1.0&#34;</span> <span style=color:#000>encoding</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#ce5c00;font-weight:700>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>beans</span> <span style=color:#000>xmlns</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#000>xmlns</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>xsi</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style=color:#000>xmlns</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>webflow</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow-config&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#000>xsi</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>schemaLocation</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>           http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>           http://www.springframework.org/schema/webflow-config
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>           http://www.springframework.org/schema/webflow-config/spring-webflow-config-2.0.xsd&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>webflow</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>flow</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>executor</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;flowExecutor&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span> <span style=color:#000>flow</span> <span style=color:#000>를</span> <span style=color:#000>정의한</span> <span style=color:#000>파일을</span> <span style=color:#000>가져와</span> <span style=color:#000>flow</span> <span style=color:#000>registry</span> <span style=color:#000>구성한다</span><span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>webflow</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>flow</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>registry</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;flowRegistry&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#000>flow</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>services</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;flowBuilderServices&#34;</span> <span style=color:#000>base</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/WEB-INF&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>webflow</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>flow</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>location</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>pattern</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/**/*-flow.xml&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>webflow</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>flow</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span> <span style=color:#000>Web</span> <span style=color:#000>Flow</span> <span style=color:#000>views</span> <span style=color:#000>에</span>  <span style=color:#000>커스터마이징</span> <span style=color:#000>할</span> <span style=color:#000>수</span> <span style=color:#000>있도록</span> <span style=color:#000>확장하여</span> <span style=color:#000>사용한다</span><span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>webflow</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>flow</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>services</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;flowBuilderServices&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#000>view</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>factory</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>creator</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;mvcViewFactoryCreator&#34;</span> <span style=color:#000>conversion</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>service</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;conversionService&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#000>development</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;true&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;!--</span> <span style=color:#000>Web</span> <span style=color:#000>Flow</span> <span style=color:#000>에서</span>  <span style=color:#000>tiles</span> <span style=color:#000>를</span> <span style=color:#000>사용할</span> <span style=color:#000>수</span> <span style=color:#000>있도록</span> <span style=color:#000>설정한다</span><span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#ce5c00;font-weight:700>--&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>bean</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;mvcViewFactoryCreator&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.mvc.builder.MvcViewFactoryCreator&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>property</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewResolvers&#34;</span> <span style=color:#000>ref</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tilesViewResolver&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>bean</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>beans</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>상세 : <a href=./setting_system.md>Web Flow views 에 커스터마이징 할 수 있도록 확장하여 사용한다</a></p><h4 id=tiles>tiles</h4><p>URL : http://localhost:8080/swfHelloWorld 으로 처음 접근할 때 index.html 파일이 열리게 된다.</p><p><strong>index.html</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>http-equiv</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Refresh&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;0; URL=spring/start&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위에서 보는 것처럼 “spring/start” URL을 호출한다.<br><strong>spring/start</strong> 에 해당하는 화면은 먼저 설정된 tiles 설정 정보에서 찾는다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>tiles</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>definitions</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>definition</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;start&#34;</span> <span style=color:#204a87;font-weight:700>extends</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;standardLayout&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>put</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>attribute</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;body&#34;</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/WEB-INF/main.jsp&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>definition</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>tiles</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>definitions</span><span style=color:#ce5c00;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>tiles 관련된 것은 <a href=http://tiles.apache.org/>http://tiles.apache.org/</a>를 참조하시길 바랍니다.<br>등록된 tiles 설정 파일은 앞 설정에서 나왔다. 다시 보면</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- tiles 설정 정보를 정의한다. --&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;tilesConfigurer&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.tiles2.TilesConfigurer&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;definitions&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>/WEB-INF/layouts/layouts.xml<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>/WEB-INF/views.xml<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>/WEB-INF/sample/views.xml<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>/WEB-INF/sample/hello/views.xml<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span> 
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h3 id=hello-web-flow>Hello, Web Flow</h3><p>다시 돌아와서 Hello , Web Flow 를 화면에 찍어 보도록 하겠다.<br>Web Flow로 해당 화면의 흐름을 작성한 예를 보자.<br></p><p>hello-flow.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>	http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;say&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;helloworld&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;helloworld&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;return&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;return&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;return&#34;</span>	<span style=color:#c4a000>view=</span><span style=color:#4e9a06>&#34;externalRedirect:servletRelative:/start&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span></code></pre></div><p>자세한 설명은 <a href=./flow_definition.md>flow 정의</a>에서 다루고 있다.<br>간단하게 보면 view-state, end-state로 나눠져 있는 것을 볼 수 있다. 처음으로 존재하는 view-state는 시작점이라고 생각해도 무방하다. 또한 문자 그대로 end-state는 마지막점이다. hello 화면이 맨 처음 나오고 거기서 helloworld 화면이 보이고 다음은 return이라는 마지막 실행을 하는 것이다.<br>view-state 안쪽의 transition는 화면에서 클릭하여 이동하게 하는 버튼의 실행이라고 할 수 있다. 여기선 say를 눌러서 실행하면 helloworld 라는 view-state로 이동하는 것이다. 마찬가지로 return을 누르면 externalRedirect:servletRelative:/start으로 이동하는 것이다.</p><ul><li>참조 : <a href=./with_spring_mvc.md>externalRedirect, servletRelative</a></li></ul><p>view-state에서 별도의 view를 정의하지 않은 경우 id를 가지고 view를 가져오게 된다. 여기서는 hello 라는 id가 곧 view 명이 되게 된다.<br>default는 flow.xml과 같은 디렉토리에 있는 화면소스(JSP, xhtml, 등)을 찾게 된다. 여기선 tiles로 정의된 부분을 참조한다.<br>…/hello/views.xml 파일 내용을 살펴보면,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;definition</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hello&#34;</span> <span style=color:#c4a000>extends=</span><span style=color:#4e9a06>&#34;standardLayout&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;put-attribute</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;body&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;/WEB-INF/sample/hello/hello.jsp&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/definition&gt;</span> 
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>로 화면에 해당되는 hello.jsp 를 가져오는 것을 확인할 수 있다.</p><p>그렇다면 transition은 화면에서 발생한 이벤트와 매핑을 할까? hello.jsp 소스를 잠시 보겠다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#a40000>&lt;</span>%@ taglib prefix=&#34;form&#34; uri=&#34;http://www.springframework.org/tags/form&#34;%&gt;
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html PUBLIC &#34;-//W3C//DTD XHTML 1.0 Transitional//EN&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;head&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;title&gt;</span>Welcome to Spring Web Flow<span style=color:#204a87;font-weight:700>&lt;/title&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/head&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;body&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;h1&gt;</span>Welcome to Spring Web Flow<span style=color:#204a87;font-weight:700>&lt;/h1&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;form:form</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;start&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;_eventId_say&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;Click to say hello!&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/form:form&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/body&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/html&gt;</span>
</span></span></code></pre></div><p><img src=../images/hello1-1page.jpg alt=hello1-1page.jpg></p><p>보는 바와 같이 form으로 둘러싸인 곳에 해답은 있다. &lt;input type=“submit” name=“_eventId_say” …. /> 에서 name 을 보면 <strong>_eventId_say</strong>로 답을 찾을 수 있다.<br>_eventId가 답이다. say는 transition의 on과 같음을 확인할 수 있다. eventId 에 정의된 특정 위치의 문자열을 가지고 transition을 분석하다.
transition에 대한 내용은 flow 정의에서 자세히 살펴보길 바란다. eventId 가 “say”를 가지고 form 이 전달되면 <a href=./flow_definition.md>flow 정의</a> flow 정의에 따라 transition을 찾고 그에 맞는 state로 넘어가게 된다.<br>결과는 별로의 값을 가지고 보여주는 화면은 아니고 단지 아래와 같은 화면을 보여주도록 되어 있다.</p><p><img src=../images/hello1-2page.jpg alt=jhello1-2page.jpg></p><p>다음은 입력값이 있는 예를 살펴 보도록 하겠다.</p><h3 id=hello-web-flow-with-input-value>Hello, Web Flow with input value</h3><p>먼저 flow 정의 파일인 hello2-flow.xml 을 보도록 하자.
실행 시나리오는 on-start ⇒ view-state ⇒ action-state ⇒ decision-stat ⇒ end-state 이다.</p><p><strong>hello2-flow.xml</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>	http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-start&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;helloService.sayMessage()&#34;</span> <span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.message&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-start&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;hello2&#34;</span> <span style=color:#c4a000>model=</span><span style=color:#4e9a06>&#34;message&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binder&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;str&#34;</span> <span style=color:#c4a000>required=</span><span style=color:#4e9a06>&#34;true&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/binder&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;proceed&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;actionHello&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;return&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;return&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;action-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;actionHello&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;helloService.addHello(message)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;yes&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;moreDecision&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;no&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;hello&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/action-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;decision-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;moreDecision&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;if</span> <span style=color:#c4a000>test=</span><span style=color:#4e9a06>&#34;helloService.getDecision(message)&#34;</span> <span style=color:#c4a000>then=</span><span style=color:#4e9a06>&#34;helloworld2&#34;</span> <span style=color:#c4a000>else=</span><span style=color:#4e9a06>&#34;return&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/decision-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;helloworld2&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;return&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;return&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;return&#34;</span>	<span style=color:#c4a000>view=</span><span style=color:#4e9a06>&#34;externalRedirect:servletRelative:/start&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/xml&gt;</span>
</span></span></code></pre></div><p>보여 주고자 하는 것은 hello2 화면(view-state)에서 입력 데이터를 객체에 바인딩하고, helloService 서비스 객체를 통해 addHello 메소드 실행, 그 후 결과에 따라 분기문(decision-state)을 통과하여 helloworld2 화면으로 가는 것이다.<br>간략하게 설명하면, on-start는 flow를 처음 실행할 때 선행하여 실행된다. 여기서는 helloService의 sayMessage를 실행하여 flowScope 내의 message 객체로 저장한다.</p><p><strong>HelloService .java</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Service</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;helloService&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloService</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>Iservice</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Message</span> <span style=color:#000>sayMessage</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Message</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>flow가 시작할 때 첫 번째로 만나는 view-state는 시작점으로 인식한다. 따라서 view-state “hello2”는 시작점에 해당한다.<br>hello2.jsp 를 화면에 보여주는데 앞단의 예제와 같다. Spring MVC의 tiles를 이용하여 보여주게 된다.</p><p><strong>views.xml</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;definition</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hello2&#34;</span> <span style=color:#c4a000>extends=</span><span style=color:#4e9a06>&#34;standardLayout&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;put-attribute</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;body&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;inhello2.body&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/definition&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;definition</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;inhello2.body&#34;</span> <span style=color:#c4a000>template=</span><span style=color:#4e9a06>&#34;/WEB-INF/sample/hello2/main.jsp&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;put-attribute</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;helloSection&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;/WEB-INF/sample/hello2/hello.jsp&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/definition&gt;</span> 
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p><strong>hello.jsp</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;form:form</span> <span style=color:#c4a000>method=</span><span style=color:#4e9a06>&#34;post&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;p&gt;</span>
</span></span><span style=display:flex><span>       to Who : <span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;text&#34;</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;str&#34;</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;str&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34; World ~*&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;script</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;text/javascript&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>					Spring.addDecoration(new Spring.ElementDecoration({
</span></span><span style=display:flex><span>						elementId : &#34;str&#34;,
</span></span><span style=display:flex><span>						widgetType : &#34;dijit.form.ValidationTextBox&#34;,
</span></span><span style=display:flex><span>						widgetAttrs : { promptMessage : &#34;for who ? &#34;, required : true }}));
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;/script&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;br&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/p&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;proceed&#34;</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;button&#34;</span> 
</span></span><span style=display:flex><span>      <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;_eventId_proceed&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;say&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;script</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;text/javascript&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      Spring.addDecoration(new Spring.ValidateAllDecoration({elementId:&#39;proceed&#39;, event:&#39;onclick&#39;}));
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;/script&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;button&#34;</span> 
</span></span><span style=display:flex><span>      <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;_eventId_return&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;index&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/form:form&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>상단의 화면은 아래 hello2-flow.xml 내의 view-state와 매핑된다.<br>여기서 봐야 할 부분은 화면 내의 str 이름의 input 데이터를 message라는 객체로 바인딩하는 부분인다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;hello2&#34;</span> <span style=color:#c4a000>model=</span><span style=color:#4e9a06>&#34;message&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binder&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;str&#34;</span> <span style=color:#c4a000>required=</span><span style=color:#4e9a06>&#34;true&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/binder&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;proceed&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;actionHello&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;return&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;return&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>이벤트에 해당하는 proceed 버튼을 클리하면 다음 state로 이동하게 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;proceed&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;actionHello&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span> 
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>actionHello은 아래와 같다. 하는 기능은 helloService 객체의 addHello 메소드 호출이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;action-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;actionHello&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;helloService.addHello(message)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;yes&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;moreDecision&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;no&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;hello&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/action-state&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>addHello 메소드는 아래와 같다. 반환되는 값이 boolean인 것을 주목할 필요가 있다. 리턴되는 boolean 값은 transition의 yes, no 와 매핑된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>addHello</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Message</span> <span style=color:#000>msg</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>msg</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setStr</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Hello,&#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>msg</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStr</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><p>다음 나오는 decision-state는 아래와 같이 분기문의 기능을 수행한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;decision-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;moreDecision&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;if</span> <span style=color:#c4a000>test=</span><span style=color:#4e9a06>&#34;helloService.getDecision(message)&#34;</span> <span style=color:#c4a000>then=</span><span style=color:#4e9a06>&#34;helloworld2&#34;</span> <span style=color:#c4a000>else=</span><span style=color:#4e9a06>&#34;return&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/decision-state&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>helloworld2 화면으로 이동하게 되면 아래와 같은 jsp 소스를 확인할 수 있다. message 객체의 str 값을 EL 을 이용하여 ${message.str} 으로 보여주고 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#a40000>&lt;</span>%@ taglib prefix=&#34;form&#34;   
</span></span><span style=display:flex><span>    uri=&#34;http://www.springframework.org/tags/form&#34; %&gt;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;h2&gt;</span>Hello Message?<span style=color:#204a87;font-weight:700>&lt;/h2&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;form:form&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;b&gt;</span>Step two :<span style=color:#204a87;font-weight:700>&lt;/b&gt;</span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;fieldset&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;div</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;field&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;div</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;label&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>&lt;label&gt;</span>${message.str}<span style=color:#204a87;font-weight:700>&lt;/label&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/div&gt;</span>		
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/div&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;div</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;buttonGroup&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			  <span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;button&#34;</span>  <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;_eventId_return&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;index&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/div&gt;</span>	
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/fieldset&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/form:form&gt;</span>
</span></span></code></pre></div><p>화면을 다시 보면</p><p><img src=../images/hello1-1page.jpg alt=hello1-1page.jpg></p><p>say 버튼을 누르면,</p><p><img src=../images/hello1-1page.jpg alt=hello1-1page.jpg></p><p>Hello , 뒤에 넣었던 문장이 붙어서 나오게 된다.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-f8c907836117bbed3d73d0dbf344a9e0>5 -</h1></div><div class=td-content style=page-break-before:always><h1 id=pg-ba17568ee434f0e939d30d26ceb6e3a5>6 - Spring Web Flow 환경 설정</h1><div class=lead>Spring Web Flow를 사용하기 위해서는 Flow 정의를 위한 XML 문서를 작성하고, FlowRegistry와 FlowExecutor를 설정해야 한다. FlowRegistry는 flow XML을 가져오는 역할을, FlowExecutor는 이를 실행하는 역할을 담당한다.</div><h1 id=spring-web-flow-환경-구성하기>Spring Web Flow 환경 구성하기</h1><p>Spring Web Flow를 사용하기 위한 Web 개발 환경에 대한 세팅을 설명한다.</p><h2 id=설정>설정</h2><p>Spring Web Flow의 Flow 정의를 위한 XML 문서는 아래와 같은 Schema를 갖는다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style=color:#c4a000>xmlns:webflow=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow-config&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>http://www.springframework.org/schema/webflow-config
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>http://www.springframework.org/schema/webflow-config/spring-webflow-config-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- Setup Web Flow here --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><h3 id=기본적인-설정>기본적인 설정</h3><p>Spring Web Flow를 사용하려면 FlowRegistry FlowExecutor를 설정해야 한다.</p><p>FlowRegistry는 등록될 시나리오에 따라 작성된 flow xml 을 가져오는 역할[1]을 수행한다.
FlowExecutor는 등록된 flow 설정 xml을 실행[2]한다. 차후 Spring MVC 와 결합하여 Web Flow 시스템이 실행되는 부분에 대해 다루겠다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [1] Flow 설정 파일 등록--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-registry</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowRegistry&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;webflow:flow-location</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/WEB-INF/flows/booking/booking.xml&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/webflow:flow-registry&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [2] Flow 실행의 중추 역할을 하는 서비스 제공--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-executor</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowExecutor&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h3 id=flow-registry-옵션>flow-registry 옵션</h3><p>flow-registry는 아래 보는 것과 같이 설정할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [1]기본은 이름-flow.xml이지만, 직접 지정할 수도 있다. --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-location</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/WEB-INF/flows/booking/booking.xml&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [2]id로 식별이 가능하도록 할 수도 있다 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-location</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/WEB-INF/flows/booking/booking.xml&#34;</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookHotel&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [3]메타 정보도 등록할 수 있다. --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-location</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/WEB-INF/flows/booking/booking.xml&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;flow-definition-attributes&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;attribute</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;caption&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;Books a hotel&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/flow-definition-attributes&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/webflow:flow-location&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [4]ANT 패턴을 지정할 수도 있다. --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-location-pattern</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;/WEB-INF/flows/**/*-flow.xml&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	[5]기본 앞 첨자 경로를 지정해서 위치를 조합해서 사용할 수도 있다. 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	    Flow 정의 파일은 모듈화를 높이기 위해서 관련 있는 폴더에 각각 위치해 있는게 가장 좋다.	--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-registry</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowRegistry&#34;</span> <span style=color:#c4a000>base-path=</span><span style=color:#4e9a06>&#34;/WEB-INF&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;webflow:flow-location</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/hotels/booking/booking.xml&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/webflow:flow-registry&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [6]Flow 상속 구조 구성 가능 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- my-system-config.xml --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-registry</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowRegistry&#34;</span> <span style=color:#c4a000>parent=</span><span style=color:#4e9a06>&#34;sharedFlowRegistry&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;webflow:flow-location</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/WEB-INF/flows/booking/booking.xml&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/webflow:flow-registry&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- shared-config.xml --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-registry</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;sharedFlowRegistry&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- Global flows shared by several applications --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/webflow:flow-registry&gt;</span>
</span></span></code></pre></div><h3 id=커스텀-flowbuilder-서비스-설정>커스텀 FlowBuilder 서비스 설정</h3><p>flow-registry는 아래 보는 것과 같이 설정할 수 있다.</p><p>flow-registry에서 flow-builder-services는 flow를 구축하는 데 사용되는 서비스나 설정 등을 커스터마이징할 수 있다.
지정하지 않는 경우에는 기본 서비스가 사용된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-registry</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowRegistry&#34;</span> 	<span style=color:#c4a000>flow-builder-services=</span><span style=color:#4e9a06>&#34;flowBuilderServices&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;webflow:flow-location</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/WEB-INF/flows/booking/booking.xml&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/webflow:flow-registry&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-builder-services</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowBuilderServices&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h4 id=구성-가능한-서비스>구성 가능한 서비스</h4><h5 id=conversion-service>conversion-service</h5><p>SWF 시스템에서 사용하는 ConversionService를 커스터마이징. Flow 실행 동안에 필요한 경우 특정 타입을 다른 타입으로 변환해 줌(propertyEditor 성격)</p><h5 id=expression-parser>expression-parser</h5><p>ExpressionParser 커스터마이징하는데 사용. 기본은 Unified EL이 사용되며, 사용하는 영역은 classpath 이다. 다른 ExpressionParser로는 OGNL이 사용 됨.</p><h5 id=view-factory-creator>view-factory-creator</h5><p>ViewFactoryCreator를 커스터마이징. 디폴트 ViewFactoryCreator는 JSP, Velocity, Freemaker 등을 화면에 보여주게 해주는 Spring MVC ViewFactories로 되어 있음.</p><h5 id=development>development</h5><p>Flow 개발 모드 설정. true인 경우, Flow 정의가 변경되면 hot-reloading 적용(message bundles 과 같은 리소스 포함).</p><h5 id=별도로-커스터마이징-된경우>별도로 커스터마이징 된경우</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-builder-services</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowBuilderServices&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>conversion-service=</span><span style=color:#4e9a06>&#34;conversionService&#34;</span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>expression-parser=</span><span style=color:#4e9a06>&#34;expressionParser&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>view-factory-creator=</span><span style=color:#4e9a06>&#34;viewFactoryCreator&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>           
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;conversionService&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;...&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;expressionParser&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;...&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;viewFactoryCreator&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;...&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h3 id=flow-executor-옵션>flow-executor 옵션</h3><h4 id=flow-실행-리스너-붙이기>Flow 실행 리스너 붙이기</h4><p>Flow 실행의 Lifecycle에 관련된 리스너(listener)는 flow-execution-listeners를 이용하여 등록한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow-execution-listeners&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;listener</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securityListener&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;listener</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;persistenceListener&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow-execution-listeners&gt;</span>
</span></span></code></pre></div><p>또한 특정 흐름에 대해서만 적용 가능하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;listener</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securityListener&#34;</span> <span style=color:#c4a000>criteria=</span><span style=color:#4e9a06>&#34;securedFlow1,securedFlow2&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h4 id=flowexecution-persistence-조정>FlowExecution persistence 조정</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow-execution-repository</span> <span style=color:#c4a000>max-executions=</span><span style=color:#4e9a06>&#34;5&#34;</span> <span style=color:#c4a000>max-execution-snapshots=</span><span style=color:#4e9a06>&#34;30&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h5 id=max-executions>max-executions</h5><p>사용자 세션 당 생성될 수 있는 Flow 실행 개수 지정</p><h5 id=max-execution-snapshots>max-execution-snapshots</h5><p>Flow 실행 당 받을 수 있는 이력 snapshot 개수 지정. snapshot을 사용하지 못하게 하려면, 0으로 지정. 제한이 없게 하려면 -1로 설정.</p><h2 id=참고자료>참고자료</h2><ul><li><a href=https://docs.spring.io/spring-webflow/docs/2.3.3.RELEASE/reference/html/>Spring Web Flow reference</a></li><li>Spring Web-Flow Framework Reference beta with Korean (by 박찬욱)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-40147d8c31847866947057ef75910027>7 - Spring Web Flow와 Spring MVC 연동</h1><div class=lead>Spring Web Flow는 Spring MVC와 연동해 웹 애플리케이션을 개발할 수 있으며, 이를 위해 web.xml에 DispatcherServlet 설정이 필요하다. DispatcherServlet은 웹 애플리케이션별로 등록되며, 요청 경로와 초기화 파라미터(contextConfigLocation)를 설정한다.</div><h2 id=spring-web-flow-와-mvc-연동>Spring Web Flow 와 MVC 연동</h2><p>Spring Web Flow를 사용하여 웹을 개발할 때 Spring MVC와 연동하여 개발할 수 있다. 이를 위해 Spring MVC 연동 모듈 등을 설정해야 한다.
여기서는 booking-mvc sample( 실행데모(faces이지만 시나리오는 같음) )을 기준으로 설정하겠다.</p><h2 id=설명>설명</h2><p>Spring MVC 와의 연동을 위해 우리는 web.xml 안에 있는 DispatcherServlet 설정을 보도록 하겠다.</p><h3 id=webxml-환경-구성>web.xml 환경 구성</h3><p>Spring MVC를 구성하는 첫 단계는 web.xml에 DispatcherServlet을 구성하는 것이다.
DispatcherServlet은 웹 애플리케이션별 하나를 등록한다.</p><p>이 예제에서는 /spring/으로 시작하는 모든 요청을 받도록 설정하고 있다. init-param을 사용해 contextConfigLocation을 설정하고 있다.</p><p><strong>web.xml</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>Spring MVC Dispatcher Servlet<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span style=color:#204a87;font-weight:700>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;init-param&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>contextConfigLocation<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>/WEB-INF/web-application-config.xml<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/init-param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/servlet&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;servlet-mapping&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>Spring MVC Dispatcher Servlet<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;url-pattern&gt;</span>/spring/*<span style=color:#204a87;font-weight:700>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></div><h3 id=flow로-전달>Flow로 전달</h3><p>DispatcherServlet은 애플리케이션 자원에 대한 요청과 핸들러를 매핑시켜 준다. Flow도 핸들러의 하나의 유형으로 처리된다.</p><h4 id=flowhandleradapter-등록-및-flow-매핑-정의>FlowHandlerAdapter 등록 및 Flow 매핑 정의</h4><p>먼저 FlowHandlerAdapter Bean을 정의하고 나서 property(flowExecutor)로 flowExecutor 빈을 설정함으로써
Spring MVC 내에서 Flow를 제어할 수 있도록 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Enables FlowHandler URL mapping --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.mvc.servlet.FlowHandlerAdapter&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;flowExecutor&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;flowExecutor&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>이 설정은 Dispatcher가 애플리케이션 자원 경로를 flow registry에 등록된 Flow로 매핑할 수 있도록 해준다.
예를 들어, /hotels/booking 요청은 hotels/booking 이란 Flow ID를 갖는 Flow에게 요청이 가게 된다.
flow registry에서 해당 ID 못 찾게 되면, Dispatcher의 순서에 따라 다음 핸들러 매핑에서 찾고, 없다면 “noHandlerFound”(?) 응답이 반환되게 된다.</p><h4 id=작업-흐름을-제어하는-flow>작업 흐름을 제어하는 Flow</h4><p>조건에 맞는 flow가 매핑되면 FlowHandlerAdapter는 새로운 flow 실행을 시작할 것인지 아니면 HTTP 요청에 담겨있는 정보를 기반으로 기존 실행을 계속할 것인지를 판단하게 된다.</p><ul><li>HTTP 요청 파라미터는 모든 Flow 실행의 입력 맵에서 사용할 수 있다.</li><li>Flow 실행이 마지막 응답 전송 없이 끝나는 경우, Default 핸들러가 동일한 요청을 새로이 Flow 실행을 시도(?)하게 된다</li><li>발생한 Excpetion이 NoSuchFlowExecutionException인 경우에는 새로이 Flow 실행을 시작해 복구 시도를 해보며, 다른 예외는 제어하지 않는다.</li></ul><p>자세한 내용은 SWF JavaDoc 에서 FlowHandlerAdapter 클래스를 참고하길 바란다.</p><h3 id=커스텀-flowhandler-구현>커스텀 FlowHandler 구현</h3><p>FlowHandler는 HTTP 서블릿 환경에서 Flow가 실행을 커스터마이징할 수 있는 확장 영역이다.
FlowHandlerAdapter에 의해 실행/사용되며, 아래와 같은 수행을 한다.</p><ul><li>실행되는 Flow의 id 반환</li><li>Flow 실행시 입력될 값 생성</li><li>Flow 실행이 종료되면서 반환하는 결과 처리</li><li>Flow 실행에서 발생해서 던저진 예외 처리</li></ul><p>이러한 수행을 위한 메소드는 org.springframework.mvc.servlet.FlowHandler 인터페이스 형태로 되어 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>FlowHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getFlowId</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>MutableAttributeMap</span> <span style=color:#000>createExecutionInputMap</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>handleExecutionOutcome</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FlowExecutionOutcome</span> <span style=color:#000>outcome</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>handleException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FlowException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>,</span>	<span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>FlowHandler를 구현 시, AbstractFlowHandler를 상속하면 된다. 모든 연산은 선택적이 되어서, 필요할 때만 구현하면 되며,
구현하지 않으면 기본 구현 내용(AbstractFlowHandler 내에 구현된)이 적용된다.
특히 다음과 같은 경우에는 구현을 고려할 수 있다.</p><ul><li>getFlowId(HttpServletRequest) 재정의: HTTP 요청에서 직접적으로 Flow id를 받을 수 없을 때. 일반적으로는 요청의 URI에서 경로 정보를 얻게 됨. 예를 들어, http://localhost/app/hotels/booking?hotelId=1 는 hotels/booking이란 Flow id로 매핑 됨.</li><li>createExecutionInputMap(HttpServletRequest) 재정의: HttpServletRequest에서 Flow 입력 파라미터를 세부적으로 직접 추출해야 하는 경우. 기본적으로는 모든 요청 파라미터가 Flow 입력 파라미터로 넘겨짐.</li><li>handleExecutionOutcome 재정의: 직접 Flow 실행 결과를 제어할 필요가 있을 경우. 기본 행동은 Flow의 새로운 실행을 재시작하려고 마지막 Flow의 URL로 redirect 보냄.</li><li>handleExeception 재정의: 제어되지 못한 Flow 실행을 세심하게 조정할 필요가 있는 경우. 기본적으로는 제어하지 않은 Exception은 Spring MVC ExceptionResolver로 다시 보내진다.</li></ul><h4 id=flowhandler-예제>FlowHandler 예제</h4><p>가장 일반적인 스프링 MVC와의 상호 작용은, Flow가 종료됐을 때 @Controller로 재전송하는 방법이다. FlowHandler는 이를 특정 controller URL을 Flow 정의와 관련 없이 가능하도록 해준다. 예를 보자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>BookingFlowHandler</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractFlowHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>handleExecutionOutcome</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>FlowExecutionOutcome</span> <span style=color:#000>outcome</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>	                                     <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>outcome</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getId</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>equals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;/booking/show?bookingId=&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>outcome</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getOutput</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;bookingId&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;/hotels/index&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>재정의된 handleExecutionOutcome 메소드에서는 Flow 결과로 나온 flow id 가 bookingConfirmed인 경우 특정 URL(/booking/show?bookingId=…)로 보낸다.
flow id 가 bookingConfirmed 와 다른 경우 /hotels/index 에 대한되는 URL로 가게 된다.</p><h4 id=커스텀-flowhandler-배포>커스텀 FlowHandler 배포</h4><p>커스텀 FlowHandler를 설치하려면,그냥 빈으로 등록하기만 하면 된다. 빈 이름은 반드시 적용하고자 하는 Flow의 id와 일치해야 한다</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hotels/booking&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.samples.booking.BookingFlowHandler&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>이 설정을 통해서 /hotels/booking 자원에 대한 접근은 커스텀 핸들러인 BookingFlowHandler를 사용해서 hotels/booking이 실행되게 된다.
booking flow 가 끝나는 시점에서 BookingFlowHandler의 handleExecutionOutcome이 실행되며 String(URL) 결과에 따라 적당한 controller로 재전송된다.</p><h4 id=flowhandler-재전송>FlowHandler 재전송</h4><p>FlowExecutionOutcome이나 FlowException을 제어하는 FlowHandler는 제어를 한 후에 재전송하는 경로를 지정하는 String을 반환하게 된다. 이전 예에서 BookingFlowHandler는 bookingConfirmed 결과에 대해서는 booking/show로 재전송하고, 다른 결과에 대해서는 hotels/index 자원 URI로 반환하게 된다. 기본적으로 반환되는 자원의 위치는 현재 서블릿 매핑에 관계된다. 이는 flow handler가 상대 경로를 사용해서 애플리케이션 내에 있는 다른 컨트롤러로 redirect할 수 있게 해준다. <strong>여기에 더해서 좀더 제어가 필요한 경우에 사용할 수 있는 명시적인 앞첨자를 제공한다.</strong></p><ul><li>servletRelative: 현재 서블릿에 대한 상대적인 자원으로 재전송</li><li>contextRelative: 현재 웹 애플리케이션 컨텍스트 경로(web application context path)에 대한 상대적인 자원으로 재전송</li><li>servletRelative: 서블릿 루트에 대한 상대적인 자원으로 재전송</li><li>http: 또는 https: : 완전한 자원 URI로 재전송</li></ul><p>이 앞첨자는 externalRedirect: 지시어와 함께 Flow 정의 내에서도 사용할 수 있다.
예를 들면, view=“externalRedirect:http://springframework.org”.</p><h3 id=뷰-결정>뷰 결정</h3><p>Web Flow 2는 따로 지정하지 않는다면 Flow 파일이 있는 디렉터리에 있는 파일과 선택된 뷰 식별자를 매핑해주게 된다. 기존 스프링 MVC+Web Flow 애플리케이션에서는 이미 외부 ViewResolver가 매핑 처리를 해주고 있다. 그러므로 기존 resolver를 계속 사용하고, 기존 Flow 뷰가 패키징된 방법이 변경되는 것을 피하기 위해서 다음처럼 설정하자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-registry</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowRegistry&#34;</span>	<span style=color:#c4a000>flow-builder-services=</span><span style=color:#4e9a06>&#34;flowBuilderServices&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;webflow:location</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/WEB-INF/hotels/booking/booking.xml&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/webflow:flow-registry&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-builder-services</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowBuilderServices&#34;</span> 	<span style=color:#c4a000>view-factorycreator=</span><span style=color:#4e9a06>&#34;mvcViewFactoryCreator&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;mvcViewFactoryCreator&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.mvc.builder.MvcViewFactoryCreator&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;viewResolvers&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;myExistingViewResolverToUseForFlows&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>MvcViewFactoryCreator는 당신이 Spring MVC view 시스템(여기선 “myExistingViewResolverToUseForFlows”)을 Spring Web Flow 내에서 사용할 수 있도록 해준다.
Booking Hotels 샘플에서는 아래와 같이 설정되어 있다(tilesViewResolver 를 이용할 수 있도록 되어 있다).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;mvcViewFactoryCreator&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.mvc.builder.MvcViewFactoryCreator&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;viewResolvers&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;tilesViewResolver&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>또한 useSpringBinding의 값을 true로 설정하면 Spring MVC의 고유한 BeanWrapper를 이용하여 데이터 바인딩을 할 수 있다.</p><h3 id=뷰에서-이벤트-보내기>뷰에서 이벤트 보내기</h3><p>flow가 view-state에 들어가서 잠시 멈추게 되면, 사용자를 해당 실행 URL로 재전송해서, 사용자 이벤트가 다시 시작되기를 기다리게 된다. 이번 절에서는 JSP, Velocity나 Freemarker처럼 템플릿 엔진에 의해서 생성된 HTML 기반 뷰에서 이벤트를 발생시키는 방법을 알아보자.</p><h4 id=html-버튼을-사용해서-이벤트-보내기>HTMl 버튼을 사용해서 이벤트 보내기</h4><p>다음은 proceed와 cancle 이벤트를 발생시키는 같은 폼 내의 두 개 버튼을 보여준다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;_eventId_proceed&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;Proceed&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;_eventId_cancel&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;Cancel&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>버튼이 선택되면, SWF는 _eventId로 시작하는 요청 파라미터를 찾아서, 그 부분을 잘라내고 남은 문자열을 id로 사용하게 된다.
_eventId_proceed는 proceed가 된다. 그러기 때문에 동일한 폼에서 다양한 여러 이벤트를 발생시킬 수 있다.</p><h4 id=hidden-html-폼-파라미터-사용해-이벤트-신호-보내기>hidden HTML 폼 파라미터 사용해 이벤트 신호 보내기</h4><p>form이 submit될 때 proceed 이벤트가 발생하려면 다음처럼 하자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;Proceed&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;hidden&#34;</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;_eventId&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;proceed&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>여기서는 _eventId 파라미터로 오는 값을 찾아서 event id로 해당 값을 사용하게 된다.
이런 방법은 form으로 전송할 수 있는 이벤트가 하나일 때만 생각해봐야 한다.</p><h4 id=html-link-사용해서-이벤트-보내기>HTML link 사용해서 이벤트 보내기</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${flowExecutionUrl}&amp;_eventId=cancel&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Cancel<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p><strong>매개변수 식별 순서는 “eventId” ⇒ “_eventId” ⇒ 없음 이다.</strong></p><h2 id=참고-자료>참고 자료</h2><ul><li><a href=http://static.springframework.org/spring-webflow/docs/2.0.x/reference/html/index.html>Spring Web Flow reference 2.0.x</a></li><li>Spring Web-Flow Framework Reference beta with Korean (by 박찬욱)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-818d8526803f79a4976a65f1bc482a51>8 - Spring Web Flow에서 보안 적용</h1><div class=lead>Spring Security를 통해 Flow 실행에 보안을 적용하려면 인증 및 권한 규칙을 설정하고, Flow 정의에 secured 구성요소를 추가하며, SecurityFlowExecutionListener를 사용하여 보안 규칙을 처리한다. 보안 규칙은 Flow, state, transition 단계에서 적용 가능하다.</div><h1 id=flow에-보안-적용하기securing-flows>Flow에 보안 적용하기(Securing Flows)</h1><h2 id=개요>개요</h2><p>보안은 어플리케이션 에서 매우 중요한 이슈이다.
Spring Security는 어플리케이션과 결합하여 여러 수준에서 보안을 책임지는 플랫폼의 기능을 수행한다.
여기서는 Web Flow에 적용되는 Spring Security에 대해 알아보겠다.</p><h3 id=어떻게-flow를-안전하게-할-수-있을까>어떻게 Flow를 안전하게 할 수 있을까?</h3><p>Flow 실행에 보안을 적용시키고 싶다면 다음 단계에 따르자.</p><ol><li>Spring Security에서 인증(authentication)과 권한(authorization) 규칙을 설정한다.</li><li>secured 구성요소로 Flow 정의에 보안 규칙을 추가한다.</li><li>보안 규칙을 처리해주는 SecurityFlowExecutionListener 추가한다.</li></ol><h3 id=secured-구성요소>secured 구성요소</h3><p>secured 구성 요소는 접근하기 전에 권한 확인을 적용해 주며, Flow 실행 단계마다 한 번 이상은 나올 수 없다.
Flow 실행에서 세 단계로 보안을 적용할 수 있다. Flow, state, transition에 보안 적용이 가능하다.
사용되는 문법은 동일하다. secured 구성요소는 보안이 적용되어야 하는 구성 요소 내에 위치하면 된다.
예를 들어 view state에 보안을 적용하고자 하면,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;secured-view&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&lt;secured</span> <span style=color:#c4a000>attributes=</span><span style=color:#4e9a06>&#34;ROLE_USER&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> ...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><h4 id=속성에-보안-적용>속성에 보안 적용</h4><p>attributes 속성은 &lsquo;,&rsquo;(콤마)로 구분해서 SS의 권한 속성을 리스트로 입력할 수 있다. 이 속성은 대부분 허가된 보안 롤(role)을 명시하게 된다.
스프링 시큐리티 접근 결정 매니저(access decision manager)에 의해 이 속성에 입력한 값과 사용자가 가지고 있는 값을 비교한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;secured</span> <span style=color:#c4a000>attributes=</span><span style=color:#4e9a06>&#34;ROLE_USER&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>기본적으로, 롤 기반 접근 결정 관리자를 사용하여 사용자가 접근할 수 있는지 확인한다.
만약 애플리케이션이 권한 룰을 사용하지 않는다면 이 부분을 오버라이딩할 필요가 있다.</p><h4 id=타입-맞춰보기>타입 맞춰보기</h4><p>두 가지 유형의 일치 유형 제공: any, all.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;secured</span> <span style=color:#c4a000>attributes=</span><span style=color:#4e9a06>&#34;ROLE_USER, ROLE_ANONYMOUS&#34;</span> <span style=color:#c4a000>match=</span><span style=color:#4e9a06>&#34;any&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>이 속성은 필수가 아니다. 정의하지 않으면 기본 값은 any다.</p><h3 id=securityflowexecutionlistener>SecurityFlowExecutionListener</h3><p>Web Flow 설정에 추가한다.
SecurityFlowExecutionListener가 Web Flow 설정에 정의되어 있어야 플로우 실행기(executor)에 적용된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-executor</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowExecutor&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>flow-registry=</span><span style=color:#4e9a06>&#34;flowRegistry&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;webflow:flow-execution-listeners&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;webflow:listener</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;securityFlowExecutionListener&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/webflow:flow-execution-listeners&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/webflow:flow-executor&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securityFlowExecutionListener&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.security.SecurityFlowExecutionListener&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>보안 설정에 의해서 접근이 거절되면, AccessDeniedException이 발생한다.
기본으로 롤 기반 의사결정이 이루어 지지만, 커스텀 의사결정 관리자를 지정할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;securityFlowExecutionListener&#34;</span> 	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.security.SecurityFlowExecutionListener&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;accessDecisionManager&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;myCustomAccessDecisionManager&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h3 id=spring-security-환경-구성>Spring Security 환경 구성</h3><h4 id=스프링-환경-구성>스프링 환경 구성</h4><p>http와 authentication-provider로 정의하면 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;security:http</span> <span style=color:#c4a000>auto-config=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;security:form-login</span> <span style=color:#c4a000>login-page=</span><span style=color:#4e9a06>&#34;/spring/login&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>login-processing-url=</span><span style=color:#4e9a06>&#34;/spring/loginProcess&#34;</span> <span style=color:#c4a000>default-target-url=</span><span style=color:#4e9a06>&#34;/spring/main&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>authentication-failure-url=</span><span style=color:#4e9a06>&#34;/spring/login?login_error=1&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;security:logout</span> <span style=color:#c4a000>logout-url=</span><span style=color:#4e9a06>&#34;/spring/logout&#34;</span> <span style=color:#c4a000>logout-success-url=</span><span style=color:#4e9a06>&#34;/spring/logout-success&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/security:http&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;security:authentication-provider&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;security:password-encoder</span> <span style=color:#c4a000>hash=</span><span style=color:#4e9a06>&#34;md5&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;security:user-service&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;security:user</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;keith&#34;</span> <span style=color:#c4a000>password=</span><span style=color:#4e9a06>&#34;417c7382b16c395bc25b5da1398cf076&#34;</span>	<span style=color:#c4a000>authorities=</span><span style=color:#4e9a06>&#34;ROLE_USER,ROLE_SUPERVISOR&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;security:user</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;erwin&#34;</span> <span style=color:#c4a000>password=</span><span style=color:#4e9a06>&#34;12430911a8af075c6f41c6976af22b09&#34;</span>	<span style=color:#c4a000>authorities=</span><span style=color:#4e9a06>&#34;ROLE_USER,ROLE_SUPERVISOR&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;security:user</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;jeremy&#34;</span> <span style=color:#c4a000>password=</span><span style=color:#4e9a06>&#34;57c6cbff0d421449be820763f03139eb&#34;</span> <span style=color:#c4a000>authorities=</span><span style=color:#4e9a06>&#34;ROLE_USER&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;security:user</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;scott&#34;</span> <span style=color:#c4a000>password=</span><span style=color:#4e9a06>&#34;942f2339bf50796de535a384f0d1af3e&#34;</span>	<span style=color:#c4a000>authorities=</span><span style=color:#4e9a06>&#34;ROLE_USER&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/security:user-service&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/security:authentication-provider&gt;</span>
</span></span></code></pre></div><h4 id=webxml-환경-구성>web.xml 환경 구성</h4><p>필터 설정.(SS 기본)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;filter&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;filter-name&gt;</span>springSecurityFilterChain<span style=color:#204a87;font-weight:700>&lt;/filter-name&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span style=color:#204a87;font-weight:700>&lt;/filter-class&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/filter&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;filter-mapping&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;filter-name&gt;</span>springSecurityFilterChain<span style=color:#204a87;font-weight:700>&lt;/filter-name&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;url-pattern&gt;</span>/*<span style=color:#204a87;font-weight:700>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/filter-mapping&gt;</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li><a href=https://docs.spring.io/spring-webflow/docs/2.3.3.RELEASE/reference/html/>Spring Web Flow reference</a></li><li>Spring Web-Flow Framework Reference beta with Korean (by 박찬욱)</li><li><del><a href=http://whiteship.me/2146>Whiteship&rsquo;s Note</a></del> (만료됨)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-6487bc980dc54970dd00c6723ba56f27>9 - Flow가 관리하는 영속성(Flow Managed Persistence)</h1><div class=lead>Web Flow는 Flow 실행 중에 PersistenceContext를 생성하고, Flow가 종료될 때 데이터를 commit하여 영속성 관리를 지원하며, 주로 하이버네이트와 JPA와 연동된다. 이 패턴은 동시에 수정되는 데이터를 보호하기 위해 optimistic locking과 함께 사용되며, HTTP 세션 기반 저장 방법과는 달리 Flow 범위 내에서 영속성을 관리한다.</div><h1 id=flow가-관리하는-영속성flow-managed-persistence>Flow가 관리하는 영속성(Flow Managed Persistence)</h1><h2 id=개요>개요</h2><p>대부분의 애플리케이션은 여러 방법으로 데이터에 접근한다. 여러 사용자가 공유하는 데이터를 동시에 수정한다.
따라서 트랜잭션 데이터 접근 속성이 필요하다. 관계형 데이터 집합을 도메인 객체로 변환하여 애플리케이션 처리를 도와준다.
Web Flow는 “Flow가 관리하는 영속성”(flow managed persistence)을 제공하여 Flow가 객체 영속성 문맥을 만들고, commit 하고, 닫을 수 있도록 한다.
Web Flow는 하이버네이트와 JPA 객체 영속화 기술과 연동한다.</p><p>Flow-관리 영속성과 별도로 PesistenceContext 관리를 애플리케이션의 서비스 계층에서 완전히 캡슐화하는 패턴이 있다.
이런 경우 Web 계층은 영속화에 관여하지 않는다. 그 대신 서비스 계층으로 념주겨거나 반환받은 detached object를 가지고 동작한다.
이번 장은 Flow-관리 영속성에 초점을 맞추고 이 기능을 언제 어떻게 사용하는지 살펴보겠다.</p><h2 id=설명>설명</h2><h3 id=flow-범위flowscoped-persistencecontext>Flow 범위(FlowScoped) PersistenceContext</h3><p>이 패턴은 Flow 시작 시에 flowScope으로 PersistenceContext를 생성해 준다.
이 persistence context는 Flow 실행 과정 동안에 데이터 접근을 하는데 사용하며,
Flow가 종료될 때 persistent entity에서 변경된 내용을 반영(commit) 한다.
이 패턴은 대부분 다중 사용자에 의해서 동시에 수정되는 데이터의 정합성을 보호하고자 optimistic locking 전략과 함께 사용된다.</p><p>저장이나 재시작 능력이 필요 없다면, Flow 상태를 표준 HTTP 세션 기반 저장 방법이 충분하다.
이 때 커밋 전 세션 만료나 종료(termination)는 잠재적으로 변경 사항을 손실할 수 있다.
FlowScoped PersistenceContext 패턴을 사용하려면 먼저 persistence-context로 Flow를 식별하게 해야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;persistence-context</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span></code></pre></div><p>그 다음으로 이 패턴을 적용할 Flow에 적절한 FlowExecutionListener를 설정하자.
하이버네이트를 사용한다면, HibernateFlowExecutionListener를 등록하고, JPA를 사용한다면, JpaFlowExecutionListener를 등록하자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;webflow:flow-executor</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;flowExecutor&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>flow-registry=</span><span style=color:#4e9a06>&#34;flowRegistry&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;webflow:flow-execution-listeners&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;webflow:listener</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;jpaFlowExecutionListener&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/webflow:flow-execution-listeners&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/webflow:flow-executor&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;jpaFlowExecutionListener&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.webflow.persistence.JpaFlowExecutionListener&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;entityManagerFactory&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;transactionManager&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>Flow가 종료되는 시점에 커밋이 일어나게 하려면, end-state의 commit 속성을 입력하자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span> <span style=color:#c4a000>commit=</span><span style=color:#4e9a06>&#34;true&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>이걸로 끝이다.</p><p>이제 Flow가 시작할 때 리스너가 flowScope에 새로운 EntityManager를 할당해서 제어하게 된다.
Flow 내에서 스프링 기반 데이터 접근 객체를 사용해서 발생하는 데이터 접근 시에는 항상 이 EntityManager를 자동으로 사용하게 된다.
이러한 데이터 접근 연산은 중간 수정 내용의 고립성 유지를 위해 항상 트랜잭션 처리 대상이 되지 않고, 읽기 전용 트랜잭션에서만 실행되어야 한다.</p><h2 id=참고자료>참고자료</h2><ul><li><a href=https://docs.spring.io/spring-webflow/docs/2.3.3.RELEASE/reference/html/>Spring Web Flow reference</a></li><li>Spring Web-Flow Framework Reference beta with Korean (by 박찬욱)</li><li><del><a href=http://whiteship.me/2146>Whiteship&rsquo;s Note</a></del> (만료됨)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-0a4da6ff9e481ff6260e0bb53f55d853>10 -</h1></div><div class=td-content style=page-break-before:always><h1 id=pg-3918366007fbc6c95185b8b03b4c7c85>11 - Flow 정의</h1><div class=lead>Flow는 여러 단계의 흐름을 캡슐화한 재사용 가능한 구조로, 상태(state)로 구성되며 각 상태는 이벤트에 따라 다른 뷰로 전환된다. 웹 애플리케이션 개발자는 XML 기반의 Flow 정의 언어로 Flow를 작성하며, 첫 번째 상태가 Flow의 시작점이 된다.</div><h1 id=flow-정의>Flow 정의</h1><h2 id=개요>개요</h2><h3 id=flow>Flow</h3><p>Flow란 상이한 상황(context)에서 실행될 수 있는 재사용이 가능한 여러 단계들의 흐름을 캡슐화한 것을 의미한다.
모든 Flow는 아래와 같은 Root로 시작한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span></code></pre></div><h3 id=flow의-구성>Flow의 구성</h3><p>SWF에서 Flow는 “Sate(state)“로 부르는 일련의 단계들로 구성된다. Flow로 진입하게 되는 Sate는 일반적으로 사용자에게 보여지는 뷰가 된다.
이 뷰에서는 Sate를 제어하게 되는 이벤트가 발생한다. 이들 이벤트는 결과적으로 다른 뷰로 이동하게 되는 Transition(transition)을 일으키게 된다.
모든 state는 &lt;flow/> 안에 정의하게 된다. 맨 처음 정의되는 state가 Flow의 시작점이 된다.</p><h4 id=flow의-작성법>Flow의 작성법</h4><p>Flow는 웹 애플리케이션 개발자가 XML 기반 Flow 정의 언어를 사용해서 작성된다.</p><h2 id=설명>설명</h2><h3 id=flow의-필수적인-언어-구성요소>Flow의 필수적인 언어 구성요소</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                     http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookingCancelled&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span></code></pre></div><ul><li>view-state: Flow 중 화면을 보여주는 Sate를 정의하는 구성 요소</li><li>편의상 Flow 정의 파일이 있는 디렉터리 내에서 view-state id와 일치하는 화면 템플릿을 맞춰 보게 됨</li><li>transition: Sate 내에서 발생한 이벤트를 제어하는 구성 요소. 화면 이동을 일으킴.</li><li>end-state: Flow의 결과를 정의</li></ul><h3 id=actions>Actions</h3><p>대부분의 Flow는 화면 이동 로직 뿐만 아니라, 애플리케이션의 비즈니스 서비스나 다른 행동을 호출할 필요가 있을 수 있다.
Flow 내에서 Action을 취할 수 있는 여러 지점이 존재한다.</p><ul><li>Flow가 시작할 때</li><li>Sate에 들어갈 때</li><li>화면을 보여줄 때</li><li>Transition이 일어날 때</li><li>Sate가 종료될 때</li><li>Flow가 종료될 때</li></ul><p>SWF에서 Action은 기본적으로 Unified EL이라는 간결한 표현 언어를 사용해서 정의하게 된다.</p><h5 id=evaluate>evaluate</h5><p>대부분 evaluate 구성 요소를 사용하게 된다. 이를 통해 Spring Bean에 있는 메소드나 다른 Flow 변수를 호출할 수 있다.
예를 들면 아래와 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [1] entityManager Bean 의 persist 메소드에 booking 객체를 넣어 호출한다.  --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;entityManager.persist(booking)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [2] findHotels 메소드 호출하고 실행결과 Hotels 객체를 flowScope 데이타 모델에  저장한다. --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.findHotels(searchCriteria)&#34;</span> <span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.hotels&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [3] findHotels 메소드 호출하고 실행결과 Hotels 객체를 flowScope 데이타 모델에  저장시 dataModel 타입으로 변환하여 저장한다.  --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.findHotels(searchCriteria)&#34;</span> <span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.hotels&#34;</span> <span style=color:#c4a000>result-type=</span><span style=color:#4e9a06>&#34;dataModel&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>아래 예에서는 Flow가 시작할 때 Flow 범위에 Booking 객체를 생성해 저장한다. hotelId는 Flow의 입력 속성으로 받게 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hotelId&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-start&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.createBooking(hotelId, currentUser.name)&#34;</span>	<span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.booking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-start&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;confirm&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;revise&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;cancel&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;bookingCancelled&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookingCancelled&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span></code></pre></div><h4 id=입력출력-매핑>입력/출력 매핑</h4><p>각각의 Flow는 잘 정의된 입력/출력 계약(input/output contract)를 갖고 있다.
Flow는 시작할 때 입력 속성을 건네받게 되고, 종료될 때 출력 속성을 반환하게 된다. 이처럼 Flow 호출은 개념적으로 다음과 같은 메소드 호출과 비슷하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>FlowOutcome</span> <span style=color:#000>flowId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>inputAttributes</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>반환되는 FlowOutcome은 다음과 같은 메소드 선언부를 갖게 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>FlowOutcome</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getName</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>getOutputAttributes</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=입력>입력</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [1] 해당 변수의 값은 flow scope 내에 hotelId 이란 이름으로 저장된다.  --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hotelId&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [2] type 속성으로 속성 지정 가능. 타입이 일치하지 않다면 타입 변환 시도 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hotelId&#34;</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;long&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [3] value 속성으로 입력 값을 할당 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hotelId&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;flowScope.myParameterObject.hotelId&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- [4] required 속성으로 null이나 비어있지 못하도록 강제 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hotelId&#34;</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;long&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;flowScope.hotelId&#34;</span> <span style=color:#c4a000>required=</span><span style=color:#4e9a06>&#34;true&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h5 id=출력>출력</h5><p>Flow 출력 속성은 output 구성 요소를 사용한다. output 속성은 end-state 내에 선언한다. 출력 값은 속성의 이름으로 Flow 범위 내에서 얻어오게 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;output</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;bookingId&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/end-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 직접 대상 값 지정 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;output</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;confirmationNumber&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;booking.confirmationNumber&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/end-state&gt;</span>
</span></span></code></pre></div><h5 id=입력출력-매핑샘플>입력/출력 매핑:샘플</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                      http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hotelId&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-start&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.createBooking(hotelId, currentUser.name)&#34;</span> 	<span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.booking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-start&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;confirm&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;revise&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;cancel&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;bookingCancelled&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;output</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;bookingId&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;booking.id&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/end-state&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookingCancelled&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span></code></pre></div><p>위 Flow는 이제 hotelId를 입력 값으로 받아서, 새로운 예약이 끝나게 되면 bookingId 출력 속성을 결과로 반환하게 된다.</p><h4 id=변수들>변수들</h4><p>Flow에는 하나 이상의 인스턴스 변수 선언이 가능하다. 이 변수들은 flow가 시작할 때 할당되며,
변수를 유지하게 되는 모든 @Autowired transient 참조는 Flow가 재시작될 때 다시 값이 할당(rewired) 되게 된다.
var 구성 요소를 사용해서 Flow 변수를 선언하자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;var</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;searchCriteria&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.mycompany.myapp.hotels.search.SearchCriteria&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>변수로 사용하는 클래스가 Flow 요청 간 인스턴스의 Sate를 유지하기 위해서 java.io.Serializable을 interface로 가지고 있어야 함을 기억하자.</p><h4 id=sub-flow-호출>Sub Flow 호출</h4><p>Flow 내에서 하위 Flow로써 또 다른 Flow 호출이 가능하다. 이때 하위 Flow가 결과를 반환할 때까지 기존 Flow는 대기하게 된다.</p><h5 id=subflow-state>subflow-state</h5><p>subflow-state 구성요소를 사용해서 하위 Flow 호출을 하게 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;subflow-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;addGuest&#34;</span> <span style=color:#c4a000>subflow=</span><span style=color:#4e9a06>&#34;createGuest&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;guestCreated&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;booking.guests.add(currentEvent.attributes.guest)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;creationCancelled&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/subfow-state&gt;</span>
</span></span></code></pre></div><p>이 예제에서는 createGuest Flow를 호출한다. guestCreated 출력이 반환되면, 새로운 손님이 예약 손님 리스트에 추가된다.</p><h5 id=subflow-input-전달>subflow input 전달</h5><p>input 구성요소를 사용하면 하위 Flow에 입력값을 건낼 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;subflow-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;addGuest&#34;</span> <span style=color:#c4a000>subflow=</span><span style=color:#4e9a06>&#34;createGuest&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;booking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/subfow-state&gt;</span>
</span></span></code></pre></div><h5 id=subflow-output-매핑>subflow output 매핑</h5><p>출력 값의 이름으로 하위 Flow에서 출력하는 속성을 참조해서 Transition을 하게 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;subflow-state</span>  <span style=color:#a40000>..</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;guestCreated&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;booking.guests.add(currentEvent.attributes.guest)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  ..
</span></span></code></pre></div><p>이 예에서는 guestCreated을 반환하게 될 때 gest 이름으로 넘어온 값을 booking 내의 guests (currentEvent.attributes.guest)의 일부로 추가해주고 있다.</p><h4 id=샘플sub-flow-호출하기>샘플:Sub Flow 호출하기</h4><p>아래는 샘플 코드이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                      http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hotelId&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-start&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.createBooking(hotelId, currentUser.name)&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.booking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-start&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;addGuest&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;addGuest&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;confirm&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;revise&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;cancel&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;bookingCancelled&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;subflow-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;addGuest&#34;</span> <span style=color:#c4a000>subflow=</span><span style=color:#4e9a06>&#34;createGuest&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;guestCreated&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;booking.guests.add(currentEvent.attributes.guest)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;creationCancelled&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/subfow-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;output</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;bookingId&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;booking.id&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/end-state&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;bookingCancelled&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li><a href=http://static.springframework.org/spring-webflow/docs/2.0.x/reference/html/index.html>Spring Web Flow reference 2.0.x</a> (링크 만료됨)</li><li>Spring Web-Flow Framework Reference beta with Korean (by 박찬욱)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-2f738e9ce90749986712abe0ced22328>12 - Web Flow에서 Expression Language (EL) 사용</h1><div class=lead>Web Flow는 데이터 모델 및 action 실행을 위해 Unified EL 또는 OGNL을 사용하며, 주로 클라이언트 데이터 접근, 내부 데이터 구조 접근, 스프링 빈 메소드 호출 등에서 EL을 활용한다. Flow에서 EL 표현식은 eval 표현과 템플릿 표현을 통해 데이터 구조에 접근하거나 동적 뷰를 생성할 수 있다.</div><h1 id=expression-language>Expression Language</h1><h2 id=개요>개요</h2><p>Web Flow는 데이터 모델 및 action 실행을 위해 EL을 이용한다. 우리는 EL에 대해 알아보면서 flow 정의를 해보도록 하겠다.</p><h2 id=설명>설명</h2><h3 id=지원하는-el-구현체>지원하는 EL 구현체</h3><h4 id=unified-el>Unified EL</h4><p>기본으로는 Unified EL을 사용한다. jboss-el이 기본 구현체로 되어 있다.</p><pre tabindex=0><code>참고 : web 컨테이너에서는 대게 el-api 를 지원해준다. 톰캣 6의 경우처럼 말이다.
</code></pre><h4 id=ognl>OGNL</h4><p>OGNL은 SWF2에서 제공하는 또 다른 EL이다. 클래스패스에만 추가하면 자동으로 찾아서 사용한다.</p><h4 id=el-호환성>EL 호환성</h4><p>Unified EL과 OGNL은 비슷한 문법을 가지고 있다. 가능하면 Unified EL만 사용하자.</p><h3 id=el-사용법>EL 사용법</h3><p>Flow에서 EL 사용하는 경우</p><ul><li>클라이언트에서 제공되는 데이터에 접근하는 경우. 입력 속성이나 요청 파라미터</li><li>flowScope처럼 내부 데이터 구조에 접근하는 경우</li><li>스프링 빈에 있는 메소드 호출</li><li>생성자 결정할 때</li></ul><p>Flow에 의해서 보여지는 뷰는 EL을 사용해서 Flow 데이터 구조에 접근하게 됨</p><h4 id=표현-타입>표현 타입</h4><h5 id=표준-eval-표현>표준 eval 표현</h5><p>가장 일반적인 방법은 eval 표현으로, 이 경우 ${}나 #{}을 사용하면 안 된다. 이 예는 searchCriteria에 있는 nextPage() 호출.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;searchCriteria.nextPage()&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h5 id=표현-템플릿>표현 템플릿</h5><p>다음은 “template” 표현식으로 아래와 같은 형태로 ${} 을 사용할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;error&#34;</span> <span style=color:#c4a000>view=</span><span style=color:#4e9a06>&#34;error-${externalContext.locale}.xhtml&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>externalContext 에 세팅되어 있는 locale 결과를 대체하여 error-결과.xhtml 로 생성된</p><h4 id=특별한-el-변수>특별한 EL 변수</h4><h5 id=scope>Scope</h5><ul><li>flowScope: flow 변수에 할당되며, Flow 범위를 가진 객체. 기본적으로 Flow 범위에 저장되는 모든 객체는 Serializable 이어야 함.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;searchService.findHotel(hotelId)&#34;</span> <span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.hotel&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>viewScope: view 변수에 할당되며, view-state 내 범위를 갖음. 그러므로 view-state 내에서만 참조 가능. 역시 모든 객체는 Serializable 이어야 함.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;on-render&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;searchService.findHotels(searchCriteria)&#34;</span> <span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;viewScope.hotels&#34;</span> <span style=color:#c4a000>result-type=</span><span style=color:#4e9a06>&#34;dataModel&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/on-render&gt;</span>
</span></span></code></pre></div><ul><li>requestScope: request 변수에 할당. 한 번의 Flow 내에서 공유</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;set</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;requestScope.hotelId&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;requestParameters.id&#34;</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;long&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>flashScope: flash 변수에 할당. Flow가 시작될 때 할당되고, 뷰가 보여지고 난 후 clear 됐다가, Flow가 종료되면 정리되는 범위. 객체는 Serializable 해야 함.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;set</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;flashScope.statusMessage&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;&#39;Booking confirmed&#39;&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>conversationScope</li></ul><p>convesation 변수에 할당. 최상위 Flow가 시작할 때 할당되며, 최상위 Flow가 종료될 때 정리. 최상위 Flow의 자식 Flow에서 공유. HTTP session에 저장되며, 세션 복제를 할 경우를 대비해 Serizalizable를 구현해야 함.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;searchService.findHotel(hotelId)&#34;</span> <span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;conversationScope.hotel&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h5 id=context>context</h5><ul><li>flowRequestcontext: 현재 Flow 요청을 표현. RequestContext API.</li><li>messageContext: 에러나 성공 메세지를 포함해서 Flow 실행 메세지를 받아오고, 만드는데 대한 context에 접근할 수 있음. MessageContext 참조.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingValidator.validate(booking, messageContext)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>flowExecutionContext: 현재 Flow 상태를 표현. FlowExecutionContext API.</li><li>externalContext: 사용자 세션 속성 등 외부 환경에 접근할 수 있음. ExternalContext API.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;searchService.suggestHotels(externalContext.sessionMap.userProfile)&#34;</span> <span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;viewScope.hotels&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h5 id=그-외>그 외</h5><ul><li>requestParameters: 사용자로부터 넘어온 request 매개변수 접근</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;set</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;requestScope.hotelId&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;requestParameters.id&#34;</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;long&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>currentEvent: 현재 Event 객체에 접근</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;booking.guests.add(currentEvent.guest)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>currentUser: 인증된 Principal에 접근</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.createBooking(hotelId, currentUser.name)&#34;</span> <span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.booking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>resourceBundle: message 자원 관리</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;set</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;flashScope.successMessage&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;resourceBundle.successMessage&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>flowExecutionUrl: 현재 flow execution view-state에 대한 context-relative URI에 접근</li></ul><h4 id=범위-검색-알고리즘>범위 검색 알고리즘</h4><p>특정 범위에 변수를 할당할 때는 반드시 범위를 명시해야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;set</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;requestScope.hotelId&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;requestParameters.id&#34;</span> <span style=color:#c4a000>type=</span><span style=color:#4e9a06>&#34;long&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>특정 범위에 있는 변수에 접근할 때는 꼭 범위를 명시할 필요는 없다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;entityManager.persist(booking)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>booking처럼 범위를 명시하지 않은 경우, 범위 검색 알고리즘(scope searching algorithm)이 동작하며,
이 알고리즘은 request→flash→view→flow→conversation 범위의 순서로 찾게 된다. 없을 경우 EvaluationException 발생.
아래그림은 검색되는 Scope 순서를 잘 보여주고 있다.</p><p><img src=../images/scopsofswf.jpg alt=scopsofswf></p><h2 id=참고자료>참고자료</h2><ul><li><a href=http://static.springframework.org/spring-webflow/docs/2.0.x/reference/html/index.html>Spring Web Flow reference 2.0.x</a> (링크 만료됨)</li><li>Spring Web-Flow Framework Reference beta with Korean (by 박찬욱)</li><li>Pro Spring 2.5(Apress) - Chapter 18 Spring Web Flow</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-ac904c0b2c7c163163c0370f938bf624>13 - Spring Web Flow의 뷰(View) 보여주기</h1><div class=lead>view-state는 화면을 생성해 보여준 후, 사용자의 응답을 기다리는 역할을 하며, ID가 별도의 view 설정 없이 곧 뷰를 의미한다. 예를 들어, &ldquo;enterBookingDetails"라는 ID는 해당 뷰를 나타내는 역할을 한다.</div><h1 id=뷰view-보여주기>뷰(View) 보여주기</h1><h2 id=개요>개요</h2><p>view-state는 flow 내에서 화면을 생성하는 요소이다.
여기서는 view-state 에 대해서 알아보도록 하자.</p><h2 id=설명>설명</h2><h3 id=뷰-상태view-state-정의하기>뷰 상태(view state) 정의하기</h3><p>view-state는 기본적으로 해당 뷰를 생성하여 보여준 후, 사용자가 화면을 통해 응답을 하는 것을 기다린다.
아래는 view-state는 enterBookingDetails라는 ID 를 가지고 있으며 또한 별도의 view 설정이 없기 때문에 ID 가 곧 view를 뜻한다</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><p>따라서. 디렉토리 상의</p><p><img src=../images/dir.jpg alt=dir></p><p>booking.xml(or booking-flow.xml) 이 존재하는 디렉토리에 있는 enterBookingDetails.jsp 이 자동으로 view로 동작한다.
또는 절대 경로를 이용하여 명시적으로 view=”/WEB-INF/hotels/booking/enterBookingDetails.jsp” 설정할 수도 있다.
아래에서 다시 설명하겠다.</p><h3 id=뷰-식별자-지정하기>뷰 식별자 지정하기</h3><p>뷰 속성을 여러 방법으로 지정할 수 있다.</p><ul><li>상대 경로 사용</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#c4a000>view=</span><span style=color:#4e9a06>&#34;bookingDetails.xhtml&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><ul><li>절대 경로 사용</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#c4a000>view=</span><span style=color:#4e9a06>&#34;/WEB-INF/hotels/booking/bookingDetails.jsp</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><ul><li>논리적인 경로 사용: Spring MVC 등과 통합 시</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#c4a000>view=</span><span style=color:#4e9a06>&#34;bookingDetails&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><h3 id=뷰-범위>뷰 범위</h3><p>view-state 내부에서 유지되는 변수. Ajax 요청처럼 동일한 뷰를 여러 번 보여줘야 하는 경우 유용.</p><ul><li>var 태그를 사용해서 view 변수 선언.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;var</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;searchCriteria&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.mycompany.myapp.hotels.SearchCriteria&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>viewScope 변수에 할당하기</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;on-render&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.findHotels(searchCriteria)&#34;</span> <span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;viewScope.hotels&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/on-render&gt;</span>
</span></span></code></pre></div><h4 id=뷰-범위내에서-object-다루기>뷰 범위내에서 Object 다루기</h4><p>아래 코드는 화면 ID가 searchResults인 view-state 화면을 그리되
그리기 전 bookingService.findHotels(searchCriteria) 메소드를 호출한 후 그 결과를 viewScope내의 hotels로 저장한 후 화면을 보여주고 있다.
그리고 화면상에 next 또는 previous 이벤트 발생시 eval(searchCriteria.nextPage()/previousPage()) 이 발생
그 결과를 fragments으로 지정된 영역에 뿌려주고 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;searchResults&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-render&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.findHotels(searchCriteria)&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;viewScope.hotels&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-render&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;next&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;searchCriteria.nextPage()&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;render</span> <span style=color:#c4a000>fragments=</span><span style=color:#4e9a06>&#34;searchResultsFragment&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;previous&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;searchCriteria.previousPage()&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;render</span> <span style=color:#c4a000>fragments=</span><span style=color:#4e9a06>&#34;searchResultsFragment&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><p>자세한 것은 아래에서 다시 설명하도록 하겠다.</p><h3 id=화면을-보여줄-때-액션-실행>화면을 보여줄 때 액션 실행</h3><p>뷰를 보여주기 전에 특정 액션을 실행하려면 on-render를 사용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;on-render&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.findHotels(searchCriteria)&#34;</span> <span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;viewScope.hotels&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/on-render&gt;</span>
</span></span></code></pre></div><h3 id=model-binding>Model Binding</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#c4a000>model=</span><span style=color:#4e9a06>&#34;booking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>뷰 이벤트가 발생했을 때 지정된 모델에 대해서 다음 행동이 일어난다.</p><ol><li>view-to-model binding.</li><li>모델 유효성 검증.</li></ol><h3 id=타입-변환-수행>타입 변환 수행</h3><h4 id=변환기converter-구현>변환기(Converter) 구현</h4><p>org.springframework.binding.convert.converters.TwoWayConverter을 구현하면 된다. StringToObject를 구현하는게 더 좋다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#000>Object</span> <span style=color:#000>toObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>string</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Class</span> <span style=color:#000>targetClass</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#000>String</span> <span style=color:#000>toString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>object</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span></code></pre></div><p>구현 예.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>StringToMonetaryAmount</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>StringToObject</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>StringToMonetaryAmount</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MonetaryAmount</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Object</span> <span style=color:#000>toObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>string</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Class</span> <span style=color:#000>targetClass</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>MonetaryAmount</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>string</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>String</span> <span style=color:#000>toString</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>object</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  	<span style=color:#000>MonetaryAmount</span> <span style=color:#000>amount</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MonetaryAmount</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>object</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>amount</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>org.springframework.binding.convert.converters에 이미 구현된 변환기가 위치.</p><h4 id=변환기-등록하기>변환기 등록하기</h4><p>org.springframework.binding.convert.service.DefaultConversionService을 상속해서 addDefaultConverters() 메소드를 재정의 하면 된다.
자세한 것은 시스템 설정에서 ConversionService 확장을 이용하여 설정하는 곳에서 다루고 있다.</p><h3 id=바인딩-금지하기>바인딩 금지하기</h3><p>bind 속성으로 특정 뷰 이벤트에서 모델 바인딩과 유효성 검증을 안 하게 할 수도 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#c4a000>model=</span><span style=color:#4e9a06>&#34;booking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;proceed&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;cancel&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;bookingCancelled&#34;</span> <span style=color:#c4a000>bind=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><h3 id=명시적으로-바인딩-지정하기>명시적으로 바인딩 지정하기</h3><p>아래와 같이 binder 속성으로 바인딩 할 프로퍼티를 명시적으로 지정할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#c4a000>model=</span><span style=color:#4e9a06>&#34;booking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;binder&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;creditCard&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;creditCardName&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;creditCardExpiryMonth&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;creditCardExpiryYear&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/binder&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;proceed&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;cancel&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;cancel&#34;</span> <span style=color:#c4a000>bind=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><p>binder로 지정하지 않으면 모든 프로퍼티를 바인딩된다. converter를 이용하여 변환기 지정이 가능하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#c4a000>model=</span><span style=color:#4e9a06>&#34;booking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;binder&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;checkinDate&#34;</span> <span style=color:#c4a000>converter=</span><span style=color:#4e9a06>&#34;shortDate&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;checkoutDate&#34;</span> <span style=color:#c4a000>converter=</span><span style=color:#4e9a06>&#34;shortDate&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;creditCard&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;creditCardName&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;creditCardExpiryMonth&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;binding</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;creditCardExpiryYear&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/binder&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;proceed&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;cancel&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;cancel&#34;</span> <span style=color:#c4a000>bind=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><h3 id=model-유효성-검증>Model 유효성 검증</h3><p>Model 유효성 검사에 대한 부분은 Web flow에서는 프로그래밍적으로 제약사항을 강제화하는 형태로 지원하고 있다.</p><h4 id=프로그램-내에서-유효성-검증>프로그램 내에서 유효성 검증</h4><p>첫 번째 방법으로 유효성 검증 로직을 모델 객체 내에 정의하는 방법이다.
Web Flow 는 view-stat에서 모델로 넘어간 시점(view-state postback lifecycle)에서 자동적으로 validate 메소드를 자동으로 호출한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#c4a000>model=</span><span style=color:#4e9a06>&#34;booking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;proceed&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><p>Booking class 내의 validate(view-state 명) 코드는 아래와 같이 볼 수 있다.(메소드명 : validate + EnterBookingDetails)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>Booking</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Date</span> <span style=color:#000>checkinDate</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Date</span> <span style=color:#000>checkoutDate</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>validateEnterBookingDetails</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ValidationContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>MessageContext</span> <span style=color:#000>messages</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessages</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>checkinDate</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>before</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>today</span><span style=color:#ce5c00;font-weight:700>()))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>messages</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MessageBuilder</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>source</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;checkinDate&#34;</span><span style=color:#ce5c00;font-weight:700>).</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#000>defaultText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Check in date must be a future date&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>checkinDate</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>before</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>checkoutDate</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>messages</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MessageBuilder</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>			                                        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>source</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;checkoutDate&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			                                        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>defaultText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Check out date must be later than check in date&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			                                        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>enterBookingDetails에 대한 이벤트가 발생했을 때 자동으로 validateEnterBookingDetails이 호출 된다.
메소드 이름을 validate$<state> 로 정의하면 된다.</p><h4 id=validator-구현>Validator 구현</h4><p>Validator로 불리는 별도의 객체로 정의할 수도 있다. 클래스 이름을 $<model>Validator 로 지정하면 된다.
메소드 이름은 역시 validate$<state>로 한다.
아래 클래스명은 Booking + Validator 이며 메소드 이름은 validate + EnterBookingDetails 임을 볼 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Component</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>BookingValidator</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>validateEnterBookingDetails</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Booking</span> <span style=color:#000>booking</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ValidationContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>MessageContext</span> <span style=color:#000>messages</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessages</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>booking</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCheckinDate</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>before</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>today</span><span style=color:#ce5c00;font-weight:700>()))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>messages</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MessageBuilder</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>			                                        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>source</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;checkinDate&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			                                        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>defaultText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Check in date must be a future date&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			                                        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>booking</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCheckinDate</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>before</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>booking</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCheckoutDate</span><span style=color:#ce5c00;font-weight:700>()))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>messages</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MessageBuilder</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>			                                        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>source</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;checkoutDate&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			                                        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>defaultText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Check out date must be later than check in date&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			                                        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>spring mvc의 Error 객체도 받을 수 있다.</p><h4 id=validationcontext>ValidationContext</h4><p>유효성 검증 동안에 MessageContext에 접근할 수 있게 해주며, 다양한 객체에 접근 가능하게 해준다.</p><h3 id=유효성-검증-하지-않기>유효성 검증 하지 않기</h3><p>validate=“false”로 설정하면 유효성 검사를 하지 않을 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;chooseAmenities&#34;</span> <span style=color:#c4a000>model=</span><span style=color:#4e9a06>&#34;booking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;proceed&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;back&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;enterBookingDetails&#34;</span> <span style=color:#c4a000>validate=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><h3 id=뷰-transition-실행>뷰 transition 실행</h3><p>전이 대상은 (1)다른 뷰, (2)현재 뷰를 다시, (3)action을 실행, (4)Ajax 이벤트를 제어할 때
&lsquo;fragments&rsquo;로 불리는 일부 뷰를 보여주라는 요청일 수도 있다.</p><h4 id=전이-액션transition-actions>전이 액션(Transition actions)</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingAction.makeBooking(booking, messageContext)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>BookingAction</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>makeBooking</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Booking</span> <span style=color:#000>booking</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>MessageContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>bookingService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>make</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>booking</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>RoomNotAvailableException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>defaultText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;No room is available at this hotel&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=글로벌-전이global-transitions>글로벌 전이(Global transitions)</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;global-transitions&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;login&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;login&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;logout&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;logout&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/global-transitions&gt;</span>
</span></span></code></pre></div><h4 id=이벤트-핸들러event-handlers>이벤트 핸들러(Event handlers)</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;event&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>&lt;!-- Handle event --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span></code></pre></div><h4 id=프레그먼트-보여주기fragments>프레그먼트 보여주기(fragments)</h4><p>현재 뷰 중 일부만을 다시 보여줄 수 있는 방법으로, Ajax 기반일 때 주로 사용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;next&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;searchCriteria.nextPage()&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;render</span> <span style=color:#c4a000>fragments=</span><span style=color:#4e9a06>&#34;searchResultsFragment&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span></code></pre></div><p>&lsquo;,&lsquo;로 구분해서 다수의 fragment를 지정할 수도 있다.</p><h3 id=메세지-사용하기>메세지 사용하기</h3><p>MessageContext는 플로우 실행 동안에 메세지를 저장하는 데 사용되는 API다.
일반 메세지나 국제화가 지원된 메세지 모두 사용 가능하다.
메세지 수준도 지정 가능하며, 지원되는 수준은 info, warning, error이 있다. 메세지를 추가할 때는 MessageBuilder를 사용하자.</p><ul><li>일반 메세지 추가</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>MessageContext</span> <span style=color:#000>context</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>MessageBuilder</span> <span style=color:#000>builder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MessageBuilder</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>source</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;checkinDate&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>defaultText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Check in date must be a future date&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>warn</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>source</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;smoking&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>defaultText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Smoking is bad for your health&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>defaultText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;We have processed your reservation - thank you and enjoy your stay&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><ul><li>국제화가 지원되는 메세지 추가</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>MessageContext</span> <span style=color:#000>context</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>MessageBuilder</span> <span style=color:#000>builder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MessageBuilder</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>source</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;checkinDate&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>code</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;checkinDate.notFuture&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>warn</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>source</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;smoking&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>code</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;notHealthy&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>resolvableArg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;smoking&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><h4 id=메세지-번들-사용하기>메세지 번들 사용하기</h4><p>스프링의 MessageSource를 사용해서 메세지 번들 정의가 가능하다. 간단히 프로퍼티 파일로 관리하면 된다.</p><pre tabindex=0><code>#messages.properties
checkinDate=Check in date must be a future date
notHealthy={0} is bad for your health
reservationConfirmation=We have processed your reservation - thank you and enjoy your stay
</code></pre><p>뷰나 플로우에서는 resourceBundle EL 변수로 접근도 가능하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;h:outputText</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;#{resourceBundle.reservationConfirmation}&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h4 id=시스템-생성-메세지-이해하기>시스템 생성 메세지 이해하기</h4><p>시스템에서 발생한 예외에 대해 메세지 지정할 수 있다. 예를 들어 타입 변환 시 예외가 발생하면 typeMismatch를 통해서 메세지 지정할 수 있다.</p><pre tabindex=0><code>booking.checkinDate.typeMismatch=The check in date must be in the format yyyy-mm-dd.
</code></pre><h3 id=팝업-띄우기>팝업 띄우기</h3><p>모달 팝업 다이얼로그를 뷰로 렌더링하고 싶다면, view-state 내에 popup=“true”로 설정하면 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;changeSearchCriteria&#34;</span> <span style=color:#c4a000>view=</span><span style=color:#4e9a06>&#34;enterSearchCriteria.xhtml&#34;</span> <span style=color:#c4a000>popup=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>특히 스프링 자바 스크립트와 함께 사용하면, 팝업을 보여주는데 클라이언트 코드가 전혀 필요 없다.
SWF가 클라이언트 요청을 팝업으로 재전송(redirect)해준다.</p><h3 id=뷰-백트랙킹view-backtracking>뷰 백트랙킹(View backtracking)</h3><p>기본적으로 브라우저의 백 버튼으로 이전 view-state로 돌아갈 수 있다. history를 사용해서 이에 대한 설정이 가능하다.</p><ul><li>&lsquo;discard&rsquo;로 설정하면 백트랙킹(backtracking)을 방지할 수 있다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;cancel&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;bookingCancelled&#34;</span> <span style=color:#c4a000>history=</span><span style=color:#4e9a06>&#34;discard&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><ul><li>&lsquo;invalidate&rsquo;로 설정하면 이전에 보여줬던 모든 뷰뿐만 아니라 현재 뷰까지도 백트랙킹을 방지한다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;confirm&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;bookingConfirmed&#34;</span> <span style=color:#c4a000>history=</span><span style=color:#4e9a06>&#34;invalidate&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li><a href=http://static.springframework.org/spring-webflow/docs/2.0.x/reference/html/index.html>Spring Web Flow reference 2.0.x</a> (링크 만료)</li><li>Spring Web-Flow Framework Reference beta with Korean (by 박찬욱)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-34033b7af9a64c3302d9433ec626766f>14 - Action 실행</h1><div class=lead>Action-state는 flow 내에서 특정 액션 실행 후 그 결과에 따라 다른 상태로 전이하는 기능을 제공하며, decision-state는 if-else와 같은 흐름 제어를 수행한다. 예를 들어, 특정 조건에 따라 transition이 결정되는 구조를 정의할 수 있다.</div><h1 id=action-실행>Action 실행</h1><h2 id=개요>개요</h2><p>action-state는 flow 내에서 action 실행을 제어하기 위한 요소이다.<br>decision-state를 이용하여 if-else와 같은 흐름 제어를 할 수 있다. 좀 더 자세히 알아보도록 하자.</p><h2 id=설명>설명</h2><h3 id=액션-상태-정의하기>액션 상태 정의하기</h3><p>특정 액션을 호출한 다음에, 그 결과에 따라서 다른 상태로 전이하고 싶은 경우에는 action-state 구성 요소를 사용하자.<br>직관적으로 봤을 때 아래 코드는 interview.moreAnswersNeeded()의 결과값에 의해 transition이 실행될 것을 예상할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;action-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;moreAnswersNeeded&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;interview.moreAnswersNeeded()&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;yes&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;answerQuestions&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;no&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;finish&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/action-state&gt;</span>
</span></span></code></pre></div><p>좀더 완전한 예를 살펴보자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                      http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-start&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;interviewFactory.createInterview()&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.interview&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-start&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;answerQuestions&#34;</span> <span style=color:#c4a000>model=</span><span style=color:#4e9a06>&#34;questionSet&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;on-entry&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;interview.getNextQuestionSet()&#34;</span>
</span></span><span style=display:flex><span>				<span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;viewScope.questionSet&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/on-entry&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;submitAnswers&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;moreAnswersNeeded&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;interview.recordAnswers(questionSet)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;action-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;moreAnswersNeeded&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;interview.moreAnswersNeeded()&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;yes&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;answerQuestions&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;no&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;finish&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/action-state&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;end-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;finish&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span></code></pre></div><h3 id=의사결정-상태decision-states-정의>의사결정 상태(decision states) 정의</h3><p>action-state를 대신해서 편리하게 if/else 문법을 사용해서 이동하고자 하는 의사결정을 해주는 decision-state를 사용한다.<br>이전 예제를 의사결정 상태로 구현한 예를 보자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;decision-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;moreAnswersNeeded&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;if</span> <span style=color:#c4a000>test=</span><span style=color:#4e9a06>&#34;interview.moreAnswersNeeded()&#34;</span> <span style=color:#c4a000>then=</span><span style=color:#4e9a06>&#34;answerQuestions&#34;</span> <span style=color:#c4a000>else=</span><span style=color:#4e9a06>&#34;finish&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/decision-state&gt;</span>  
</span></span></code></pre></div><h3 id=액션-출력-이벤트-매핑>액션 출력 이벤트 매핑</h3><p>액션은 대부분 POJO의 메소드를 호출한다. action-state와 decision-state을 호출했을 때,
이들 메소드가 반환하는 값은 상태를 전이하게 해주는데 사용할 수 있다. 전이가 이벤트에 의해서 발생되기 때문에, 우선 메소드가 반환하는 값은 반드시 Event 객체에 매핑되어야 한다.<br>다음 테이블은 공통적으로 반환하는 값 타입에 따라 Event 객체가 어떻게 매핑되는지를 설명해준다.</p><p>메소드 반환 타입 매핑된 Event 식별자 표현</p><table><thead><tr><th>결과로 리턴되는 타입</th><th>메핑되는 이벤트 값</th></tr></thead><tbody><tr><td>java.lang.String</td><td>String 값</td></tr><tr><td>java.lang.Boolean</td><td>yes(true에 해당), no(false에 해당)</td></tr><tr><td>java.lang.Enum Enum</td><td>Enum 이름</td></tr><tr><td>나머지 다른 타입</td><td>success</td></tr></tbody></table><p>예제.moreAnswersNeeded() 메소드의 리턴 타입은 boolean인 것을 예상할 수 있으면 그에 따라 yes, no에 매핑됨을 알 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;action-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;moreAnswersNeeded&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;interview.moreAnswersNeeded()&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;yes&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;answerQuestions&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;no&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;finish&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/action-state&gt;</span>
</span></span></code></pre></div><h3 id=액션-구현>액션 구현</h3><p>POJO 로직처럼 action 코드를 작성하는 것이 가장 일반적이다.<br>때로는 flow context에 접근할 필요가 있는 액션 코드를 작성할 필요가 있다.<br>이럴 때는 POJO를 호출하면서, EL 변수로 flowRequestContext를 건낼 수 있다.<br>그 대신 Action 인터페이스를 구현하거나, MultiAction 기본 클래스를 상속할 수도 있다.</p><h4 id=pojo-메소드-호출>POJO 메소드 호출</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;pojoAction.method(flowRequestContext)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>PojoAction</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>method</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>RequestContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=custom-action-구현-호출>custom Action 구현 호출</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;customAction&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>CustomAction</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>Action</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Event</span> <span style=color:#000>execute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>RequestContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=multiaction-구현-호출>MultiAction 구현 호출</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;multiAction.actionMethod1&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>CustomMultiAction</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>MultiAction</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Event</span> <span style=color:#000>actionMethod1</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>RequestContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Event</span> <span style=color:#000>actionMethod2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>RequestContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=액션-예외>액션 예외</h3><p>action은 복잡한 비즈니스 로직을 캡슐화하고 있는 서비스를 호출할 수도 있다.<br>이 서비스들은 비즈니스 예외를 던질 수도 있으니 이를 처리해야 할 수도 있다.</p><h4 id=pojo-액션-사용-시-비즈니스-예외-제어하기>POJO 액션 사용 시 비즈니스 예외 제어하기</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingAction.makeBooking(booking, flowRequestContext)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>BookingAction</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>makeBooking</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Booking</span> <span style=color:#000>booking</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>RequestContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>BookingConfirmation</span> <span style=color:#000>confirmation</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>bookingService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>make</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>booking</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFlowScope</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;confirmation&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>confirmation</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;success&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>RoomNotAvailableException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MessageBuilder</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>efaultText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;No room is available at this hotel&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;error&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=multiaction-사용-시-비즈니스-예외-제어하기>MultiAction 사용 시 비즈니스 예외 제어하기</h3><p>아래 예제는 이전 예제와 기능적으로는 동일하지만, POJO 액션 대신 MultiAction으로 구현했다.<br>Event ${methodName}(RequestContext) 규약에 따라 메소드를 구성하면 되고, POJO의 자유스러움에 비해, 보다 더 강력한 타입 안정성을 제공한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingAction.makeBooking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>BookingAction</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>MultiAction</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Event</span> <span style=color:#000>makeBooking</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>RequestContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Booking</span> <span style=color:#000>booking</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Booking</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFlowScope</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;booking&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>BookingConfirmation</span> <span style=color:#000>confirmation</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>bookingService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>make</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>booking</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getFlowScope</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;confirmation&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>confirmation</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>success</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>RoomNotAvailableException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessageContext</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>			       <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MessageBuilder</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>defaultText</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;No room is available at this hotel&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>error</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=다른-action-실행-예제>다른 Action 실행 예제</h3><h4 id=on-start>on-start</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;hotelId&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-start&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.createBooking(hotelId, currentUser.name)&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.booking&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-start&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span></code></pre></div><h4 id=on-entry>on-entry</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;changeSearchCriteria&#34;</span> <span style=color:#c4a000>view=</span><span style=color:#4e9a06>&#34;enterSearchCriteria.xhtml&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>popup=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-entry&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;render</span> <span style=color:#c4a000>fragments=</span><span style=color:#4e9a06>&#34;hotelSearchForm&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-entry&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><h4 id=on-exit>on-exit</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;editOrder&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-entry&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;orderService.selectForUpdate(orderId, currentUser)&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;viewScope.order&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-entry&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;save&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;finish&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;orderService.update(order, currentUser)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-exit&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;orderService.releaseLock(order, currentUser)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-exit&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><h4 id=on-end>on-end</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/webflow
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                      http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;input</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;orderId&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-start&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;orderService.selectForUpdate(orderId, currentUser)&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;flowScope.order&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-start&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;editOrder&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;save&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;finish&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;orderService.update(order, currentUser)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-end&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;orderService.releaseLock(order, currentUser)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-end&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/flow&gt;</span>
</span></span></code></pre></div><h4 id=on-render>on-render</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;reviewHotels&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;on-render&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;bookingService.findHotels(searchCriteria)&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#c4a000>result=</span><span style=color:#4e9a06>&#34;viewScope.hotels&#34;</span> <span style=color:#c4a000>result-type=</span><span style=color:#4e9a06>&#34;dataModel&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/on-render&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;select&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewHotel&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;set</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;flowScope.hotel&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;hotels.selectedRow&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><h4 id=on-transition>on-transition</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;subflow-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;addGuest&#34;</span> <span style=color:#c4a000>subflow=</span><span style=color:#4e9a06>&#34;createGuest&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;guestCreated&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;reviewBooking&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;booking.guestList.add(currentEvent.attributes.newGuest)&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/subfow-state&gt;</span>
</span></span></code></pre></div><h4 id=named-actions>Named actions</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;action-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;doTwoThings&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;service.thingOne()&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;attribute</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;name&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;thingOne&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/evaluate&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;service.thingTwo()&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;attribute</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;name&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;thingTwo&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/evaluate&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;thingTwo.success&#34;</span> <span style=color:#c4a000>to=</span><span style=color:#4e9a06>&#34;showResults&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/action-state&gt;</span>
</span></span></code></pre></div><h4 id=streaming-actions>Streaming actions</h4><p>아래 예는 flow에서 printBoardingPassAction를 호출하는 것으로 PDF로 프린트하고자 할 때 구현하는 예를 보여주고 있다.<br>AbstractAction을 상속한 PrintBoardingPassAction의 doExecute() 메소드 안에 실제 pdf 관련 소스를 구현하고 success()를 리턴한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;reviewItinerary&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;transition</span> <span style=color:#c4a000>on=</span><span style=color:#4e9a06>&#34;print&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;evaluate</span> <span style=color:#c4a000>expression=</span><span style=color:#4e9a06>&#34;printBoardingPassAction&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/view-state&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>PrintBoardingPassAction</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractAction</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Event</span> <span style=color:#000>doExecute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>RequestContext</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// stream PDF content here...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// - Access HttpServletResponse by calling context.getExternalContext().getNativeResponse();
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// - Mark response complete by calling context.getExternalContext().recordResponseComplete();
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>success</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li><a href=http://static.springframework.org/spring-webflow/docs/2.0.x/reference/html/index.html>Spring Web Flow reference 2.0.x</a> (링크 만료)</li><li>Spring Web-Flow Framework Reference beta with Korean (by 박찬욱)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-ec02c2174b3a681e22e139c6a7430d13>15 - Flow 상속</h1><div class=lead>Flow 상속은 상위 Flow의 설정을 하위 Flow에서 사용할 수 있도록 하며, 주로 global transition과 예외 핸들러를 상속받는 데 사용된다. 자바 상속과 유사하지만, 하위 Flow는 상위 Flow의 요소를 재정의할 수 없으며, 여러 상위 Flow를 상속받을 수 있다.</div><h1 id=flow-상속>Flow 상속</h1><h2 id=개요>개요</h2><p>Flow 상속은 한 Flow가 다른 Flow 설정을 상속할 수 있게 되어 있다. 상속은 Flow와 State 레벨에서 모두 발생할 수 있다.
가장 흔한 유즈케이스는 상위 Flow로 global transition과 예외 핸들러를 정의하고 하위 Flow로 그 설정을 상속받는 것이다.
상위 Flow를 찾으려면 다른 Flow들처럼 flow-registry에 추가해야 된다.</p><h2 id=설명>설명</h2><h3 id=flow-상속은-자바-상속과-비슷한가>Flow 상속은 자바 상속과 비슷한가?</h3><p>상위에 정의한 요소를 하위에서 접근할 수 있다는 측면에서는 자바 상속과 Flow 상속이 비슷하다.
하지만 몇 가지 차이점을 가지고 있다.</p><p>하위 Flow는 상위 Flow의 요소를 재정의할 수 없다. 상위와 하위 Flow에 있는 동일한 요소는 병합된다.
상위 Flow에만 있는 요소는 하위 Flow에 추가된다.</p><p><strong>하위 Flow는 여러 상위 Flow를 상속</strong>받을 수 있다. 그러나, 자바 상속은 단일 클래스로 제한된다.</p><h3 id=flow-상속-타입>Flow 상속 타입</h3><h4 id=flow-수준-상속>Flow 수준 상속</h4><p>Flow 수준 상속은 flow 내에 parent 속성을 이용하여 정의한다. 이 속성은 콤마로 구분하여 상속받을 Flow를 표현한다.
하위 flow는 목록에 명시된 순서대로 각각의 상위 Flow를 상속받는다.
첫 번째 상속으로 상위 Flow에 있는 요소와 내용을 추가하고 나면 그것을 다시 하위 Flow로 간주하고 그 다음 상위 flow를 상속 받는다.
아래 예를 보면 common-transitions를 먼저 상속 받고 다음에 common-states를 상속 받는다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>parent=</span><span style=color:#4e9a06>&#34;common-transitions, common-states&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><h4 id=state-수준-상속>State 수준 상속</h4><p>State 수준 상속은 Flow 수준 상속과 비슷하다. 유일한 차이점은 Flow 전체가 아니라 오직 해당 <strong>State 하나만 상위로부터 상속</strong>받는다.
Flow 상속과 달리 오직 하나의 상위만 허용한다. 또한 상속받을 Flow State의 식별자가 반드시 정의되어 있어야 한다.
Flow와 State 식별자는 #로 구분한다.
<strong>상위와 하위 State는 반드시 같은 타입이어야 한다.</strong> 예를 들어 view-state는 ent-state를 상속받을 수 없다. 오직 view-state만 상속받을 수 있다</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;view-state</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;child-state&#34;</span> <span style=color:#c4a000>parent=</span><span style=color:#4e9a06>&#34;parent-flow#parent-view-state&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><h3 id=추상-flow>추상 Flow</h3><p>종종 상위 Flow는 직접 호출하지 않도록 설계한다. 그런 Flow를 실행하지 못하도록 abstract로 설정할 수 있다.
만약 추상 Flow를 실행하려고 하면 FlowBuilderException가 발생한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;flow</span> <span style=color:#c4a000>abstract=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span></code></pre></div><h3 id=상속-알고리즘>상속 알고리즘</h3><p>하위 Flow가 상위 Flow를 상속할 때 발생하는 기본적인 일은 상위와 하위 Flow를 병합하여 새로운 Flow를 만드는 것이다.
웹 Flow 정의 언어에는 각각의 엘리먼트에 대해 어떻게 병합할 것인가에 대한 규칙이 있다.
엘리먼트에는 두 종류가 있다. 병합 가능한 것(mergeable)과 병합이 가능하지 않은 것(non-mergeable)이 있다.
병합 가능(mergeable)한 엘리먼트는 만약 엘리먼트가 같다면 병합을 시도한다. 병합이 가능하지 않은(non-mergeable) 엘리먼트는 항상 최종 Flow에 직접 포함된다.
병합 과정 중에 수정하지 않는다.</p><h4 id=주의>주의</h4><ul><li>상위 Flow에 있는 외부 리소스 경로는 절대 경로여야 한다. ** 상대 경로는 두 Flow를 병합할 때 상위 Flow와 하위 Flow가 위치한 디렉토리가 다르면 깨질 수 있다. 일반 병합하면, 상위 Flow에 있던 모든 상대 경로는 하위 Flow 기준으로 바뀐다.</li></ul><h4 id=병합-가능한mergeable-엘리먼트>병합 가능한(mergeable) 엘리먼트</h4><p>만약 같은 타입의 엘리먼트고 입력한 속성이 같다면 상위 엘리먼트의 내용을 하위 엘리먼트로 병합한다.
병합 알고리즘은 계속해서 병합하는 상위와 하위의 서브 엘리먼트를 각각 병합한다.
그렇지 않으면 상위 Flow의 엘리먼트를 하위 Flow에 새로운 엘리먼트로 추가한다.</p><p>대부분의 경우 상위 flow의 엘리먼트가 하위 Flow 엘리먼트에 추가된다.
이 규칙에 예외로는 시작할 때 추가될 action 엘리먼트(evaluate, render, set)가 있다. 상위 action의 결과를 하위 action 결과로 사용하게 한다.</p><p>병합이 가능한 엘리먼트는 다음과 같다.</p><ul><li>action-state: id</li><li>attribute: name</li><li>decision-state: id</li><li>end-state: id</li><li>flow: 항상 병합</li><li>if: test</li><li>on-end: 항상 병합</li><li>on-entry: 항상 병합</li><li>on-exit: 항상 병합</li><li>on-render: 항상 병합</li><li>on-start: 항상 병합</li><li>input: name</li><li>output: name</li><li>secured: attributes</li><li>subflow-state: id</li><li>transition: on and on-exception</li><li>view-state: id</li></ul><h4 id=병합할-수-없는-엘리먼트>병합할 수 없는 엘리먼트</h4><p>병합할 수 없는 엘리먼트는 다음과 같다</p><ul><li>bean-import</li><li>evaluate</li><li>exception-handler</li><li>persistence-context</li><li>render</li><li>set</li><li>var</li></ul><h2 id=참고자료>참고자료</h2><ul><li><a href=http://static.springframework.org/spring-webflow/docs/2.0.x/reference/html/index.html>Spring Web Flow reference 2.0.x</a> (링크 만료)</li><li>Spring Web-Flow Framework Reference beta with Korean (by 박찬욱)</li><li><a href=http://whiteship.me/2146>Whiteship&rsquo;s Note</a> (링크 만료)</li></ul></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/eGovFramework/egovframe-docs aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2016&ndash;2024
<span class=td-footer__authors>eGovFrame | <a href="https://www.egovframe.go.kr/home/sub.do?menuNo=23">Apache 2.0</a> |</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href="https://www.egovframe.go.kr/home/sub.do?menuNo=77" target=_blank rel=noopener>개인정보 보호 정책</a></span></div></div></div></footer></div><script src=/egovframe-docs/js/main.min.4eb19af2236072614b7d308c10176f918f1b447443492377d98b5b2c5e44aac3.js integrity="sha256-TrGa8iNgcmFLfTCMEBdvkY8bRHRDSSN32YtbLF5EqsM=" crossorigin=anonymous></script>
<script defer src=/egovframe-docs/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script>
<script src=/egovframe-docs/js/tabpane-persist.js></script></body></html>