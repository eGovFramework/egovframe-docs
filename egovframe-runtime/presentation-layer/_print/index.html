<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=ko class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://eGovFramework.github.io/egovframe-docs/egovframe-runtime/presentation-layer/><link rel=alternate type=application/rss+xml href=https://eGovFramework.github.io/egovframe-docs/egovframe-runtime/presentation-layer/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/egovframe-docs/favicons/favicon.ico><link rel=apple-touch-icon href=/egovframe-docs/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/egovframe-docs/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/egovframe-docs/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/egovframe-docs/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/egovframe-docs/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/egovframe-docs/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/egovframe-docs/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/egovframe-docs/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/egovframe-docs/favicons/android-192x192.png sizes=192x192><title>화면처리 | 표준프레임워크 개발가이드</title><meta name=description content="화면처리 서비스그룹은 업무처리 서비스와 사용자간의 인터페이스를 담당하는 서비스로 사용자 화면 구성 및 사용자 입력 정보 검증 등의 기능을 지원한다."><meta property="og:title" content="화면처리"><meta property="og:description" content="화면처리 서비스그룹은 업무처리 서비스와 사용자간의 인터페이스를 담당하는 서비스로 사용자 화면 구성 및 사용자 입력 정보 검증 등의 기능을 지원한다."><meta property="og:type" content="website"><meta property="og:url" content="https://eGovFramework.github.io/egovframe-docs/egovframe-runtime/presentation-layer/"><meta itemprop=name content="화면처리"><meta itemprop=description content="화면처리 서비스그룹은 업무처리 서비스와 사용자간의 인터페이스를 담당하는 서비스로 사용자 화면 구성 및 사용자 입력 정보 검증 등의 기능을 지원한다."><meta name=twitter:card content="summary"><meta name=twitter:title content="화면처리"><meta name=twitter:description content="화면처리 서비스그룹은 업무처리 서비스와 사용자간의 인터페이스를 담당하는 서비스로 사용자 화면 구성 및 사용자 입력 정보 검증 등의 기능을 지원한다."><link rel=preload href=/egovframe-docs/scss/main.min.19c9649623f11a8e1a7bf9b22db92c1b1350433f3ac8ceabd50c30ca684a2e5a.css as=style integrity="sha256-GclkliPxGo4ae/myLbksGxNQQz86yM6r1QwwymhKLlo=" crossorigin=anonymous><link href=/egovframe-docs/scss/main.min.19c9649623f11a8e1a7bf9b22db92c1b1350433f3ac8ceabd50c30ca684a2e5a.css rel=stylesheet integrity="sha256-GclkliPxGo4ae/myLbksGxNQQz86yM6r1QwwymhKLlo=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/egovframe-docs/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="60" height="25" viewBox="0 0 60 25" enable-background="new 0 0 60 25"><image id="image0" width="60" height="25" x="0" y="0" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAZCAYAAABtnU33AAAAIGNIUk0AAHomAACAhAAA+gAAAIDo AAB1MAAA6mAAADqYAAAXcJy6UTwAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAAHCAAABwgAc0P m54AAAHcelRYdFJhdyBwcm9maWxlIHR5cGUgeG1wAAA4jYVUQZLjIAy86xX7BCyBBM/x2vg2VXPc 528Lj23imIypOAlI6lZLiP59fdMffywlksWyzJZ1taCrJos6cfD/umg18TNZmXXSqJuyJpn3/dN6 Y+ZAVxhs/nWXlOOaAocouhkcOYhyldA+LDXMHHyBAiO4ypw4Rop6w98PnUO2iBVkBuZm7eFqMOLa IIw3maT44o0kCGOD8V73IPgWKwgL2pZ5dQA/vrjcGcWoiUxUsFFaagUqVDD8MYAuDGwo4QwhxEug flmmXlRX6j2pxqheYuM31NMV6WZwDp4gV6Tmqn/CuqBQpQzWDwpqpRHa4bTj/Q7Xp+Ya6TPeMLkf H6/aiXevylmbXbs5elESVIle/ORBN12kxgZADSHEAmaTmqbUjDVakaXJ+THIBU099inmnAIaIsN1 QZ87fVwHT3BvEKlorAl9s1xa0u9OzwlfoH6VdKFGVXBhJwiYgDX1OIfZ3eo9OA1TKo8pCa7UC9Dh QSOXQQWPFplT9rJY4+uXiE4sa5e3JTY2H8PQDac8Ow5gOmv6jPMKE30KlSZBbD11wACAeoSR4X0O 8dZPon0QUT+J+jF6Gfsgjepne6/fJ7yf0H9Fc2ZpNW51UwAAAAFvck5UAc+id5oAAAyuSURBVFjD tZd/kFXlecc/z3vOub932R/sroKC+GuUNWOMxNq0UTDGtqZ2iHLXSttEO9GkMaBi0KBWz4yGKKBW MU0wWm20Gu9V04mGaJoWNErjTMyodRGMCkXk18ICu3vv3XvPed+nf5zLdTUSTWd8/rrz3vf5/X3e 53uEg4iCCKiGoV/N5UvWpL846tgZYc4+4qpv/KZULHoD5bLlo4kkJpEr79p4U0PNYRFBPRZPrZdq U5EH7/9a7+piseSVywMf1eb/S8xB/wlDDyDOZhfncvkvGhG68oU+8YIVAMVy2X10N5qYBMEEA5m2 7i+ZVPZiCTKXZDt6L1AvfxJA/9eL8nEme9CEVVUkDGMNw5wPC+rVmoucfXxftbo14wdzNtzy/VkC WiqWvD/E2Q2gLq5X65W9uEalro1aLaqOQlyLANY+83Gne7AOl8vJeS59GoX8oTG6pHPx5edF2pgf O0fg+58DKPav/4M6IqCIZF0cXaeWs1SjYlzbNxdTfQxg7Q18rHBuiSqiYehrKemYhqEPoLcsXam3 3Dw8sTBvLv/+T19f8YOnAA7cL5VKXqlU8hSVxJ5KGIYtnTAMjWry3+UrN7yx8I7XPvMBQUgYqglD NcWStpBTLKk3O1Q/VJ1gTw2qUiypN3uN+gfOZq9Rn6aflr427xw41+RBeddvGBptBqvLlv5al918 H8C2cFUO4M1bV/3D67fes/6Arr7PAe+z9365fOWGNxbc+dpZAMVQU8WSemGoH4y099ueUMT3Hr9P v6k3sUgHzn0B1SuuyNJrvozz3pRrw/94t8sy3Vq9C6Cyp24BnHOvOTFT7gvvy0h40TgirF7x8LyG pHNzR195kDB0K1Y8MVnEZq+8cu7bAN9c/nQ+Q6b3psWnbxIRRV3y4M0s2/LAgC0Dl6zSYLT2alfQ OaMPguN/+OX0I4jo/Ef0bAmY5Rz//vA8eQWg+IROHd/24t7sMSfPNgHd4WflgeJzOo0051Pj/rLI ULGkXihiz12vp0mKT+Yq3PuASMUHoFeuor09ZHS8pt++5lS5dukr+FEfmsp6gQwCHN09bAF8MTsw fPeiwXwE8F/LH/6CpHPldJDjUU5Oz4MftAeFeRjvTGAeQFv+sNMUWQR8/j0AKAOogGjsV3uCrpk3 K5r3M965F96nTzdSHGsCfprtg8puzv+b1frH/3a2jPiTWFhoO7mi8HW/QF/xGX1OUiyZdAwXj2ym C1hSHhBbfFlnkOLx7DS6a9s5FFhiNLyiC1jE6Kglm83iy6UApII+RKNq3W1thucAqmPb3zpm0cXX 0tyXnmcWe2Ko1WvgyRIAEXYrfKKVWBzNxNlsE1YeSAK1/n5vdrjWAzBOLS7+I+DMOMIN79ptTYqF QRYqu9iZmsRMjfgzAI3pULgMoU9jMFmuxzC3ugPU59ziOs0CSJ5LU510V7fSUI8F52zTyYa0zMHz 2omjM6jUVoH5SwCMX0BMdXRvamTifJchHgxLKYB1t5WmisjplVrlqnocXZRJZ2c8tOKJ46oavWyt y4S3r+lIcrSHW9f4bXPChdjVAMphf2NtOCcGiP2hOnF9Mi4OVHm6Z8bkADirMcpyN86nGiNUCDgF AItNF+jSmIvjOqvTBS6UmJ81xrhcLMeSZmrzjSnWhyjbKqegpFLCGQZ1c4jj5+W6O56Fxp2o69Tv fKsTKx5o9Owp08cBJAydhKELw9CVWR8nJbCnOBdXRj1z13lXnnf/WK06hO+fftnedZsQCXJeqjsp nswA2doMwuH7c7+yctP5f3/X1ku+9N0d5wNUqvkYY7rE2mUP/q2cXYuYpkpK4O4fXSDbVPmxWo5K 7FFojLD1kc/JPQKPGw8M3FqeJXeoYcSl6CgOahcRU5yw/McnyMuiPIVltg8cj2MNAI3RzWRyO8Ec iYhDiQcGEuhuCsNMLZjUORZEWqlmfGCr4vpFzEsDiwZqSSDml9a6WYThKr1zzngGexjwpjjXh3hv NoES+blJi/xGDOl2XKO+fXaoj6XsG0YlXxMv9RyASdEhhu3eyOatAGLYqMKpAEZJOeFFADyGasNU x/bwdnNF7DQWY1Ic5YSdsWNDcx5fEDjdAL3gXkm6eHcVka2Im0KMA2nRx47C5FO60unVPabjsSnt bY/oJZcEqmaKYN6Y8OoPGt+fBqCOvc7pIclMmy5PzJbkDooqB+gmzhlYi/opT1THrB3fBmCj0Vdd Lb6skj8i2e0+Qy0/BhHDFgCx1DC8k6sykpijhsE6y2HA2z85TkYB1ON/ROj2MWRxpkdvvPx4rESA Qbx2PG8IXFAqlbyBgQHre9Lb0dbxyd3jlv2x440pJ2RB2xXd0XqcjG4Toa05qztQmZb81sx4VNnS 7IAfVffdHpvMC7aytwPj718bzokvWLXNQ0zN82QM4OH57buBnwMUS9ojDS5E2JZkjGCTBNUjwjBW HhDbtO9EUevTIUBxUI82jiCK6NEMOR9LBt+sQPwKGEfg91KP/5nAWZTg0+vXB4CtxI3h4eHdG+sS jNclOPKQbE13iRac2tFW5R37LS4H4JS3ReSQS5e+0I0qLura2VxCxsCj9yyYsW4iJ/Bd1Sidsai2 6GWxpD0BXE+Gc7LdTK/u4cEWmBxRsgEAf4IhRVA8YqzfxqlRiuedjzFCHscOgxDgeVlEJoP0kk6B ZwIaOoqScZlMGqCvsv/ZadWFM0cqlTNFZF/d5lOqIqJNxwl0K5iEhqp4mx3a11Uw01DGll19XFIY FVWhkCQ0mDpADaGAINaZbGuM0sKNuT6+YQzTa8NYkfewuIMzugBUcV4GROjFMNlkyBKQ9wGlES1H vI04k2bfSBui63B+HTWpI/2gA9hfHhzUgTJuwy22HunEgr7Ls521aTV+M2C32Yj3p77I0SC7AIrF YpMje807g3bt7JluYgrGJfaK/zLaA8yv7aGhyo2aJhA4sdVFg3IQcXWctJGvD7EeuBmPSbaKMRnG fUTqiHlElqx4caKShmEXqYyN43g68L/F/n6hXKbhnC8eopmMqkpdkGwrXl8KojQSqOkW57m88fRE p7oFoL+/X/bye0QF6yedC/KF44E2tZz3UFEen/8zXai2Cd4P+UZzHk4ED58N5WPlgfeMDmgdOBZ4 URcsSNPX/gni4C0Jw2Fd9p2Kb7yTgGc59FABGDEmngR2hBHEFIaNSFcrYZVeI94YgDPRDicZ3ygn OMxLyY3TSbj0QZojkPKa6TiORNj40IA8nhSQTuTDUgUENYJxMXvF4zAAQjXnXcQRAjMMKrtReziA rFxZJx38Ezkzt1nx1yPVLwBs304A0O3au0Wksyedblhrh6zT6a0GOXeUdfFugP37h3cZ8WIDJyE2 YVl8+Be+jcYFQIQOYNeERA4X/QgJJ8XyPOUdHIfOXqM+oTiT5lTy3GkQeQvjfRpAl17ajXUnYt22 ppNfBL7/+XduuvXwKeFXqwBeynwrG6Tah4bAiWwUNTMP+DHGnGSEjQBhODAWq42DVHqauOB1gJmD g+p+93PyYNIAJrWKqcxCmuPyAcho3UsWfMqk2IRPd/dUEl4Q8yfSYLcBXYdyjl51VRu0z0U0j+HV RDv+OX7ApLRZtXnZ7Z/auuJ73875qa/WosaW/vDSMeuiV8Qz059c9vBnH13xxHGeMbOc8N/vejfb nIup22gHwPr+cvKu/x7xgow2A9+B4ehiSbvml/TkdIETEcYPwLal4L9XXwSnAekfHS1vozgR/q7Z 9aIanjeoWYvnpenkKYwsR+Q3cnW4VcPQyNXX/Tpu1J/PZ3N/kcH7paLXpIMUTu33AKan92+0qls8 P/VDMe5R51y1YeVXrXyFbXHUGB0JOnclXUdVcU4PNsRY6yVfZR68BuRShkfJ8K+NMRoqpJpttKJJ 0qKoKO++9IoVkvFDeVYM/zhvk/6n30aPGFYbuebW9Vj7JB3tn6GQ78Tq3QDs2RMA1CGs1KrkAj9X SGfYW6k8s2Hsnds0VHPMwoX12LpV3ZO6jujp6OlXdfd+ZdGfD4fhmgyAOnaKMSMrFx5Tb4VjTJsY 0+xLsRVn7ItgTBsJK+eBv5bXEH5VmMocEWYgXI9wLIB6pNWQaSLBP7DXk7miYEyz745VfgEvM5Uz 4iovlnvluabjYAH7RgW8DeWjfnsvgKxc2dAwNLJ48S/2rbi9WI/tgnpcHxwRc/1AGDZKxUEP4J2x 6m2RDM+oi1cYrlduABgcHIoAnPKkWvvWhElTQa+II/cqQLmIownxeLQxEnjRlZkev7W5NOabY9tZ rsq9keUhvy3hzy7mLt8k1NJPsb4Rc21Lx3Jd7HgJoHyc/GTe63pTVOWv1ONrAP8HnXv5+VCzqmwA AACWZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBMQAC AAAAEQAAAFqHaQAEAAAAAQAAAGwAAAAAAAAASAAAAAEAAABIAAAAAUFkb2JlIEltYWdlUmVhZHkA AAADoAEAAwAAAAEAAQAAoAIABAAAAAEAAAA8oAMABAAAAAEAAAAZAAAAAAcgI+gAAAAldEVYdGRh dGU6Y3JlYXRlADIwMjQtMTItMTVUMDk6MjE6MTErMDA6MDDm9w0tAAAAJXRFWHRkYXRlOm1vZGlm eQAyMDI0LTEyLTE1VDA5OjIxOjExKzAwOjAwl6q1kQAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAy NC0xMi0xNVQwOToyMToxMSswMDowMMC/lE4AAAATdEVYdGV4aWY6Q29sb3JTcGFjZQAxLCCMM8Ni AAAAFXRFWHRleGlmOkV4aWZPZmZzZXQAMTA4LCDt5R1PAAAAGXRFWHRleGlmOlBpeGVsWERpbWVu c2lvbgA2MCwgoYmFBAAAABl0RVh0ZXhpZjpQaXhlbFlEaW1lbnNpb24AMjUsIJHbC1AAAAAedEVY dGV4aWY6U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkefmo5qwAAAASdEVYdHRpZmY6T3JpZW50YXRp b24AMber/DsAAAAQdEVYdHhtcDpDb2xvclNwYWNlADEFDsjRAAAAIHRFWHR4bXA6Q3JlYXRvclRv b2wAQWRvYmUgSW1hZ2VSZWFkeSr/T6AAAAAXdEVYdHhtcDpQaXhlbFhEaW1lbnNpb24AMjE2rgMn zQAAABZ0RVh0eG1wOlBpeGVsWURpbWVuc2lvbgAzMG6tL6oAAAAASUVORK5CYII="/></svg></span><span class=navbar-brand__name>표준프레임워크 개발가이드</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/egovframe-docs/egovframe-development/><span>개발환경(예정)</span></a></li><li class=nav-item><a class="nav-link active" href=/egovframe-docs/egovframe-runtime/><span>실행환경</span></a></li><li class=nav-item><a class=nav-link href=/egovframe-docs/runtime-example/><span>실행환경 예제</span></a></li><li class=nav-item><a class=nav-link href=/egovframe-docs/common-component/><span>공통컴포넌트(예정)</span></a></li><li class="td-light-dark-menu nav-item dropdown"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg><button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown data-bs-display=static aria-label="Toggle theme (auto)"><svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=bd-theme-text><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false><svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false><svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true><svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></li></ul></div><div class="d-none d-lg-block"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>이 섹션의 다중 페이지 출력 화면임.
<a href=# onclick="return print(),!1">여기를 클릭하여 프린트</a>.</p><p><a href=/egovframe-docs/egovframe-runtime/presentation-layer/>이 페이지의 일반 화면으로 돌아가기</a>.</p></div><h1 class=title>화면처리</h1><div class=lead>화면처리 서비스그룹은 업무처리 서비스와 사용자간의 인터페이스를 담당하는 서비스로 사용자 화면 구성 및 사용자 입력 정보 검증 등의 기능을 지원한다.</div><ul><li>1: <a href=#pg-31d1e27d9723b118049c7ab30b5e6856>MVC 패턴의 구조와 장점</a></li><li>2: <a href=#pg-46a24bf728a7b6d614218e3ae8e5698a>Spring MVC Architecture</a></li><li>3: <a href=#pg-414119c332a5904a6a37e49b0f982ed5>DispatcherServlet</a></li><li>4: <a href=#pg-1e6ea5844632d444ed56cc47c3b13d29>HandlerMapping</a></li><li>5: <a href=#pg-9902299d75c3bd5be2057d1f696164b2>Spring MVC Tag Configuration</a></li><li>6: <a href=#pg-404522f2d68d13c85437f6487909b10e>Controller</a></li><li>7: <a href=#pg-838d8dd01c23d19c4a43f0b79103b750>Annotation 기반 Controller</a></li><li>8: <a href=#pg-08c319109072509092038f7418a9ad23>Spring의 Validator 인터페이스와 유효성 검증</a></li><li>9: <a href=#pg-e3291d7d5b4efb88c0537abb957414ce>Bean Validation (JSR-303)</a></li><li>10: <a href=#pg-d376ca86ffb3d14bd557c43cd7ad20c7>View</a></li><li>11: <a href=#pg-769189172b147f11b368571eb0e70527>Map 객체를 통한 입력값 처리 방법</a></li><li>12: <a href=#pg-8b462a89cad5cb2cce2bcc7099517989>스프링 WebFlux와 기존 스프링 웹 프레임워크 비교</a></li><li>13: <a href=#pg-1582f4d95d21529049f014dc9e60cbbf>Reactive Core</a></li><li>14: <a href=#pg-171474be9b8ab96df2310f8efa41d340>스프링 WebFlux의 DispatcherHandler와 요청 처리 흐름</a></li><li>15: <a href=#pg-05e9c669eccc17bab65bea194cc4c753>스프링 WebFlux에서 어노테이션 기반 컨트롤러 활용 방법</a></li><li>16: <a href=#pg-88748e6fc2135df036998e22b14cbb02>스프링 WebFlux 함수형 프로그래밍 모델(WebFlux.fn)</a></li><li>17: <a href=#pg-2ebe607b413b815db2b35319495701e5>스프링 WebFlux의 WebClient와 논블로킹 처리</a></li><li>18: <a href=#pg-0ddb00a1ec9b767ebfb20ab06b1ef199>Ajax 지원 서비스</a></li><li>19: <a href=#pg-3910939c1a51aaefec093fee2eff210d>Internationalization(국제화)</a></li><li>20: <a href=#pg-4cc496746aaa077bb2f35dd989e2fea3>Security Service</a></li><li>21: <a href=#pg-4ab5f38785f99b8ed0ac7565fd474633>Spring Framework + Jakarta Commons Validator</a></li><li>22: <a href=#pg-e45a4e52ea7552fe6295b4e19061e54d>Commons Validator에 validation rule 추가하기</a></li><li>23: <a href=#pg-1fd485618572aabc83908f6a1e83b440>UI Adaptor Service</a></li><li>24: <a href=#pg-abc8b87ef1cdce547d3438e20f288215>Asynchronous request processing</a></li><li>25: <a href=#pg-b9ed1bdf40b7ae592cb22b9c8363ac24>jQuery 가이드</a></li><li>26: <a href=#pg-35218b5f118a49ed5ac39c858d34c2bf>WebSocket</a></li><li>27: <a href=#pg-d54688493603f8e6fe7e2cb7d9d22f8e>STOMP over WebSocket 개요 및 메시지 처리 흐름</a></li><li>28: <a href=#pg-43e62e63dc735ca18e8286a5e96a43cf>SockJS Fallback Options</a></li><li>29: <a href=#pg-86ef8b41b494dd5887eb46c6b99cc161>UI - bootstrap</a></li><li>30: <a href=#pg-b243bf573fb36b506ca8d9b28e282192>UX/UI Controller Component</a></li><li>31: <a href=#pg-7293ece693e0270846af1dfc6d4eca30>HTML5 CSS3.0 JavaScript Module App Framework 기본 활용</a></li></ul><div class=content><h1 id=화면처리>화면처리</h1><p>화면처리 서비스그룹은 업무처리 서비스와 사용자간의 인터페이스를 담당하는 서비스로 사용자 화면 구성 및 사용자 입력 정보 검증 등의 기능을 지원한다.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-31d1e27d9723b118049c7ab30b5e6856>1 - MVC 패턴의 구조와 장점</h1><div class=lead>MVC 패턴은 애플리케이션의 기능을 Model, View, Controller로 분리하여 UI 코드와 비즈니스 로직의 종속성을 줄이고, 재사용성과 변경 용이성을 높인다. 표준프레임워크에서 &ldquo;MVC 서비스"는 이 패턴을 활용한 Web MVC Framework를 의미한다.</div><h1 id=web-servlet>Web Servlet</h1><h2 id=개요>개요</h2><p><img src=images/web-servlet.jpg alt="MVC(Model-View-Controller) 패턴"></p><p><strong>MVC(Model-View-Controller) 패턴</strong>은 코드를 기능(역할)에 따라 <strong>Model, View, Controller</strong> 3가지 요소로 분리한다.</p><ul><li><strong>Model</strong> : 애플리케이션의 데이터와 비즈니스 로직을 담는 객체이다.</li><li><strong>View</strong> : Model의 정보를 사용자에게 표시한다. 하나의 Model을 다양한 View에서 사용할 수 있다.</li><li><strong>Controller</strong> : Model과 View의 중계 역할을 한다. 사용자의 요청을 받아 Model에 변경된 상태를 반영하고, 응답을 위한 View를 선택한다.</li></ul><p>MVC 패턴은 <strong>UI 코드와 비즈니스 코드를 분리</strong>함으로써 <u>종속성을 줄이고, 재사용성을 높이고, 보다 쉬운 변경이 가능</u>하도록 한다.</p><p>MVC 패턴이 Web Framework에만 사용되는 단어는 아니지만, 표준프레임워크에서 “MVC 서비스”란 MVC 패턴을 활용한 Web MVC Framework를 의미한다.</p><h2 id=설명>설명</h2><p>오픈소스 Web MVC Framework에는 Spring MVC, Struts, Webwork, JSF 등이 있으며, 각각의 장점을 가지고 사용되고 있다.<br>기능상에서 큰 차이는 없으나, 아래와 같은 장점을 고려 <strong>표준프레임워크에서는 Spring Web MVC를 MVC 서비스의 기반 오픈 소스로 채택</strong>하였다.</p><ul><li>Framework 내의 특정 클래스를 상속하거나, 참조, 구현해야 하는 등의 제약사항이 비교적 적다.<br>Controller(Spring 2.5 @MVC)나 Form 클래스 등이 좀 더 POJO-style에 가까워 비즈니스 로직에 집중된 코드를 작성할 수 있다.</li><li>IOC Container가 Spring이라면 (간단한 설정으로 Struts나 Webwork 같은 Web Framework을 사용할 수 있겠지만) 연계를 위한 추가 설정 없이 Spring MVC를 사용할 수 있다.<br><strong>표준프레임워크의 IOC Container는 Spring</strong>이다.</li><li>오픈소스 프로젝트가 활성화(꾸준한 기능 추가, 빠른 bug fix와 Q&amp;A) 되어 있으며 로드맵이 신뢰할만하다.</li><li>국내 커뮤니티 활성화 정도, 관련 참고 문서나 도서를 쉽게 구할 수 있다.</li></ul><h3 id=spring-mvc>Spring MVC</h3><p>Spring MVC에 대한 설명은 아래 상세 페이지를 참고하라.</p><ul><li><a href=./web-servlet-spring-mvc-architecture.md>Spring MVC Architecture</a></li><li><a href=./web-servlet-dispatcherservlet.md>DispatcherServlet</a></li><li><a href=./web-servlet-handlermapping.md>HandlerMapping</a></li><li><a href=./web-servlet-controller.md>Controller</a></li><li><a href=./web-servlet-annotation-based-controller.md>Annotation-based Controller</a></li><li><a href=./web-servlet-validation.md>Validation</a></li><li><a href=./web-servlet-declarative-validation.md>Declarative Validation</a></li><li><a href=./web-servlet-view.md>View</a></li></ul><h3 id=예제-실행>예제 실행</h3><ul><li><a href=../../runtime-example/individual-example/presentation-layer/easycompany-example.md>easycompany 설치 가이드</a> : MVC와 Ajax Support, Security의 예제 코드인 easycompany 설치와 실행 방법을 가이드 한다.</li></ul><h2 id=참고-자료>참고 자료</h2><ul><li>🌏 <a href=https://web.archive.org/web/20090227080302/http://java.sun.com/blueprints/patterns/MVC-detailed.html>SUN Java BluePrints, Model-View-Controller</a></li></ul><h2 id=서블릿-개발과-동작과정png>서블릿 개발과 동작과정.png</h2><img width=302 alt="서블릿 개발과 동작과정" src=https://github.com/user-attachments/assets/c503f93b-9837-4203-aada-4bb3f7a669ee></div><div class=td-content style=page-break-before:always><h1 id=pg-46a24bf728a7b6d614218e3ae8e5698a>2 - Spring MVC Architecture</h1><div class=lead>Spring MVC는 DispatcherServlet, HandlerMapping, Controller, ViewResolver 등 각 컴포넌트의 역할이 명확히 분리되어 있으며, 다양한 인터페이스와 구현 클래스를 제공해 유연한 선택이 가능하다. POJO 스타일의 클래스 작성으로 비즈니스 로직에 집중할 수 있으며, 웹 요청 파라미터와 커맨드 클래스 간 데이터 매핑, 데이터 검증, 오류 처리 기능을 지원한다. 또한 JSP 폼 구성을 위한 태그 라이브러리도 제공한다.</div><h1 id=spring-mvc-architecture>Spring MVC Architecture</h1><h2 id=개요>개요</h2><p>Spring Framework은 간단한 설정만으로 Struts나 Webwork같은 Web Framework을 사용할 수 있지만, 자체적으로 MVC Web Framework을 가지고 있다.
Spring MVC는 기본요소인 Model, View, Controller 외에도, 아래와 같은 특성을 가지고 있다.</p><ul><li>DispatcherServlet, HandlerMapping, Controller, Interceptor, ViewResolver, View등 각 컴포넌트들의 역할이 명확하게 분리되어 있다.</li><li>HandlerMapping, Controller, View등 컴포넌트들에 다양한 인터페이스 및 구현 클래스를 제공함으로써 경우에 따라 선택하여 사용할 수 있다.</li><li>Controller(@MVC)나 폼 클래스(커맨드 클래스) 작성시에 특정 클래스를 상속받거나 참조할 필요 없이 POJO 나 POJO-style의 클래스를 작성함으로써 비지니스 로직에 집중한 코드를 작성할 수 있다.</li><li>웹요청 파라미터와 커맨드 클래스간에 데이터 매핑 기능을 제공한다.</li><li>데이터 검증을 할 수 있는, Validator와 Error 처리 기능을 제공한다.</li><li>JSP Form을 쉽게 구성하도록 Tag를 제공한다.</li></ul><h2 id=설명>설명</h2><p>Spring MVC(Model-View-Controller)의 핵심 Component는 아래와 같다.</p><table><thead><tr><th>Component</th><th>개요</th></tr></thead><tbody><tr><td>DispatcherServlet</td><td>Spring MVC Framework의 Front Controller, 웹요청과 응답의 Life Cycle을 주관한다.</td></tr><tr><td>HandlerMapping</td><td>웹요청시 해당 URL을 어떤 Controller가 처리할지 결정한다.</td></tr><tr><td>Controller</td><td>비지니스 로직을 수행하고 결과 데이터를 ModelAndView에 반영한다.</td></tr><tr><td>ModelAndView</td><td>Controller가 수행 결과를 반영하는 Model 데이터 객체와 이동할 페이지 정보(또는 View객체)로 이루어져 있다.</td></tr><tr><td>ViewResolver</td><td>어떤 View를 선택할지 결정한다.</td></tr><tr><td>View</td><td>결과 데이터인 Model 객체를 display한다.</td></tr></tbody></table><p>이들 컴포넌트간의 관계와 흐름을 그림으로 나타내면 아래와 같다.</p><p><img src=../images/web-servlet--spring-mvc-architecture.png alt=web-servlet&amp;ndash;spring-mvc-architecture></p><ol><li>Client의 요청이 들어오면 DispatchServlet이 가장 먼저 요청을 받는다.</li><li>HandlerMapping이 요청에 해당하는 Controller를 return한다.</li><li>Controller는 비지니스 로직을 수행(호출)하고 결과 데이터를 ModelAndView에 반영하여 return한다.</li><li>ViewResolver는 view name을 받아 해당하는 View 객체를 return한다.</li><li>View는 Model 객체를 받아 rendering한다.</li></ol><p>이 가이드문서는 Spring 2.5.6 버젼을 기준으로 작성되었다.</p><h2 id=참고자료>참고자료</h2><ul><li>The Spring Framework - Reference Documentation 2.5.6</li><li>Spring Framework API Documentation 2.5.6</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-414119c332a5904a6a37e49b0f982ed5>3 - DispatcherServlet</h1><div class=lead>DispatcherServlet은 Spring MVC의 유일한 Front Controller로, 모든 웹 요청을 처리하고 결과 데이터를 클라이언트에 응답하는 핵심 요소이다. 웹 요청의 전체 라이프사이클을 주관하며 Controller로의 진입점 역할을 한다.</div><h1 id=dispatcherservlet>DispatcherServlet</h1><h2 id=개요>개요</h2><p>Spring MVC Framework의 유일한 Front Controller인 DispatcherServlet은 Spring MVC의 핵심 요소이다.
DispatcherServlet은 Controller로 향하는 모든 웹요청의 진입점이며, 웹요청을 처리하며, 결과 데이터를 Client에게 응답 한다.
DispatcherServlet은 Spring MVC의 웹요청 Life Cycle을 주관한다 할 수 있다.</p><h2 id=설명>설명</h2><h3 id=dispatcherservlet에서의-웹요청-흐름>DispatcherServlet에서의 웹요청 흐름</h3><p>Client의 웹요청시에 DispatcherServlet에서 이루어지는 처리 흐름은 아래와 같다.
좀더 자세한 처리 흐름을 알고 싶다면 디버깅모드로 과정을 추적해 보는 것을 권장한다.</p><p><img src=../images/web-servlet-dispatcherservlet-flow.png alt="DispatcherServlet flow"></p><ol><li>doService 메소드에서부터 웹요청의 처리가 시작된다. DispatcherServlet에서 사용되는 몇몇 정보를 request 객체에 담는 작업을 한 후 doDispatch 메소드를 호출한다.</li><li>아래 3번~13번 작업이 doDispatch 메소드안에 있다. Controller, View 등의 컴포넌트들을 이용한 실제적인 웹요청처리가 이루어 진다.</li><li>getHandler 메소드는 RequestMapping 객체를 이용해서 요청에 해당하는 Controller를 얻게 된다.</li><li>요청에 해당하는 Handler를 찾았다면 Handler를 HandlerExecutionChain 객체에 담아 리턴하는데, 이때 HandlerExecutionChain는 요청에 해당하는 interceptor들이 있다면 함께 담아 리턴한다.</li><li>실행될 interceptor들이 있다면 interceptor의 preHandle 메소드를 차례로 실행한다.</li><li>Controller의 인스턴스는 HandlerExecutionChain의 getHandler 메소드를 이용해서 얻는다.</li><li>HandlerMapping과 마찬가지로 여러개의 HanlderAdaptor를 설정할 수 있는데, getHandlerAdaptor 메소드는 Controller에 적절한 HanlderAdaptor 하나를 리턴한다.</li><li>선택된 HanlderAdaptor의 handle 메소드가 실행되는데, 실제 실행은 파라미터로 넘겨 받은 Controller를 실행한다.</li><li>계층형 Controller인 경우는 handleRequest 메소드가 실행된다. @Controller인 경우는 HanlderAdaptor(AnnotationMethodHandlerAdapter)가 HandlerMethodInvoker를 이용해 실행할 Controller의 메소드를 invoke()한다.</li><li>interceptor의 postHandle 메소드가 실행된다.</li><li>resolveViewName 메소드는 논리적 뷰 이름을 가지고 해당 View 객체를 반환한다.</li><li>Model 객체의 데이터를 보여주기 위해 해당 View 객체의 render 메소드가 수행된다.</li></ol><h3 id=webxml에-dispatcherservlet-설정하기>web.xml에 DispatcherServlet 설정하기</h3><p>Spring MVC Framework을 사용하기 위해서는 web.xml에 DispatcherServlet을 설정하고, DispatcherServlet이 WebApplicationContext를 생성할수 있도록 빈(Bean) 정보가 있는 파일들도 설정해주어야 한다.</p><h4 id=기본-설정>기본 설정</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;web-app&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>&lt;!-- easycompnay라는 웹어플리케이션의 웹요청을 DispatcherServlet이 처리한다.--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>easycompany<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span style=color:#204a87;font-weight:700>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/servlet&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/web-app&gt;</span>
</span></span></code></pre></div><p>servlet-name은 DispatcherServlet이 기본(default)으로 참조할 빈 설정 파일 이름의 prefix가 되는데, (servlet-name)-servlet.xml 같은 형태이다.
위 예제와 같이 web.xml을 작성했다면 DispatcherServlet은 기본으로 /WEB-INF/easycompany-servlet.xml을 찾게 된다.</p><h4 id=contextconfiglocation을-이용한-설정>contextConfigLocation을 이용한 설정</h4><p>빈 설정 파일을 하나 이상을 사용하거나, 파일 이름과 경로를 직접 지정해주고 싶다면 contextConfigLocation 라는 초기화 파라미터 값에 빈 설정 파일 경로를 설정해준다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>easycompany<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span style=color:#204a87;font-weight:700>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;init-param&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>contextConfigLocation<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>
</span></span><span style=display:flex><span>                        /WEB-INF/config/easycompany-web.xml
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/init-param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/servlet&gt;</span>
</span></span></code></pre></div><h4 id=contextloaderlistener를-이용한-설정>ContextLoaderListener를 이용한 설정</h4><p>일반적으로 빈 설정 파일은 하나의 파일만 사용되기 보다는 persistance, service, web등 layer 단위로 나뉘게 된다.
또한, 같은 persistance, service layer의 빈을 2개 이상의 DispatcherServlet이 공통으로 사용할 경우도 있다.
이럴때는 공통빈(persistance, service)설정 정보는 ApplicationContext에, web layer의 빈들은 WebApplicationContext에 저장하는 아래와 같은 방법을 추천한다.
공통빈 설정 파일은 서블릿 리스너로 등록된 org.springframework.web.context.ContextLoaderListener로 로딩해서 ApplicationContext을 만들고,
web layer의 빈설정 파일은 DispatcherServlet이 로딩해서 WebApplicationContext을 만든다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>....
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>&lt;!-- ApplicationContext 빈 설정 파일--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;context-param&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>contextConfigLocation<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#8f5902;font-style:italic>&lt;!--빈 설정 파일들간에 구분은 줄바꿈(\n),컴마(,),세미콜론(;)등으로 한다.--&gt;</span>
</span></span><span style=display:flex><span>                        /WEB-INF/config/easycompany-service.xml,/WEB-INF/config/easycompany-dao.xml 
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/context-param&gt;</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>&lt;!-- 웹 어플리케이션이 시작되는 시점에 ApplicationContext을 로딩하며, 로딩된 빈정보는 모든 WebApplicationContext들이 참조할 수 있다.--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;listener&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span style=color:#204a87;font-weight:700>&lt;/listener-class&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/listener&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>employee<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span style=color:#204a87;font-weight:700>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;init-param&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>contextConfigLocation<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>
</span></span><span style=display:flex><span>				/WEB-INF/config/easycompany-service.xml
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/init-param&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/servlet&gt;</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>webservice<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span style=color:#204a87;font-weight:700>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;init-param&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>contextConfigLocation<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>
</span></span><span style=display:flex><span>				/WEB-INF/config/easycompany-webservice.xml
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/init-param&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/servlet&gt;</span>
</span></span><span style=display:flex><span>....
</span></span></code></pre></div><p>이 ApplicationContext의 빈 정보는 모든 WebApplicationContext들이 참조할 수 있다.
예를 들어, DispatcherServlet은 2개 사용하지만 같은 Service, DAO를 사용하는 web.xml을 아래와 같이 작성했다면,
easycompany-servlet.xml에 정의된 빈정보는 easycompany-webservice.xml가 참조할 수 없지만,
easycompany-service.xml, easycompany-dao.xml에 설정된 빈 정보는 easycompany-servlet.xml, easycompany-webservice.xml 둘 다 참조한다.
ApplicationContext과 WebApplicationContext과의 관계를 그림으로 나타내면 아래와 같다.</p><p><img src=../images/web-servlet-dispatcherservlet-relation.png alt=web-servlet-dispatcherservlet-relation></p><h2 id=참고자료>참고자료</h2><ul><li>The Spring Framework - Reference Documentation 2.5.6</li><li>Spring Framework API Documentation 2.5.6</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-1e6ea5844632d444ed56cc47c3b13d29>4 - HandlerMapping</h1><div class=lead>DispatcherServlet은 요청을 처리할 Controller를 HandlerMapping을 통해 매핑하며, Spring MVC는 여러 종류의 HandlerMapping 구현 클래스를 제공한다. Spring 3.1 이후 버전부터 기본 HandlerMapping은 RequestMappingHandlerMapping이며, 그 이전 버전에서는 DefaultAnnotationHandlerMapping이 기본으로 사용되었다.</div><h1 id=handlermapping>HandlerMapping</h1><h2 id=개요>개요</h2><p>DispatcherServlet에 Client로부터 Http Request가 들어 오면 HandlerMapping은 요청처리를 담당할 Controller를 mapping한다.
Spring MVC는 interface인 HandlerMapping의 구현 클래스도 가지고 있는데, 용도에 따라 여러 개의 HandlerMapping을 사용하는 것도 가능하다.
빈 정의 파일에 HandlerMapping에 대한 정의가 없다면 Spring MVC는 기본(default) HandlerMapping을 사용한다.</p><p>기본 HandlerMapping은 BeanNameUrlHandlerMapping이며, jdk1.5 이상의 실행환경일 때, Spring 3.1이후 버전이면(egov 3.0부터) RequestMappingHandlerMapping가 기본 HandlerMapping이며,
Spring 3.1이전 버전이면(egov 3.0이전 버전) DefaultAnnotationHandlerMapping가 기본 HandlerMapping이다.
(DefaultAnnotationHAndlerMapping은 3.1부터 deprecated되고 RequestMappingHandlerMapping으로 대체됨)</p><h2 id=설명>설명</h2><p>BeanNameUrlHandlerMapping, SimpleUrlHandlerMapping 등 주요 HandlerMapping 구현 클래스는 상위 추상 클래스인 AbstractHandlerMapping과 AbstractUrlHandlerMapping을 확장하기 때문에 이 추상클래스들의 프로퍼티를 사용한다.
주요 프로퍼티는 아래와 같다.</p><ul><li>defaultHandler<ul><li>요청에 해당하는 Controller가 없을 경우, defaultHandler에 등록된 Controller를 반환한다.</li></ul></li><li>alwaysUseFullPath<ul><li>URL과 Controller 매핑시에 URL full path를 사용할지 여부를 나타낸다.</li><li>예를 들어, servlet-mapping이 /easycompany/* 이고, alwaysUseFullPath가 true이면 /easycompany/employeeList.do, alwaysUseFullPath가 false이면 /employeeList.do 이다.</li></ul></li><li>interceptors<ul><li>Controller가 요청을 처리하기 전,후로 특정한 로직을 수행되기 원할때 interpceptor를 등록한다. 복수개의 interpceptor를 등록할 수 있다. interceptor에 대한 자세한 설명은 이곳을 참고하라.</li></ul></li><li>order<ul><li>여러개의 HandlerMapping 사용시에 우선순위.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping&#34;</span> <span style=color:#c4a000>p:order=</span><span style=color:#4e9a06>&#34;2&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&#34;</span> <span style=color:#c4a000>p:order=</span><span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><ul><li>pathMatcher : 사용자 요청 URL path와 설정정보의 URL path를 매칭할때, 특정 스타일의 매칭을 지원하는 PathMatcher를 등록할수 있다. 기본값은 Ant-style의 패턴매칭을 제공하는 AntPathMatcher이다.</li></ul><p>Spring MVC(3.1이후버전) 제공하는 주요 HandlerMapping 구현 클래스는 아래와 같다.</p><ul><li>BeanNameUrlHandlerMapping</li><li>RequestMappingHandlerMapping(DefaultAnnotationHandlerMapping이 deprecated되면서 대체됨)</li><li>ControllerClassNameHandlerMapping</li><li>SimpleUrlHandlerMapping</li></ul><p>Spring 3 버전 이전에는 @MVC에서 DefaultAnnotationHandlerMapping은 URL 단위로 interceptor를 적용할 수 없기에 전자정부프레임워크에서 아래와 같은 HandlerMapping 구현 클래스를 추가했다.</p><ul><li>SimpleUrlAnnotationHandlerMapping</li></ul><p>그러나 Spring 3버전부터 <a href=mvc:interceptors>mvc:interceptors</a> element에서 url별로 interceptor를 적용할 수 있도록 추가하여 SimpleUrlAnnotationHandlerMapping은 deprecated되었다.</p><h3 id=beannameurlhandlermapping>BeanNameUrlHandlerMapping</h3><p>BeanNameUrlHandlerMapping은 빈정의 태그에서 <strong>name</strong> attribute에 선언된 URL과 <strong>class</strong> attribute에 정의된 Controller를 매핑하는 방식으로 동작한다.
예를 들어, 아래와 같이 정의되어 있다면,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#a40000>...</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>&lt;!--HandlerMapping이 BeanNameUrlHandlerMapping 밖에 없다면 BeanNameUrlHandlerMapping에 대한 별도의 빈정의는 필요 없다.--&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#8f5902;font-style:italic>&lt;!--&lt;bean class=&#34;org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping&#34;/&gt;--&gt;</span> 
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;/insertEmployee.do&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.InsertEmployeeController&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>       ...
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>Client에서 URL ~~/insertEmployee.do 요청이 들어오면 InsertEmployeeController 클래스가 요청 처리를 담당한다.</p><p>앞 개요에서 언급했듯이 WAC(WebgApplicationContext)에 HandlerMapping 빈정의가 없다면 BeanNameUrlHandlerMapping이 (별도의 빈 정의 없이) 사용된다.
하지만, SimpleUrlHandlerMapping 같은 다른 HandlerMapping과 같이 써야 한다면, BeanNameUrlHandlerMapping도 빈정의가 되어야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#a40000>...</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mappings&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>       ....
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;/insertEmployee.do&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.InsertEmployeeController&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>       ....
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><h3 id=requestmappinghandlermapping--deprecated-defaultannotationhandlermapping과-거의-동일->RequestMappingHandlerMapping ( @deprecated DefaultAnnotationHandlerMapping과 거의 동일 )</h3><p>@MVC 개발을 하려면 RequestMappingHandlerMapping을(Spring 3.1이전버전은 DefaultAnnotationHandlerMapping) 사용해야 한다. 단, jdk 1.5 이상의 개발환경이어야 한다.
RequestMappingHandlerMapping 사용 방법은 세가지가 있다.</p><ul><li>선언하지 않는 방법</li><li><code>&lt;mvc:annotation-driven/></code>을 선언하는 방법</li><li>RequestMappingHandlerMapping을 직접 선언하는 방법</li></ul><h4 id=선언하지-않는-방법>선언하지 않는 방법</h4><p>RequestMappingHandlerMapping은 기본 HandlerMapping이므로 지정하지 않아도 사용가능하다. 아래와 같이 컴포넌트 스캔할 패키지를 지정해 주면,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style=color:#c4a000>xmlns:p=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/p&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:context=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>				http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>&lt;context:component-scan</span> <span style=color:#c4a000>base-package=</span><span style=color:#4e9a06>&#34;org.mycode.controller&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>패키지 org.mycode.controller 아래의 @Controller중에 @RequestMapping에 선언된 URL과 해당 @Controller 클래스의 메소드와 매핑한다.</p><h4 id=mvcannotation-driven을-선언하는-방법><a href=mvc:annotation-driven/>mvc:annotation-driven/</a>을 선언하는 방법</h4><p>@MVC사용 시 필요한 빈들을 등록해주는 <code>&lt;mvc:annotation-driven/></code>을 설정하면 내부에서
org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping ,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter 이 구성된다.</p><ul><li>기존 Spring 3.0버전에서 <code>&lt;mvc:annotation-driven/></code>는 DefaultAnnotationHandlerMapping, AnnotationMethodHandlerAdapter를 구성해주었다.</li></ul><p><code>&lt;mvc:annotation-driven></code>은 다음과 같이 사용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#a40000>...</span> <span style=color:#a40000>생략</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;mvc:annotation-driven/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 생략 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><ul><li>여기서 주의할 점은, CommandMap을 사용할 경우 mvc:annotation-driven을 선언하면 안된다. CommandMap을 사용할 경우 EogvRequestMappingHandlerAdapter와 RequestMappingHandlerMapping을 직접 선언해주어야한다.</li></ul><h4 id=requestmappinghandlermapping을-직접-선언하는-방법>RequestMappingHandlerMapping을 직접 선언하는 방법</h4><p>다른 HandlerMapping과 함께 사용할 때 선언한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!--생략--&gt;</span>
</span></span></code></pre></div><h4 id=controller코드-예제>Controller코드 예제</h4><p>위와 같이 RequestMappingHandlerMapping을 설정하였을 때</p><p>Controller에서의 간단한 예제를 보면,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>org.mycode.controller</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>....</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/hello.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>hellomethod</span><span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>           <span style=color:#ce5c00;font-weight:700>......</span>   
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>/hello.do로 URL 요청이 들어 오면 HelloController의 메소드 hellomethod가 실행된다.</p><h3 id=controllerclassnamehandlermapping>ControllerClassNameHandlerMapping</h3><p>ControllerClassNameHandlerMapping은 빈정의된 Controller의 클래스 이름중 suffix인 Controller를 제거한 나머지 이름의 소문자로 url mapping한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#a40000>..</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   ...
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.EmployeeListController&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.InsertEmployeeController&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   ...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>빈 정의가 위와 같다면, EmployeeListController ↔ /employeelist*, InsertEmployeeController ↔ /insertemployee* 과 같이 url mapping이 이루어 진다.
ControllerClassNameHandlerMapping에 프로퍼티 값으로 caseSensitive나 pathPrefix, basePackage등을 설정할 수 있는데,</p><ul><li>caseSensitive<ul><li>Controller 이름으로 URL 경로 mapping시에 대문자 사용여부. (ex. /insertemployee* 가 아니라 /easycompany/insertEmployee*로 사용하기 원할때).</li></ul></li><li>pathPrefix<ul><li>URL 경로에 기본적인 prefix 값. 기본값은 false이다.</li></ul></li><li>basePackage<ul><li>URL mapping에 사용되는 Controller의 기본 패키지 이름이다. 사용되는 Controller의 패키지명에 기본 패키지에 추가되는 subpackage가 있다면 해당 subpackage 이름이 URL 경로에 추가된다.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#a40000>..</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   ...
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;pathPrefix&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;/easycompany&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;caseSensitive&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span> 
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;basePackage&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;com.easycompany.controller&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.EmployeeListController&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.InsertEmployeeController&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>   ...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>하면, EmployeeListController ↔ /easycompany/hierarchy/employeeList*, InsertEmployeeController ↔ /easycompany/hierarchy/insertEmployee* 과 같이 url mapping이 이루어 진다.</p><h3 id=simpleurlhandlermapping>SimpleUrlHandlerMapping</h3><p>SimpleUrlHandlerMapping은 Ant-Style 패턴 매칭을 지원하며, 하나의 Controller에 여러 URL을 mapping 할 수 있다.
proerty의 key 값에 URL 패턴을 지정하고 value에는 Controller의 id 혹은 이름을 지정한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#a40000>...</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mappings&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#204a87;font-weight:700>&lt;props&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/employeeList.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>employeeListController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/insertEmployee.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>insertEmployeeController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/updateEmployee.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>updateEmployeeController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/loginProcess.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>loginController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/**/login.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>staticPageController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/static/*.html&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>staticPageController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#204a87;font-weight:700>&lt;/props&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;loginController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.LoginController&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;employeeListController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.EmployeeListController&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;insertEmployeeController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.InsertEmployeeController&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;updateEmployeeController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.UpdateEmployeeController&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;staticPageController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.UrlFilenameViewController&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>SimpleUrlHandlerMapping을 사용하면 Interceptor를 특정 URL 단위로 적용하는게 가능하다.
프로퍼티 interceptors에 적용하려는 Interceptor들을 리스트로 선언해주면 된다.
URL /employeeList.do, /insertEmployee.do, /updateEmployee.do 요청에 대해서 사용자 인증여부를 interceptor로 검증한다고 하면,아래와 같이 정의한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#a40000>...</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;interceptors&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                     <span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>local=</span><span style=color:#4e9a06>&#34;authenticInterceptor&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                     <span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mappings&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#204a87;font-weight:700>&lt;props&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/employeeList.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>employeeListController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/insertEmployee.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>insertEmployeeController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/updateEmployee.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>updateEmployeeController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#204a87;font-weight:700>&lt;/props&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mappings&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#204a87;font-weight:700>&lt;props&gt;</span>                                
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/**/login.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>staticPageController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/static/*.html&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>staticPageController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#204a87;font-weight:700>&lt;/props&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;loginController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.LoginController&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;employeeListController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.EmployeeListController&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;insertEmployeeController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.InsertEmployeeController&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;updateEmployeeController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.UpdateEmployeeController&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;staticPageController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.UrlFilenameViewController&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;authenticInterceptor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.interceptor.AuthenticInterceptor&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><h3 id=simpleurlannotationhandlermapping-deprecated>SimpleUrlAnnotationHandlerMapping (@deprecated)</h3><ul><li>Spring 3부터 <code>&lt;mvc:interceptors></code> element를 통해 SimpleUrlAnnotationHandlerMapping과 동일한 기능을 제공하므로 deprecated되었다.</li></ul><p>DefaultAnnotationHandlerMapping에 interceptor를 등록하면, 모든 @Controller에 interceptor가 적용되는 문제점이 있다.
SimpleUrlAnnotationHandlerMapping은 @Controller 사용시에 url 단위로 Interceptor를 적용하기 위해 개발되었다.
Spring 3부터 <code>&lt;mvc:interceptors></code>를 이용하여 동일한 기능을 제공하므로 현재 SimpleUrlAnnotationHandlerMapping은 deprecated되었다.
그러나 이전 버전은 해당기능을 제공하지 않는다.</p><p>SimpleUrlAnnotationHandlerMapping은 아래와 같은 3가지 사항이 고려됬다.</p><ul><li>HandlerMapping:Interceptors 관계의 스프링 구조를 깨뜨리지 말자. (ex. Controller:Interceptor (X))</li><li>쉬운 사용을 위해 기존의 HandlerMapping과 비슷한 방식의 사용법을 선택하자. (ex.SimpleUrlHandlerMapping)</li><li>최소한의 커스터마이징을 하자. → 짧은 시간… 또한 추후 deprecated시에 시스템에 영향을 최소화 하기 위해.</li></ul><p>웹 어플리케이션이 초기 구동될때, DefaultAnnotationHandlerMapping은 2가지 주요한 작업을 한다. (다른 HandlerMapping도 유사한 작업을 한다.)</p><ol><li>@RequestMapping의 url 정보를 읽어 들여 해당 Controller와 url간의 매핑 작업.</li><li>설정된 Interceptor들에 대한 정보를 읽어 들임.</li></ol><p>1번 작업은 DefaultAnnotationHandlerMapping의 상위 클래스인 AbstractDetectingUrlHandlerMapping에서 이루어 지는데,
맵핑을 위한 url리스트를 가져오는 determineUrlsForHandler 메소드는 하위 클래스에서 구현하도록 abstract 선언 되어 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>AbstractDetectingUrlHandlerMapping</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractUrlHandlerMapping</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>detectHandlers</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>BeansException</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isDebugEnabled</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Looking for URL mappings in application context: &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>getApplicationContext</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>beanNames</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>detectHandlersInAncestorContexts</span> <span style=color:#ce5c00;font-weight:700>?</span>
</span></span><span style=display:flex><span>				<span style=color:#000>BeanFactoryUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>beanNamesForTypeIncludingAncestors</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getApplicationContext</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>:</span>
</span></span><span style=display:flex><span>				<span style=color:#000>getApplicationContext</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>getBeanNamesForType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// Take any bean name that we can determine URLs for.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>beanNames</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>String</span> <span style=color:#000>beanName</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>beanNames</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span><span style=display:flex><span>			<span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>urls</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>determineUrlsForHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>beanName</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>ObjectUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isEmpty</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>urls</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#8f5902;font-style:italic>// URL paths found: Let&#39;s consider it a handler.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>				<span style=color:#000>registerHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>urls</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>beanName</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isDebugEnabled</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>					<span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>debug</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Rejected bean name &#39;&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>beanNames</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;&#39;: no URL paths identified&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>				<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>determineUrlsForHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>beanName</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>DefaultAnnotationHandlerMapping의 determineUrlsForHandler 메소드는 @RequestMapping의 url 리스트를 전부 가져오기 때문에,
빈 설정 파일에 정의한 url 리스트만 가져오도록 SimpleUrlAnnotationHandlerMapping에서 determineUrlsForHandler 메소드를 구현 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>egovframework.rte.ptl.mvc.handler</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>SimpleUrlAnnotationHandlerMapping</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>DefaultAnnotationHandlerMapping</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//url리스트, 중복값을 허용하지 않음으로 Set 객체에 담는다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Set</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>urls</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setUrls</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Set</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>urls</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>urls</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>urls</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * @RequestMapping로 선언된 url중에 프로퍼티 urls에 정의된 url만 remapping해 return
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * url mapping시에는 PathMatcher를 사용하는데, 별도로 등록한 PathMatcher가 없다면 AntPathMatcher를 사용한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * @param urlsArray - @RequestMapping로 선언된 url list
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * @return urlsArray중에 설정된 url을 필터링해서 return.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>remappingUrls</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>urlsArray</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>urlsArray</span><span style=color:#ce5c00;font-weight:700>==</span><span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>remappedUrls</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>for</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Iterator</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>it</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>urls</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>iterator</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>it</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasNext</span><span style=color:#ce5c00;font-weight:700>();)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>String</span> <span style=color:#000>urlPattern</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>it</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>next</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>for</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>urlsArray</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>;</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++){</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getPathMatcher</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>matchStart</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>urlPattern</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>urlsArray</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>])){</span>					
</span></span><span style=display:flex><span>					<span style=color:#000>remappedUrls</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>urlsArray</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]);</span>
</span></span><span style=display:flex><span>				<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[])</span> <span style=color:#000>remappedUrls</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toArray</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>remappedUrls</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>()]);</span>		
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * @RequestMapping로 선언된 url을 필터링하기 위해
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping의 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * 메소드 protected String[] determineUrlsForHandler(String beanName)를 override.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * @param beanName - the name of the candidate bean
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 * @return 빈에 해당하는 URL list
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>determineUrlsForHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>beanName</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>remappingUrls</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>determineUrlsForHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>beanName</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>	
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>인터셉터를 적용할 url들을 프로퍼티 urls에 선언하면 되며, Ant-style의 패턴 매칭이 지원된다.
SimpleUrlAnnotationHandlerMapping은 선언된 url만을 Controller와 매핑처리한다.
따라서, 아래와 같이 선언된 DefaultAnnotationHandlerMapping와 같이 선언되어야 하며, 우선순위는 SimpleUrlAnnotationHandlerMapping이 높아야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;selectAnnotaionMapper&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.ptl.mvc.handler.SimpleUrlAnnotationHandlerMapping&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>p:order=</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;interceptors&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>local=</span><span style=color:#4e9a06>&#34;authenticInterceptor&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;urls&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;set&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;value&gt;</span>/*Employee.do<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;value&gt;</span>/employeeList.do<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/set&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;annotationMapper&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>p:order=</span><span style=color:#4e9a06>&#34;2&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;authenticInterceptor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.interceptor.AuthenticInterceptor&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li>The Spring Framework - Reference Documentation 2.5.6</li><li>Spring Framework API Documentation 2.5.6</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-9902299d75c3bd5be2057d1f696164b2>5 - Spring MVC Tag Configuration</h1><div class=lead>Spring 3부터 mvc태그를 통하여 Controller처리를 위한 설정을 쉽게 하도록 Spring mvc 네임스페이스를 제공한다.</div><h1 id=spring-mvc-tag-configuration>Spring MVC Tag Configuration</h1><h2 id=개요>개요</h2><p>Spring 3부터 mvc태그를 통하여 Controller처리를 위한 설정을 쉽게 하도록 Spring mvc 네임스페이스를 제공한다.</p><ul><li><a href=#mvcannotation-driven><a href=mvc:annotation-driven>mvc:annotation-driven</a></a></li><li><a href=#mvcinterceptors><a href=mvc:interceptors>mvc:interceptors</a></a></li><li><a href=#mvcview-controller><a href=mvc:view-controller>mvc:view-controller</a></a></li></ul><h2 id=설명>설명</h2><h3 id=mvcannotation-driven>mvc:annotation-driven</h3><p>Spring 3.0부터 제공하는 mvc 태그 설정이다. Annotation기반의 Controller호출 설정과 필요한 bean설정을 편리하게 하도록 만들어졌다. 그러나 내부 수정이 어렵기 때문에 mvc:annotation-driven에서 제공하는 기능에 대하여 잘 숙지하고 변경이 불가능 한 경우에는 mvc:annotation-driven을 쓰지 않고 필요한 bean을 수동으로 넣어줘야하는 경우도 있다.
mvc:annotation-driven에서 쓰는 bean설정을 중복으로 쓰지 않도록 주의한다.</p><h4 id=mvcannotation-driven에서-제공하는-기능>mvc:annotation-driven에서 제공하는 기능</h4><ul><li>RequestMappingHandlerMapping bean등록(기존 DefaultAnnotationHandlerMapping)</li><li>RequestMappingHandlerAdapter bean등록(기존 AnnotationMethodHandlerAdapter)<ul><li>customArgumentResolvers, customReturnValueHandlers 추가 가능</li></ul></li><li>JSR-303의 검증용 어노테이션(@Valid)를 사용할 수 있도록 LocalValidatorFactoryBean bean설정 (JSR-303지원 라이브러리 존재 시)</li><li>RequestMappingHandlerAdapter의 messageConverters프로퍼티로 메시지 컨버터들 등록</li></ul><p>(다음 설정과 동일한 동작을 한다.)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.http.converter.ByteArrayHttpMessageConverter&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.http.converter.StringHttpMessageConverter&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;writeAcceptCharset&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.http.converter.ResourceHttpMessageConverter&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.http.converter.xml.SourceHttpMessageConverter&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.http.converter.xml.XmlAwareFormHttpMessageConverter&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- jaxb2라이브러리 존재시 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.http.converter.xml.Jaxb2RootElementHttpMessageConverter&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- jackson 라이브러리 존재시 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.http.converter.json.MappingJacksonHttpMessageConverter&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- rome 라이브러리 존재시 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.http.converter.feed.AtomFeedHttpMessageConverter&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.http.converter.feed.RssChannelHttpMessageConverter&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><ul><li>디폴트 validator로 어노테이션 방식의 포맷터를 지원하는 FormattingConversionServiceFactoryBean를 제공하며 validator를 추가 설정하도록 지원</li><li>디폴트 컨버전 서비스로 FormattingConversionServiceFactoryBean을 제공하며 conversion-service를 추가 설정하도록 지원</li><li>ConversionServiceExposingInterceptor를 등록하여 JSP의 <code>&lt;spring:eval></code>에서 ConversionService를 적용되도록 지원</li></ul><h4 id=mvcannotation-driven-설정-시-주의해야할-점>mvc:annotation-driven 설정 시 주의해야할 점</h4><ol><li><code>&lt;mvc:annotation-driven></code>을 사용할 때는 직접 RequestMappingHandlerAdapter를 등록해주어서는 안되며 직접 등록이 필요한 경우에는 <code>&lt;mvc:annotation-driven></code>을 설정하지 않고 각각의 필요한 설정을 수동으로 해주어야 한다. 전자정부 프레임워크 3.0에서는 Controller의 파라미터로 CommandMap을 쓰기 위하여 RequestMappingHandlerAdapter를 상속받은 EgovRequestMappingHandlerAdapter를 만들었으며, CommandMap을 써야하는 경우 <code>&lt;mvc:annotation-driven></code>을 설정하지 않고 EgovRequestMappingHandlerAdapter를 직접 선언하도록 가이드하고 있다.</li><li>RequestMappingHandlerAdapter의 customArgumentResolvers 속성에 pring 3.1이전 버전은 WebArgumentResolver인터페이스를 구현해야 했으나 HandlerMethodArgumentResolver인터페이스를 구현한 ArgumentResolver가 설정해야 한다. <code>&lt;mvc:annotation-driven></code> 내부 설정으로 WebArgumentResolver인터페이스 구현체를 쓸 수 있으나 이는 RequestMappingHandlerAdapter가 처리하는 것이 아니라 ServletWebArgumentResolverAdapter에서 호환하도록 변경해주는 것이다.</li><li>customReturnValueHandlers의 속성은 (Spring3.1이전버전의 customModelAndViewResolvers속성에서 이름변경) 기존에는 ModelAndViewResolver인터페이스의 구현체를 설정하였으나 Spring 3.1부터 HandlerMethodReturnValueHandler인터페이스의 구현체를 설정해야 한다.</li></ol><h3 id=mvcinterceptors>mvc:interceptors</h3><p>기존 HandlerMapping에는 Interceptor를 모든 url에 일괄적으로만 적용할 수 있었기 때문에 전자정부 프레임워크에서는 SimpleUrlAnnotationHandlerMapping을 제공하여 url별로 Interceptor를 걸 수 있도록 하였다. 그러나 Spring 3부터 제공하는 <a href=mvc:interceptors>mvc:interceptors</a>태그를 통해 url마다 Interceptor를 적용할 수 있도록 Spring mvc태그 스키마에서 제공하고 있다. 따라서 SimpleUrlAnnotationHandlerMapping은 deprecated되었으며 url별로 Interceptor를 적용하기 위해서는 <a href=mvc:interceptors>mvc:interceptors</a>태그를 사용하도록 한다.</p><p>Interceptor를 일괄 적용하기 위해서는 다음의 예와 같이 사용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;mvc:interceptors&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egov.interceptors.EgovInterceptor&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/mvc:interceptors&gt;</span>
</span></span></code></pre></div><p>특정 패턴의 url에만 인터셉터를 적용하기 위해서는 <code>&lt;mvc:interceptors></code>태그 내부에 <code>&lt;mvc:interceptor></code>를 사용한다.
만약 <code>/egov/sample</code>로 시작되는 URL요청에만 인터셉터를 정의하기 위해서는 다음과 같이 사용할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;mvc:interceptors&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;mvc:interceptor&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;mvc:mapping</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/egov/sample/*&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egov.interceptors.EgovInterceptor&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/mvc:interceptor&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/mvc:interceptors&gt;</span>
</span></span></code></pre></div><p>또한 interceptor에 특정 URL Pattern을 제외하여 맵핑하는 기능도 지원하고 있다. 이 때는 <code>&lt;mvc:interceptor></code>내부에서 <code>&lt;exclude-mapping></code>태그를 사용한다.
만약 /egov/로 시작하는 URL중 /egov/admin/으로 시작하는 URL에 interceptor맵핑을 제외하고 싶으면 다음과 같이 사용한다.</p><p><code>&lt;exclude-mapping></code> 태그는 spring 3.2 버전 부터 사용 가능 합니다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;mvc:interceptors&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;mvc:interceptor&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;mvc:mapping</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/egov/**&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;mvc:exclude-mapping</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/egov/admin/**&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egov.interceptors.EgovInterceptor&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/mvc:interceptor&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/mvc:interceptors&gt;</span>
</span></span></code></pre></div><h3 id=mvcview-controller>mvc:view-controller</h3><p>Controller에서 별다른 로직 없이 View를 지정하여 DispatcherServlet에 넘겨주는 작업만 하는 경우가 많다. 이럴 때 사용할 수 있는 것이 바로 <code>&lt;mvc:view-controller></code>태그이다.
<code>&lt;mvc:view-controller></code>태그를 설정하여 매핑할 URL패턴과 View이름만 넣어주면 해당 URL을 매핑하고 설정한 view를 리턴하는 ParameterizableViewController가 자동으로 등록된다.</p><p>만약 ”/“URL을 요청받았을 경우 “index”를 View이름으로 리턴하기 위해서는 다음과 같이 사용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;mvc:view-controller</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/&#34;</span> <span style=color:#c4a000>view-name=</span><span style=color:#4e9a06>&#34;index&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>InternalResourceViewResolver의 prefix를 /WEB-INF/views/로 정하고 suffix를 .jsp로 정하였다면 / URL이 요청되었을 때 /WEB-INF/views/index.jsp view를 호출하게 된다.</p><h2 id=참고자료>참고자료</h2><ul><li><a href=http://docs.spring.io/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-config-enable/>Spring 3.2.x reference : Enabling the MVC Java Config or the MVC XML Namespace</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-404522f2d68d13c85437f6487909b10e>6 - Controller</h1><div class=lead>DispatcherServlet은 HandlerMapping을 통해 요청을 처리할 Controller를 결정하고, 해당 Controller는 요청을 처리하여 데이터를 Model 객체에 반영한다. Spring MVC는 다양한 Controller들을 제공하며, 이들은 대부분 org.springframework.web.servlet.mvc.Controller 인터페이스를 구현한 클래스들이다.</div><h1 id=controller>Controller</h1><h2 id=개요>개요</h2><p>DispatcherServlet은 HandlerMapping를 이용해서 해당 요청을 처리할 Controller를 결정한다.
이 Controller는 요청에 대해서 처리를 하고 데이터를 Model 객체에 반영한다.
Spring MVC는 다양한 종류의 Controller를 제공하는데, 데이터 바인딩이나 폼 처리 또는 멀티 액션등의 편의 기능을 제공한다.
이 Controller들은 org.springframework.web.servlet.mvc.Controller 인터페이스를 구현한 클래스들이다.(@Controller는 예외다. 여기서는 @Controller에 대한 설명은 제외한다.)
eclipse에서 인터페이스 Controller를 Hierarchy View에서 열어보면 아래와 같은 구조를 보여준다.</p><p><img src=../images/web-servlet-controller-preview.png alt="Controller preview"></p><p>이 중 주요 Controller의 용도 및 특징을 표로 나타내면 아래와 같다.</p><table><thead><tr><th>클래스</th><th>용도 및 특징</th></tr></thead><tbody><tr><td>Controller</td><td>기본적인 Controller 인터페이스이다. Struts의 Action과 비교될 수 있다.<br>Spring에서는 Controller 작성시에 직접 Controller 인터페이스를 구현하지 말고, 아래의 구현 클래스를 확장해서 작성할것을 권장한다.</td></tr><tr><td>AbstractController</td><td>웹 요청과 응답을 처리하는 기본적인 Controller이다.<br>WebContentGenerator를 상속받기 때문에, HTTP 메소드(POST,GET) 지정, 세션 필수 여부등의 편의기능을 추가로 받는다.</td></tr><tr><td>AbstractCommandController</td><td>HttpServletRequest의 파라미터를 동적으로 데이터 객체(Command)에 바인딩 할 수 있다.<br>하지만 HTML 폼 처리시엔 SimpleFormController을 사용하라.</td></tr><tr><td>SimpleFormController</td><td>HTML 폼 처리시에 사용하는 Controller이다.<br>AbstractCommandController처럼 HttpServletRequest의 파라미터와 Command 객체를 바인딩할뿐 아니라,<br>입력폼에 필요한 데이터를 채워 보여주거나(referenceData, formBackingObject), 일반적인 폼 처리 시나리오에 따른 view 분기(formView, successView) 등의 편의 기능을 제공한다.</td></tr><tr><td>MultiActionController</td><td>연관된 여러 액션을 한 Controller에서 처리할때 사용하는 Controller이다.</td></tr><tr><td>UrlFilenameViewController</td><td>Controller에서 처리 로직이 없이 바로 view로 이동하는 경우에 사용한다.</td></tr></tbody></table><h2 id=설명>설명</h2><h3 id=abstractcontroller>AbstractController</h3><p>단순히 요청을 처리하고 그 결과를 ModelAndView 객체에 반영하는 작업을 할 때는 AbstractController을 상속한 Controller를 구현하면 된다.
구현 Controller에서는 AbstractController의 추상 메소드인 handleRequestInternal을 구현하면 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>handleRequestInternal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span></code></pre></div><p>Controller를 작성할때 인터페이스 Controller를 바로 구현하는 대신, AbstractController를 상속받아 구현하면 특정 HTTP 메소드(GET,POST)에 대한 필터링이나 세션 필수 체크등의 편의 기능을 제공받는다.
AbstractController의 작업 흐름은 아래와 같다.</p><ol><li>DispatcherServlet에 의해 handleRequest()가 호출된다.</li><li>특정 HTTP 메소드(GET,POST)에 대한 필터링을 수행한다.</li><li>세션필수여부값이 true이면 HttpServletRequest 객체에서 세션을 꺼낸다.</li><li>cacheSeconds 프로퍼티에 설정된 값에 따라 캐시 헤더를 설정한다.</li><li>추상 메소드인 handleRequestInternal()을 호출한다. AbstractController를 상속받은 구현, Controller 클래스를 작성했다면 구현된 handleRequestInternal() 메소드가 실행된다.</li></ol><p>관련 프로퍼티를 정리하면 아래와 같다.</p><table><thead><tr><th>이름</th><th>기본값</th><th>설명</th></tr></thead><tbody><tr><td>supportedMethods</td><td>GET,POST</td><td>Controller가 지원하는 HTTP 메소드 리스트(GET, POST and PUT)로 콤마(,)로 구분한다.</td></tr><tr><td>requireSession</td><td>false</td><td>Controller에서 요청 처리시에 session이 반드시 필요한지 여부이다. 값이 true인데 세션이 없다면 ServletException이 발생한다.</td></tr><tr><td>cacheSeconds</td><td>-1</td><td>응답의 캐시 헤더에 설정하는 시간값으로 단위는 초단위이다.<br>값이 0이면 캐시를 수행하지 않는 헤더를 갖게 되며, -1(기본값)이면 어떤 헤더도 생성하지 않으며, 양수값을 설정하면 설정한 값(초)만큼 내용을 캐싱을 수행하는 헤더를 생성한다.</td></tr><tr><td>synchronizeOnSession</td><td>false</td><td>메소드 handleRequestInternal()을 호출할때 세션(HttpSession)에 동기화(synchronized)해서 호출할지 여부이다. 만일 세션이 없다면 아무 영향이 없다.</td></tr></tbody></table><h4 id=예제>예제</h4><p>사용자 인증처리를 위해 아이디와 패스워드를 입력받는 페이지 예제</p><p><img src=../images/web-servlet-controller-ex-login-form.png alt=web-servlet-controller-ex-login-form></p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ page contentType=&#34;text/html; charset=UTF-8&#34;%&gt;
&lt;html&gt;
	&lt;head&gt;
	&lt;title&gt;Login Page&lt;/title&gt;
	&lt;link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;scripts/easycompany.css&#34; /&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;form action=&#34;/easycompany/loginProcess.do&#34; method=&#34;post&#34;&gt;
		아이디 : &lt;input type=text name=&#34;id&#34;&gt; 패스워드: &lt;input type=password name=&#34;password&#34;&gt; &lt;input type=submit value=&#34;로그인&#34;&gt;
	&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>로그인 처리를 하는 LoginController를 AbstractController를 확장해서 작성해 보자.
먼저 아래와 같이 빈설정을 하고</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;/loginProcess.do&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.LoginController&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:loginService-ref=</span><span style=color:#4e9a06>&#34;loginService&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:supportedMethods=</span><span style=color:#4e9a06>&#34;POST&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span> <span style=color:#8f5902;font-style:italic>&lt;!--HTTP 메소드가 POST일때만 처리한다--&gt;</span>
</span></span></code></pre></div><p>메소드 handleRequestInternal()에 실제 구현 로직을 넣어 준다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.hierarchy</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>LoginController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractController</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>LoginService</span> <span style=color:#000>loginService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setLoginService</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>LoginService</span> <span style=color:#000>loginService</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>loginService</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>loginService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 *  AbstractController의 추상 메소드인 handleRequestInternal의 구현 메소드이다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 *  사용자로 부터 아이디, 패스워드를 입력받아 인증 성공이면 세션 객체에 계정정보를 담고 사원정보리스트 페이지로 포워딩한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 *  인증에 실패하면 로그인 페이지로 다시 리턴한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>	 */</span>	
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>handleRequestInternal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>id</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//아이디
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>String</span> <span style=color:#000>password</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;password&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//패스워드
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//로그인 인증을 처리한 후, 로그인 성공이면 Account 객체에 계정 관련정보를 리턴한다. 로그인 실패이면 null 리턴.  
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>Account</span> <span style=color:#000>account</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Account</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>loginService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>authenticate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>account</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#8f5902;font-style:italic>//로그인 성공
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getSession</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>setAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;UserAccount&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>account</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//계정정보를 세션에 저장.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;redirect:/employeeList.do&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//사원리스트 페이지로 이동.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#8f5902;font-style:italic>//실패
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;login&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//로그인페이지로 이동
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=abstractcommandcontroller>AbstractCommandController</h3><p>AbstractCommandController는 요청 파라미터값을 커맨드(Command) 클래스의 필드값과 자동으로 바인딩할 때 사용된다.
커맨드 클래스는 일반적인 JavaBean이면 되는데, ActionForm 같이 프레임워크에 종속적인 구조의 폼 클래스를 사용해야 하는 Struts와의 차이점이라 할 수 있다.
파라미터와 커맨드 클래스의 데이터 바인딩은 일반적으로 알려진 JavaBeans 프로퍼티 표시법을 따른다.
firstName 이란 이름의 파라미터가 있다면 커맨드 클래스의 setFirstName([value]) 메소드를 찾아 값을 바인딩한다.
파라미터 address.city 는 커맨드 클래스의 getAddress().setCity([value]) 메소드를 찾아 값을 바인딩한다.
이 기능은 HTML 폼 처리에 유용한 편의 기능이지만, 일반적으로 HTML 폼 처리에는 AbstractCommandController대신 SimpleFormController를 사용한다.
AbstractCommandController을 상속받는 구현 Controller에서는 추상메소드 handle()을 구현하면 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>handle</span><span style=color:#ce5c00;font-weight:700>(</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindException</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span></code></pre></div><h4 id=예제-1>예제</h4><p>사원번호,부서번호,사원이름등의 검색 조건에 따라 사원리스트를 보여주는 페이지 예제</p><p><img src=../images/web-servlet-controller-ex-employee-list.png alt=web-servlet-controller-ex-employee-list></p><p>검색 조건을 담는 빈은 아래와 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.domain</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>SearchCriteria</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>searchEid</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>searchDid</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>searchName</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// 위의 변수들에 대한 getter/setter...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>검색 조건을 화면으로 부터 입력받아 검색 조건 빈(bean)인 SearchCriteria에 담아서 서비스에 넘겨주고 리스트로 결과를 받아오는 EmployeeListController 작성해 보자.
EmployeeListController를 AbstractController를 이용해 만든다면, 파라미터의 값을 꺼내고 값을 객체에 담는 코드를 직접 작성해야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.hierarchy</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EmployeeListController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractController</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>....</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>handleRequestInternal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//request 객체의 파라미터값을 꺼내서
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>String</span> <span style=color:#000>searchEid</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;searchEid&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//사원번호
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>String</span> <span style=color:#000>searchDid</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;searchDid&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//부서번호
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>String</span> <span style=color:#000>searchName</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;searchName&#34;</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//사원이름
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#8f5902;font-style:italic>//객체에 저장한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>SearchCriteria</span> <span style=color:#000>searchCriteria</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>SearchCriteria</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>searchCriteria</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSearchEid</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>searchEid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>searchCriteria</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSearchDid</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>searchDid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>searchCriteria</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSearchName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>searchName</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Employee</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>employeelist</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>employeeService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAllEmployees</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>searchCriteria</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>ModelAndView</span> <span style=color:#000>modelview</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;employeelist&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>employeelist</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;searchCriteria&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>searchCriteria</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setViewName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;employeelist&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>맵핑해야할 파라미터가 많다면 상당히 번거로운 작업이고, 단순 작업 코드의 라인이 길어져 코드의 가독성도 떨어진다.
EmployeeListController를 AbstractCommandController을 상속받아 구현해 보면 아래와 같이 변경될 것이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.hierarchy</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EmployeeListController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractCommandController</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>EmployeeListController</span><span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//Command 객체에 대한 선언. 빈 설정 파일에 Command 객체에 대한 선언이 있다면 이 코드는 필요없다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>setCommandClass</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>SearchCriteria</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>setCommandName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;searchCriteria&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>....</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>handle</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindException</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//이미 파라미터와 Command 객체의 바인딩이 되어 있다. 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>SearchCriteria</span> <span style=color:#000>searchCriteria</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>SearchCriteria</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Employee</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>employeelist</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>employeeService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAllEmployees</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>searchCriteria</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>ModelAndView</span> <span style=color:#000>modelview</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;employeelist&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>employeelist</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;searchCriteria&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>searchCriteria</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setViewName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;employeelist&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>커맨드 클래스 설정은 setCommandClass,setCommandName 메소드 대신에 빈 설정 파일에 정의할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;employeeListController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.EmployeeListController&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:employeeService-ref=</span><span style=color:#4e9a06>&#34;employeeService&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:commandName=</span><span style=color:#4e9a06>&#34;searchCriteria&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:commandClass=</span><span style=color:#4e9a06>&#34;com.easycompany.domain.SearchCriteria&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>이 데이터 바인딩은 spring의 폼 태그 <code>&lt;form:form></code> 와 함께 쓰면 더욱 편리하게 사용할 수 있다.
폼 태그의 변수 <strong>commandName은 커맨드 클래스의 이름과 일치</strong>해야 한다.
커맨드 객체에 사원번호, 부서번호등의 값이 들어 있다면 JSP는 커맨드 객체의 필드값과 폼필드값을 자동으로 바인딩하여 보여주게 된다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ taglib prefix=&#34;form&#34; uri=&#34;http://www.springframework.org/tags/form&#34; %&gt;
...
&lt;form:form commandName=&#34;searchCriteria&#34; action=&#34;/easycompany/employeeList.do&#34;&gt;
&lt;table width=&#34;50%&#34; border=&#34;1&#34;&gt;
	&lt;tr&gt;
		&lt;td&gt;사원번호 : &lt;form:input path=&#34;searchEid&#34;/&gt;&lt;/td&gt;
		&lt;td&gt;부서번호 : &lt;form:input path=&#34;searchDid&#34;/&gt;&lt;/td&gt;
		&lt;td&gt;이름 : &lt;form:input path=&#34;searchName&#34;/&gt;&lt;/td&gt;
		&lt;td&gt;&lt;input type=&#34;submit&#34; value=&#34;검색&#34; onclick=&#34;this.disabled=true,this.form.submit();&#34; /&gt;&lt;/td&gt;
	&lt;/tr&gt;	
&lt;/table&gt;
&lt;/form:form&gt;
&lt;table&gt;
	&lt;tr&gt;
		&lt;th&gt;&lt;/th&gt;
		&lt;th&gt;사원번호&lt;/th&gt;
		&lt;th&gt;부서번호&lt;/th&gt;
		&lt;th&gt;이름&lt;/th&gt;
		&lt;th&gt;나이&lt;/th&gt;
		&lt;th&gt;이메일&lt;/th&gt;
	&lt;/tr&gt;	
&lt;c:forEach items=&#34;${employeelist}&#34; var=&#34;empinfo&#34;&gt;	
	&lt;tr&gt;
		&lt;td&gt;&lt;/td&gt;
		&lt;td&gt;&lt;a href=&#34;javascript:getEmployeeInfo(&#39;${empinfo.employeeid}&#39;)&#34;&gt;${empinfo.employeeid}&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;${empinfo.departmentid}&lt;/td&gt;
		&lt;td&gt;${empinfo.name}&lt;/td&gt;
		&lt;td&gt;${empinfo.age}&lt;/td&gt;
		&lt;td&gt;${empinfo.email}&lt;/td&gt;
	&lt;/tr&gt;
&lt;/c:forEach&gt;
&lt;/table&gt;
...
</code></pre><h3 id=simpleformcontroller>SimpleFormController</h3><p>HTML 폼을 보여주거나 전송(submission)하는 등에 폼처리를 다루는 Controller를 작성 한다면, SimpleFormController를 상속한 Controller를 구현하면 된다.
SimpleFormController는 상위 클래스인 BaseCommandController와 AbstractFormController가 제공하는 파라미터와 커맨드(폼) 클래스의 데이터 바인딩, 세션 폼 모드, 입력값 검증(validation), 입력폼에 초기 데이터 세팅등의 편의 기능을 그대로 사용하면서
폼 전송시에 결과에 따른 화면 분기(formView, successView)등 편의 기능을 추가로 제공한다.
폼을 보여주고 전송하는 Controller를 각각 만들지 않고 하나로 만들 수 있다.
SimpleFormController의 작업 흐름을 보려면 상위 클래스인 AbstractFormController의 handleRequestInternal() 메소드를 참고하면 되는데, 작업 흐름은 아래와 같다.</p><ul><li><p>GET 방식 호출</p><ul><li>Controller가 폼 페이지에 대한 요청을 받는다. (GET 방식 호출)</li><li>formBackingObject() 메소드는 기본적으로 요청에 대한 커맨드 객체를 생성해서 반환한다. 일반적으로는 formBackingObject를 오버라이딩해서 GET 방식 호출시에 폼에 채우고자 하는 기본값을 가져오는 로직을 넣는다.</li><li>initBinder() 메소드가 실행되는데, 커맨드 클래스의 특정 필드에 대해서 커스텀 에디터를 사용할수 있도록 한다.</li><li>프로퍼티 bindOnNewForm이 true이면, 초기 요청 파라미터들을 가지고 새로운 커맨드 객체에 값을 채우는데 ServletRequestDataBinder가 적용되며, onBindOnNewForm() 콜백 메소드가 호출된다.</li><li>showForm() 메소드는 referenceData()를 호출해서 폼 페이지에서 보여주고자 하는 참조 데이터(주로 셀렉트박스, 체크박스 같은 유형)를 ModelAndView에 저장한다.</li><li>formView에서는 Model 데이터를 바탕으로 폼에 필요한 데이터를 채워서 표시한다.</li></ul></li><li><p>POST 방식 호출</p><ul><li>사용자가 폼데이터를 전송한다(submit). (POST 방식 호출)</li><li>getCommand() 메소드가 커맨드 객체를 반환하는데,
만일 sessionForm이 false이면 formBackingObject() 메소드를 호출해서 커맨드 클래스의 인스턴스를 반환하고,
sessionForm이 true이면 세션에서 커맨드 객체를 꺼내서 반환한다. 만일 해당 객체를 세션에서 찾지 못하면 handleInvalidSubmit() 메소드를 호출한다. handleInvalidSubmit()는 새로운 커맨드 객체를 생성하고 다시 폼 전송을 시도한다.</li><li>요청 파라미터들로 커맨드 객체를 채우기 위해 ServletRequestDataBinder가 사용된다.</li><li>onBind() 메소드를 호출한다. 유효성검사(validation) 수행전에 필요한 작업들을 수행할 수 있다.</li><li>프로퍼티 validateOnBinding값이 true이면, 등록된 Validator가 호출된다. Validator는 커맨드 객체의 필드값에 대한 유효성을 검사한다.</li><li>onBindAndValidate() 메소드를 호출한다. 여기서 바인딩과 유효성 검사 이후 사용자 정의 작업을 수행할 수 있다.</li><li>processFormSubmission() 메소드에서 전송을 처리한다. 유효성검사 결과 에러가 있는 경우 showForm() 메소드가 호출되어 다시 formView로 이동하고 에러가 없으면 onSubmit() 메소드가 수행되면서 폼 제출이 된다.</li><li>폼 제출이 성공하면 successView로 이동한다.</li></ul></li></ul><p>관련 프로퍼티는 아래와 같다.</p><table><thead><tr><th>이름</th><th>기본값</th><th>설명</th><th>해당클래스</th></tr></thead><tbody><tr><td>commandName</td><td>command</td><td>커맨드 클래스의 이름(별칭)</td><td>BaseCommandController</td></tr><tr><td>commandClass</td><td>null</td><td>요청 파라미터와 데이터 바인딩하게 될 커맨드 클래스</td><td>BaseCommandController</td></tr><tr><td>validators</td><td>null</td><td>커맨드 객체의 데이터 유효성검사를 수행할 Validator 빈의 배열</td><td>BaseCommandController</td></tr><tr><td>validator</td><td>null</td><td>Validator가 한개인 경우 사용.</td><td>BaseCommandController</td></tr><tr><td>validateOnBinding</td><td>true</td><td>유효성검사를 수행할지 여부. true이면 수행한다.</td><td>BaseCommandController</td></tr><tr><td>bindOnNewForm</td><td>false</td><td>새로운 폼이 보여지는 시점에서 데이터 바인딩을 할지 여부.</td><td>AbstractFormController</td></tr><tr><td>sessionForm</td><td>false</td><td>커맨드 객체를 세션에 저장하여 사용할지 여부.</td><td>AbstractFormController</td></tr><tr><td>formView</td><td>null</td><td>사용자가 입력하는 폼페이지나 유효성검사시에 에러났을 경우에 사용하는 뷰를 표시한다.</td><td>SimpleFormController</td></tr><tr><td>successView</td><td>null</td><td>폼 제출이 성공했을때 보여줄 뷰를 표시한다.</td><td>SimpleFormController</td></tr></tbody></table><h4 id=예제-2>예제</h4><p>부서 정보 수정 페이지(/easycompany/webapp/WEB-INF/jsp/modifydepartment.jsp) 예제
이 페이지의 처리 흐름은 아래와 같다.</p><ul><li>사용자에게 입력폼페이지를 보여주되 기존의 부서정보를 채워서 보여준다. → 위에서 언급한 GET 방식 호출시의 프로세스에 따라 처리 된다.</li><li>사용자는 수정할 내용을 수정한 후에 저장 버튼을 누른다. → POST 방식 호출시의 프로세스에 따라 처리 된다.<ul><li>저장에 실패하거나 입력값 검증에 문제가 있으면 다시 초기 입력 폼페이지로 이동한다.</li><li>저장에 성공하면 부서 정보 리스트페이지로 이동한다.</li></ul></li></ul><p><img src=../images/web-servlet-controller-ex-employee-reg.png alt=web-servlet-controller-ex-employee-reg></p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;form:form commandName=&#34;department&#34;&gt;
&lt;table&gt;
	&lt;tr&gt;
		&lt;th&gt;부서번호&lt;/th&gt;
		&lt;td&gt;&lt;c:out value=&#34;${department.deptid}&#34;/&gt;&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;th&gt;부서이름&lt;/th&gt;
		&lt;td&gt;&lt;form:input path=&#34;deptname&#34; size=&#34;20&#34;/&gt;&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;th&gt;상위부서&lt;/th&gt;
		&lt;td&gt;
			&lt;form:select path=&#34;superdeptid&#34;&gt;
				&lt;option value=&#34;&#34;&gt;상위부서를 선택하세요.&lt;/option&gt;
				&lt;form:options items=&#34;${deptInfoOneDepthCategory}&#34; /&gt;
			&lt;/form:select&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;th&gt;설명&lt;/th&gt;
		&lt;td&gt;&lt;form:textarea path=&#34;description&#34; rows=&#34;10&#34; cols=&#34;40&#34;/&gt;&lt;/td&gt;
	&lt;/tr&gt;	
&lt;/table&gt;
&lt;table width=&#34;80%&#34; border=&#34;1&#34;&gt;
	&lt;tr&gt;
		&lt;td&gt;
		&lt;input type=&#34;submit&#34; value=&#34;저장&#34;/&gt;		
		&lt;input type=&#34;button&#34; value=&#34;리스트페이지&#34; onclick=&#34;location.href=&#39;/easycompany/departmentList.do?depth=1&#39;&#34;/&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
&lt;/table&gt;
&lt;/form:form&gt;
</code></pre><p>처리를 담당할 UpdateDepartmentController를 빈 설정 파일(xxx-servlet.xml)에 아래와 같이 등록한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;updateDepartmentController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.UpdateDepartmentController&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>p:departmentService-ref=</span><span style=color:#4e9a06>&#34;departmentService&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>p:commandName=</span><span style=color:#4e9a06>&#34;department&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>p:commandClass=</span><span style=color:#4e9a06>&#34;com.easycompany.domain.Department&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>p:formView=</span><span style=color:#4e9a06>&#34;modifydepartment&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c4a000>p:successView=</span><span style=color:#4e9a06>&#34;redirect:/departmentList.do?depth=1&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h5 id=formbackingobject-메소드>formBackingObject 메소드</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Object</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span>
</span></span></code></pre></div><p>일반적으로 수정 폼페이지는 기존의 데이터를 폼에 채우고 사용자가 원하는 부분을 수정한 후에 전송(submit)하는데,
기존 데이터를 불러와 폼에 채우는 역할을 formBackingObject 메소드가 담당한다.
formBackingObject 메소드는 커맨드 객체를 생성해서 리턴하는데, 필요에 따라 이 메소드를 오버라이드해서 필요한 데이터를 커맨드 객체에 채워 주면 된다.
부서 정보 수정 페이지에서 기존의 부서 정보를 채워서 보여 주는 부분을 먼저 작성해 보자.
오버라이드한 메소드에HTTP GET 메소드 요청이면 파라미터에 있는 부서 아이디로 부서 정보 테이블을 조회해서 결과를 객체 Department에 담아 반환하는 로직을 추가해 보자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.hierarchy</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>UpdateDepartmentController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>SimpleFormController</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DepartmentService</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setDepartmentService</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DepartmentService</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>departmentService</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Object</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>isFormSubmission</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)){</span>	<span style=color:#8f5902;font-style:italic>// GET 요청이면
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>String</span> <span style=color:#000>deptid</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span><span style=color:#8f5902;font-style:italic>//부서 아이디로 DB를 조회한 결과가 커맨드 객체 반영.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>else</span><span style=color:#ce5c00;font-weight:700>{</span>	<span style=color:#8f5902;font-style:italic>// POST 요청이면
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#8f5902;font-style:italic>//AbstractFormController의 formBackingObject을 호출하면 요청객체의 파라미터와 설정된 커맨드 객체간에 기본적인 데이터 바인딩이 이루어 진다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>...</span>	
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=referencedata-메소드>referenceData 메소드</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Map</span> <span style=color:#000>referenceData</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Map</span> <span style=color:#000>referenceData</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Errors</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span>
</span></span></code></pre></div><p>폼 페이지에 미리 보여 주어야 할 데이터중에 커맨드 객체에 포함하기 어려운 경우가 있다.
부서 정보 수정 페이지에 보면 상위 부서 정보가 셀렉트박스로 되어 있는데, 커맨드 객체인 부서(Department)객체에는 해당 부서의 상위부서번호만 있을 뿐 이 회사에 어떤 상위부서들이 있는 지에 대한 정보는 없다.
커맨드 객체에 없지만 페이지에 필요한 이런 참조성 데이터들을 사용하기 위해서 referenceData 메소드를 사용하면 된다.
referenceData 메소드는 맵 객체를 반환하는데 이 맵은 모델 객체에 담겨 ModelAndView에 저장된다.
우리는 그저 referenceData 메소드를 오버라이드해서 참조성 데이터를 맵 객체에 넣어 주면 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.hierarchy</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>UpdateDepartmentController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>SimpleFormController</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DepartmentService</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setDepartmentService</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DepartmentService</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>departmentService</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Map</span> <span style=color:#000>referenceData</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Errors</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Map</span> <span style=color:#000>param</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>param</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;depth&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>		
</span></span><span style=display:flex><span>		<span style=color:#000>Map</span> <span style=color:#000>referenceMap</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>referenceMap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptInfoOneDepthCategory&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentIdNameList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>param</span><span style=color:#ce5c00;font-weight:700>));</span>	<span style=color:#8f5902;font-style:italic>//상위부서정보를 가져와서 Map에 담는다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>referenceMap</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>부서 정보 수정페이지를 열었을때 참조 데이터로 가져온 상위 부서 정보 리스트 중에 해당 부서의 상위 부서값이 셀렉트 박스에서 기본으로 선택(“selected”)되서 보여져야 한다면,
참조데이터 중에 커맨드 객체와 일치하는 값을 일일히 조건문을 사용해서 비교하는 로직을 넣어주는 중노동을 해야 하나,
스프링 폼태그를 사용하면 간단하게 해결된다.
referenceData 메소드가 반환한 상위 부서 정보 맵 데이터중에 해당 부서의 상위부서와 일치하는게 있으면 <code>&lt;form:options></code>은 해당 옵션을 선택(“selected”)으로 프린트한다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;form:select path=&#34;superdeptid&#34;&gt;
	&lt;option value=&#34;&#34;&gt;상위부서를 선택하세요.&lt;/option&gt;
	&lt;form:options items=&#34;${deptInfoOneDepthCategory}&#34; /&gt;
&lt;/form:select&gt;
</code></pre><h5 id=onsubmit-메소드>onSubmit 메소드</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>onSubmit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>onSubmit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindException</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>onSubmit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindException</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span>
</span></span></code></pre></div><p>onSubmit() 메소드를 오버라이드한 메소드를 만들어서 폼의 내용을 전송을 하는 로직을 넣어보자.
커맨드 객체인 부서 정보 객체(Department)의 내용을 DB에 반영하고, 처리가 성공했으면 successView로 이동하고 실패하면 showForm 메소드를 호출한다.
이 showForm 메소드는 폼페이지를 다시 보여주기 위해 필요한 데이터와 에러정보를 ModelAndView에 넣고 formView로 이동한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.hierarchy</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>UpdateDepartmentController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>SimpleFormController</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DepartmentService</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setDepartmentService</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DepartmentService</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>departmentService</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>onSubmit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindException</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Department</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updateDepartment</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>showForm</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getSuccessView</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=multiactioncontroller>MultiActionController</h3><p>지금까지 살펴본 Controller들은 하나의 액션에 하나의 Controller를 만드는 방식이다. (SimpleFormController가 하나의 url에 대해 GET, POST 메소드에 따라 분기 처리를 하기는 하지만.)
연관있는 여러 액션들을 하나의 Controller에 모으고 싶다면 MultiActionController를 상속받아 Controller를 작성하면 되는데 하나의 액션을 하나의 메소드로 작성한다.
그 메소드는 아래의 형식을 갖는다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ModelAndView</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000>Map</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000>String</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#204a87;font-weight:700>void</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>actionName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>그러면 어떤 액션(url)을 어떤 메소드가 처리 할지를 결정하는 일이 필요한데, 이때 도움을 주는 인터페이스가 MethodNameResolver이다.
MethodNameResolver은 요청에 대해서 어떤 메소드가 처리 할지 메소드 이름을 반환하는데, 스프링은 다음과 같은 3가지 MethodNameResolver 구현 클래스를 제공한다.</p><ul><li>ParameterMethodNameResolver : 특정 파라미터에 메소드 이름을 준다. 기본 파라미터는 action 이다.</li><li>InternalPathMethodNameResolver : URL 경로의 마지막 부분중에 확장자를 제외한 부분이 메소드 이름이 된다.</li><li>PropertiesMethodNameResolver : mapping 프로퍼티에 URL과 메소드 이름을 설정한다.</li></ul><h4 id=예제-3>예제</h4><p>상위 부서 리스트를 가져오는 액션과 특정 상위 부서에 속한 하위 부서 리스트를 가져 오는 액션을 처리하는 DepartmentListController를 작성해 보자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.hierarchy</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DepartmentListController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>MultiActionController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//상위 부서 리스트를 가져 온다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>departmentList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>depth</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;depth&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Map</span> <span style=color:#000>paramMap</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>paramMap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;depth&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>depth</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Department</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>departmentlist</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>paramMap</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>ModelAndView</span> <span style=color:#000>mav</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;departmentlist&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>mav</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;departmentlist&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>departmentlist</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>mav</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//특정 상위 부서에 속한 하위 부서 리스트를 가져 온다.	
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>subDepartmentList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>superdeptid</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;superdeptid&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>depth</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;depth&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Map</span> <span style=color:#000>paramMap</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>paramMap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;depth&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>depth</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>paramMap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;superdeptid&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>superdeptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Department</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>departmentlist</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>paramMap</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>ModelAndView</span> <span style=color:#000>mav</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;departmentsublist&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>mav</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;departmentlist&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>departmentlist</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>mav</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=parametermethodnameresolver를-사용한-경우>ParameterMethodNameResolver를 사용한 경우</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;/departmentList.do&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.DepartmentListController&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:departmentService-ref=</span><span style=color:#4e9a06>&#34;departmentService&#34;</span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:methodNameResolver-ref=</span><span style=color:#4e9a06>&#34;paramResolver&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span> <span style=color:#8f5902;font-style:italic>&lt;!-- ParameterMethodNameResolver를 MethodNameResolver로 사용--&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;paramResolver&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.multiaction.ParameterMethodNameResolver&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:paramName=</span><span style=color:#4e9a06>&#34;method&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span> <span style=color:#8f5902;font-style:italic>&lt;!--파라미터이름은 &#34;method&#34;--&gt;</span>
</span></span></code></pre></div><p>ParameterMethodNameResolver는 어떤 메소드를 호출할지에 대한 정보를 파라미터에 지정하는데, 파라미터 이름은 프로퍼티 “paramName”의 값이다.</p><ul><li>/easycompany/departmentList.do?depth=1&amp;method=departmentList → departmentList()</li><li>/easycompany/departmentList.do?superdeptid=1000&amp;depth=2&amp;method=subDepartmentList → subDepartmentList()</li></ul><h6 id=internalpathmethodnameresolver를-사용한-경우>InternalPathMethodNameResolver를 사용한 경우</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;departmentController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.DepartmentListController&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:departmentService-ref=</span><span style=color:#4e9a06>&#34;departmentService&#34;</span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:methodNameResolver-ref=</span><span style=color:#4e9a06>&#34;pathResolver&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span> <span style=color:#8f5902;font-style:italic>&lt;!-- InternalPathMethodNameResolver를 MethodNameResolver로 사용--&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;pathResolver&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.multiaction.InternalPathMethodNameResolver&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>InternalPathMethodNameResolver를 사용하면 URL /abc/foo.do로 요청이 들어올때 public ModelAndView foo(HttpServletRequest, HttpServletResponse) 메소드로 맵핑된다.
예제에서 보면, URL과 메소드간에 맵핑이 아래와 같이 이루어 진다.</p><ul><li>/easycompany/departmentList.do?depth=1 → departmentList()</li><li>/easycompany/subDepartmentList.do?superdeptid=1000&amp;depth=2 → subDepartmentList()</li></ul><h6 id=propertiesmethodnameresolver를-사용한-경우>PropertiesMethodNameResolver를 사용한 경우</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;departmentController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.hierarchy.DepartmentListController&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:departmentService-ref=</span><span style=color:#4e9a06>&#34;departmentService&#34;</span> 
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:methodNameResolver-ref=</span><span style=color:#4e9a06>&#34;propResolver&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span> <span style=color:#8f5902;font-style:italic>&lt;!-- InternalPathMethodNameResolver를 MethodNameResolver로 사용--&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;propResolver&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.multiaction.PropertiesMethodNameResolver&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mappings&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;props&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/departmentList.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>departmentList<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/subDepartmentList.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>subDepartmentList<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;/props&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>PropertiesMethodNameResolver는 URL과 메소드의 매핑 관계를 “mappings” 프로퍼티에 명시해준다.</p><h3 id=urlfilenameviewcontroller>UrlFilenameViewController</h3><p>UrlFilenameViewController는 Controller에서 처리 로직이 없이 바로 view로 이동하는 경우에 사용하는 Controller이다.
DispatcherServlet을 거쳐야 하지만, html 위주의 static한 페이지를 보여줄때 사용한다.
아래와 같이 URL path가 곧 뷰이름이 되며, prefix와 suffix를 지정할수도 있다.</p><pre tabindex=0><code>&#34;/index&#34; -&gt; &#34;index&#34; 
&#34;/index.html&#34; -&gt; &#34;index&#34; 
&#34;/index.html&#34; + prefix &#34;pre_&#34; and suffix &#34;_suf&#34; -&gt; &#34;pre_index_suf&#34; 
&#34;/products/view.html&#34; -&gt; &#34;products/view&#34;
</code></pre><p>Controller를 따로 만들 필요가 없으며, 아래와 같이 빈 설정 파일에서 url과 UrlFilenameViewController를 매핑만 해주면 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;urlMapping&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;mappings&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;props&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/login.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>urlFilenameViewController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;prop</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;/validator.do&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>urlFilenameViewController<span style=color:#204a87;font-weight:700>&lt;/prop&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/props&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;urlFilenameViewController&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.UrlFilenameViewController&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>InternalResourceViewResolver가 아래와 같이 선언되어 있다면,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.InternalResourceViewResolver&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>p:prefix=</span><span style=color:#4e9a06>&#34;/WEB-INF/jsp/&#34;</span> <span style=color:#c4a000>p:suffix=</span><span style=color:#4e9a06>&#34;.jsp&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>URL http://localhost:8080/easycompany/login.do로 요청이 들어올때, /easycompany/webapp/WEB-INF/jsp/login.jsp을 찾아서 보여준다.</p><h2 id=참고자료>참고자료</h2><ul><li>The Spring Framework - Reference Documentation 2.5.6</li><li>Spring Framework API Documentation 2.5.6</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-838d8dd01c23d19c4a43f0b79103b750>7 - Annotation 기반 Controller</h1><div class=lead>스프링 프레임워크는 2.5 버전부터 Java 5+ 이상에서 @Controller를 이용한 Annotation 기반 컨트롤러 개발을 지원한다. 이는 기존의 계층형 Controller(SimpleFormController, MultiActionController)와 달리 인터페이스 구현 없이 더 유연하고 간결한 방식으로 요청을 처리할 수 있는 점이 주요 개선점이다.</div><h1 id=annotation-based-controller>Annotation-based Controller</h1><h2 id=개요>개요</h2><p>스프링 프레임워크는 2.5 버젼 부터 Java 5+ 이상이면 @Controller(Annotation-based Controller)를 개발할 수 있는 환경을 제공한다.
인터페이스 Controller를 구현한 SimpleFormController, MultiActionController 같은 기존의 계층형(Hierarchy) Controller와의 주요 차이점 및 개선점은 아래와 같다.</p><ul><li><a href=#%EC%96%B4%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%84%A4%EC%A0%95>어노테이션을 이용한 설정</a><ul><li>XML 기반으로 설정하던 정보들을 어노테이션을 사용해서 정의한다.</li></ul></li><li><a href=#%EC%9C%A0%EC%97%B0%ED%95%B4%EC%A7%84-%EB%A9%94%EC%86%8C%EB%93%9C-%EC%8B%9C%EA%B7%B8%EB%8B%88%EC%B3%90>유연해진 메소드 시그니쳐</a><ul><li>Controller 메소드의 파라미터와 리턴 타입을 좀 더 다양하게 필요에 따라 선택할 수 있다.</li></ul></li><li><a href=#pojo-style%EC%9D%98-controller>POJO-Style의 Controller</a><ul><li>Controller 개발시에 특정 인터페이스를 구현 하거나 특정 클래스를 상속해야할 필요가 없다.</li><li>하지만 폼 처리, 다중 액션등 기존의 계층형 Controller가 제공하던 기능들을 여전히 쉽게 구현할 수 있다.</li></ul></li></ul><p>계층형 Controller로 작성된 폼 처리를 @Controller로 구현하는 예도 설명한다.
예제 코드 easycompany의 Controller는 동일한 기능(또한 공통의 Service, DAO, JSP를 사용)을 계층형 Controller와 @Controller로 각각 작성했다.</p><ul><li>계층형 Controller - 패키지 com.easycompany.controller.hierarchy</li><li>@Controller - 패키지 com.easycompany.controller.annotation</li></ul><h2 id=설명>설명</h2><h3 id=어노테이션을-이용한-설정>어노테이션을 이용한 설정</h3><p>계층형 Controller들을 사용하면 여러 정보들(요청과 Controller의 매핑 설정 등)을 XML 설정 파일에 명시 해줘야 하는데, 복잡할 뿐 아니라 설정 파일과 코드 사이를 빈번히 이동 해야하는 부담과 번거로움이 될 수 있다.
@MVC는 Controller 코드안에 어노테이션으로 설정함으로써 좀 더 편리하게 MVC 프로그래밍을 할 수 있도록 했다.
@MVC에서 사용하는 주요 어노테이션은 아래와 같다.</p><table><thead><tr><th>이름</th><th>설명</th></tr></thead><tbody><tr><td>@Controller</td><td>해당 클래스가 Controller임을 나타내기 위한 어노테이션</td></tr><tr><td>@RequestMapping</td><td>요청에 대해 어떤 Controller, 어떤 메소드가 처리할지를 맵핑하기 위한 어노테이션</td></tr><tr><td>@RequestParam</td><td>Controller 메소드의 파라미터와 웹요청 파라미터와 맵핑하기 위한 어노테이션</td></tr><tr><td>@ModelAttribute</td><td>Controller 메소드의 파라미터나 리턴값을 Model 객체와 바인딩하기 위한 어노테이션</td></tr><tr><td>@SessionAttributes</td><td>Model 객체를 세션에 저장하고 사용하기 위한 어노테이션</td></tr><tr><td>@RequestPart</td><td>Multipart 요청의 경우, 웹요청 파라미터와 맵핑가능한 어노테이션(egov 3.0, Spring 3.1.x부터 추가)</td></tr><tr><td>@CommandMap</td><td>Controller메소드의 파라미터를 Map형태로 받을 때 웹요청 파라미터와 맵핑하기 위한 어노테이션(egov 3.0부터 추가)</td></tr><tr><td>@ControllerAdvice</td><td>Controller를 보조하는 어노테이션으로 Controller에서 쓰이는 공통기능들을 모듈화하여 전역으로 쓰기 위한 어노테이션(egov 3.0, Spring 3.2.X부터 추가)</td></tr></tbody></table><h4 id=controller>@Controller</h4><p>@MVC에서 Controller를 만들기 위해서는 작성한 클래스에 @Controller를 붙여주면 된다. 특정 클래스를 구현하거나 상속할 필요가 없다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.annotation</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>LoginController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>앞서 DefaultAnnotationHandlerMapping에서 언급한 대로 <code>&lt;context:component-scan></code> 태그를 이용해 @Controller들이 있는 패키지를 선언해 주면 된다.
@Controller만 스캔 한다면 include, exclude 등의 필터를 사용하라.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style=color:#c4a000>xmlns:p=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/p&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xmlns:context=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>				http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;context:component-scan</span> <span style=color:#c4a000>base-package=</span><span style=color:#4e9a06>&#34;com.easycompany.controller.annotation&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><h4 id=requestmapping>@RequestMapping</h4><p>@RequestMapping은 요청에 대해 어떤 Controller, 어떤 메소드가 처리할지를 맵핑하기 위한 어노테이션이다. @RequestMapping이 사용하는 속성은 아래와 같다.</p><table><thead><tr><th>이름</th><th>타입</th><th>설명</th></tr></thead><tbody><tr><td>value</td><td>String[]</td><td>URL 값으로 맵핑 조건을 부여한다.<br>@RequestMapping(value=”/hello.do”) 또는 @RequestMapping(value={”/hello.do”, ”/world.do” })와 같이 표기하며,<br>기본값이기 때문에 @RequestMapping(”/hello.do”)으로 표기할 수도 있다.<br>”/myPath/*.do”와 같이 Ant-Style의 패턴매칭을 이용할 수도 있다.<br>Spring 3.1부터 URL뒤에 중괄호를 이용하여 변수값을 직접 받을 수 있도록 하였다. 아래 설명(URI Template Variable Enhancements)을 참고하라</td></tr><tr><td>method</td><td>RequestMethod[]</td><td>HTTP Request 메소드값을 맵핑 조건으로 부여한다.<br>HTTP 요청 메소드값이 일치해야 맵핑이 이루어 지게 한다.<br>@RequestMapping(method = RequestMethod.POST)같은 형식으로 표기한다.<br>사용 가능한 메소드는 GET, POST, HEAD, OPTIONS, PUT, DELETE, TRACE이다</td></tr><tr><td>params</td><td>String[]</td><td>HTTP Request 파라미터를 맵핑 조건으로 부여한다.<br>params=“myParam=myValue”이면 HTTP Request URL중에 myParam이라는 파라미터가 있어야 하고 값은 myValue이어야 맵핑한다.<br>params=“myParam”와 같이 파라미터 이름만으로 조건을 부여할 수도 있고, ”!myParam”하면 myParam이라는 파라미터가 없는 요청 만을 맵핑한다.<br>@RequestMapping(params={“myParam1=myValue”, “myParam2”, ”!myParam3”})와 같이 조건을 주었다면,<br>HTTP Request에는 파라미터 myParam1이 myValue값을 가지고 있고, myParam2 파라미터가 있어야 하고, myParam3라는 파라미터는 없어야 한다.</td></tr><tr><td>consumes</td><td>String[]</td><td>설정과 Content-Type request헤더가 일치 할 경우에만 URL이 호출된다.</td></tr><tr><td>produces</td><td>String[]</td><td>설정과 Accept request헤더가 일치 할 경우에만 URL이 호출된다.</td></tr></tbody></table><p>@RequestMapping은 클래스 단위(type level)나 메소드 단위(method level)로 설정할 수 있다.</p><p><strong>type level</strong></p><p>/hello.do 요청이 오면 HelloController의 hello 메소드가 수행된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/hello.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span>   <span style=color:#8f5902;font-style:italic>//type level에서 URL을 정의하고 Controller에 메소드가 하나만 있어도 요청 처리를 담당할 메소드 위에 @RequestMapping 표기를 해야 제대로 맵핑이 된다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>hello</span><span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>		
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>method level</strong></p><p>/hello.do 요청이 오면 hello 메소드,
/helloForm.do 요청은 GET 방식이면 helloGet 메소드, POST 방식이면 helloPost 메소드가 수행된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloController</span> <span style=color:#ce5c00;font-weight:700>{</span>	
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/hello.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>hello</span><span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/helloForm.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>helloGet</span><span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/helloForm.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>helloPost</span><span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>	
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>type + method level</strong>
둘 다 설정할 수도 있는데, 이 경우엔 type level에 설정한 @RequestMapping의 value(URL)를 method level에서 재정의 할수 없다.</p><p>/hello.do 요청시에 GET 방식이면 helloGet 메소드, POST 방식이면 helloPost 메소드가 수행된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/hello.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>helloGet</span><span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>helloPost</span><span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>AbstractController 상속받아 구현한 예제 코드 LoginController를 어노테이션 기반의 Controller로 구현해 보겠다.</p><p>기존의 LoginController는 URL /loginProcess.do로 오는 요청의 HTTP 메소드가 POST일때 handleRequestInternal 메소드가 실행되는 Controller였는데,</p><p>다음과 같이 구현할 수 있겠다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.annotation</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>LoginController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>LoginService</span> <span style=color:#000>loginService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/loginProcess.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>login</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>id</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>String</span> <span style=color:#000>password</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;password&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Account</span> <span style=color:#000>account</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Account</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>loginService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>authenticate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>account</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getSession</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>setAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;UserAccount&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>account</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;redirect:/employeeList.do&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;login&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>	
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>위 예제 코드에서 서비스 클래스를 호출하기 위해서 @Autowired가 사용되었는데 자세한 내용은 <a href=https://docs.spring.io/spring-framework/reference/core/beans/annotation-config/autowired.html>여기</a>를 참고하라.</p><p><strong>type + method level + request</strong></p><p>앞의 내용에서 추가되어 request의 header설정 일치 여부에 따라 URL호출이 가능하다.</p><p>다음 예제에서 URL이 /pets로 요청된 경우, POST타입의 request의 content-type이 application/json인 경우에만 다음 메소드가 호출된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/pets&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>consumes</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application/json&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>addPet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestBody</span> <span style=color:#000>Pet</span> <span style=color:#000>pet</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Model</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// implementation omitted
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>다음 예제에서 GET타입으로 URL이 /pets/*로 요청된 경우, request의 accept header가 application/json인 경우에만 다음 메소드가 호출된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/pets/{petId}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>produces</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application/json&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@ResponseBody</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Pet</span> <span style=color:#000>getPet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@PathVariable</span> <span style=color:#000>String</span> <span style=color:#000>petId</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Model</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> 
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// implementation omitted
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>URI Template Variale Enhancements</strong></p><p>@RequestMapping의 value에 URL뒤에 중괄호로 Controller메소드의 파라미터로 받을 값의 변수명을 입력해주면 변수를 받을 수 있다.</p><p>다음 예제에서 Controller메소드의 URL을 ”/user/view/{id}“로 설정하였을 때, 만약 /user/view/12345 로 URL요청이 들어오면 view함수의 파라미터인 id가 12345로 설정된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/user/view/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>view</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@PathVariable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// implementation omitted
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>@RequestParam</strong></p><p>@RequestParam은 Controller 메소드의 파라미터와 웹요청 파라미터와 맵핑하기 위한 어노테이션이다.
관련 속성은 아래와 같다.</p><table><thead><tr><th>이름</th><th>타입</th><th>설명</th></tr></thead><tbody><tr><td>value</td><td>String</td><td>파라미터 이름</td></tr><tr><td>required</td><td>boolean</td><td>해당 파라미터가 반드시 필수 인지 여부. 기본값은 true이다.</td></tr></tbody></table><p>아래 코드와 같은 방법으로 사용되는데,
해당 파라미터가 Request 객체 안에 없을때 그냥 null값을 바인드 하고 싶다면, pageNo 파라미터 처럼 required=false로 명시해야 한다.</p><p>name 파라미터는 required가 true이므로, 만일 name 파라미터가 null이면 org.springframework.web.bind.MissingServletRequestParameterException이 발생한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/hello.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>hello</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#8f5902;font-style:italic>//required 조건이 없으면 기본값은 true, 즉 필수 파라미터 이다. 파라미터 name이 존재하지 않으면 Exception 발생.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;pageNo&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>required</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>pageNo</span><span style=color:#ce5c00;font-weight:700>){</span> <span style=color:#8f5902;font-style:italic>//파라미터 pageNo가 존재하지 않으면 String pageNo는 null.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#ce5c00;font-weight:700>...</span>		
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>위에서 작성한 LoginController의 login 메소드를 보면 파라미터 아이디와 패스워드를 Http Request 객체에서 getParameter 메소드를 이용해 구하는데,</p><p>@RequestParam을 사용하면 아래와 같이 변경할수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.annotation</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>LoginController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>LoginService</span> <span style=color:#000>loginService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/loginProcess.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>login</span><span style=color:#ce5c00;font-weight:700>(</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;password&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>		
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Account</span> <span style=color:#000>account</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Account</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>loginService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>authenticate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>password</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>account</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getSession</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>setAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;UserAccount&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>account</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;redirect:/employeeList.do&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;login&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=modelattribute>@ModelAttribute</h4><p>@ModelAttribute의 속성은 아래와 같다.</p><table><thead><tr><th>이름</th><th>타입</th><th>설명</th></tr></thead><tbody><tr><td>value</td><td>String</td><td>바인드하려는 Model 속성 이름.</td></tr></tbody></table><p>@ModelAttribute는 실제적으로 ModelMap.addAttribute와 같은 기능을 발휘하는데, Controller에서 2가지 방법으로 사용된다.</p><p><strong>1.메소드 리턴 데이터와 Model 속성(attribute)의 바인딩</strong></p><p>메소드에서 비지니스 로직(DB 처리같은)을 처리한 후 결과 데이터를 ModelMap 객체에 저장하는 로직은 일반적으로 자주 발생한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ModelMap</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//DB에서 부서정보 데이터를 가져온다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//데이터를 모델 객체에 저장한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><p>@ModelAttribute를 메소드에 선언하면 해당 메소드의 리턴 데이터가 ModelMap 객체에 저장된다.
위 코드를 아래와 같이 변경할수 있는데, 사용자로 부터 GET방식의 /updateDepartment.do 호출이 들어오면,
formBackingObject 메소드가 실행 되기 전에 DefaultAnnotationHandlerMapping이 org.springframework.web.bind.annotation.support.HandlerMethodInvoker을 이용해서
(@ModelAttribute가 선언된)getEmployeeInfo를 실행하고, 결과를 ModelMap객체에 저장한다.
결과적으로 getEmployeeInfo 메소드는 ModelMap.addAttribute(“department”, departmentService.getDepartmentInfoById(…)) 작업을 하게 되는것이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Department</span> <span style=color:#000>getEmployeeInfo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//DB에서 부서정보 데이터를 가져온다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#000>또는</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>Department</span> <span style=color:#000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><p><strong>2.메소드 파라미터와 Model 속성(attribute)의 바인딩</strong></p><p>@ModelAttribute는 ModelMap 객체의 특정 속성(attribute) 메소드의 파라미터와 바인딩 할때도 사용될수 있다.
아래와 같이 메소드의 파라미터에 ”<strong>@ModelAttribute(“department”) Department department</strong>” 선언하면 department에는 <strong>(Department)ModelMap.get(“department”)</strong> 값이 바인딩된다.
따라서, 아래와 같은 코드라면 formBackingObject 메소드 파라미터 department에는 getDepartmentInfo 메소드가 ModelMap 객체에 저장한 Department 데이터가 들어 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>Department</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#8f5902;font-style:italic>//department에는 getDepartmentInfo에서 구해온 데이터들이 들어가 있다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>employee</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getEmployeeid</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>employee</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getName</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Department</span> <span style=color:#000>getDepartmentInfo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//DB에서 부서정보 데이터를 가져온다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><h4 id=sessionattributes>@SessionAttributes</h4><p>@SessionAttributes는 model attribute를 session에 저장, 유지할 때 사용하는 어노테이션이다. @SessionAttributes는 클래스 레벨(type level)에서 선언할 수 있다. 관련 속성은 아래와 같다.</p><table><thead><tr><th>이름</th><th>타입</th><th>설명</th></tr></thead><tbody><tr><td>types</td><td>Class[]</td><td>session에 저장하려는 model attribute의 타입</td></tr><tr><td>value</td><td>String[]</td><td>session에 저장하려는 model attribute의 이름</td></tr></tbody></table><h4 id=requestparam>@RequestParam</h4><p>Multipart request의 경우, 넘겨받은 Contents의 Content-Type에 따라 HttpMessageConverter를 통해 해당 타입대로 multipart컨텐츠를 얻을 때 사용하는 어노테이션이다.</p><p>예를 들어 다음과 같이 요청이 multipart로 들어올 때</p><pre tabindex=0><code>POST /someUrl
Content-Type: multipart/mixed
 
--edt7Tfrdusa7r3lNQc79vXuhIIMlatb7PQg7Vp
Content-Disposition: form-data; name=&#34;meta-data&#34;
Content-Type: application/json; charset=UTF-8
Content-Transfer-Encoding: 8bit
 
{
  &#34;name&#34;: &#34;value&#34;
}
--edt7Tfrdusa7r3lNQc79vXuhIIMlatb7PQg7Vp
Content-Disposition: form-data; name=&#34;file-data&#34;; filename=&#34;file.properties&#34;
Content-Type: text/xml
Content-Transfer-Encoding: 8bit
... File Data ...
</code></pre><p>Controller에서 요청값은 아래와 같이 받을 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/someUrl&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>onSubmit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestPart</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;meta-data&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>MetaData</span> <span style=color:#000>metadata</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>                       <span style=color:#5c35cc;font-weight:700>@RequestPart</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;file-data&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>MultipartFile</span> <span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=commandmap>@CommandMap</h4><p>@CommandMap은 실행환경 3.0환경부터 추가된 Controller에서 Map형태로 웹요청 값을 받았을 때 다른 Map형태의 argument와 구분해주기 위한 어노테이션이다. @CommandMap은 파라미터 레벨(type level)에서만 선언할 수 있다.</p><p>사용 방법은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>   <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/test.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>test</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#5c35cc;font-weight:700>@CommandMap</span> <span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>commandMap</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//생략
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>자세한 사용방법은 <a href=web-servlet-AnnotationCommandMapArgumentResolver.md>AnnotationCommandMapArgumentResolver</a>을 참고한다.</p><h4 id=controlleradvice>@ControllerAdvice</h4><p>@ControllerAdvice 어노테이션을 통해 Controller에서 쓰이는 몇가지 어노테이션 기능들을 모듈화하여 전역으로 쓸 수 있다.
@ControllerAdvice은 @RequestMapping이 붙은 메소드를 지원하며 다음과 같은 Controller 어노테이션을 지원한다.</p><table><thead><tr><th>이름</th><th>설명</th></tr></thead><tbody><tr><td>@ExceptionHandler</td><td>@ExceptionHandler 뒤에 붙은 Exception이 발생했을 때, 전역적으로 예외처리가 가능하다.</td></tr><tr><td>@InitBinder</td><td>모델 검증과 바인딩을 하기 위한 Annotation으로써 JSR-303 빈 검증기능을 사용하는 스프링 validator를 사용할 수 있다.</td></tr><tr><td>@ModelAttribute</td><td>도메인 오브젝트나 DTO프로퍼티에 요청파라미터를 한 번에 받을 수 있는 @ModelAttribute를 전역으로 사용 가능하다.</td></tr></tbody></table><p><strong>@ExceptionHandler with @ControllerAdvice</strong></p><p>기존에는 예외발생시, AnnotationMethodHandlerExceptionResolver가 Controller내부에서 @ExceptionHandler가 붙은 메소드를 찾아 예외처리를 해준다.</p><p>Controller 내부에서만 @ExceptionHandler가 동작하기 때문에 각 Controller별로 @ExceptionHandler 메소드를 만들어야했다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/hello&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>hello</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//DataAccessException이 일어날 가능성
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Controller 내부에서 DataAccessException발생시 호출
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#5c35cc;font-weight:700>@ExceptionHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DataAccessException</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>dataAccessExceptionHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DataAccessException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;dataexception&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;msg&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessage</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>Spring 3.2부터는 @ControllerAdvice를 이용하여 @ExceptionHandler를 전역으로 쓸 수 있다.</p><p>@ControllerAdvice + @ExceptionHandler를 통해 각각의 Exception에 대하여 전역적인 후처리 관리가 가능해진다.</p><p>즉, Controller마다 @ExceptionHandler를 만들지 않더라도 @ControllerAdvice가 붙은 Class안에서 여러 Exception에 대한 처리가 가능한 @ExceptionHandler 메소드를 만들면 로지컬한 Exception별 후처리가 가능해지는 것이다.</p><p>@ControllerAdvice와 함께 @ExceptionHandler를 쓰는 방법은 다음과 같다.
다음과 같이 쓰는 경우, Controller에서 발생하는 해당 Exception들이 예외처리가 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@ControllerAdvice</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>CentralControllerHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@ExceptionHandler</span><span style=color:#ce5c00;font-weight:700>({</span><span style=color:#000>EgovBizException</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>handleEgovBizException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>EgovBizException</span> <span style=color:#000>ee</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//생략
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@ExceptionHandler</span><span style=color:#ce5c00;font-weight:700>({</span><span style=color:#000>BaseException</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>handleBaseException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>BaseException</span> <span style=color:#000>be</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//생략
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>@InitBinder with @ControllerAdvice</strong></p><p>@ControllerAdvice가 붙은 Class내부에서 @InitBinder 메소드를 씀으로써 이를 전역으로 쓸 수도 있다.</p><ul><li>@InitBinder<ul><li>WebDataBinder를 초기화하는 메소드를 지정할 수 있는 설정을 제공한다. WebDataBinder는 Web request parameter를 javaBean객체에 바인딩하는 특정한 DataBinder이다.</li><li>일반적으로 annotation handler메소드의 command와 form객체 인자를 조사하는데 사용된다.(CustomEditor를 등록하거나 Validator를 등록할 때 쓰인다)</li></ul></li></ul><p>@ControllerAdvice 와 함께 @InitBinder를 쓰는 방법은 다음과 같다.
@InitBinder는 Controller에서 @Valid를 쓰는 경우에만 해당 파라미터의 데이터 검증이 적용된다.</p><p>Person객체를 모델바인딩 및 검증해주는 PersonValidator를 이용하는 경우이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@ControllerAdvice</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>CentralControllerHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@InitBinder</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>initBinder</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebDataBinder</span> <span style=color:#000>binder</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>binder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setValidator</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PersonValidator</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//생략
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>이 때 Controller의 구현 예이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/persons&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>updatePerson</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@Valid</span> <span style=color:#000>Person</span> <span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>personService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updatePerson</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//생략
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=modelattribute와-controlleradvice>@ModelAttribute와 @ControllerAdvice</h4><p>@ControllerAdvice를 통해 @ModelAttribute의 메소드 또한 전역으로 쓰일 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@ControllerAdvice</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>GlobalControllerAdvice</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>...</span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;model&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Model</span> <span style=color:#000>getModel</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>model</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=유연해진-메소드-시그니쳐>유연해진 메소드 시그니쳐</h3><p>@RequestMapping을 적용한 Controller의 메소드는 아래와 같은 메소드 파라미터와 리턴 타입을 사용할수 있다.</p><p>특정 클래스를 확장하거나 인터페이스를 구현해야 하는 제약이 없기 때문에 계층형 Controller 비해 유연한 메소드 시그니쳐를 갖는다.</p><h4 id=controller의-메소드-파라미터>@Controller의 메소드 파라미터</h4><p>사용가능한 메소드 파라미터는 아래와 같다.</p><ul><li>Servlet API<ul><li>ServletRequest, HttpServletRequest, HttpServletResponse, HttpSession 같은 요청,응답,세션관련 Servlet API들</li></ul></li><li>WebRequest, NativeWebRequest<ul><li>org.springframework.web.context.request.WebRequest, org.springframework.web.context.request.NativeWebRequest</li></ul></li><li>java.util.Locale</li><li>java.io.InputStream / java.io.Reader</li><li>java.io.OutputStream / java.io.Writer</li><li>@RequestParam<ul><li>HTTP Request의 파라미터와 메소드의 argument를 바인딩하기 위해 사용하는 어노테이션</li></ul></li><li>java.util.Map / org.springframework.ui.Model / org.springframework.ui.ModelMap<ul><li>뷰에 전달할 모델데이터들</li></ul></li><li>Command/form 객체<ul><li>HTTP Request로 전달된 parameter를 바인딩한 커맨드 객체, @ModelAttribute을 사용하면 alias를 줄수 있다.</li></ul></li><li>Errors, BindingResult<ul><li>org.springframework.validation.Errors / org.springframework.validation.BindingResult 유효성 검사후 결과 데이터를 저장한 객체</li></ul></li><li>SessionStatus<ul><li>org.springframework.web.bind.support.SessionStatus 세션폼 처리시에 해당 세션을 제거하기 위해 사용된다.</li></ul></li></ul><p>메소드는 임의의 순서대로 파라미터를 사용할수 있다. 단, BindingResult가 메소드의 argument로 사용될 때는 바인딩 할 커맨드 객체가 바로 앞에 와야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>updateEmployee</span><span style=color:#ce5c00;font-weight:700>(...,</span><span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;employee&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>Employee</span> <span style=color:#000>employee</span><span style=color:#ce5c00;font-weight:700>,</span>			
</span></span><span style=display:flex><span>			<span style=color:#000>BindingResult</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>,...)</span> <span style=color:#8f5902;font-style:italic>/* (O) */</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>updateEmployee</span><span style=color:#ce5c00;font-weight:700>(...,</span><span style=color:#000>BindingResult</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>                        <span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;employee&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>Employee</span> <span style=color:#000>employee</span><span style=color:#ce5c00;font-weight:700>,...)</span> <span style=color:#8f5902;font-style:italic>/* (X) */</span>
</span></span></code></pre></div><p><strong>이 외의 타입을 메소드 파라미터로 사용하려면?</strong></p><p>스프링 프레임워크는 위에서 언급한 타입이 아닌 custom arguments도 메소드 파라미터로 사용할 수 있도록 org.springframework.web.bind.support.WebArgumentResolver라는 인터페이스를 제공한다.</p><p>WebArgumentResolver를 사용한 예제는 <a href="https://www.egovframe.go.kr/wiki/doku.php?id=egovframework:rte:ptl:controller:commandmapargumentresolver">이곳</a>을 참고</p><h4 id=controller의-메소드-리턴-타입>@Controller의 메소드 리턴 타입</h4><p>사용가능한 메소드 리턴 타입은 아래와 같다.</p><ul><li>ModelAndView<ul><li>커맨드 객체와 @ModelAttribute이 적용된 메소드의 리턴 데이터가 담긴 Model 객체와 View 정보가 담겨 있다.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>        <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>ModelAndView</span> <span style=color:#000>mav</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>mav</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>mav</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>또는</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ModelMap</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>ModelAndView</span> <span style=color:#000>mav</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>mav</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAllObjects</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>mav</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>Model (또는 ModelMap)<ul><li>커맨드 객체와 @ModelAttribute이 적용된 메소드의 리턴 데이터가 Model 객체에 담겨 있다.</li><li>View 이름은 RequestToViewNameTranslator가 URL을 이용하여 결정한다.</li><li>인터페이스 RequestToViewNameTranslator의 구현클래스인 DefaultRequestToViewNameTranslator가 View 이름을 결정하는 방식은 아래와 같다.</li></ul></li></ul><pre tabindex=0><code>http://localhost:8080/gamecast/display.html -&gt; display
http://localhost:8080/gamecast/displayShoppingCart.html -&gt; displayShoppingCart
http://localhost:8080/gamecast/admin/index.html -&gt; admin/index
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Model</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Model</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>또는</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Model</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Model</span> <span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ExtendedModelMap</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>Map<ul><li>커맨드 객체와 @ModelAttribute이 적용된 메소드의 리턴 데이터가 Map 객체에 담겨 있으며, View 이름은 역시 RequestToViewNameTranslator가 결정한다.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Map</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Map</span> <span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>또는</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Map</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Map</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>String<ul><li>리턴하는 String 값이 곧 View 이름이된다.</li><li>커맨드 객체와 @ModelAttribute이 적용된 메소드의 리턴 데이터가 Model(또는 ModelMap)에 담겨있다.</li><li>리턴할 Model(또는 ModelMap)객체가 해당 메소드의 argument에 선언되어 있어야한다.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/* (O) */</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ModelMap</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/* (X) */</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>ModelMap</span> <span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelMap</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>View<ul><li>View를 리턴한다. 커맨드 객체와 @ModelAttribute이 적용된 메소드의 리턴 데이터가 Model(또는 ModelMap)에 담겨 있다.</li></ul></li><li>void<ul><li>메소드가 ServletResponse / HttpServletResponse등을 사용해서 직접 응답을 처리하는 경우. View 이름은 RequestToViewNameTranslator가 결정한다.</li></ul></li></ul><h3 id=pojo-style의-controller>POJO-Style의 Controller</h3><p>@MVC는 Controller 개발시에 특정 인터페이스를 구현 하거나 특정 클래스를 상속해야할 필요가 없다.</p><p>Controller의 메소드에서 Servlet API를 반드시 참조하지 않아도 되며, 훨씬 유연해진 메소드 시그니쳐로 개발이 가능하다.</p><p>여기서는 SimpleFormController의 폼 처리 액션을 @Controller로 구현함으로써, POJO-Style에 가까워졌지만 기존의 계층형 Controller에서 제공하던 기능들을 여전히 구현할 수 있음을 보이고자 한다.</p><h4 id=formcontroller-by-simpleformcontroller---controller>FormController by SimpleFormController -> @Controller</h4><p>앞서 SimpleFormController을 설명하면서 예제로 작성된 com.easycompany.controller.hierarchy.UpdateDepartmentController를 @ModelAttribute와 @RequestMapping을 이용해서 같은 기능을 @Controller로 작성해 보겠다.</p><p>JSP 소스는 동일한 것을 사용한다. <a href=web-servlet-controller.md#simpleformcontroller>이곳</a>의 예제 화면 이미지 및 JSP 코드를 참고.
기존의 UpdateDepartmentController를 보면 3가지 메소드로 이루어졌다.</p><ul><li>referenceData<ul><li>입력폼에 필요한 참조데이터인 상위부서정보를 가져와서 Map 객체에 저장한다. 이후에 이 Map 객체는 스프링 내부 로직에 의해 ModelMap 객체에 저장된다.</li></ul></li><li>formBackingObject<ul><li>GET 방식 호출일때 초기 입력폼에 들어갈 부서 데이터를 리턴한다. 이 데이터 역시 ModelMap 객체에 저장된다.</li></ul></li><li>onSubmit<ul><li>POST 전송시에 호출되며 폼 전송을 처리한다.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.hierarchy</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>UpdateDepartmentController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>SimpleFormController</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DepartmentService</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setDepartmentService</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DepartmentService</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>departmentService</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//상위부서리스트(selectbox)는 부서정보클래스에 없으므로 , 상위부서리스트 데이터를 DB에서 구해서 별도의 참조데이터로 구성한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Map</span> <span style=color:#000>referenceData</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Errors</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Map</span> <span style=color:#000>referenceMap</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>referenceMap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptInfoOneDepthCategory&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentIdNameList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>	<span style=color:#8f5902;font-style:italic>//상위부서정보를 가져와서 Map에 담는다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>referenceMap</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Object</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>isFormSubmission</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)){</span>	<span style=color:#8f5902;font-style:italic>// GET 요청이면
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>String</span> <span style=color:#000>deptid</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span><span style=color:#8f5902;font-style:italic>//부서 아이디로 DB를 조회한 결과가 커맨드 객체 반영.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>else</span><span style=color:#ce5c00;font-weight:700>{</span>	<span style=color:#8f5902;font-style:italic>// POST 요청이면
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#8f5902;font-style:italic>//AbstractFormController의 formBackingObject을 호출하면 요청객체의 파라미터와 설정된 커맨드 객체간에 기본적인 데이터 바인딩이 이루어 진다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>onSubmit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindException</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Department</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updateDepartment</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>showForm</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getSuccessView</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>@Controller로 작성된 com.easycompany.controller.annotation.UpdateDepartmentController은 3개의 메소드로 이루어져 있다.</p><p>계층형 Controller인 기존의 UpdateDepartmentController와는 달리 각 메소드는 Override 할 필요없기 때문에 메소드 이름은 자유롭게 지을 수 있다.</p><p>쉬운 비교를 위해 SimpleFormController과 동일한 메소드 이름을 선택했다.</p><ul><li>referenceData<ul><li>입력폼에 필요한 참조데이터인 상위부서정보를 가져와서 ModelMap에 저장한다.(by @ModelAttribute)</li></ul></li><li>formBackingObject<ul><li>GET 방식 호출일때 처리를 담당한다. 초기 입력폼 구성을 위한 부서데이터를 가져와서 ModelMap에 저장한다.</li></ul></li><li>onSubmit<ul><li>POST 전송시에 호출되며 폼 전송을 처리한다.</li></ul></li></ul><p>(POJO에 가까운) 프레임워크 코드들은 감춰졌고, 보다 직관적으로 비지니스 내용을 표현할 수 있게 되었다고 생각한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.annotation</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>UpdateDepartmentController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DepartmentService</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//상위부서리스트(selectbox)는 부서정보클래스에 없으므로 , 상위부서리스트 데이터를 DB에서 구해서 별도의 참조데이터로 구성한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptInfoOneDepthCategory&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>referenceData</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentIdNameList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// 해당 부서번호의 부서정보 데이터를 불러와 입력폼을 채운다
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>formBackingObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptid&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ModelMap</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentInfoById</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//form tag의 commandName은 이 attribute name과 일치해야 한다. &lt;form:form commandName=&#34;department&#34;&gt;.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//사용자가 데이터 수정을 끝내고 저장 버튼을 누르면 수정 데이터로 저장을 담당하는 서비스(DB)를 호출한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#8f5902;font-style:italic>//저장이 성공하면 부서리스트 페이지로 이동하고 에러가 있으면 다시 입력폼페이지로 이동한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>onSubmit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>Department</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindingResult</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//validation code
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>DepartmentValidator</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>validate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>);</span>		
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasErrors</span><span style=color:#ce5c00;font-weight:700>()){</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updateDepartment</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;redirect:/departmentList.do?depth=1&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li><a href=https://docs.spring.io/spring-framework/docs/2.5.x/reference/index.html>The Spring Framework - Reference Documentation 2.5.6</a></li><li><a href=https://docs.spring.io/spring-framework/docs/2.5.6/javadoc-api/>Spring Framework API Documentation 2.5.6</a></li><li><a href=https://spring.io/blog/2007/11/14/annotated-web-mvc-controllers-in-spring-2-5>SpringSource Team Blog,Annotated Web MVC Controllers in Spring 2.5, Juergen Hoeller</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-08c319109072509092038f7418a9ad23>8 - Spring의 Validator 인터페이스와 유효성 검증</h1><div class=lead>스프링 프레임워크는 Validator 인터페이스를 제공해 웹, 데이터 접근 등 다양한 계층의 객체에 유효성 검증을 지원한다. 또한 Jakarta Commons Validator와 같은 외부 Validator도 스프링에서 통합하여 사용할 수 있다.</div><h1 id=validation>Validation</h1><h2 id=개요>개요</h2><p>객체의 유효성 검증을 위해 스프링 프레임워크는 org.springframework.validation.Validator라는 인터페이스를 제공한다.
Validator는 특정 계층에 종속적인 구조가 아니라서, web이나 data-access등 어떤 계층의 객체라도 유효성 검증이 가능하게 한다.
Jakarta Commons Validator나 Valang 같은 외부 Validator들도 Spring 프레임워크에서 사용할 수 있다.
Spring Modules를 이용한 Jakarta Commons Validator 사용 방법에 대해서는 Spring Framework에서 Commons Validator 사용 을 참고하라.</p><h2 id=설명>설명</h2><p>부서 정보를 수정하는 페이지에서 커맨드 객체인 부서 정보 클래스를 유효성 검증하는 코드를 작성해 보자.
부서 클래스인 Department 클래스는 아래와 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.domain</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>Department</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>deptid</span><span style=color:#ce5c00;font-weight:700>;</span>   <span style=color:#8f5902;font-style:italic>//부서아이디
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>deptname</span><span style=color:#ce5c00;font-weight:700>;</span>  <span style=color:#8f5902;font-style:italic>//부서이름
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>superdeptid</span><span style=color:#ce5c00;font-weight:700>;</span>  <span style=color:#8f5902;font-style:italic>//상위부서아이디
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>superdeptname</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#8f5902;font-style:italic>//상위부서이름
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>depth</span><span style=color:#ce5c00;font-weight:700>;</span>  <span style=color:#8f5902;font-style:italic>//부서레벨
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>description</span><span style=color:#ce5c00;font-weight:700>;</span>  <span style=color:#8f5902;font-style:italic>//부서설명
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//위 프로퍼티들의 setter/getter
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=validator-구현>Validator 구현</h3><p>인터페이스 org.springframework.validation.Validator의 메소드는 다음과 같다.</p><ul><li>boolean supports(Class clazz) : 주어진 객체(clazz)에 대해 Validator가 지원 가능한가?</li><li>void validate(Object target, Errors errors) : 주어진 객체(target)에 대해서 유효성 체크를 수행하고, 유효성 에러 발생시 주어진 Errors객체에 관련 정보가 저장된다.</li></ul><p>구현 Validator 클래스를 만들때는 위 두 메소드를 구현해야 한다.</p><p>Department를 유효성 검증 하기 위한 DepartmentValidator를 만들어 보자.
Validation 조건은 부서이름(deptname) 프로퍼티는 반드시 값이 존재해야 하며, 부서설명(description) 프로퍼티는 입력값의 길이가 10 이상이어야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.validator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.validation.Errors</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.validation.Validator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>com.easycompany.domain.Department</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DepartmentValidator</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>Validator</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>supports</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Class</span> <span style=color:#000>clazz</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>Department</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isAssignableFrom</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>clazz</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>validate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>target</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Errors</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Department</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>target</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>isEmptyOrWhitespace</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDeptname</span><span style=color:#ce5c00;font-weight:700>()))</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#8f5902;font-style:italic>//부서 이름 프로퍼티 값이 존재하는가? 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>rejectValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deptname&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;required&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDescription</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>null</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDescription</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#8f5902;font-style:italic>//부서설명 프로퍼티는 값의 길이가 10 이상인가?
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>rejectValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;lengthsize&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[]{</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>},</span> <span style=color:#4e9a06>&#34;description&#39;s length must be larger than 10.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>		
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>	
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>isEmptyOrWhitespace</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>null</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>trim</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>위 코드에서 처럼 유효성 검증이 실패한 경우 Errors 인터페이스의 rejectValue 메소드를 실행하는데, Errors 인터페이스에 대한 자세한 설명은 <a href=https://docs.spring.io/spring-framework/docs/2.5.x/javadoc-api/org/springframework/validation/Errors.html>여기</a>를 참고하라.</p><p><strong>errors.rejectValue(“deptname”, “required”);</strong></p><ul><li>deptname 프로퍼티에 대해서 유효성 검증시 에러가 발생했고, 관련 메시지 key는 “required”란 의미이다.</li></ul><p><strong>errors.rejectValue(“description”, “lengthsize”, new Object[]{10}, “description&rsquo;s length must be larger than 10.”);</strong></p><ul><li>description 프로퍼티에 대해서 유효성 검증시 에러가 발생했고, 관련 메시지 key는 “lengthsize” 이며 메시지에 전달될 argument는 10이며,
해당 메시지 key가 존재 하지 않으면 “description&rsquo;s length must be larger than 10.”란 메시지를 사용한다는 의미이다.</li></ul><p>스프링에서는 유효성 검증을 위한 ValidationUtils라는 유틸 클래스를 제공한다.
부서 이름 프로퍼티(deptname) 값이 null또는 white space인지 체크하는 부분은 ValidationUtils의 rejectIfEmptyOrWhitespace 메소드를 사용해서 작성할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.validator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.validation.Errors</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.validation.Validator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.validation.ValidationUtils</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>com.easycompany.domain.Department</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DepartmentValidator</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>Validator</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>supports</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Class</span> <span style=color:#000>clazz</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>Department</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isAssignableFrom</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>clazz</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>validate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>target</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Errors</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Department</span> <span style=color:#000>department</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Department</span><span style=color:#ce5c00;font-weight:700>)</span><span style=color:#000>target</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>ValidationUtils</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>rejectIfEmptyOrWhitespace</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;deptname&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;required&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDescription</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>null</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDescription</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>()&lt;</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#8f5902;font-style:italic>//부서설명 프로퍼티는 입력값의 길이가 10 이상인가?
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>rejectValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;lengthsize&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[]{</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>},</span> <span style=color:#4e9a06>&#34;description&#39;s length must be larger than 10.&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>		
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=에러-메시지-설정>에러 메시지 설정</h3><p>message 프로퍼티 파일에서 메시지 key인 “required”, “lengthsize”에 대한 메시지 설정을 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#c4a000>required</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>필수 입력값입니다.</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>lengthsize</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>{0}자 이상 입력해야 합니다.</span>
</span></span></code></pre></div><h3 id=controller에서-validation>Controller에서 validation</h3><p>Controller에서 validation을 수행하는 코드를 적용해 보자.
폼을 전송하는 순간에 유효성 검증을 하기 원한다면,
com.easycompany.controller.annotation.UpdateDepartmentController 에서 onSubmit 메소드에 validation 코드를 추가한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.annotation</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.validation.BindingResult</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>com.easycompany.validator.DepartmentValidator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>UpdateDepartmentController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//사용자가 데이터 수정을 끝내고 저장 버튼을 누르면 수정 데이터로 저장을 담당하는 서비스(DB)를 호출한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#8f5902;font-style:italic>//저장이 성공하면 부서리스트 페이지로 이동하고 에러가 있으면 다시 입력폼페이지로 이동한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateDepartment.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>onSubmit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;department&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>Department</span> <span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindingResult</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//validation code
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>DepartmentValidator</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>validate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//validation을 수행한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasErrors</span><span style=color:#ce5c00;font-weight:700>()){</span> <span style=color:#8f5902;font-style:italic>//validation 에러가 있으면,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>  <span style=color:#8f5902;font-style:italic>//이 페이지로 이동.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updateDepartment</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>department</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;redirect:/departmentList.do?depth=1&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifydepartment&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=jsp>JSP</h3><p>손쉬운 에러 메시지 표기를 위해 Spring 폼태그 <code>&lt;form:errors/></code>를 사용할 것을 권장한다.
/easycompany/webapp/jsp/annotation/modifydepartment.jsp</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ taglib prefix=&#34;form&#34; uri=&#34;http://www.springframework.org/tags/form&#34; %&gt;
...
&lt;form:form commandName=&#34;department&#34;&gt;
&lt;table&gt;
...
	&lt;tr&gt;
		&lt;th&gt;부서이름&lt;/th&gt;
		&lt;td&gt;&lt;form:input path=&#34;deptname&#34; size=&#34;20&#34;/&gt;&lt;form:errors path=&#34;deptname&#34; /&gt;&lt;/td&gt;
	&lt;/tr&gt;
...
	&lt;tr&gt;
		&lt;th&gt;설명&lt;/th&gt;
		&lt;td&gt;&lt;form:textarea path=&#34;description&#34; rows=&#34;10&#34; cols=&#34;40&#34;/&gt;&lt;form:errors path=&#34;description&#34; /&gt;&lt;/td&gt;
	&lt;/tr&gt;	
&lt;/table&gt;
&lt;/form:form&gt;
...
</code></pre><h3 id=test>TEST</h3><p>부서 이름값을 비우고, 부서설명 부분에 10자 이하로 입력한 후에 저장 버튼을 누르면, 다시 부서정보수정 페이지로 돌아와서 아래와 같이 에러 메시지가 출력될 것이다.</p><p><img src=../images/web-servlet-validation.png alt=web-servlet-validation></p><h2 id=참고자료>참고자료</h2><ul><li>Spring Framework API Documentation 2.5.6</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-e3291d7d5b4efb88c0537abb957414ce>9 - Bean Validation (JSR-303)</h1><div class=lead>JSR-303(Bean Validation) 스펙은 @Valid 애노테이션을 사용해 모델 객체 필드의 자동 검증을 지원한다. 이를 통해 표준화된 방식으로 애노테이션을 활용한 필드 검증이 가능하다.</div><h1 id=bean-validation-jsr-303>Bean Validation (JSR-303)</h1><h2 id=개요>개요</h2><p><a href=web-servlet-validation.md>화면처리: validation</a>을 통해 검증방법을 알아보았다. 이전과는 다르게 JSR-303(Bean Validation) 스펙은 자동 검증 방식을 제공한다. @javax.validation.Valid애노테이션을 사용하여 내부적으로(자동으로) 검증이 수행된다.</p><p>또한, 최근에 표준 스펙으로 인증받은 JSR-303 빈 검증방식을 이용하여 모델 오브젝트 필드에서 애노테이션을 이용해 검증을 진행할 수 있다.</p><h2 id=설명>설명</h2><h3 id=valid를-이용한-자동검증>@Valid를 이용한 자동검증</h3><p>기존의 검증 방식을 자동 검증 방식으로 변경하였으며, 방법은 컨트롤러 메소드의 <code>@ModelAttribute</code> 파라미터에 <code>@Valid</code> 애노테이션을 추가한다. 그러면 <code>validate()</code> 메소드를 실행하는 대신 바인딩 과정에서 자동으로 검증이 진행된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>ExampleController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Autowired</span> <span style=color:#000>ExampleValidator</span> <span style=color:#000>validator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@InitBinder</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>initBinder</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebDataBinder</span> <span style=color:#000>dataBinder</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#000>dataBinder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setValidator</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>validator</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/insertMember.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>insertMember</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;memberVO&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#5c35cc;font-weight:700>@Valid</span> <span style=color:#000>MemberVO</span> <span style=color:#000>memberVO</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindingResult</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>..)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//..
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=jsr-303-빈-검증bean-validation-기능>JSR-303 빈 검증(bean validation) 기능</h3><p>위의 방식은 기존의 검증방식을 자동 검증으로 변경한 방법이며 다음에 설명한 검증방법은 제약조건을 빈에 직접 설정하여 검증하는 방식이다.</p><p>먼저, 클래스패스에 의존 라이브러리를 추가해야 한다. 메이븐을 사용 중이라면 다음 의존 라이브러리를 프로젝트에 추가한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>javax.validation<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>validation-api<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;version&gt;</span>1.0.0.GA<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.hibernate<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>hibernate-validator<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;version&gt;</span>4.0.0.GA<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>다음은 JSR-303 제약조건 애노테이션이 적용된 모델오브젝트 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>MemberVO</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@NotNull</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Size</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;이름을 입력하세요.&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Pattern</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>regexp</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;.+@.+\\.[a-z]+&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;이메일 형식이 잘못되었습니다.&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>email</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//..
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p><code>@NotNull</code>은 빈문자열을 검증하지 못하기 때문에 <code>@Size(min=1)</code>을 사용하여 빈 문자열을 확인해야 한다.</p><p>위와같은 제약조건 애노테이션을 사용해 검증을 수행하기 위해서는 LocalValidatiorFactoryBean을 빈으로 등록해 줘야 한다. LocalValidatiorFactoryBean은 JSR-303의 검증기능을 스프링의 Validator처럼 사용할 수 있게 해주는 일종의 어댑터다. LocalValidatiorFactoryBean을 빈으로 등록하면 컨트롤러에서 Validator타입으로 DI 받아서 @InitBinder에서 WebDataBinder에 설정하거나 코드에서 직접 Validator처럼 사용할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;validator&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.validation.beanvalidation.LocalValidatorFactoryBean&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>빈 검증 기능을 validator로 사용하는 컨트롤러 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>ExampleController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Resource</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Validator</span> <span style=color:#000>validator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@InitBinder</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>initBinder</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebDataBinder</span> <span style=color:#000>dataBinder</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#000>dataBinder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setValidator</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>validator</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/insertMember.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>insertMember</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;memberVO&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#5c35cc;font-weight:700>@Valid</span> <span style=color:#000>MemberVO</span> <span style=color:#000>memberVO</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindingResult</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>..)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//..
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p><img src=../images/web-servlet-declarative-validation.png alt=web-servlet-declarative-validation></p><h2 id=참고자료>참고자료</h2><ul><li><a href="https://www.egovframe.go.kr/wiki/doku.php?id=egovframework:rte3.10:rex:validation_%EC%98%88%EC%A0%9C">Validator 예제</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-d376ca86ffb3d14bd557c43cd7ad20c7>10 - View</h1><div class=lead>Controller는 요청을 처리한 후 View 이름과 데이터를 ModelAndView에 저장해 DispatcherServlet에 반환하고, DispatcherServlet은 ViewResolver를 통해 실제 View 객체를 얻는다. 이 View는 Model 객체의 정보를 출력하며, 스프링은 JSP에서 편리한 데이터 출력을 위해 Spring form tag library를 제공한다.</div><h1 id=view>View</h1><h2 id=개요>개요</h2><p>Controller가 요청에 대한 처리를 하고, View 이름과 데이터(Model)를 ModelAndView에 저장해 DispatcherServlet에 반환(return)하면,
DispatcherServlet은 View 이름을 가지고 ViewResolver에게서 실제 View 객체를 얻고, 이 View는 Controller가 저장한 Model 객체의 정보를 출력한다.
여기서는 View와 ViewResolver, 그리고 JSP에서 편리한 데이터 출력을 위해 스프링이 제공하는 Spring form tag library에 대해서 설명한다.</p><ul><li><a href=#view>View</a><ul><li><a href=#%EA%B0%9C%EC%9A%94>개요</a></li><li><a href=#%EC%84%A4%EB%AA%85>설명</a><ul><li><a href=#viewresolver>ViewResolver</a><ul><li><a href=#internalresourceviewresolverurlbasedviewresolver>InternalResourceViewResolver/UrlBasedViewResolver</a></li></ul></li><li><a href=#view-1>View</a></li><li><a href=#spring-tag-library>Spring Tag Library</a><ul><li><a href=#meassage-tagspringmessage>meassage tag(<code>&lt;spring:message></code>)</a></li><li><a href=#form-tagformformforminput>form tag(<code>&lt;form:form>,&lt;form:input>,...</code>)</a></li></ul></li><li><a href=#%EC%A0%84%EC%9E%90%EC%A0%95%EB%B6%80%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-tag-library>전자정부프레임워크 Tag Library</a></li></ul></li><li><a href=#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C>참고자료</a></li></ul></li></ul><h2 id=설명>설명</h2><h3 id=viewresolver>ViewResolver</h3><p>Controller는 코드내에서 실제 View 객체를 생성하지 않고 View 이름만을 결정할 수 있는데, 이로써 Controller와 View의 분리(decoupling)를 가능하게 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.hierarchy</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EmployeeListController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractCommandController</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>handle</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span> <span style=color:#000>command</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>BindException</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>		<span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Employee</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>employeelist</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>employeeService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAllEmployees</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>commandMap</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>ModelAndView</span> <span style=color:#000>modelview</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;employeelist&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>employeelist</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//직접 View 객체를 생성하지 않고,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#8f5902;font-style:italic>//View view = new InternalResourceView(&#34;/jsp/employeelist.jsp&#34;); 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#8f5902;font-style:italic>//modelview.setView(view);
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#8f5902;font-style:italic>//View 이름만을 저장.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setViewName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;employeelist&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>modelview</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>이때, DispatcherServlet에 실제 View 객체를 구해주는건 Controller가 아니라 ViewResolver가 담당한다.
ViewResolver는 Controller가 반환한 ModelAndView 객체에 담긴 View 이름을 가지고 실제 View 객체를 반환하는 인터페이스이다.
Spring에서 제공하는 ViewResolver 구현 클래스는 아래와 같다.</p><table><thead><tr><th>ViewResolver</th><th>설명</th></tr></thead><tbody><tr><td>XmlViewResolver</td><td>View이름과 View 클래스간의 매핑정보가 담긴 XML로 부터 View이름에 해당하는 View를 구한다.<br>기본설정 파일은 /WEB-INF/views.xml이다.</td></tr><tr><td>ResourceBundleViewResolver</td><td>View이름과 View 클래스간의 매핑정보가 담긴 리소스 번들(프로퍼티파일)로 부터 View 이름에 해당하는 View를 구한다.<br>기본설정 파일은 views.properties이다.</td></tr><tr><td>InternalResourceViewResolver/UrlBasedViewResolver</td><td>특정 디렉토리 경로의 JSP파일들을 호출할 때 편리하게 사용할수 있다.<br>기본적으로 사용하는 View 클래스는 InternalResourceView이며, View 이름이 곧 JSP 파일이름이 된다.</td></tr><tr><td>VelocityViewResolver /FreeMarkerViewResolver</td><td>Velocity/FreeMarker 연동시에 사용한다.</td></tr></tbody></table><h4 id=internalresourceviewresolverurlbasedviewresolver>InternalResourceViewResolver/UrlBasedViewResolver</h4><p>비지니스 로직 처리가 끝난 후 ”/jsp/main/abc.jsp” 경로의 JSP 파일로 forwarding하는 Controller가 있다고 하면, InternalResourceViewResolver/UrlBasedViewResolver를 사용해서 아래와 같이 Controller를 작성하고, 빈 정의 파일에 설정할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.InternalResourceViewResolver&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>또는</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.UrlBasedViewResolver &#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>hello</span><span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#8f5902;font-style:italic>//비지니스 로직 처리.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;/jsp/main/abc.jsp&#34;</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#8f5902;font-style:italic>//뷰이름이 곧 JSP 파일의 경로.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#ce5c00;font-weight:700>}</span>	
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>InternalResourceViewResolver/UrlBasedViewResolver의 프로퍼티 prefix, suffix를 사용하면 좀더 간단하게 처리할수 있는데,
JSP가 특정 디렉토리 경로 아래에 있고, 예를 들어 /jsp/main 디렉토리 아래, 확장자는 .jsp 이라면,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.InternalResourceViewResolver&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:prefix=</span><span style=color:#4e9a06>&#34;/jsp/main/&#34;</span> <span style=color:#c4a000>p:suffix=</span><span style=color:#4e9a06>&#34;.jsp&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>또는</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.UrlBasedViewResolver&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:prefix=</span><span style=color:#4e9a06>&#34;/jsp/main/&#34;</span> <span style=color:#c4a000>p:suffix=</span><span style=color:#4e9a06>&#34;.jsp&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>hello</span><span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;abc&#34;</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#8f5902;font-style:italic>//prefix와 suffix를 제외한 부분만 표기.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#ce5c00;font-weight:700>}</span>	
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>간단히 뷰이름을 설정할 수 있다.</p><h3 id=view-1>View</h3><p>Spring이 제공하는 View 클래스를 사용할 수도 있지만, UI Tool 등과의 연동등으로 인해 View 클래스를 직접 작성해야 하는 경우도 발생한다.
인터페이스 View를 직접 구현해서 View 클래스를 만들수도 있지만, AbstractView를 확장하여 구현해보자.
renderMergedOutputModel 메소드를 구현하면 되는데, 아래와 같은 메소드 시그니쳐를 가지고 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>abstract</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>renderMergedOutputModel</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>                                                <span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>                                                <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span>
</span></span></code></pre></div><p>AjaxTags란 Ajax 관련 오픈소스 사용을 위해 Model 객체의 데이터를 &rsquo;text/xml&rsquo; 형식으로 렌더링하는 View 클래스를 만들어 봤다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.view</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>java.io.PrintWriter</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>java.util.Map</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>javax.servlet.http.HttpServletRequest</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>javax.servlet.http.HttpServletResponse</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.web.servlet.view.AbstractView</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>AjaxXmlView</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractView</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>renderMergedOutputModel</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setContentType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;text/xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHeader</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Cache-Control&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;no-cache&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCharacterEncoding</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>PrintWriter</span> <span style=color:#000>writer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getWriter</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>writer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>write</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;ajaxXml&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>		<span style=color:#000>writer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=spring-tag-library>Spring Tag Library</h3><h4 id=meassage-tagspringmessage>meassage tag(<code>&lt;spring:message></code>)</h4><p>스프링은 메시지 리소스 파일로 부터 메시지를 가져와 간편하게 출력할수 있도록, <code>&lt;spring:message></code> 태그를 제공한다.
JSP 페이지의 타이틀을 <code>&lt;spring:message></code>를 이용해서 출력하는 예제를 만들어 보자.
빈 정의 파일에 리소스 번들 관련된 설정이 되어 있어야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Message Source--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;messageSource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.context.support.ResourceBundleMessageSource&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#c4a000>p:basename=</span><span style=color:#4e9a06>&#34;messages&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>먼저 메시지 관련 리소스 파일에 코드값을 설정해준다. PropertiedEditor 같은 유틸의 도움을 받으면 편리하게 한글 입력-편집이 가능하다.</p><p>/easycompany/webapp/WEB-INF/classes/messages_ko.properties</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#a40000>...</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># -- spring:message --</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>easaycompany.loginform.title</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>로그인페이지</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>easaycompany.employeelist.title</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>사원 정보 리스트 페이지</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>easaycompany.updateemployee.title</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>사원 정보 수정 페이지</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>easaycompany.insertemployee.title</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>사원 정보 입력 페이지</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>easaycompany.departmentlist.title</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>부서 정보 리스트 페이지</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>easaycompany.updatedepartment.title</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>부서 정보 수정 페이지</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>easaycompany.insertdepartment.title</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>부서 정보 입력 페이지</span>
</span></span></code></pre></div><p>JSP 페이지에 커스텀 태그를 사용하기 위해 라이브러리 선언을 해줘야 한다. 그리고 <code>&lt;spring:message></code> 태그의 code 값에는 메시지 키값을 주면 된다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>...
&lt;%@ taglib prefix=&#34;spring&#34; uri=&#34;http://www.springframework.org/tags&#34; %&gt;
&lt;html xmlns=&#34;http://www.w3.org/1999/xhtml&#34;&gt;
&lt;head&gt;
&lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=utf-8&#34; /&gt;
&lt;title&gt;&lt;spring:message code=&#34;easaycompany.departmentlist.title&#34;/&gt;&lt;/title&gt;
...
</code></pre><p>해당 화면의 타이틀이 “부서 정보 리스트 페이지”로 표기 될 것이다.</p><h4 id=form-tagformformforminput>form tag(<code>&lt;form:form>,&lt;form:input>,...</code>)</h4><p>폼 관련 어플리케이션을 개발할 때는 스프링이 제공하는 폼 태그와 같이 사용하면 편리하다.
스프링 폼 태그는 Model 데이터의 커맨드 객체(command object)나 참조 데이터(reference data)들을 화면상에서 쉽게 출력하도록 도와 준다.
일단, 스프링 폼 태그를 사용하려면 페이지에 커스텀 태그 라이브러리를 선언해야 한다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ taglib prefix=&#34;form&#34; uri=&#34;http://www.springframework.org/tags/form&#34; %&gt;
</code></pre><p>스프링 폼 태그에는 아래와 같은 태그들이 있다.</p><p><em><strong><a href=form:form>form:form</a></strong></em></p><p><code>&lt;form:form></code>는 속성 commandName에 정의된 model attribute를 PageContext에 저장해서, <code>&lt;form:input></code>이나 <code>&lt;form:hidden></code>같은 tag들이 접근할 수 있도록 한다.
관련 속성은 아래와 같다.</p><ul><li>commandName<ul><li>참조하려는 model attribute 이름</li></ul></li><li>action<ul><li>폼 전송할 URL</li></ul></li><li>method<ul><li>폼 전송시에 HTTP 메소드(GET, POST)</li></ul></li><li>enctype<ul><li>폼 전송시에 데이터 인코딩 타입</li></ul></li></ul><p><code>&lt;form:form></code> 태그를 사용하고 출력된 페이지에서 소스 보기로 HTML 코드를 열어보면 아래와 같이 HTML FORM 태그가 출력된걸 확인할 수 있을것이다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;form:form commandName=&#34;department&#34; action=&#34;http://myUrl...&#34; method=&#34;post&#34;&gt; -&gt; &lt;form id=&#34;department&#34; action=&#34;http://myUrl...&#34; method=&#34;post&#34;&gt;
 
&lt;form:form commandName=&#34;department&#34;&gt; -&gt; &lt;form id=&#34;department&#34; action=&#34;현재페이지 URL&#34; method=&#34;post&#34;&gt;
</code></pre><p><em><strong><a href=form:input>form:input</a></strong></em></p><p>HTML text타입의 input 태그에 commandName에 지정된 객체 프로퍼티를 바인딩하기 위해 사용한다.
path에 프로퍼티 이름을 적으면, text타입의 input 태그의 id, name 값이 프로퍼티 이름이 되고, value는 해당 프로퍼티의 값이 된다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;form:form commandName=&#34;department&#34;&gt;
	&lt;tr&gt;
		&lt;th&gt;부서이름&lt;/th&gt;
		&lt;td&gt;&lt;form:input path=&#34;deptname&#34; size=&#34;20&#34;/&gt;&lt;/td&gt;
	&lt;/tr&gt;
&lt;/form:form&gt;
</code></pre><p>아래와 같이 HTML로 출력된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;department&#34;</span> <span style=color:#c4a000>action</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/easycompany/updateDepartment.do?deptid=1100&#34;</span> <span style=color:#c4a000>method</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;post&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>부서이름<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;deptname&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;deptname&#34;</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;회식메뉴혁신팀&#34;</span> <span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#000;font-weight:700>/&gt;&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>form</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p><em><strong><a href=form:password>form:password</a></strong></em></p><p>HTML password타입의 input 태그에 commandName에 지정된 객체 프로퍼티를 바인딩하기 위해 사용한다.
바인딩값을 표기하기 위해서는 showPassword 속성을 showPassword=“true”로 지정해 주어야 한다.</p><p><em><strong><a href=form:hidden>form:hidden</a></strong></em></p><p>HTML hidden타입의 input 태그에 commandName에 지정된 객체 프로퍼티를 바인딩하기 위해 사용한다.</p><p><em><strong><a href=form:select>form:select</a>, <a href=form:options>form:options</a>, <a href=form:option>form:option</a></strong></em></p><p>HTML select, option 태그에 commandName에 지정된 객체 프로퍼티를 바인딩하기 위해 사용한다.
아래와 같이 <code>&lt;form:select></code>의 path 속성에 commandName 객체의 프로퍼티를 지정하고,
<code>&lt;form:options></code>의 items 속성에 List, Map등의 Collection 객체를 값으로 주면,</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;form:form commandName=&#34;department&#34;&gt;
	&lt;tr&gt;
		&lt;th&gt;상위부서&lt;/th&gt;
		&lt;td&gt;
			&lt;form:select path=&#34;superdeptid&#34;&gt;
				&lt;option value=&#34;&#34;&gt;상위부서를 선택하세요.&lt;/option&gt;
				&lt;form:options items=&#34;${deptInfoOneDepthCategory}&#34; /&gt;
			&lt;/form:select&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
&lt;/form:form&gt;
</code></pre><p>아래와 같이 HTML로 출력된다. <code>&lt;form:select></code>의 path 속성값과 일치하는 option 값이 있으면 <code>selected=“selected”</code> 된다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;form id=&#34;department&#34; action=&#34;/easycompany/updateDepartment.do?deptid=1100&#34; method=&#34;post&#34;&gt;
	&lt;tr&gt;
		&lt;th&gt;상위부서&lt;/th&gt;
		&lt;td&gt;
			&lt;select id=&#34;superdeptid&#34; name=&#34;superdeptid&#34;&gt;
				&lt;option value=&#34;&#34;&gt;상위부서를 선택하세요.&lt;/option&gt;
				&lt;option value=&#34;5000&#34;&gt;금융사업부&lt;/option&gt;
                                &lt;option value=&#34;3000&#34;&gt;IT연구소&lt;/option&gt;
                                &lt;option value=&#34;4000&#34;&gt;공공사업부&lt;/option&gt;
                                &lt;option value=&#34;1000&#34; selected=&#34;selected&#34;&gt;경영기획실&lt;/option&gt;
                                &lt;option value=&#34;2000&#34;&gt;경영지원실&lt;/option&gt;
			&lt;/select&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
&lt;/form&gt;
</code></pre><p><em><strong><a href=form:checkboxes>form:checkboxes</a></strong></em></p><p><em><strong><a href=form:checkbox>form:checkbox</a></strong></em></p><p><em><strong><a href=form:errors>form:errors</a></strong></em></p><h3 id=전자정부프레임워크-tag-library>전자정부프레임워크 Tag Library</h3><p><strong><code>&lt;ui:pagination/></code></strong></p><p>페이징 처리의 편의를 위해 <code>&lt;ui:pagination/></code> 태그를 제공한다.
<code>&lt;ui:pagination/></code>의 주요 속성은 아래와 같다.</p><table><thead><tr><th>이름</th><th>설명</th><th>필수여부</th></tr></thead><tbody><tr><td>paginationInfo</td><td>페이징리스트를 만들기 위해 필요한 데이터. 데이터 타입은 egovframework.rte.ptl.mvc.tags.ui.pagination.PaginationInfo이다.</td><td>yes</td></tr><tr><td>type</td><td>페이징리스트 렌더링을 담당할 클래스의 아이디. 이 아이디는 빈설정 파일에 선언된 프로퍼티 rendererType의 key값이다.</td><td>yes</td></tr><tr><td>jsFunction</td><td>페이지 번호에 걸리게 될 자바스크립트 함수 이름. 페이지 번호가 기본적인 argument로 전달된다.</td><td>yes</td></tr></tbody></table><p>ui 태그에 대한 라이브러리 선언을 해주고 페이징 리스트가 위치할 곳에 아래와 같이 사용하면 된다.
paginationInfo 속성에는 Controller에서 Model 객체에 저장한 PaginationInfo의 attribute name을 적어 주면 되고,
jsFunction 속성은 페이징 리스트의 각 페이지 번호에 걸릴 링크인 자바스크립트 함수명을 적어 주면 된다.
type 속성은 빈 설정시에 rendererType 프로퍼티의 entry key값을 적어준다. 렌더링 타입을 태그에서 결정하는 것이다.</p><p><strong>1. 관련 클래스 빈 설정한다.</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- For Pagination Tag --&gt;</span>	 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;imageRenderer&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;com.easycompany.tag.ImagePaginationRenderer&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;textRenderer&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.ptl.mvc.tags.ui.pagination.DefaultPaginationRenderer&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;paginationManager&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.ptl.mvc.tags.ui.pagination.DefaultPaginationManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;rendererType&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;map&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;entry</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;image&#34;</span> <span style=color:#c4a000>value-ref=</span><span style=color:#4e9a06>&#34;imageRenderer&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;entry</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;text&#34;</span> <span style=color:#c4a000>value-ref=</span><span style=color:#4e9a06>&#34;textRenderer&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/map&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p><strong>2. JSP에서 라이브러리를 선언한 후 사용한다.</strong></p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ taglib prefix=&#34;ui&#34; uri=&#34;http://egovframework.gov/ctl/ui&#34;%&gt;
...
&lt;script type=&#34;text/javascript&#34;&gt;
	function linkPage(pageNo){
		location.href = &#34;/easycompany/employeeList.do?pageNo=&#34;+pageNo;
	}	
&lt;/script&gt;
&lt;body&gt;
...
		&lt;ui:pagination paginationInfo = &#34;${paginationInfo}&#34;
			type=&#34;image&#34;
			jsFunction=&#34;linkPage&#34;/&gt;
...
&lt;/body&gt;
</code></pre><p><code>&lt;ui:pagination/></code>에 대한 좀더 상세한 설명과 사용법, 확장 방법등은 <a href="https://www.egovframe.go.kr/wiki/doku.php?id=egovframework:rte:ptl:view:paginationtag">이곳</a>을 참고</p><h2 id=참고자료>참고자료</h2><ul><li>The Spring Framework - Reference Documentation 2.5.6</li><li>Spring Framework API Documentation 2.5.6</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-769189172b147f11b368571eb0e70527>11 - Map 객체를 통한 입력값 처리 방법</h1><div class=lead>전자정부프레임워크 3.0 이전에는 CommandMapArgumentResolver를 통해 Map 객체를 사용했으나, 3.0부터는 @CommandMap과 AnnotationCommandMapArgumentResolver로 이를 처리한다. 이 클래스는 HTTP 요청의 파라미터 이름과 값을 Map에 담아 Controller에서 사용할 수 있도록 지원한다.</div><h1 id=annotationcommandmapargumentresolver>AnnotationCommandmapArgumentResolver</h1><h2 id=개요>개요</h2><p>Controller에서 화면(JSP) 입력값을 받기 위해서 일반적으로 Command(Form Class) 객체를 사용하지만, Map 객체를 사용하는걸 선호할 수 있다.
전자정부프레임워크 버전 3.0이전에서는 CommandMapArgumentResolver를 통해 Map객체를 사용할 수 있었다. 그러나 3.0부터는 @CommandMap과 AnnotationCommandmapArgumentResolver를 통해 Map객체를 사용할 수 있다.
org.springframework.web.method.support.HandlerMethodArgumentResolver의 구현클래스인 AnnotationCommandMapArgumentResolver은 HTTP request 객체에 있는 파라미터이름과 값을 Map 객체에 담아 Controller에서 사용도록 제공한다.</p><h2 id=설명>설명</h2><h3 id=handlermethodargumentresolver>HandlerMethodArgumentResolver</h3><p>Sping MVC의 <code>@Controller</code>의 메소드의 argument로 사용할 수 있는 유형(이에 관한 정보는 이곳을 참조하라.)은 기존의 계층형 Controller보다 다양해 졌지만,
필요에 따라 기본 유형외의 custom argument를 사용해야 할때가 있을 것이다.
Sping MVC는 Controller의 argument 유형을 customizing 할 수 있는 HandlerMethodArgumentResolver라는 interface를 제공한다.
기존 Spring web 3.1이전 버전에서는 WebArgumentResolver를 구현하여 AnnotationMethodHandlerAdapter에 등록하여 ArgumentResolver를 적용하였으나,
3.1이후부터는 HandlerMethodArgumentResolver를 구현하여 RequestMappingHandlerAdapter에 등록하여 ArgumentResolver를 적용해야 한다.</p><p>아래와 같이 Controller의 메소드에서 MySpecialArg라는 custom argument를 argument로 사용하려 한다면,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>hello</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MySpecialArg</span> <span style=color:#000>mySpecialArg</span><span style=color:#ce5c00;font-weight:700>,...)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>인터페이스 HandlerMethodArgumentResolver를 구현한 클래스를 만든다. 구현해야 할 메소드는 아래와 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>supportsParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MethodParameter</span> <span style=color:#000>parameter</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>Object</span> <span style=color:#000>resolveArgument</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MethodParameter</span> <span style=color:#000>parameter</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>ModelAndViewContainer</span> <span style=color:#000>mavContainer</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>NativeWebRequest</span> <span style=color:#000>webRequest</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>WebDataBinderFactory</span> <span style=color:#000>binderFactory</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>MySpecialArgumentResolver</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>HandlerMethodArgumentResolver</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>supportsParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MethodParameter</span> <span style=color:#000>parameter</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MySpecialArg</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isAssignableFrom</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>parameter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameterType</span><span style=color:#ce5c00;font-weight:700>()))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Object</span> <span style=color:#000>resolveArgument</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MethodParameter</span> <span style=color:#000>parameter</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>ModelAndViewContainer</span> <span style=color:#000>mavContainer</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>NativeWebRequest</span> <span style=color:#000>webRequest</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>WebDataBinderFactory</span> <span style=color:#000>binderFactory</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MySpecialArg</span><span style=color:#ce5c00;font-weight:700>();</span>		
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>만들어진 ArgumentResolver클래스는 RequestMappingHandlerAdapter의 customArgumentResolvers 프로퍼티에 등록하도록 한다. list유형 프로퍼티이므로 여러개의 ArgumentResolver클래스를 등록할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;customArgumentResolvers&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;... MySpecialArgumentResolver&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h3 id=annotationcommandmapargumentresolver-1>AnnotationCommandMapArgumentResolver</h3><p>HTTP request 객체에 있는 파라미터이름과 값을 특정 폼 빈에 담아서 사용하는 방식이 일반적이지만, Map 객체에 담아서 사용하는걸 선호하는 경우도 있다.
Controller에서 Map객체를 쓰기 위해 전자정부 프레임워크 3.0부터는 @CommandMap과 AnnotationCommandMapArgumentResolver를 쓰도록 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>helloPost</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@CommandMap</span> <span style=color:#000>Map</span> <span style=color:#000>commandMap</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ModelMap</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>Map commandMap에 파라미터의 이름과 값이 들어 있게 하려면 위에서 언급한 AnnotationCommandMapArgumentResolver를 이용해야 한다.
HandlerMethodArgumentResolver의 구현 클래스인 AnnotationCommandMapArgumentResolver는
Controller 메소드의 argument중에 @CommandMap이 붙은 Map 객체가 있다면, HTTP request 객체에 있는 파라미터이름과 값을 Map객체에 담는다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>egovframework.rte.ptl.mvc.bind</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>AnnotationCommandMapArgumentResolver</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>HandlerMethodArgumentResolver</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>supportsParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MethodParameter</span> <span style=color:#000>parameter</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isAssignableFrom</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>parameter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameterType</span><span style=color:#ce5c00;font-weight:700>())</span> 
</span></span><span style=display:flex><span>				<span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#000>parameter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasParameterAnnotation</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>CommandMap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Object</span> <span style=color:#000>resolveArgument</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MethodParameter</span> <span style=color:#000>parameter</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>ModelAndViewContainer</span> <span style=color:#000>mavContainer</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>NativeWebRequest</span> <span style=color:#000>webRequest</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>WebDataBinderFactory</span> <span style=color:#000>binderFactory</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>commandMap</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>webRequest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNativeRequest</span><span style=color:#ce5c00;font-weight:700>();</span>			
</span></span><span style=display:flex><span>		<span style=color:#000>Enumeration</span><span style=color:#ce5c00;font-weight:700>&lt;?&gt;</span> <span style=color:#000>enumeration</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameterNames</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>while</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>enumeration</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasMoreElements</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>String</span> <span style=color:#000>key</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>enumeration</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>nextElement</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>values</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameterValues</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>values</span><span style=color:#ce5c00;font-weight:700>!=</span><span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>commandMap</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>values</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>?</span> <span style=color:#000>values</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>values</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>commandMap</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>AnnotationCommandMapArgumentResolver를 사용하려면 EgovRequestMappingHandlerAdapter에 등록해야 한다. 보통의 경우는 RequestMappingHandlerAdapter를 등록하여 사용하면 되지만, Controller에 Map객체를 쓰기 위해 AnnotationCommandMapArgumentResolver를 등록하려면 egov3.0부터 제공하는 EgovRequestMappingHandlerAdapter를 사용해야 한다.
만약 RequestMappingHAndlerAdapter를 이용하거나 <code>&lt;mvc:annotation-driven></code>을 사용할 경우에는 AnnotationCommandMapArgumentResolver를 사용할 수 없으므로 주의해야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.ptl.mvc.bind.annotation.EgovRequestMappingHandlerAdapter&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;customArgumentResolvers&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.ptl.mvc.bind.AnnotationCommandMapArgumentResolver&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>테스트를 위한 Form에 데이터를 아래와 같이 등록하고 폼을 제출했을때,</p><p><img src=../images/web-servlet-AnnotationCommandMapArgumentResolver.png alt=web-servlet-AnnotationCommandMapArgumentResolver></p><p><code>@CommandMap</code> Map 객체의 데이터는 key, value 형태로 아래와 같이 들어 있다. 같은 파라미터 이름으로 여러값이 들어 있는 값은 배열로 들어 있다.</p><pre tabindex=0><code>key:text1   value:{aaa,bbb}
key:text2   value:ccc
key:text3   value:ddd
key:cb   value:{on,on}
key:rb2   value:on
key:rb1   value:on
</code></pre><h2 id=참고자료>참고자료</h2><ul><li><a href=http://docs.spring.io/spring/docs/3.2.x/spring-framework-reference/html/new-in-3.1.html#new-in-3.1-handler-method-controller-processing>new handler method controller processing</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-8b462a89cad5cb2cce2bcc7099517989>12 - 스프링 WebFlux와 기존 스프링 웹 프레임워크 비교</h1><div class=lead>스프링 WebFlux는 5.0 버전부터 추가된 리액티브 스택 웹 프레임워크로, 서블릿 API와는 달리 완전한 논블로킹 동작과 Reactive Streams back pressure를 지원한다. 기존의 스프링 웹 MVC와 함께 스프링 프레임워크에 포함되어 있으며, Netty, Undertow 등 다양한 서버에서 실행될 수 있다.</div><h1 id=web-reactive>Web Reactive</h1><h2 id=개요>개요</h2><p>스프링 프레임워크, 스프링 웹 MVC를 포함한 기존 웹 프레임워크는 서블릿 API와 서블릿 컨테이너를 위해 개발되었다. 스프링 WebFlux는 5.0 버전부터 추가된 리액티브 스택 웹 프레임워크로서, 서블릿 API와 서블릿 컨테이너를 개발하기 위한 스프링 프레임워크이다.
스프링 웹 MVC를 포함한 기존의 웹 프레임워크와 달리 완전한 논블로킹으로 동작하며 Reactive Streams back pressure를 지원하고 Netty, Undertow, 서블릿 3.1+ 컨테이너 서버에서 실행된다. 웹 프레임워크 모두 스프링 프레임워크에 포함되어 있으며, 원하는 모듈을 선택하여 개발할 수 있다.</p><h2 id=설명>설명</h2><h3 id=overview>Overview</h3><p>스프링 WebFlux가 탄생한 이유 중 하나는 적은 쓰레드로 동시 처리를 제어하고 적은 하드웨어 리소스로 확장하기 위해 논블로킹 웹 스택이 필요했기 때문이다. 이전에도 서블릿 3.1은 논블로킹 I/O를 위한 API를 제공했지만 서블릿으로 논블로킹을 구현하려면 다른 동기 처리나(Filter, Servlet) 블로킹 방식(getParameter, getPart)을 쓰는 API를 사용하기 어려우므로 어떤 논블로킹과도 잘 동작하는 새로운 공통 API를 만들게 됐다. 또한 이미 비동기 논블로킹 환경에서 자리를 잡은 서버(e.g. Netty) 때문에라도 새 API가 필요했다.</p><p>또 다른 이유는 함수형 프로그래밍으로 자바 8에서 추가된 람다 표현식으로 자바에서도 함수형 API를 작성할 수 있게 되어 continuation-style API로 비동기 로직을 선언적으로 작성할 수 있다.</p><h3 id=리액티브reactive-정의>리액티브(Reactive) 정의</h3><p>리액티브라는 용어는 변화에 반응하는 것을 중심에 두고 만든 프로그래밍 모델을 의미한다. 논블로킹은 작업을 기다리기보단 완료되거나 데이터를 사용할 수 있게 되면 반응하므로 논블로킹도 리액티브이다. 스프링은 리액티브와 관련한 중요한 메커니즘이 하나 더 있는데, 논블로킹 back pressure이다. 동기식 명령형 코드에서 블로킹 호출은 호출자가 대기하도록 하는 자연스러운 형태의 back pressure 역할을 한다. 논블로킹 코드에서는 프로듀서 속도가 컨슈머 속도롤 압도하지 않도록 이벤트 속도를 제어하는 것이 중요하다.</p><p>리액티브 스트림은 비동기 구성 요소 간의 상호 작용을 정의하는 간단한 사양(Java 9에서도 채택됨)으로, back pressure가 있는 비동기 구성 요소 간의 상호 작용을 정의한다. 예를 들어 데이터 저장소(Publisher 역할)가 데이터를 생성하면 HTTP 서버(Subscriber 역할)가 이 데이터로 요청을 처리할 수 있다. 리액티브 스트림의 주요 목적은 Subscriber가 Publisher의 데이터 생성 속도를 제어할 수 있도록 하는 것이다.</p><pre tabindex=0><code>자주 묻는 질문 : Publisher 속도를 늦출 수 없으면 어떻게 할까?
리액티브 스트림의 목적은 메커니즘과 경계를 확립하는 것이다. Publisher가 속도를 늦출 수 없다면 데이터를 버퍼에 담을지(Buffer), 데이터를 삭제할지(Drop), 실패(Fail)로 처리할지를 결정해야 한다.
</code></pre><h3 id=리액티브-api>리액티브 API</h3><p>리액티브 스트림은 상호 운용성을 위해 중요한 역할을 한다. 하지만 이건 라이브러리와 인프라 구조에 사용되는 컴포넌트에는 유용하지만 애플리케이션 API에서 다루기엔 너무 저수준이다. 애플리케이션은 컬렉션 뿐만 아니라 비동기 로직을 구성하기 위해 더 높은 수준의 더 풍부하고 기능적인 API가 필요하다. 이는 Java 8 Stream API와 유사하며 이것이 바로 리액티브 라이브러리가 하는 역할이다.</p><p>Reactor는 스프링 WebFlux가를 위해 선택된 리액티브 라이브러리이다. 이 라이브러리는 0…1(Mono) 및 0…N(Flux)의 데이터 시퀀스에서 작업할 수 있는 Mono 및 Flux API 유형을 제공하며, ReactiveX의 연산자 어휘와 일치하는 풍부한 연산자 집합을 통해 작동한다. Reactor는 리액티브 스트림 라이브러리이므로 모든 연산자는 논블로킹 back pressure를 지원한다. Reactor는 서버 측 Java에 중점을 두고 스프링과 긴밀히 협력하여 개발되었다.</p><p>WebFlux는 핵심 종속성으로 Reactor를 필요로 하지만, 리액티브 스트림를 통해 다른 리액티브 라이브러리와 상호 운용할 수 있다. 일반적으로 WebFlux API는 일반 Publisher를 입력으로 받아 내부적으로 Reactor 유형에 맞게 조정하고 이를 사용한 후 Flux 또는 Mono를 출력으로 반환한다. 따라서 모든 Publisher를 입력으로 전달할 수 있고 출력에 연산을 적용할 수 있지만 다른 리액티브 라이브러리와 함께 사용하려면 출력을 조정해야 한다. 가능한 경우(예: 주석이 달린 컨트롤러) WebFlux는 RxJava나 다른 리액티브 라이브러리에 맞게 바꿔준다. 자세한 내용은 리액티브 라이브러리를 참조하라.</p><h3 id=programming-models>Programming Models</h3><p>스프링 웹 모듈에 있는 WebFlux는 여러 서버를 지원하기 위한 HTTP 추상화와 리액티브 스트림 어댑터, 코덱, Servlet APT에 상응하는 핵심 웹 핸들러 API 등 스프링 WebFlux의 기반이 되는 리액트브 기반이 포함되어 있다. 이러한 기분 위에서 스프링 WebFlux는 두 가지 프로그래밍 모델 중 하나를 선택할 수 있다.</p><ul><li>Annotated Controllers : 스프링 MVC와 일치하며 스프링 웹 모듈의 동일한 주석을 기반으로 한다. 스프링 MVC와 WebFlux 컨트롤러는 모두 리액티브(Reactor 및 RxJava) 반환 유형을 지원하므로 구분하기가 쉽지 않다. 한 가지 주목할 만한 차이점은 WebFlux가 리액티브 @RequestBody 인수도 지원한다는 것이다.</li><li>Functional Endpoints : 경량화된 람다 기반 함수형 프로그래밍 모델로 요청을 라우팅해주는 작은 라이브러리나 유틸리티 모음이라고 생각하면 된다. Annotated Controllsers와 다른 점은 애플리케이션이 처음부터 끝까지 요청 처리를 담당하고 어노테이션을 통해 의도를 선언한 후 다시 호출된다는 점이다.</li></ul><h3 id=applicability>Applicability</h3><p>스프링 MVC와 WebFlux 중 어떤 것을 적용할 것이냐는 이분법적 사고는 좋지 않다. 사실, 두 가지 모두 함께 작동하여 사용 가능한 옵션의 범위를 확장한다. 이 둘은 서로의 연속성과 일관성을 위해 설계되었으며, 나란히 사용할 수 있고, 각 측면의 피드백은 양쪽 모두에게 도움이 된다. 다음 다이어그램은 이 두 가지의 관계, 공통점, 그리고 각각 고유하게 지원하는 기능을 보여준다.</p><p>다음과 같은 구체적인 사항을 고려하는 것이 좋다.</p><p><img src=../images/spring-mvc-and-webflux-venn.png alt=image></p><ul><li>정상적으로 작동하는 스프링 MVC 애플리케이션이 있다면 변경할 필요가 없다. 명령형 프로그래밍은 코드를 작성하고, 이해하고, 디버깅하는 가장 쉬운 방법이다. 역사적으로 대부분의 라이브러리가 차단되어 있기 때문에 라이브러리 선택의 폭이 넓습니다.</li><li>이미 논블로킹 웹 스택을 찾고 있다면, 스프링 WebFlux는 이 분야의 다른 제품과 동일한 실행 모델 이점을 제공하며 서버(Netty, Tomcat, Jetty, Undertow 및 Servlet 3.1+ 컨테이너), 프로그래밍 모델(Annotated Controllers and Functional Endpoints), 반응형 라이브러리(Reactor, RxJava 또는 기타) 선택도 제공한다.</li><li>Java 8 람다 또는 Kotlin과 함께 사용하기 위한 가볍고 기능적인 웹 프레임워크에 관심이 있다면 스프링 WebFlux 함수형 웹 엔드포인트를 사용할 수 있다. 로직을 투명하게 제어할 수 있기 때문에 덜 복잡한 요구 사항을 가진 소규모 애플리케이션이나 마이크로서비스에도 좋은 선택이 될 수 있다.</li><li>마이크로서비스 아키텍처에서는 스프링 MVC 또는 스프링 WebFlux 컨트롤러를 사용하거나 스프링 WebFlux Functional Endpoints를 사용하는 애플리케이션을 혼합하여 사용할 수 있다. 두 프레임워크 모두에서 동일한 어노테이션 기반 프로그래밍 모델을 지원하므로 지식을 재사용하는 동시에 작업에 적합한 도구를 선택하기 쉽다.</li><li>애플리케이션을 평가하는 간단한 방법은 애플리케이션의 종속성을 확인하는 것이다. 블로킹 지속성 API(JPA, JDBC) 또는 네트워킹 API를 사용해야 하는 경우, 적어도 일반적인 아키텍처에서는 스프링 MVC가 가장 좋다. 별도의 스레드에서 블로킹 호출을 수행하는 것은 기술적으로 Reactor와 RxJava 모두에서 가능하지만 논블로킹 웹 스택을 활용하기 어렵다.</li><li>원격 서비스에 대한 호출이 있는 스프링 MVC 애플리케이션이 있는 경우 리액티브 WebClient를 사용하면 스프링 MVC 컨트롤러 메서드에서 직접 리액티브 유형(Reactor, RxJava 또는 기타)을 반환할 수 있다. 호출 당 지연 시간이 길거나 호출 간의 상호 의존성이 클수록 이 점은 더욱 극적으로 나타난다. 스프링 MVC 컨트롤러는 다른 리액티브 컴포넌트도 호출할 수 있다.</li><li>팀 규모가 크다면 논블로킹, 함수형, 선언적 프로그래밍은 러닝커브가 높다는 점도 고려해야 한다. 전면적인 전환없이 시작할 수 있는 실용적인 방법은 리액티브 웹클라이언트를 사용하는 것이다. 작은 것부터 시작해서 변화가 있는지 확인하면 전환이 불필요할 경우도 많을 것이다. 어떤 이점을 찾아야 할지 잘 모르겠다면 논블로킹 I/O의 작동 방식(예: 단일 스레드 Node.js의 동시 처리)과 그 효과에 대해 알아보는 것부터 시작해라.</li></ul><h3 id=servers>Servers</h3><p>스프링 WebFlux는 Tomcat, Jetty, Servlet 3.1+ 컨테이너 뿐만 아니라 Netty 및 Undertow도 지원된다. 모든 서버는 낮은 수준의 공통 API에 맞춰 조정되므로 서버 전반에서 상위 수준의 프로그래밍 모델을 지원할 수 있다.</p><p>스프링 WebFlux에는 서버 기동이나 중단을 위한 내장 기능은 없다. 하지만 스프링 설정과 WebFlux를 조립해 구성한 코드로 쉽게 애플리케이션을 실행할 수 있다.</p><p>스프링 Boot에는 이러한 단계를 자동화하는 WebFlux 스타터가 있다. 기본적으로 스타터는 Netty를 사용하지만, Maven 또는 Gradle 종속성을 변경하여 Tomcat, Jetty 또는 Undertow로 쉽게 전환할 수 있다. 스프링 Boot가 Netty를 디폴트로 사용하는 이유는 보통 비동기 논블로킹에 많이 사용되기도 하고 클라이언트와 서버가 리소스를 공유할 수 있어서다.</p><p>Tomcat과 Jetty는 스프링 MVC와 WebFlux에 모두 사용할 수 있다. 하지만 동작방식은 다르다는 점에 주의해야 한다. 스프링 MVC는 Servlet 차단 I/O에 의존하며, 애플리케이션이 필요한 경우 Servlet API를 직접 사용할 수 있다. 스프링 WebFlux는 Servlet 3.1 논블로킹 I/O롤 동작하며 서블릿 API는 저수준 어댑터로 사용하기 때문에 노출되어 있지 않다.</p><p>스프링 WebFlux에서 Undertow를 사용할 때는 서블릿 API가 아닌 Undertow API를 사용한다.</p><h3 id=performance>Performance</h3><p>성능에는 많은 특징과 의미가 있다. 리액티브 및 논블로킹은 일반적으로 애플리케이션을 더 빠르게 실행하지 않는다. 일부 경우(예: 웹클라이언트를 사용하여 원격 호출을 병렬로 실행하는 경우)에는 그럴 수 있다. 전반적으로 논블로킹 방식으로 작업을 수행하려면 더 많은 작업이 필요하며 필요한 처리 시간이 약간 늘어날 수 있다.</p><p>리액티브 및 논블로킹 방식의 주요 이점은 적은 수의 고정된 스레드와 적은 메모리로 확장할 수 있다는 점이다. 따라서 애플리케이션이 보다 예측 가능한 방식으로 확장되므로 부하가 걸렸을 때 복원력이 향상된다. 그러나 이러한 이점을 누리려면 느리고 예측할 수 없는 네트워크 I/O가 혼합된 경우 등 지연 시간이 어느 정도 발생해야 한다. 바로 이 지점에서 리액티브 스택의 강점이 드러나기 시작하며, 그 차이는 극적일 수 있다.</p><h3 id=concurrency-model>Concurrency Model</h3><p>스프링 MVC와 스프링 WebFlux는 모두 Annotated Controller를 사용할 수 있다는 점은 동일해도 동시성 모델과 블로킹/스레드 기본 전략은 다르다.
스프링 MVC(그리고 일반적인 서블릿 애플리케이션)는 애플리케이션이 처리중인 스레드가 잠시 중단될 수 있다(예를 들어 원격 호출의 경우). 이러한 이유로 서블릿 컨테이너는 요청 처리 중에 잠재적인 차단을 흡수하기 위해 대규모 스레드 풀을 사용한다.
스프링 WebFlux(및 일반적으로 논블로킹 서버)에서는 실행되는 스레드가 중단되지 않는다는 전제가 있다. 따라서 논블로킹 서버는 작은 고정 크기의 스레드 풀(이벤트 루프 워커)을 사용하여 요청을 처리한다.</p><pre tabindex=0><code>&#34;확장&#34;과 &#34;적은 수의 스레드&#34;는 모순적으로 들릴 수 있지만 현재 스레드를 차단하지 않고 대신 콜백에 의존한다는 것은 흡수할 차단 호출이 없기 때문에 추가 스레드가 필요하지 않다는 것을 의미한다.
</code></pre><h4 id=invoking-a-blocking-api>Invoking a Blocking API</h4><p>블로킹 라이브러리를 사용해야 한다면 어떻게 해야 할까? Reactor와 RxJava는 모두 다른 스레드에서 처리를 계속할 수 있는 PublishOn 연산자를 제공한다. 즉, 쉽게 빠져나갈 수 있는 탈출구가 있다는 뜻이다. 그러나 블로킹 API는 이 동시성 모델에 적합하지 않다는 점에 유의해야 한다.</p><h4 id=mutable-state>Mutable State</h4><p>Reactor와 RxJava에서는 연산자를 통해 로직을 선언한다. 런타임에 데이터가 별개의 단계에서 순차적으로 처리되는 리액티브 파이프라인이 형성된다. 이 파이프라인의 주요 이점은 해당 파이프라인 내의 애플리케이션 코드가 동시에 호출되지 않기 때문에 애플리케이션이 변경 가능한 상태를 보호할 필요가 없다는 것이다.</p><h4 id=threading-model>Threading Model</h4><p>스프링 WebFlux를 사용하는 애플리케이션은 어떤 스레드를 얼마나 실행할까?</p><ul><li>최소한의 설정으로 스프링 WebFlux 서버를 띄우면(예를 들어 데이터 접근이나 다른 의존성이 없는) 서버는 한 개의 스레드를 운영하고 소량의 스레드로 요청을 처리할 수 있다(보통은 CPU 코더 수만큼). 하지만 서블릿 컨테이너는 서블릿 블로킹 I/O와 서블릿 3.1 논블로킹 I/O를 모두 지원하기 때문에 더 많은 스레드(예들 들어 Tomcat의 경우 10개)를 실행할 것이다.</li><li>리액티브 WebClient는 이벤트 루프를 사용한다. 따라서 적은 스레드를 고정해 두고 쓴다(예를 들어 Reactor Nettry 커넥터를 쓴다면 reactor-http-nio-로 시작하는 스레드를 확인할 수 있다.). 단 클라이언트와 서버에서 모두 Reactor Netty를 사용하면 디폴트로 이벤트 루프 리소스를 공유한다.</li><li>Reactor와 RXJava는 스케줄러 라는 추상화된 스레드 풀 전략을 제공한다. publishOn 연산자가 나머지 연산을 다른 스레드 풀로 전환할 때도 이 스케줄러를 사용한다. 스케줄러는 이름을 보면 동시 처리 전략을 알 수 있다. 예를 들어 제한된 스레드로 CPU 연산이 많은 처리를 할 때는 parallel, 여러 스레드로 I/O가 많은 처리를 할 때는 elastic이다. 이런 스레드를 본다면 코드 어딘가에서 그 이름에 해당하는 스레드 풀 스케줄러 전략을 사용하고 있다는 뜻이다.</li><li>데이터에 접근하는 라이브러리나 다른 외부 의존성에서 스레드를 따로 실행하는 경우도 있다.</li></ul><h4 id=configuring>Configuring</h4><p>스프링 프레임워크에서 서버를 직접 실행하거나 중단할 수 없다. 서버의 스레딩 모델을 구성하려면 서버별 구성 API를 사용하거나 스프링 Boot를 사용하는 경우 각 서버에 대한 스프링 Boot 구성 옵션을 확인해야 한다. WebClient를 직접 구성할 수도 있다. 다른 라이브러리의 경우 해당 라이브러리 설명서를 참고하라.</p><h2 id=참고-자료>참고 자료</h2><ul><li><a href=https://docs.spring.io/spring-framework/docs/5.3.27/reference/html/web-reactive.html#spring-webflux>The Spring Framework - Web Reactive</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-1582f4d95d21529049f014dc9e60cbbf>13 - Reactive Core</h1><div class=lead>스프링-웹 모듈은 서버 요청 처리를 위한 HttpHandler와 WebHandler API를 제공하며, 클라이언트 사이드에서는 논블로킹 I/O와 리액티브 스트림 기반의 WebClient가 지원된다. 또한, 서버와 클라이언트 모두 HTTP 요청 및 응답 콘텐츠의 직렬화와 역직렬화를 위한 코덱 기능을 포함하고 있다.</div><h1 id=reactive-core>Reactive Core</h1><h2 id=설명>설명</h2><p>스프링-웹 모듈에는 반응형 웹 애플리케이션을 위한 다음과 같은 기본 지원이 포함되어 있다.</p><ul><li>서버 요청 처리에는 두 가지 수준을 지원한다.<ul><li>HttpHandler: 논블로킹 I/O 및 리액티브 스트림 Back Pressure을 사용하는 HTTP 요청을 처리하며, Reactor Netty, Undertow, Tomcat, Jetty 및 모든 Servlet 3.1+ 컨테이너용 어댑터와 함께 사용한다.</li><li>WebHandler API: 요청 처리를 위한 약간 더 높은 수준의 범용 웹 API로, 주석이 달린 컨트롤러 및 기능적 엔드포인트와 같은 구체적인 프로그래밍 모델로 작성되어 있다.</li></ul></li><li>클라이언트 사이드에서는 논블로킹 I/O 및 리액티브 스트림 Back Pressure으로 HTTP 요청을 수행하는 기본 ClientHttpConnector 계약과 함께 Reactor Netty, 리액티브 Jetty HttpClient 및 Apache HttpComponents용 어댑터가 있다. 애플리케이션에 사용되는 상위 수준의 WebClient는 이를 기반으로 구축된다.</li><li>클라이언트와 서버 모두 코덱으로 HTTP 요청 및 응답 콘텐츠의 직렬화 및 역직렬화를 한다.</li></ul><h3 id=httphandler>HttpHandler</h3><p>HttpHandler는 요청과 응답을 처리하는 메소드를 하나만 가지고 있다. 의도적으로 최소한의 기능을 제공하며, 주된 목적은 다양한 HTTP 서버 API에 대한 최소한의 추상화이다.
지원하는 서버의 API는 아래 표와 같다.</p><table><thead><tr><th>서버 이름</th><th>사용하는 Servlet API</th><th>리액티브 스트림 지원</th></tr></thead><tbody><tr><td>Netty</td><td>Netty API</td><td>Reactor Netty</td></tr><tr><td>Undertow</td><td>Undertow API API</td><td>spring-web: Undertow to 리액티브 스트림 브릿지</td></tr><tr><td>Tomcat</td><td>서블릿 3.1 논블로킹 I/O; ByteBuffers로 byte[]를 읽고 쓰는 Tomcat API</td><td>spring-web: 서블릿 3.1 논블로킹 I/O to 리액티브 스트림 브릿지</td></tr><tr><td>Jetty</td><td>서블릿 3.1 논블로킹 I/O; ByteBuffers로 byte[]를 읽고 쓰는 Jetty API</td><td>spring-web: 서블릿 3.1 논블로킹 I/O to 리액티브 스트림 브릿지</td></tr><tr><td>서블릿 3.1 컨테이너</td><td>서블릿 3.1 논블로킹 I/O</td><td>spring-web: 서블릿 3.1 논블로킹 I/O to 리액티브 스트림 브릿지</td></tr></tbody></table><p>서버 Dependency는 아래 표와 같다(지원 버전 참고)</p><table><thead><tr><th>서버 이름</th><th>Group ID</th><th>Artifact Name</th></tr></thead><tbody><tr><td>Reactor Netty</td><td>io.projectreactor.netty</td><td>reactor-netty</td></tr><tr><td>Undertow</td><td>io.undertow</td><td>undertow-core</td></tr><tr><td>Tomcat</td><td>org.apache.tomcat.embed</td><td>tomcat-embed-core</td></tr><tr><td>Jetty</td><td>org.eclipse.jetty</td><td>jetty-server, jetty-servlet</td></tr></tbody></table><p>다음은 각 서버의 API 어댑터를 활용하는 HttpHandler이다.</p><h4 id=리액터-netty>리액터 Netty</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>HttpHandler</span> <span style=color:#000>handler</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>ReactorHttpHandlerAdapter</span> <span style=color:#000>adapter</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ReactorHttpHandlerAdapter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>HttpServer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>create</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>host</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>host</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>port</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>port</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>handle</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>adapter</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>bind</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>block</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=undertow>Undertow</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>HttpHandler</span> <span style=color:#000>handler</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>UndertowHttpHandlerAdapter</span> <span style=color:#000>adapter</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>UndertowHttpHandlerAdapter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>Undertow</span> <span style=color:#000>server</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Undertow</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>addHttpListener</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>port</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>host</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>setHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>adapter</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>start</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=tomcat>Tomcat</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>HttpHandler</span> <span style=color:#000>handler</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>Servlet</span> <span style=color:#000>servlet</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>TomcatHttpHandlerAdapter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Tomcat</span> <span style=color:#000>server</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Tomcat</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>File</span> <span style=color:#000>base</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getProperty</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;java.io.tmpdir&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>Context</span> <span style=color:#000>rootContext</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addContext</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>base</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAbsolutePath</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#000>Tomcat</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addServlet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>rootContext</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;main&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>servlet</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>rootContext</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addServletMappingDecoded</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;main&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHost</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>host</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setPort</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>port</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>start</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=jetty>Jetty</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>HttpHandler</span> <span style=color:#000>handler</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>Servlet</span> <span style=color:#000>servlet</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>JettyHttpHandlerAdapter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Server</span> <span style=color:#000>server</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Server</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>ServletContextHandler</span> <span style=color:#000>contextHandler</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ServletContextHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>contextHandler</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addServlet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ServletHolder</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>servlet</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#4e9a06>&#34;/&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>contextHandler</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>start</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>ServerConnector</span> <span style=color:#000>connector</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ServerConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>connector</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHost</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>host</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>connector</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setPort</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>port</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>connector</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>start</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=서블릿-31-컨테이너>서블릿 3.1+ 컨테이너</h4><p>서블릿 3.1+ 컨테이너에 WAR를 배포하려면 WAR에 AbstractReactiveWebInitializer를 확장하여 추가하면 된다. 이 클래스는 HttpHandler, ServletHttpHandlerAdapter를 감싸고 있으며, 이 핸들러를 서블릿으로 등록한다.</p><h3 id=webhandler-api>WebHandler API</h3><p>org.springframework.web.server 패키지를 보면 HttpHandler가 WebHandler와 여러 WebExceptionHandler, WebFilter로 체인을 형성해 요청을 처리하는 범용 웹 API를 제공한다.
WebHttpHandlerBuilder에 컴포넌트를 등록하거나 스프링 ApplicationContext 위치만 알려주면 자동으로 컴포넌트 체인에 추가한다.
HttpHandler는 서로 다른 HTTP 서버를 쓰기 위한 추상화가 전부인 반면, WebHandler API는 아래와 같이 웹 애플리케이션에서 흔히 쓰는 광범위한 기능을 제공한다.</p><ul><li>User session과 Session attributes</li><li>Request attributes.</li><li>Locale, Principal 리졸브</li><li>form 데이터 파싱, 캐싱 조회</li><li>multipart 데이터 추상화</li><li>기타 등등</li></ul><h4 id=form-data>Form Data</h4><p>ServerWebExchange는 form 데이터에 접근할 수 있는 메소드를 제공한다.</p><pre tabindex=0><code>Mono&lt;MultiValueMap&lt;String, String&gt;&gt; getFormData();
</code></pre><p>DefaultServerWebExchange는 설정에 있는 HttpMessageReader를 사용해 form 데이터를 MultiValueMap으로 파싱한다. 디폴트로 사용하는 리더는 ServerCodecConfigurer 빈에 있는 FormHttpMessageReader이다.</p><h4 id=multipart-data>Multipart Data</h4><p>ServerWebExchange는 multipart 데이터에 접근할 수 있는 메소드를 제공한다.</p><pre tabindex=0><code>Mono&lt;MultiValueMap&lt;String, Part&gt;&gt; getMultipartData();
</code></pre><p>DefaultServerWebExchange는 설정에 있는 HttpMessageReader&lt;MultiValueMap&lt;String, Part»를 사용해 multipart/form-data 컨텐츠를 MultiValueMap으로 파싱한다. 현재로써는 Synchronoss NIO Multipart가 유일하게 지원하는 서브파티 라이브러리이며, 논블로킹으로 multipart 요청을 파싱하는 유일한 라이브러리이다. ServerCodecConfigurer 빈으로 활성화할 수 있다.
스트리밍 방식으로 multipart 데이터를 파싱하려면 HttpMessageReader<part>가 리턴하는 Flux<part>를 사용한다. 예를 들어 컨트롤러에서 @RequestPart를 선언하면 Map처럼 이름으로 각 파트에 접근하겠다는 뜻이므로 multipart 데이터를 한번에 파싱해야 한다. 반대로 Flux<part> 타입에 @RequestPart를 사용허면 컨텐츠를 디코딩할 때 MultiValueMap에 수집하지 않는다.</p><h4 id=forwarded-headers>Forwarded Headers</h4><p>Load Balancers와 같이 프톡시를 경유한 요청은 호스트, 포트, URL 스킴이 변경될 수 있어서 클라이언트 입장에서는 원래의 URL 정보를 알아내기 어렵다.
RFC 7239 정의에 따르면 Forwarded HTTP 헤더는 프록시가 원래 요청에 대한 정보를 추가하는 헤더이다. X-Forwarded-Host, X-Forwarded-Port, X-Forwarded-Proto, X-Forwarded-Ssl, and X-Forwarded-Prefix 같은 비표준 헤더도 존재한다.
ForwardedHeaderTransformer는 forwarded 헤더를 보고 요청의 호스트, 포트, 스킴을 바꿔준 다음, 헤더를 제거하는 컴포넌트이다. ForwardedHeaderTransformer라는 이름으로 빈을 정의하면 자동으로 체인에 추가된다.
forwarded 헤더는 보안에 신경써야 할 요소가 있는데 프록시가 헤더를 추가한건지, 클라이언트가 악의적으로 추가한 것인지 애플리케이션에서는 알 수 없기 때문이다.
따라서 외부에서 들어오는 신뢰할 수 없는 프록시 요청을 제거할 때 ForwardedHeaderTransformer를 removeOnly=true로 설정하여 헤더 정보를 사용하지 않고 제거할 수 있다.</p><pre tabindex=0><code>5.1 버전부터 ForwardedHeaderFilter는 제거대상(deprecated)이 되어 ForwardedHeaderTransformer를 대신한다. 따라서 exchange(http 요청/응답과 세션 정보 등의 컨테이너)를 만들기 전에 forwarded 헤더를 처리할 수 있다. 필터를 사용하더라도 이 필터는 전체 필터 리스트에서 제외되며 그 대신 ForwardedHeaderTransformer를 사용한다.
</code></pre><h3 id=filters>Filters</h3><p>WebHandler API에서는 WebFilter를 사용하면 다른 필터 체인과 WebHandler 전후에 요청을 가로채서 원하는 로직을 넣을 수 있다. WebFilter를 등록하려면 스프링 빈으로 만들어 빈 위에 @Order를 선언아거나 Ordered를 구현해 순서를 정해도 되고, WebFlux Config를 사용해도 된다.</p><h4 id=cors>CORS</h4><p>CORS는 컨트롤러에 어노테이션을 선언하는 것으로 잘 동작한다. Spring Security와 사용하면 CorsFilter를 사용해서 Spring Security 필터 체인보다 먼저 처리하도록 해야 한다.</p><h3 id=exceptions>Exceptions</h3><p>WebHandler API에서는 WebFilter 체인과 WebHandler에서 발생한 예외를 WebExceptionHandler로 처리한다. WebExceptionHandler를 등록하려면 스프링 빈으로 빈 위에 @Order를 선언하거나 Ordered를 구현해 순서를 정해도 되고, WebFlux Config를 사용해도 된다.
아래 표는 바로 사용할 수 있는 WebExceptionHandler 구현체이다.</p><table><thead><tr><th>Exception Handler</th><th>Description</th></tr></thead><tbody><tr><td>ResponseStatusExceptionHandler</td><td>Http status code를 지정할 수 있는 ResponseStatusException을 처리한다.</td></tr><tr><td>WebFluxResponseStatusExceptionHandler</td><td>ResponseStatusExceptionHandler를 확장하는 것으로 다른 exception 타입도 @ResponseStatus를 선언해서 HTTP status code를 정할 수 있다.</br>이 핸들러는 WebFlux Config 안에 선언되어 있다.</td></tr></tbody></table><h2 id=참고자료>참고자료</h2><ul><li><a href=https://docs.spring.io/spring-framework/docs/5.3.27/reference/html/web-reactive.html#webflux-reactive-spring-web>The Spring Framework - Web Reactive - Reactive Core</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-171474be9b8ab96df2310f8efa41d340>14 - 스프링 WebFlux의 DispatcherHandler와 요청 처리 흐름</h1><div class=lead>스프링 WebFlux는 프론트 컨트롤러 패턴을 사용하며, DispatcherHandler가 중앙 WebHandler로서 요청을 다른 컴포넌트에 위임한다. DispatcherHandler는 스프링 설정에 따라 다양한 워크플로우를 지원하고, ApplicationContextAware 인터페이스를 구현해 실행 중인 컨텍스트에 접근할 수 있다.</div><h1 id=dispatcherhandler>DispatcherHandler</h1><h2 id=설명>설명</h2><p>스프링 WebFlux도 스프링 MVC와 유사한 프론트 컨트롤러 패턴을 사용한다. 중앙 WebHandler가 받은 요청을 다른 컴포넌트에 위임하는데 DispatcherHandler가 바로 이 중앙 WebHandler다. 이 모델 덕분에 다양한 워크플로우를 지원할 수 있다.
DispatcherHandler는 스프링 설정에 따라 그에 맞는 컴포넌트로 위임한다. DispatcherHandler도 스프링 빈이며 ApplicationContextAware 인터페이스를 구현했기 때문에 실행중인 컨텍스트에 접근할 수 있다. DispatcherHandler 빈을 WebHandler 이름으로 정의하면 WebHttpHandlerBuilder가 감지하고 WebHandler API에서 설명했던 체인에 추가한다.</p><p>WebFlux 애플리케이션에서 사용하는 일반적인 스프링 설정은 다음과 같다.</p><ul><li>webHandler 이름의 DispatcherHandler 빈</li><li>WebFilter, WebExceptionHandler 빈</li><li>그 외 DispatcherHandler가 사용하는 빈</li><li>기타 등등</li></ul><p>WebExceptionHandler가 체인을 만들 때 아래와 같이 사용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>ApplicationContext</span> <span style=color:#000>context</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>HttpHandler</span> <span style=color:#000>handler</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebHttpHandlerBuilder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>applicationContext</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=special-bean-types>Special Bean Types</h3><p>DispatcherHandler는 요청을 처리하고 그에 맞는 응답을 만들 때 사용하는 특별한 빈이 있다. <strong>특별한</strong> 빈이란 WebFlux 프레임워크가 동작하는데 필요하며 스프링이 관리하는 Object 인스턴스를 말한다. 이 빈들은 기본적으로 내장돼 있지만 프로퍼티를 수정해서 확장하거나 커스텀 빈으로 대체할 수도 있다.</p><p>DispatcherHandler는 다음과 같은 빈을 감지한다. 저수준에서 동작하는 다른 빈도 자동으로 추가될 수 있다는 점에 주의하라</p><table><thead><tr><th>Bean type</th><th>Explanation</th></tr></thead><tbody><tr><td>HandlerMapping</td><td>요청을 핸들러에 매핑한다. 매핑 기준은 HandlerMapping 구현체마다 다른다(어노테이션을 선언한 컨트롤러, URL 패턴 매칭 등)</br>주로 쓰는 구현체는 @RequestMapping을 선언한 메소드를 찾는 RequestMappingHandlerMapping, 함수형 엔드포인트를 라이팅하는 RouterFunctionMapping, URL 패스 패턴으로 WebHandler를 찾는 SimpleUrlHandlerMapping 등이 있다.</td></tr><tr><td>HandlerAdapter</td><td>핸들러가 실제로 호출되는 방식에 관계없이 요청에 매핑된 핸들러를 호출할 수 있도록 DispatcherHandler를 지원한다.</br>예를 들어 어노테이션이 있는 컨트롤러를 호출하려면 어노테이션을 해결해야 한다.</br>HandlerAdapter의 주요 목적은 이러한 세부 사항으로부터 DispatcherHandler를 보호하는 것이다.</td></tr><tr><td>HandlerResultHandler</td><td>핸들러 호출의 결과를 처리하고 응답을 종료한다. Result Handling을 참고하라.</td></tr></tbody></table><h3 id=webflux-config>WebFlux Config</h3><p>애플리케이션은 요청을 처리하는 데 필요한 인프라 빈(웹 핸들러 API 및 DispatcherHandler)을 선언할 수 있다. 그러나 대부분의 경우 WebFlux Config로 시작하는게 좋다. 이 구성은 필요한 빈을 선언하고 이를 사용자 정의할 수 있는 상위 수준의 구성 콜백 API를 제공한다.</p><pre tabindex=0><code>스프링 부트를 사용해도 이 WebFlux Config로 초기화하며 부트가 제공하는 옵션으로 좀 더 편리하게 설정을 관리할 수 있다.
</code></pre><h3 id=processing>Processing</h3><p>DispatcherHandler는 다음과 같이 요청을 처리한다.</p><ul><li>HandlerMapping에서 매칭되는 핸들러를 찾는다. 첫번째로 매칭된 핸들러를 사용한다.</li><li>핸들러를 찾으면 적당한 HandlerAdapter를 사용해 핸들러를 실행하고 HandlerResult를 돌려 받는다.</li><li>HandlerResult를 적절한 HandlerResultHandler로 넘겨 바로 응답을 만들거나 뷰를 랜더링하고 처리를 완료한다.</li></ul><h3 id=result-handling>Result Handling</h3><p>핸들러 호출의 반환 값은 HandlerAdapter를 통해 몇 가지 추가 컨텍스트와 함께 HandlerResult로 래핑되어 지원을 요청하는 첫 번째 HandlerResultHandler로 전달된다. 아래 표는 사용 가능한 HandlerResultHandler 구현을 보여 주며, 모두 WebFlux 구성에 선언되어 있다.:</p><table><thead><tr><th>Result Handler Type</th><th>Return Values</th><th>Default Order</th></tr></thead><tbody><tr><td>ResponseEntityResultHandler</td><td>ResponseEntity, 보통은 @Controller에서 사용</td><td>0</td></tr><tr><td>ServerResponseResultHandler</td><td>ServerResponse, 보통은 Functional Endpoints에서 사용</td><td>0</td></tr><tr><td>ResponseBodyResultHandler</td><td>@ResponseBody, @RestController에서 리턴한 값을 처리</td><td>100</td></tr><tr><td>ViewResolutionResultHandler</td><td>CharSequence, View, Model, Map, Rendering이나 다른 Object를 model attribute로 처리</td><td>Integer.MAX_VALUE</td></tr></tbody></table><h3 id=exceptions>Exceptions</h3><p>HandlerAdapter가 리턴한 HandlerResult는 핸들러마다 다른 에러 처리 함수에 넘겨진다. 이 함수는 아래와 같을 때 호출된다.</p><ul><li>핸들러 실행에 실패한 경우(예를 들어 @Controller)</li><li>HandlerResultHandler가 핸들러가 리턴한 값을 처리하는데 실패한 경우</li></ul><p>핸들러가 리턴한 리액티브 타입이 데이터를 produce 하기 전에 에러를 알아차릴 수 있으면 이 함수로 응답을 변경할 수 있다.(예를 들어 status로)
이로 인해 @Controller 클래스의 특정 메소드에 @ExceptionHandler를 선언할 수 있다. 스프링 MVC에선 HandlerExceptionResolver가 이 역할을 담당한다.
여기서 중요한 것은 MVC가 아니지만 WebFlux 핸들러를 선택하기 전 발생한 Exception은 @ControllerAdvice로 처리할 수 없다.</p><h4 id=view-resolution>View Resolution</h4><p>뷰 해상도를 사용하면 특정 뷰 기술에 종속되지 않고 HTML 템플릿과 모델을 사용하여 브라우저에 렌더링할 수 있다.
WebFlux에서 뷰 해상도는 ViewResolver 인스턴스를 사용하여 String을 View 인스턴스에 매핑하는 전용 HandlerResultHandler를 통해 지원된다. 그런 다음 뷰를 사용하여 응답을 렌더링한다.</p><h5 id=handling>Handling</h5><p>ViewResolutionResultHandler로 전달된 HandlerResult에는 핸들러의 반환 값과 요청 처리 중에 추가된 속성이 포함된 모델이 포함된다. 반환 값은 다음 중 하나로 처리된다.</p><ul><li>문자열, 문자 시퀀스: 구성된 뷰리졸버 구현 목록을 통해 뷰로 확인할 논리적 뷰 이름이다.</li><li>void: 요청 패스에 맞는 디폴트 뷰 이름에서 앞뒤 슬래쉬를 제거하고 뷰로 리졸브한다. 뷰 이름이 제공되지 않거나(예를 들어 model attribute를 리턴한 경우) 비동기 값일 때도(예를 들어 Mono가 비어 있을 때) 동일하게 처리한다.</li><li>렌더링: 뷰 해상도 시나리오를 위한 API입니다. 코드 완성 기능이 있는 IDE에서 옵션을 확인해라.</li><li>Model, Map: 요청에 대해 모델에 추가할 model attributes</li><li>기타: 다른 모든 반환 값(BeanUtils#isSimpleProperty가 true를 리턴하는 값은 제외)은 모델에 추가할 model attribute로 간주된다. @ModelAttribute 어노테이션이 없으면 conventions와 클래스명으로 속성 이름을 결정한다.</li></ul><p>모델에는 비동기 리액티브 타입도 있을 수 있다(예를 들어 리액터나 RxJava가 리턴한 값). 이런 model attribute는 AbstractView가 랜더링하기 전에 실제값으로 바꿔준다.
single-value 리액티브 타입은 비어있지 않다면 값 하나로 리졸브되고 multi-value 리액티브 타입(에를 들어 Flux<t>)은 List<t>로 수집된다.</p><p>뷰 리졸브는 스프링 설정에 ViewResolutionResultHandler만 추가하면된다. WebFlux Config는 뷰 리졸브를 위한 설정 API를 제공한다.</p><h5 id=redirecting>Redirecting</h5><p>리액티브는 뷰 이름에 redirect: 프리픽스를 붙이기만 하면 된다. UrlBasedViewResolver(히위 클래스도 포함)가 이를 리다이렉트 요청으로 판단한다.
프리픽스를 제외한 나머지 뷰 이름은 리다이렉트 URL로 사용한다. 동작 자체는 컨트롤러가 RedirectView나 Rendering.redirectTo(“abc”).build()를 리턴했을 때와 동일하지만, 이 방법은 컨트롤러가 직접 뷰 이름을 보고 처리한다.
redirect:/some/resource 같은 값은 현재 애플리케이션에서 이동할 페이지를 찾고 redirect:https://example.com/arbitrary/path 같이 사용하면 해당 URL로 리다이렉트한다.</p><h5 id=content-negotiation>Content Negotiation</h5><p>content negotiation은 ViewResolutionResultHandler가 담당한다. 요청 미디어 타입과 View가 지원하는 미디어 타입을 비교해서 첫번째로 찾은 View를 사용한다.
스프링 WebFlux는 HttpMessageWriter로 Json, XML 같은 미디어 타입을 만드는 HttpMessageWriterView를 지원한다. 보통은 WebFlux 설정을 통해 HttpMessageWriterView를 디폴트 뷰로 사용한다. 디폴트 뷰는 요청 미디어 타입과 일치하기만 하면 항상 사용되는 뷰다.</p><h2 id=참고자료>참고자료</h2><ul><li><a href=https://docs.spring.io/spring-framework/docs/5.3.27/reference/html/web-reactive.html#webflux-dispatcher-handler>The Spring Framework - Web Reactive - DispatcherHandler</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-05e9c669eccc17bab65bea194cc4c753>15 - 스프링 WebFlux에서 어노테이션 기반 컨트롤러 활용 방법</h1><div class=lead>스프링 WebFlux는 @Controller, @RestController 어노테이션을 통해 요청을 매핑하고 입력 처리 및 예외 처리를 지원한다. 컨트롤러는 메소드 기반으로 동작하며, 상속이나 인터페이스 구현 없이도 다양한 방식으로 활용할 수 있다.</div><h1 id=annotated-controllers>Annotated Controllers</h1><h2 id=설명>설명</h2><p>스프링 WebFlux는 어노테이션 기반 프로그램밍 모델을 지원하기 때문에 @Controller, @RestController 컴포넌트로 요청을 매핑하고, 입력을 받고, 예외처리를 할수 있다. 컨트롤러는 메소드를 여러가지로 활용할 수 있어서 클래스를 상속하거나 인터페이스를 구현하지 않아도 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RestController</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HelloController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@GetMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/hello&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>handle</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;Hello WebFlux&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>위 코드에서는 response body에 쓸 String을 리턴한다.</p><h3 id=controller>@Controller</h3><p>컨트롤러는 표준 스프링 빈으로 정의한다. @Controller 어노테이션을 달면 스프링이 클래스패스 내의 다른 @Component 클래스처럼 자동으로 스캔하고 빈으로 등록한다. 이 어노테이션을 선언하면 그 클래스가 Web 컴포넌트라는 뜻이기도 하다.
@Controller 빈을 자동으로 등록하려면 아래와 같이 컴포넌트 스캔을 위한 설정이 필요하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@ComponentScan</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;org.example.web&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebConfig</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>@RestController는 자체에 @Controller, @ResponseBody를 선언하고 있어, 컨트롤러 내의 모든 메소드에 @ResponseBody를 상속한다. 따라서 리턴값으로 View를 만들지 않고 response body에 바로 쓸 수 있다.</p><h3 id=request-mapping>Request Mapping</h3><p>컨트롤러 메소드 요청을 매핑할 때는 @RequestMapping을 사용한다. 이 어노테이션에 있는 속성으로 URL, HTTP 메소드, 요청 파라미터, 헤더, 미디어 타입을 매칭할 수 있다. 메소드에 선언하거나 모든 메소드에서 공유하고 싶을 때 클래스 레벨에 선언한다.
@GetMapping, @PostMapping, @PutMapping, @DeleteMapping, @PatchMapping은 HTTP 메소드를 바로 지정할 수 있다. 이 어노테이션은 컨트롤러 메소드에서 거의 대부분이 HTTP 메소드 하나만 담당하는 일종의 커스텀 어노테이션이다. 이 어노테이션을 선언하더라도 다른 매핑 조건을 공통으로 사용하려면 클래스 레벨의 @RequestMapping을 선언해야 한다.</p><h3 id=handler-methods>Handler Methods</h3><p>@RequestMapping 핸들러는 다양한 컨트롤러 메소드 인자와 리턴값을 지원하므로 원하는 것을 선택하면 된다.
블로킹 I/O로 받는 인자(예를 들어 response body를 읽는 경우)는 리액티브 유형(Reactor, RxJava 또는 기타)을 사용할 수 있다. 이런 타입은 Description 컬럼에 명시되어 있다. 블로킹 없는 인자는 리액티브 타입을 사용하지 않는다.
일부 어노테이션은(예를 들어 @RequestParam, @RequestHeader 등) required attribute로 필수 여부를 지정할 수 있으며 JDK 8의 java.util.Optional을 사용해도 된다. 효과는 required=false와 동일하다.</p><h3 id=model>Model</h3><p>@ModelAttribute 어노테이션은 다음과 같이 사용할 수 있다.</p><ul><li>@RequestMapping 메소드 인자에 선언해서 모델을 생성, 접근하고 WebDataBinder로 객체에 바인딩한다.</li><li>@Controller나 @ControllerAdvice 클래스 메소드에 선언해서 다른 @RequestMapping 메소드를 실행하기 전 모델을 초기화한다.</li><li>@RequestMapping 메소드에서 리턴하는 값을 molde attribute로 만든다.</li></ul><p>여기서는 @ModelAttribute 메소드에 대해 설명한다. 컨트롤러는 @ModelAttribute 메소드를 얼마든지 가질 수 있다. 이러한 모든 메소드는 동일한 컨트롤러에서 @RequestMapping 메소드 앞에 호출된다. @ModelAttribute 메소드는 @ControllerAdvice를 통해 컨트롤러 간에 공유할 수도 있다.</p><p>@ModelAttribute 메소드는 여러가지 방법으로 활용할 수 있다. 지원하는 인자는 대부분 @RequestMapping 메소드와 동일하다.(@ModelAttribute 자체와 request body와 관련된 것은 제외)
다음은 @ModelAttribute 메소드 사용 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@ModelAttribute</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>populateModel</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span> <span style=color:#000>String</span> <span style=color:#000>number</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Model</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>accountRepository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>findAccount</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>number</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// add more ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=databinder>DataBinder</h3><p>WebDataBinder는 @Controller나 @ControllerAdvice 클래스에서 @InitBinder 메소드로 초기화할 수 있다.
@InitBinder 메소드는 다음과 같이 사용할 수 있다.</p><p>@InitBinder 메소드롤 컨트롤러별 java.beans.PropertyEditor나 스프링 Converter, Formatter를 등록할 수 있다.
FormattingConversionService에서 전역으로 사용하는 Converter, Formatter는 웹플럭스 설정으로 등록한다.
@InitBinder 메소드가 지원하는 인자는 @ModelAttribute(커맨드 객체)만 제외하고 대부분 @RequestMapping 메소드와 동일하다.
보통은 WebDataBinder를 인자로 받아 컴포넌트를 등록하고 void를 리턴한다. 다음은 @InitBinder 어노테이션을 사용하는 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>FormController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@InitBinder</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>initBinder</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebDataBinder</span> <span style=color:#000>binder</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>SimpleDateFormat</span> <span style=color:#000>dateFormat</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>SimpleDateFormat</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;yyyy-MM-dd&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>dateFormat</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setLenient</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>binder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>registerCustomEditor</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Date</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>CustomDateEditor</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>dateFormat</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=managing-exceptions>Managing Exceptions</h3><p>@Controller와 @ControllerAdvice 클래스 메소드에 @ExceptionHandler를 선언하면 컨트롤러 메서드의 예외를 처리할 수 있다. 다음은 예외를 처리하는 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>SimpleController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@ExceptionHandler</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ResponseEntity</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>handle</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=controller-advice>Controller Advice</h3><p>@ExceptionHandler, @InitBinder, @ModelAttribute 메소드는 @Controller 클래스(혹은 상속한 클래스)에 적용된다.
모든 컨트롤러에 적용하고 싶다면 @ControllerAdvice나 @RestControllerAdvice를 선언한 클래스 안에 만들어야 한다.</p><p>@ControllerAdvice는 @Component 어노테이션이 선언되어 있기 때문에 컴포넌트 스캔으로 스프링 빈에 등록할 수 있다.
@RestControllerAdvice는 @ControllerAdvice와 @ResponseBody가 둘 다 선언되어 있어 @ExceptionHandler 메소드에서 리턴한 값은 메시지 변환을 통해 view를 만들거나 템플릿을 랜더링하는 대신 response body로 렌더링한다.</p><p>애플리케이션을 기동하면 프레임워크 내부에서 @ControllerAdvice를 선언한 스프링 빈을 찾아 @RequestMapping과 @ExceptionHandler 메소드를 적용한다.
전역에 설정한 @ExceptionHandler 메소드는 @Controller 메소드 다음에 적용한다. 반대로 전역 @ModelAttribute, @InitBinder 메소드는 @Controller 메소드 전에 적용한다.</p><p>기본적으로 @ControllerAdvice 메소드는 모든 요청에 적용되지만 다음 예제처럼 어노테이션 attribute로 컨트롤러를 지정할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Target all Controllers annotated with @RestController
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#5c35cc;font-weight:700>@ControllerAdvice</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>annotations</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RestController</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>ExampleAdvice1</span> <span style=color:#ce5c00;font-weight:700>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Target all Controllers within specific packages
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#5c35cc;font-weight:700>@ControllerAdvice</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;org.example.controllers&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>ExampleAdvice2</span> <span style=color:#ce5c00;font-weight:700>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Target all Controllers assignable to specific classes
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#5c35cc;font-weight:700>@ControllerAdvice</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>assignableTypes</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>{</span><span style=color:#000>ControllerInterface</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>AbstractController</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>ExampleAdvice3</span> <span style=color:#ce5c00;font-weight:700>{}</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2><ul><li><a href=https://docs.spring.io/spring-framework/docs/5.3.27/reference/html/web-reactive.html#webflux-controller>The Spring Framework - Web Reactive - Annotated Controllers</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-88748e6fc2135df036998e22b14cbb02>16 - 스프링 WebFlux 함수형 프로그래밍 모델(WebFlux.fn)</h1><div class=lead>스프링 WebFlux의 함수형 모델인 WebFlux.fn은 요청을 함수로 라우팅하고 처리하며, HandlerFunction이 HTTP 요청을 처리해 비동기 응답을 반환한다. RouterFunction은 요청을 해당 HandlerFunction에 매핑하며, 이는 어노테이션 모델의 @RequestMapping과 같은 역할을 수행하지만 데이터와 행동을 함께 제공하는 점이 다르다.</div><h1 id=functional-endpoints>Functional Endpoints</h1><p>스프링 WebFlux는 경량화 된 함수형 프로그래밍 모델을 지원한다. WebFlux.fn이라고 하는 이 모델은 함수로 요청을 라우팅하고 핸들링하기 때문에 불변성(immutability)을 보장한다.
함수형 모델과 어노테이션 모델 중 하나를 선택하면 되는데 둘 다 리액티브 코어를 기반으로 한다.</p><h2 id=설명>설명</h2><p>WebFlux.fn에선 HandlerFunction이 HTTP 요청을 처리한다. HandlerFunction은 ServerRequest를 받아 비동기 ServerResponse(예를 들어 Mono<serverresponse>)를 리턴하는 함수다. 요청, 응답 객체 모두 불변하기 때문에 JDK 8 방식으로 HTTP 요청, 응답에 접근할 수 있다. HandlerFunction 역할은 어노테이션 프로그래밍 모델로 치면 @RequestMapping 메소드와 동일하다.</p><p>요청은 RouterFunction이 핸들러 펑션에 라우팅한다. RouterFunction은 ServerRequest를 받아 비동기 HandlerFunction(예를 들어 Mono<handlerfunction>)을 리턴하는 함수다. 매칭되는 라이터 펑션이 있으면 핸들러 펑션을 리턴하고 그 외는 비어 있는 Mono를 리턴한다. RouterFunction이 하는 일은 @RequestMapping 어노테이션과 동일하지만 라우터 펑션은 테이터뿐 아니라 행동까지 제공한다는 점이 다르다.</p><p>라이터를 만들 때는 아래 예제처럼 RouterFunctions.route()가 제공하는 빌더를 사용할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.http.MediaType.APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.web.reactive.function.server.RequestPredicates.*</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.web.reactive.function.server.RouterFunctions.route</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>PersonRepository</span> <span style=color:#000>repository</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>PersonHandler</span> <span style=color:#000>handler</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PersonHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>repository</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>RouterFunction</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>route</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>route</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>getPerson</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>listPeople</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>createPerson</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>PersonHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>listPeople</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ServerRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>createPerson</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ServerRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>getPerson</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ServerRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>RouterFunction을 실행하는 방법 중 하나는 HttpHandler로 변환해 내장된 서버 어댑터에 등록하는 것이다.</p><ul><li>RouterFunctions.toHttpHandler(RouterFunction)</li><li>RouterFunctions.toHttpHandler(RouterFunction, HandlerStrategies)</li></ul><h3 id=handlerfunction>HandlerFunction</h3><p>ServerRequest와 ServerResponse는 JDK 8 방식으로 HTTP 요청과 응답에 접근할 수 있는 불변(immutable) 인터페이스이다. 모든 요청, 응답 body 모두 리액티브 스트림 back pressure로 처리한다. request body는 리액터 Flux나 Mono로 표현한다.
response body는 Flux와 Mono를 포함한 어떤 리액티브 스트림 Publisher든 상관없다.</p><h4 id=serverrequest>ServerRequest</h4><p>ServerRequest로 HTTP 메소드, URI, 헤더, 쿼리 파라미터에 접근할 수 있으며, body를 추출할 수 있는 메소드를 제공한다.
다음은 request body를 Mono<string>으로 추출하는 예제다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>string</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>다음 예제는 body를 Flux<person>으로 추출한다. Person 객체는 JSON이나 XML 같은 직렬화된 데이터로 디코딩한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Flux</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>people</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToFlux</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>위 예제에서 사용한 메소드는 함수형 인터페이스 BodyExtractor를 받는 ServerRequest.body(BodyExtractor) 메소드의 축약 버전이다. BodyExtractors 유틸리티 클래스에 있는 인터페이스를 활용해도 된다. 예를 들면 앞의 예제는 아래와 같이 작성할 수도 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>string</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>BodyExtractors</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>Flux</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>people</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>BodyExtractors</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toFlux</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span></code></pre></div><p>아래 예제는 form 데이터에 접근하는 방법을 보여준다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>MultiValueMap</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;&gt;</span> <span style=color:#000>map</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>formData</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>다음은 multipart 데이터를 map으로 가져오는 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>MultiValueMap</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Part</span><span style=color:#ce5c00;font-weight:700>&gt;&gt;</span> <span style=color:#000>map</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>multipartData</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>다음은 multipart 데이터를 스트리밍 방식으로 한번에 하나씩 가져온다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Flux</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Part</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>parts</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>BodyExtractors</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toParts</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><h4 id=serverresponse>ServerResponse</h4><p>HTTP 응답은 ServerResponse로 접근할 수 있으며 이 인터페이션은 불변이기 때문에 build 메소드로 생성한다. 빌더로 헤더를 추가하거나 상태코드, body를 설정할 수 있다. 다음은 JSON 컨텐츠로 200(OK) 응답을 만드는 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>person</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ok</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>contentType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MediaType</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>다음 예제는 boby 없이 Location 헤더만 201(CREATED) 응답을 만든다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>URI</span> <span style=color:#000>location</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>created</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>location</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>hint 파라미터를 넘기면 사용하는 코덱에 따라 body 직렬화/역직렬화 방식을 커스텀 할 수 있다. 아래 예제처럼 Jackson JSON View를 지정할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ok</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>hint</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Jackson2CodecSupport</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>JSON_VIEW_HINT</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>MyJacksonView</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(...);</span>
</span></span></code></pre></div><h4 id=handler-classes>Handler Classes</h4><p>핸들러 평션은 다음처럼 람다로 만들 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>HandlerFunction</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>helloWorld</span> <span style=color:#ce5c00;font-weight:700>=</span>
</span></span><span style=display:flex><span><span style=color:#000>request</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ok</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>bodyValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Hello World&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>편리한 방식이긴 하지만 펑션을 여러 개 사용해야 한다면 인라인 람다로 만들기는 부담스럽다. 이럴 때는 핸들러 클래스로 관련 핸들러 펑션을 묶을 수 있다.
핸들러 클래스는 어노테이션 기반 애플리케이션의 @Controller와 비슷하다. 다음 예제는 리액티브 Person 레퍼지토리와 관련된 요청을 처리한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.http.MediaType.APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.web.reactive.function.server.ServerResponse.ok</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>PersonHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>PersonRepository</span> <span style=color:#000>repository</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>PersonHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PersonRepository</span> <span style=color:#000>repository</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>repository</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>repository</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>listPeople</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ServerRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Flux</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>people</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>repository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>allPeople</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ok</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>contentType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>people</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>createPerson</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ServerRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>person</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ok</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>repository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>savePerson</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>getPerson</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ServerRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>personId</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Integer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>pathVariable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>repository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getPerson</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>personId</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>flatMap</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>ok</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>contentType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>bodyValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>switchIfEmpty</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>notFound</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=validation>Validation</h4><p>함수형 프로그래밍 모델은 스프링 validation facilities를 사용해서 request body를 검증할 수 있다. 다음 예제는 Person에 대한 커스텀 스프링 Validator 구현체를 보여주고 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>PersonHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Validator</span> <span style=color:#000>validator</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PersonValidator</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>createPerson</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ServerRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>person</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>doOnNext</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>validate</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ok</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>repository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>savePerson</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>validate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span> <span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Errors</span> <span style=color:#000>errors</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>BeanPropertyBindingResult</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;person&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>validator</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>validate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasErrors</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ServerWebInputException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=routerfunction>RouterFunction</h3><p>라우터 펑션은 요청을 그에 맞는 HandlerFunction으로 라우팅한다. 라우팅 펑션을 직접 만들기보단, 보통 RouterFunctions 유틸리티 클래스를 사용한다.
RouterFunctions.route()가 리턴하는 빌더를 사용하거나 RouterFunctions.route(RequestPredicate, HandlerFunction)으로 직접 라우터를 만들 수 있다.
route() 빌더를 사용하면 static 메소드를 직접 임포트하지 않아도 된다. 예를 들어 GET 요청을 매핑할 수 있는 GET(String, HandlerFunction) 메소드와 POST 요청을 매핑하는 POST(String, HandlerFunction) 메소드가 있다.
빌더는 HTTP 메소드 외에 다른 조건으로 요청을 매핑할 수는 인터페이스도 제공한다. 각 HTTP 메소드는 RequestPredicate 파라미터를 받은 메소드를 오버로딩하고 있기 때문에 다른 조건을 추가할 수 있다.</p><h4 id=predicates>Predicates</h4><p>RequestPredicate를 직접 만들어도 되지만 요청 path, HTTP 메소드, 컨텐츠 타입 등 자주 사용하는 구현체는 RequestPredicates 유틸리티 클래스에 준비되어 있다. 다음은 유틸리티 클래스로 Accept 헤더 조건을 추가하는 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>RouterFunction</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>route</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RouterFunctions</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>route</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/hello-world&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MediaType</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>TEXT_PLAIN</span><span style=color:#ce5c00;font-weight:700>),</span>
</span></span><span style=display:flex><span><span style=color:#000>request</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ok</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>bodyValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Hello World&#34;</span><span style=color:#ce5c00;font-weight:700>)).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>여러 조건을 함께 사용할 수 있다.</p><ul><li>RequestPredicate.and(RequestPredicate) - 둘 다 만족해야 한다.</li><li>RequestPredicate.or(RequestPredicate) - 둘 중 하나만 만족하면 된다.
RequestPredicates가 제공하는 구현체도 이 조합으로 만든 것이 많다.
예를 들어 RequestPredicates.GET(String)은 RequestPredicates.method(HttpMethod)와 RequestPredicates.path(String) 조합이다. 위에 있는 예제도 빌더 내부에서 RequestPredicates.GET과 accept를 조합한 것이다.</li></ul><h4 id=routes>Routes</h4><p>라우터 평션은 정해진 순서대로 실행한다. 첫번째 조건과 일치하지 않으면 두번째를 실행하는 식이다.
따라서 구체적인 조건을 앞에 선언해야 한다. 어노테이션 프로그래밍 모델에선 자동으로 가장 구체적인 컨트롤러 메소드를 실행하지만 함수형 모델에서는 그렇지 않다는 점을 유의해야 한다.
build()를 호출하면 빌더에 정의한 모든 라우터 펑션을 RouterFunction 한 개로 합친다. 다음 방법으로도 여러 라우터 펑션을 조합할 수 있다.</p><ul><li>RouterFunctions.route() 빌더의 add(RouterFunction)</li><li>RouterFunction.and(RouterFunction)</li><li>RouterFunction.andRoute(RequestPredicate, HandlerFunction) - RouterFunctions.route()를 RouterFunction.and()로 감싸고 있는 축약 버전
다음 예제는 라우터 펑션 4개를 사용한다.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.http.MediaType.APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.web.reactive.function.server.RequestPredicates.*</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>PersonRepository</span> <span style=color:#000>repository</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>PersonHandler</span> <span style=color:#000>handler</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PersonHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>repository</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>RouterFunction</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>otherRoute</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>RouterFunction</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>route</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>route</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>getPerson</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>listPeople</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>createPerson</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>otherRoute</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=nested-routes>Nested Routes</h4><p>path가 같으면 대부분 같은 조건으로 사용하므로 라우터 평션을 그룹핑하는 경우가 많다. 앞의 예제는 라우터 펑션 세 개가 /person을 path 조건으로 사용했다.
어노테이션을 사용했다면 클래스 레벨이 @RequestMapping을 선언해 중복 코드를 줄일 수 있다. WebFlux.fn에선 path 메소드로 path 조건을 공유한다. 예를 들어 위 코드는 아래 예제처럼 라우터 펑션을 한번 감싸 개선할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>RouterFunction</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>route</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>route</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>builder</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>builder</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>getPerson</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>listPeople</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>createPerson</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>path가 가장 흔하기 하지만 빌더의 nest 메소드는 다른 조건도 감쌀 수 있다. 위 코드는 여전히 Accpet 헤더가 중복이다 nest 메소드를 함께 사용하면 코드를 한층 더 개선할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>RouterFunction</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>route</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>route</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>b1</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>b1</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>nest</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>b2</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>b2</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>getPerson</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>listPeople</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>createPerson</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=running-a-server>Running a Server</h4><p>HTTP 서버에선 어떻게 라우터 펑션을 실행할까? 간단하게는 다음과 같이 라우터 펑션을 HttpHandler로 변환할 수 있다.</p><ul><li>RouterFunctions.toHttpHandler(RouterFunction)</li><li>RouterFunctions.toHttpHandler(RouterFunction, HandlerStrategies)
리턴 받은 HttpHandler를 서버 가이드에 따라 서버 어댑터와 함께 사용하면 된다.</li></ul><p>스프링 부트에서도 사용하는 좀 더 일반적인 옵션은 WebFlux Config로 컴포넌트를 스프링 빈으로 정의하고 DispatcherHandler와 함께 실행하는 것이다.
프레임워크는 다음과 같은 컴포넌트로 함수형 엔드포인트를 지원하는데 웹플럭스 설정을 사용하면 이를 모두 스프링 빈으로 정의한다.</p><ul><li>RouterFunctionMapping: 스프링 설정에서 RouterFunction을 찾아 RouterFunction.andOther로 연결하고 최종 구성한 RouterFunction으로 요청을 라우팅한다.</li><li>HandlerFunctionAdapter: 요청에 매핑된 HandlerFunction을 DispatcherHandler가 실행하게 도와주는 간단한 어댑터</li><li>ServerResponseResultHandler: ServerResponse의 writeTo 메소드로 HandlerFunction 결과를 처리한다.
위 컴포넌트가 함수형 엔드포인트를 DispatcherHandler의 요청 처리 패턴에 맞춰주기 때문에 어노테이션 컨트롤러와 함께 사용할 수도 있다. 스프링 부트 웹플럭스 스타터도 이 방법으로 함수형 엔드포인트를 지원한다.</li></ul><h4 id=filtering-handler-functions>Filtering Handler Functions</h4><p>핸들러 펑션에 필터를 적용할 땐 라우터 빌더의 before, after, filter 메소드를 사용한다.
이 기능을 어노테이션 모델로 구현하면 @ControllerAdvice나 ServletFilter를 사용했을 것이다. 필터는 빌더의 모든 라우터 펑션에 적용된다.
이 말은 필터를 감싸져 있는 라우터에서 정의하면 상위 레벨에는 적용되지 않는다는 뜻이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>RouterFunction</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>route</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>route</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>b1</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>b1</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>nest</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>b2</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>b2</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>getPerson</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>listPeople</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>before</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>ServerRequest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>from</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>                <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>header</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;X-RequestHeader&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Value&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>                <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>()))</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>createPerson</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>after</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>logResponse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>라우터 빌더의 필터 메서드는 서버 요청과 핸들러 함수를 받아 서버 응답을 반환하는 함수인 핸들러 필터 함수를 받는다. 핸들러 함수 매개변수는 체인의 다음 요소를 나타낸다. 일반적으로 라우팅되는 핸들러이지만 여러 개의 필터가 적용되는 경우 다른 필터가 될 수도 있다.
이제 path를 보고 요청을 허가할지 말지를 결정하는 SecurityManager가 있다고 가정하고 간단한 보안 필터를 라우터에 적용해 보자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>SecurityManager</span> <span style=color:#000>securityManager</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>RouterFunction</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>route</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>route</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>b1</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>b1</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>nest</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>b2</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>b2</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>getPerson</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>listPeople</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handler</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>createPerson</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>filter</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>next</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>securityManager</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>allowAccessTo</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>()))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>next</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>handle</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ServerResponse</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>status</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UNAUTHORIZED</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>위 예제를 보면 next.handle(ServerRequest) 호출은 선택이라는 점을 알 수 있다. 여기선 접근을 허가할 때만 실행했다.
빌더의 filter 메소드 대신 RouterFunction.filter(HandlerFilterFunction)로 필터를 추가하는 방법도 있다.</p><pre tabindex=0><code>함수형 엔드포인트에서 CORS는 CorsWebFilter로 지원한다.
</code></pre><h2 id=참고자료>참고자료</h2><ul><li><a href=https://docs.spring.io/spring-framework/docs/5.3.27/reference/html/web-reactive.html#webflux-fn>The Spring Framework - Web Reactive - Functional Endpoints</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-2ebe607b413b815db2b35319495701e5>17 - 스프링 WebFlux의 WebClient와 논블로킹 처리</h1><div class=lead>스프링 WebFlux는 리액티브, 논블로킹 HTTP 요청을 위한 WebClient를 제공하며, 이를 통해 선언적인 프로그래밍이 가능하다. WebClient와 서버는 동일한 논블로킹 코덱을 사용해 요청과 응답을 인코딩 및 디코딩한다.</div><h1 id=webclient>WebClient</h1><p>스프링 WebFlux는 리액티브, 논블로킹 HTTP 요청을 위한 WebClient를 제공한다. 웹 클라이언트는 리액티브 타입을 사용하는 함수형 API이기 때문에 선언적인(declarative) 프로그래밍이 가능하다. 웹플럭스 클라이언트와 서버는 동일한 논블로킹 코덱으로 요청, 응답을 인코딩, 디코딩한다.</p><h2 id=설명>설명</h2><p>WebClient는 요청을 수행하기 위해 HTTP 클라이언트 라이브러리에 처리를 위임하며 아래와 같은 기능을 기본으로 제공한다.</p><ul><li>Reactor Netty</li><li>Jetty Reactive HttpClient</li><li>Apache HttpComponents</li><li>Others can be plugged via ClientHttpConnector.</li></ul><h3 id=configuration>Configuration</h3><p>WebClient는 가장 간단하게는 스태틱 팩토리 메소드로 만들 수 있다.</p><ul><li>WebClient.create()</li><li>WebClient.create(String baseUrl)</li></ul><p>위 메소드는 디폴트 세팅으로 Reactor Netty HttpClient를 사용하므로 클래스패스에 io.projectreactor.netty:reactor-netty가 있어야 한다.</p><p>다른 옵션을 사용하려면 WebClient.builder()를 사용한다.</p><ul><li>uriBuilderFactory: base URL을 커스텀한 UriBuilderFactory</li><li>defaultHeader: 모든 요청에 사용할 헤더</li><li>defaultCookie: 모든 요청에 사용할 쿠키</li><li>defaultRequest: 모든 요청을 커스텀할 Consumer</li><li>filter: 모든 요청에 사용할 클라이언트 필터</li><li>exchangeStrategies: HTTP 메시지 reader/writer 커스텀</li><li>clientConnector: HTTP 클라이언트 라이브러리 설정</li></ul><p>다음 예제는 HTTP 코덱을 설정한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>codecs</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>configurer</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>WebClient는 한 번 빌드하고 나면 상태를 변경할 수 없다. 단 다음 예제와 같이 원본 인스턴스는 그대로 두고 복사해와서 설정을 추가할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>client1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>filter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filterA</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>filter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filterB</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>client2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client1</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>mutate</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>filter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filterC</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>filter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filterD</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// client1 has filterA, filterB
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// client2 has filterA, filterB, filterC, filterD
</span></span></span></code></pre></div><h3 id=maxinmemorysize>MaxInMemorySize</h3><p>스프링 WebFlux는 애플리케이션 메모리 이슈를 방지하기 위해 코덱의 메모리 버퍼 사이즈를 제한한다. 디폴트는 256KB로 설정되어 있는데 버퍼가 부족하면 다음과 같은 에러가 보인다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>org</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>springframework</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>core</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>io</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>buffer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>DataBufferLimitException</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>Exceeded</span> <span style=color:#000>limit</span> <span style=color:#000>on</span> <span style=color:#000>max</span> <span style=color:#000>bytes</span> <span style=color:#000>to</span> <span style=color:#000>buffer</span>
</span></span></code></pre></div><p>다음 코드를 사용하면 모든 디폴트 코덱의 최대 버퍼 사이즈를 조절할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>webClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>codecs</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>configurer</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>configurer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>defaultCodecs</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>maxInMemorySize</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#0000cf;font-weight:700>1024</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#0000cf;font-weight:700>1024</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=reactor-netty>Reactor Netty</h3><p>HttpClient는 Reactor Netty 설정을 커스텀할 수 있는 간단한 설정 프리셋을 가지고 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>HttpClient</span> <span style=color:#000>httpClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>HttpClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>create</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>secure</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>sslSpec</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>...);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>webClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>clientConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ReactorClientHttpConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>httpClient</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=resources>Resources</h4><p>기본적으로 HttpClient는 reactor.netty.http.HttpResources에 묶여 있는 Reactor Netty의 글로벌 리소스를 사용한다. 이는 이벤트 루프 쓰레드와 커넥션 풀도 포함한다.</br>이벤트 루프로 동시성을 제어하려면 공유 리소스를 고정해 놓고 사용하는게 좋기 때문이다. 이 모드에서는 프로세스가 종료될 때까지 공유 자원을 active 상태로 유지한다.</br>서버가 프로세스와 함께 중단된다면 명시적으로 리소스를 종료시킬 필요는 없다. 하지만 프로세스 내에서 서버를 시작하거나 중단할 수 있다면(예를 들어 WAR로 배포한 스프링 MVC 애플리케이션) 다음 예제처럼 스프링이 관리하는 ReactorResourceFactory 빈을 globalResources=true롤 선언해야 스프링 ApplicationContext를 닫을 때 Reactor Netty 글러벌 리소스도 종료한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Bean</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ReactorResourceFactory</span> <span style=color:#000>reactorResourceFactory</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ReactorResourceFactory</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>원한다면 글로벌 Reactor Netty 리소스를 사용하지 않게 만들수도 있다. 하지만 아래 예제처럼 직접 모든 Reactor Netty 클라이언트와 서버 인스턴스가 공유 자원을 사용하게 만들어야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Bean</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ReactorResourceFactory</span> <span style=color:#000>resourceFactory</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>ReactorResourceFactory</span> <span style=color:#000>factory</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ReactorResourceFactory</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#000>factory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setUseGlobalResources</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>factory</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Bean</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>WebClient</span> <span style=color:#000>webClient</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>Function</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>HttpClient</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpClient</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>mapper</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Further customizations...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>};</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#000>ClientHttpConnector</span> <span style=color:#000>connector</span> <span style=color:#ce5c00;font-weight:700>=</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ReactorClientHttpConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>resourceFactory</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>mapper</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>clientConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>connector</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=timeouts>Timeouts</h4><p>다음은 커넥션 타임아웃을 설정하는 코드다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>io.netty.channel.ChannelOption</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>HttpClient</span> <span style=color:#000>httpClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>HttpClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>create</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>option</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ChannelOption</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CONNECT_TIMEOUT_MILLIS</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>10000</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>webClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>clientConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ReactorClientHttpConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>httpClient</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>다음은 read/write 타임아웃을 설정하는 코드다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>io.netty.handler.timeout.ReadTimeoutHandler</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>io.netty.handler.timeout.WriteTimeoutHandler</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>HttpClient</span> <span style=color:#000>httpClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>HttpClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>create</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>doOnConnected</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>conn</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>conn</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addHandlerLast</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ReadTimeoutHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addHandlerLast</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>WriteTimeoutHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>)));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Create WebClient...
</span></span></span></code></pre></div><p>다음은 모든 요청에 대한 타임아웃을 설정하는 코드다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>HttpClient</span> <span style=color:#000>httpClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>HttpClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>create</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>responseTimeout</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Duration</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ofSeconds</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Create WebClient...
</span></span></span></code></pre></div><p>다음은 특정 요청에 타임아웃을 설정하는 코드다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>create</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;https://example.org/path&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>httpRequest</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>httpRequest</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>HttpClientRequest</span> <span style=color:#000>reactorRequest</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>httpRequest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNativeRequest</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#000>reactorRequest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>responseTimeout</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Duration</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ofSeconds</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=jetty>Jetty</h3><p>다음은 Jetty HttpClient 설정을 커스텀하는 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>HttpClient</span> <span style=color:#000>httpClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HttpClient</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>httpClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCookieStore</span><span style=color:#ce5c00;font-weight:700>(...);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>webClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>clientConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>JettyClientHttpConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>httpClient</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>HttpClient는 전용 리소스(Executor. ByteBufferPool, Scheduler)를 생성해서 기본적으로 프로세스가 종료되거나 stop()을 호출할 때까지 유지한다.</p><p>다음 예제처럼 스프링이 관리하는 JettyResourceFactory 빈을 정의하면 여러 Jetty 클라이언트(혹은 서버) 인스턴스에서 리소스를 공유할 수 있고 스프링 ApplicationContext를 닫을 때 리소스도 종료시킬 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Bean</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>JettyResourceFactory</span> <span style=color:#000>resourceFactory</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>JettyResourceFactory</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Bean</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>WebClient</span> <span style=color:#000>webClient</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>HttpClient</span> <span style=color:#000>httpClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HttpClient</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Further customizations...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span>    <span style=color:#000>ClientHttpConnector</span> <span style=color:#000>connector</span> <span style=color:#ce5c00;font-weight:700>=</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>JettyClientHttpConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>httpClient</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>resourceFactory</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>clientConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>connector</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=httpcomponents>HttpComponents</h3><p>다음은 Apache HttpComponents HttpClient 설정을 커스텀하는 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>HttpAsyncClientBuilder</span> <span style=color:#000>clientBuilder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>HttpAsyncClients</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>custom</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>clientBuilder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setDefaultRequestConfig</span><span style=color:#ce5c00;font-weight:700>(...);</span>
</span></span><span style=display:flex><span><span style=color:#000>CloseableHttpAsyncClient</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>clientBuilder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>ClientHttpConnector</span> <span style=color:#000>connector</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HttpComponentsClientHttpConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>webClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>clientConnector</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>connector</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><h2 id=retrieve>retrieve()</h2><p>retrieve()는 response body를 받아 디코딩하는 간단한 메소드이다. 사용방법은 아래와 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>create</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;https://example.org&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>ResponseEntity</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/persons/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MediaType</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toEntity</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>혹은 body만 받아올 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>create</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;https://example.org&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/persons/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MediaType</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>다음 예제처럼 응답을 객체 스트림으로도 디코딩할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Flux</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Quote</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/quotes&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MediaType</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>TEXT_EVENT_STREAM</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToFlux</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Quote</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>4xx 또는 5xx 응답코드를 받으면 디폴트는 WebClientResponseException 또는 각 HTTP 상태에 해당하는 WebClientResponseException.BadRequest, WebClientResponseException.NotFound 등의 하위 exception을 던진다. 다음 예제처럼 onStatus 메소드로 상태별 exception을 커스텀할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/persons/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MediaType</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>onStatus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpStatus</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>is4xxClientError</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>...)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>onStatus</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpStatus</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>is5xxServerError</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>...)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h2 id=exchange>Exchange</h2><p>exchangeToMono() 및 exchangeToFlux() 메서드(또는 Kotlin의 awaitExchange {} 및 exchangeToFlow {})는 응답 상태에 따라 응답을 다르게 디코딩하는 등 더 많은 제어가 필요한 곳에 유용하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>entityMono</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/persons/1&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>accept</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MediaType</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exchangeToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>response</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>statusCode</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>equals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpStatus</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>OK</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic>// Turn to error
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createException</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>flatMap</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>error</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>});</span>
</span></span></code></pre></div><p>위의 방법을 사용할 때는 반환된 Mono 또는 Flux가 완료된 후 응답 본문을 확인하고 소비되지 않은 경우 메모리 및 연결 누수를 방지하기 위해 해제한다. 따라서 응답은 더 이상 다운스트림에서 디코딩할 수 없다. 필요한 경우 응답을 디코딩하는 방법을 선언하는 것은 제공된 함수에 달려 있다.</p><h2 id=request-body>Request Body</h2><p>request body는 Mono, 코틀린 코루틴 Deferred 등 ReactiveAdapterRegistry에 등록된 모든 비동기 타입으로 인코딩할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>personMono</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>post</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/persons/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>contentType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MediaType</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>personMono</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>다음 예제처럼 객체 스트림으로도 인코딩할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Flux</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>personFlux</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>post</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/persons/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>contentType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MediaType</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>APPLICATION_STREAM_JSON</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>personFlux</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>비동기 타입이 아닌 실제 값을 가지고 있다면 bodyValue를 사용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Person</span> <span style=color:#000>person</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>post</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/persons/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>contentType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MediaType</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>APPLICATION_JSON</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=form-data>Form Data</h3><p>form 데이터를 보내려면 MultiValueMap&lt;String, String>을 body로 사용해야 한다. 이 때는 FormHttpMessageWriter가 자동으로 content-type을 application/x-www-form-urlencoded로 설정한다. 다음은 MultiValueMap&lt;String, String>을 사용하는 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>MultiValueMap</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>formData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>post</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/path&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>formData</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>BodyInserters를 사용하면 인라인으로 form 데이터를 만들 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.web.reactive.function.BodyInserters.*</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>post</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/path&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>fromFormData</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;k1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;v1&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>with</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;k2&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;v2&#34;</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=multipart-data>Multipart Data</h3><p>multipart 데이터를 보낼 때는 MultiValueMap&lt;String, ?>을 사용해서 각 value에 part 컨텐츠를 나타내는 Object 인스턴스나 part의 컨텐츠와 헤더를 나타내는 HttpEntity를 담아야 한다. MultipartBodyBuilder를 사용하면 편리하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>MultipartBodyBuilder</span> <span style=color:#000>builder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MultipartBodyBuilder</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>part</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;fieldPart&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;fieldValue&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>part</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;filePart1&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FileSystemResource</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;...logo.png&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>part</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;jsonPart&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Jason&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>part</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;myPart&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>part</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// Part from a server request
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#000>MultiValueMap</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpEntity</span><span style=color:#ce5c00;font-weight:700>&lt;?&gt;&gt;</span> <span style=color:#000>parts</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>일반적으로는 part별로 content-type을 명시하지 않아도 된다. Content Type은 직렬화할때 쓰는 HttpMessageWriter나 Resource의 경우 파일 확장자에 따라 자동으로 결정한다. 필요하다면 빌더 part 메소드 중 MediaType을 받는 메소드를 사용하면 된다.
MultiValueMap을 만들었다면 가장 간단하게는 다음 예제처럼 body 메소드로 WebClient에 넘길 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>MultipartBodyBuilder</span> <span style=color:#000>builder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>...;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>post</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/path&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>builder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>())</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><p>MultiValueMap에 전형적인 form 데이터(application/x-www-form-urlencoded) 등 String이 아닌 갓이 하나라도 들어있으면 content-type을 multipart/form-data로 설정하지 않아도 된다.
MultipartBodyBuilder를 사용하면 항상 HttpEntity로 감싸주면 된다. MultipartBodyBuilder 대신 BodyInserters를 사용하면 인라인으로 multipart 컨텐츠를 만들 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.web.reactive.function.BodyInserters.*</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>post</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/path&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>body</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>fromMultipartData</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;fieldPart&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;value&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>with</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;filePart&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>resource</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=filter>Filter</h3><p>다음 예제와 같이 WebClient.Builder를 통해 클라이언트 필터(ExchangeFilterFunction)를 등록하여 요청을 가로채고 수정할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>filter</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>next</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#000>ClientRequest</span> <span style=color:#000>filtered</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ClientRequest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>from</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>header</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;foo&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;bar&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>next</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exchange</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filtered</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>필터는 인증과 같은 교차 문제에 사용할 수 있다. 다음 예제에서는 정적 팩토리 메서드를 통한 기본 인증에 필터를 사용한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.web.reactive.function.client.ExchangeFilterFunctions.basicAuthentication</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>filter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>basicAuthentication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;user&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;password&#34;</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>필터는 기존 웹클라이언트 인스턴스를 변경하여 추가하거나 제거할 수 있으므로 원래 웹클라이언트에 영향을 주지 않는 새 웹클라이언트 인스턴스를 생성할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import static</span> <span style=color:#000>org.springframework.web.reactive.function.client.ExchangeFilterFunctions.basicAuthentication</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>webClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>mutate</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>filters</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>filterList</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>filterList</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>basicAuthentication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;user&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;password&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>WebClient는 일련의 필터 체인을 둘러싸고 있는 얇은 외피에 ExchangeFunction이 뒤따른다. 요청을 하고 상위 수준 객체와 인코딩하기 위한 워크플로우를 제공하며 응답 콘텐츠가 항상 소비되도록 하는 데 도움이 된다.</br>필터가 어떤 방식으로든 응답을 처리할 때는 항상 콘텐츠를 소비하거나 웹클라이언트로 다운스트림으로 전파하여 동일한 콘텐츠를 보장할 수 있도록 각별한 주의를 기울여야 한다.</br>다음 예제는 미승인 상태 코드를 처리하지만 예상 여부에 관계없이 모든 응답 콘텐츠가 공개되도록 하는 필터다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ExchangeFilterFunction</span> <span style=color:#000>renewTokenFilter</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>next</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>next</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exchange</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>flatMap</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>response</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>statusCode</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>HttpStatus</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>UNAUTHORIZED</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>releaseBody</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>                <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>then</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>renewToken</span><span style=color:#ce5c00;font-weight:700>())</span>
</span></span><span style=display:flex><span>                <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>flatMap</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>token</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>ClientRequest</span> <span style=color:#000>newRequest</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ClientRequest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>from</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>next</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>exchange</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>newRequest</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>                <span style=color:#ce5c00;font-weight:700>});</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>just</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>});</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=attributes>Attributes</h3><p>요청에 속성을 추가할 수 있다. 이 기능은 필터 체인을 통해 정보를 전달하고 특정 요청에 대한 필터의 동작에 영향을 주고자 할 때 편리하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>filter</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>next</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Optional</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>usr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>attribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;myAttribute&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;https://example.org/&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>attribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;myAttribute&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Void</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>모든 요청에 속성을 삽입할 수 있는 WebClient.Builder 수준에서 전역적으로 defaultRequest 콜백을 구성할 수 있으며, 이는 예를 들어 Spring MVC 애플리케이션에서 ThreadLocal 데이터를 기반으로 요청 속성을 채우는 데 사용될 수 있다.</p><h3 id=context>Context</h3><p>속성은 필터 체인에 정보를 전달하는 편리한 방법을 제공하지만 현재 요청에만 영향을 준다. 중첩된 추가 요청에 전파되는 정보를 전달하려면(예를 들어 flatMap을 통해), 또는 이후에 실행되는 요청에 전파되는 정보를 전달하려면(예를 들어 concatMap을 통해) Reactor Context를 사용해야 한다.</p><p>다음 예제는 리액터 컨텍스트를 리액티브 체인의 끝에 채워 모든 작업에 적용하는 것을 보여준다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>WebClient</span> <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>WebClient</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>builder</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>filter</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>next</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>deferContextual</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>contextView</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>String</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>contextView</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;foo&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>}))</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>build</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;https://example.org/&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>flatMap</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>body</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// perform nested request (context propagates automatically)...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>contextWrite</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>context</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#000>context</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;foo&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>...));</span>
</span></span></code></pre></div><h3 id=synchronous-use>Synchronous Use</h3><p>WebClient는 마지막에 결과를 블로킹하면 동기(synchronous)로 결과를 가져온다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Person</span> <span style=color:#000>person</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>block</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>persons</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/persons&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>bodyToFlux</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>collectList</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>block</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>하지만 API를 여러번 호출하면 각 응답을 따로 블로킹하기보다는 전체 결과를 합쳐서 기다리는게 더 효율적이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>personMono</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>personId</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>bodyToMono</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Hobby</span><span style=color:#ce5c00;font-weight:700>&gt;&gt;</span> <span style=color:#000>hobbiesMono</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>client</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>uri</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/person/{id}/hobbies&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>personId</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>retrieve</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>bodyToFlux</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Hobby</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>collectList</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>data</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Mono</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>zip</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>personMono</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>hobbiesMono</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>hobbies</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>map</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>LinkedHashMap</span><span style=color:#ce5c00;font-weight:700>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;person&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>put</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;hobbies&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>hobbies</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>map</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>block</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span></code></pre></div><p>위 코드는 단지 한 가지 예시일 뿐이다. 요청이 끝날때까지 블로킹 하지 않고 리액티브 파이프라인을 구축해서 상호독립적으로 원격 호출을 여러번 실행하는 다른 패턴과 연산자도 많다.</p><pre tabindex=0><code>스프링 MVC나 WebFlux 컨트롤러에서 Flux나 Mono를 사용한다면 블로킹할 필요가 없다. 단순히 컨트롤러 메소드에서 리액티브 타입을 리턴하기만 하면 된다. 코틀린 코루틴과 스프링 WebFlux에서도 마찬가지다. 컨트롤러 메소드에서 suspend 함수를 사용하거라 Flow를 리턴하면 된다.
</code></pre><p>참고자료</p><ul><li><a href=https://docs.spring.io/spring-framework/docs/5.3.27/reference/html/web-reactive.html#webflux-client>TThe Spring Framework - Web Reactive - WebClient</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-0ddb00a1ec9b767ebfb20ab06b1ef199>18 - Ajax 지원 서비스</h1><div class=lead>Ajax 지원 서비스는 J2EE 개발자가 쉽게 Ajax 기능을 구현할 수 있도록 AjaxTags 라이브러리를 기반으로 제공하며, 자주 사용하는 기능을 커스텀 태그 형태로 제공한다. 주요 기능으로는 자동완성, 연동된 셀렉트박스, 탭 패널 등이 있으며, 이를 위해 JSP 설정과 Controller에서 AjaxXmlBuilder로 데이터를 가공하여 처리한다.</div><h1 id=ajax-지원-서비스>Ajax 지원 서비스</h1><h2 id=개요>개요</h2><p>일반적으로 Ajax 기능은 javascript 언어로 개발하나, server-side 구현에 익숙한 J2EE 개발자들에게는 쉽지 않은 작업이 될 수 있다.
Ajax 지원 서비스에서는 Ajax를 이용해 자주 사용되는 기능을 custom tag형태로 제공한다.
기능은 오픈소스 라이브러리인 AjaxTags를 이용한다.</p><h2 id=설명>설명</h2><h3 id=설치>설치</h3><p><strong>시스템 환경 및 필요 라이브러리</strong></p><ul><li>JDK 1.5</li><li>Servlet container running Servlets 2.4+ and JSP 2.0+ (jsp-api 2.0,servlet-api 2.4)</li><li><a href=http://ajaxtags.sourceforge.net/>AjaxTags 라이브러리</a></li></ul><p><strong>설치 순서</strong></p><ol><li><a href="http://sourceforge.net/project/showfiles.php?group_id=140499">AjaxTags Download</a> 사이트에 가서 해당 라이브러리를 download한 후 WEB-INF/lib에 위치시킨다.</li><li>web.xml 설정.</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>sourceloader<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;servlet-class&gt;</span>net.sourceforge.ajaxtags.servlets.SourceLoader<span style=color:#204a87;font-weight:700>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;init-param&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>prefix<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>/ajaxtags<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/init-param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/servlet&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;servlet-mapping&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>sourceloader<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;url-pattern&gt;</span>/ajaxtags/js/*<span style=color:#204a87;font-weight:700>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/servlet-mapping&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;servlet-mapping&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>sourceloader<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;url-pattern&gt;</span>/ajaxtags/img/*<span style=color:#204a87;font-weight:700>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/servlet-mapping&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;servlet-mapping&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>sourceloader<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;url-pattern&gt;</span>/ajaxtags/css/*<span style=color:#204a87;font-weight:700>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></div><h3 id=ajaxtags-tag-reference>AjaxTags Tag Reference</h3><p><strong>ajax:autocomplete</strong></p><p>자동완성기능. 보통 검색 입력창에 prefix 문자를 입력하면 해당 추천 검색어를 보여주는 방식으로 이용.</p><table><thead><tr><th>파라미터</th><th>설명</th><th>필수여부</th></tr></thead><tbody><tr><td>baseUrl</td><td>자동완성기능을 위한 결과 데이터를 보내주는 server-side 액션을 위한 URL.</td><td>yes</td></tr><tr><td>source</td><td>추천 검색어 리스트를 보여줄 텍스트 필드 이름. 입력 필드에 추천 검색리스트를 보여준다면 target과 source를 동일하게 입력한다.</td><td>yes</td></tr><tr><td>target</td><td>사용자가 입력하는 텍스트 필드 이름.</td><td>yes</td></tr><tr><td>parameters</td><td>baseUrl에 추가할 파라미터들.여러개일 경우 comma로 구별한다.</td><td>yes</td></tr><tr><td>className</td><td>추천 검색리스트에 적용할 CSS 클래스이름</td><td>yes</td></tr><tr><td>indicator</td><td>Ajax 요청중일때 보여줄 표시.</td><td>no</td></tr><tr><td>minimumCharacters</td><td>Ajax 요청을 위한 최소 입력값.</td><td>no</td></tr><tr><td>preFunction</td><td>Ajax 요청이 시작되기 전에 동작하는 function 이름.</td><td>no</td></tr><tr><td>postFunction</td><td>Ajax 요청이 완료된 후에 동작하는 function 이름.</td><td>no</td></tr><tr><td>errorFunction</td><td>Ajax 요청 error시에 동작하는 function 이름.</td><td>no</td></tr></tbody></table><p><strong>ajax:select</strong></p><p>하나의 셀렉트박스에서 값을 변경하면 다른 셀렉트박스에 연관된 값으로 리스트를 구성. Linked SelectBox.</p><table><thead><tr><th>파라미터</th><th>설명</th><th>필수여부</th></tr></thead><tbody><tr><td>baseUrl</td><td>자동완성기능을 위한 결과 데이터를 보내주는 server-side 액션을 위한 URL.</td><td>yes</td></tr><tr><td>source</td><td>추천 검색어 리스트를 보여줄 텍스트 필드 이름. 입력 필드에 추천 검색리스트를 보여준다면 target과 source를 동일하게 입력한다.</td><td>yes</td></tr><tr><td>target</td><td>사용자가 입력하는 텍스트 필드 이름.</td><td>yes</td></tr><tr><td>parameters</td><td>baseUrl에 추가할 파라미터들.여러개일 경우 comma로 구별한다.</td><td>no</td></tr><tr><td>eventType</td><td>no</td><td></td></tr><tr><td>executeOnLoad</td><td>응답 데이터로 select box를 구성하는 중일때 구성중인지를 별도 표시를 할지 여부.[default=false]</td><td>no</td></tr><tr><td>defaultOptions</td><td>Ajax 응답값이 없을때 보여줄 기본 리스트. comma로 구별하여 작성한다.</td><td>no</td></tr><tr><td>preFunction</td><td>Ajax 요청이 시작되기 전에 동작하는 function 이름.</td><td>no</td></tr><tr><td>postFunction</td><td>Ajax 요청이 완료된 후에 동작하는 function 이름.</td><td>no</td></tr><tr><td>errorFunction</td><td>Ajax 요청 error시에 동작하는 function 이름.</td><td>no</td></tr><tr><td>parser</td><td>응답 데이터에 대한 parser.[default=ResponseHtmlParser]</td><td>no</td></tr></tbody></table><p><strong>ajax:tabPanel</strong></p><p>탭으로 구성된 페이지들 새로 고침 없이 보여 줄때.</p><table><thead><tr><th>파라미터</th><th>설명</th><th>필수여부</th></tr></thead><tbody><tr><td>id</td><td>tabPanel의 ID</td><td>yes</td></tr><tr><td>preFunction</td><td>Ajax 요청이 시작되기 전에 동작하는 function 이름.</td><td>no</td></tr><tr><td>postFunction</td><td>Ajax 요청이 완료된 후에 동작하는 function 이름.</td><td>no</td></tr><tr><td>errorFunction</td><td>Ajax 요청 error시에 동작하는 function 이름.</td><td>no</td></tr><tr><td>parser</td><td>응답 데이터에 대한 parser.[default=ResponseHtmlParser]</td><td>no</td></tr></tbody></table><p><strong>others</strong></p><p>이외에도 여러 기능이 있다. AjaxTags의 Tag 레퍼런스 및 사용법은 아래 AjaxTags 사이트에서 확인할 수 있다.</p><h3 id=공통적인-개발-작업>공통적인 개발 작업</h3><p>AjaxTags의 어떤 태그를 사용하던지, 아래의 작업은 공통적으로 발생한다.</p><h4 id=jsp>JSP</h4><p><strong>태그 라이브러리 선언</strong></p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ taglib prefix=&#34;ajax&#34; ri=&#34;http://ajaxtags.sourceforge.net/tags/ajaxtags&#34; %&gt;
</code></pre><p><strong>Javascript, CSS 선언</strong></p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/prototype.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/scriptaculous/scriptaculous.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/overlibmws/overlibmws.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/ajaxtags.js&#34;&gt;&lt;/script&gt;
&lt;link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/css/ajaxtags.css&#34; /&gt;
&lt;link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/css/displaytag.css&#34; /&gt;
</code></pre><h4 id=controller>Controller</h4><p>AjaxTags를 사용하기 위해서는 결과 데이터가 AjaxTags에서 데이터 형식(XML style)을 갖추어야 한다.
이를 위해 AjaxTags는 AjaxXmlBuilder라는 데이터 가공을 위한 API를 제공한다.
결과 데이터를 AjaxXmlBuilder를 이용해서 변환하는 작업을 View에서 할 수도 있지만, View의 갯수가 기능 단위로 추가될 수도 있으므로,
Controller에서 변환한 후에 Model 객체에 담아서 View로 보내고 View는 공통으로 하나를 사용하기를 권한다.</p><p><strong>org.ajaxtags.helpers.AjaxXmlBuilder</strong></p><p>ajaxXml model에 추가하기</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Department</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>deptList</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDepartmentList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>param</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>AjaxXmlBuilder</span> <span style=color:#000>ajaxXmlBuilder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>AjaxXmlBuilder</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Iterator</span> <span style=color:#000>iter</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>deptList</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>iterator</span><span style=color:#ce5c00;font-weight:700>();</span> <span style=color:#000>iter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasNext</span><span style=color:#ce5c00;font-weight:700>();)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Department</span> <span style=color:#000>dept</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Department</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>iter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>next</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#000>ajaxXmlBuilder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addItem</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>dept</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDeptname</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>dept</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getDeptid</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;ajaxXml&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>ajaxXmlBuilder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span></code></pre></div><p>결과 데이터는 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;ajax-response&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;response&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;item&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;name&gt;</span>점심메뉴기획팀<span style=color:#204a87;font-weight:700>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;value&gt;</span>1200<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/item&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;item&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;name&gt;</span>야근금지역량팀<span style=color:#204a87;font-weight:700>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;value&gt;</span>1300<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/item&gt;</span>
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/response&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/ajax-response&gt;</span>
</span></span></code></pre></div><h4 id=view>View</h4><p>JSP 페이지에 프린트되는 일반적인 응답방식이 아니므로, 응답 처리를 위한 공통 View를 만들어야 한다.
결과데이터의 형식(XML)을 응답 객체에 설정한다.
Controller에서 보낸 Model객체의 결과데이터를 꺼내 write한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.view</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>java.io.PrintWriter</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>java.util.Map</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>javax.servlet.http.HttpServletRequest</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>javax.servlet.http.HttpServletResponse</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.web.servlet.view.AbstractView</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>AjaxXmlView</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractView</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>renderMergedOutputModel</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setContentType</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;text/xml&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setHeader</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Cache-Control&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;no-cache&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setCharacterEncoding</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;UTF-8&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>PrintWriter</span> <span style=color:#000>writer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getWriter</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>writer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>write</span><span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;ajaxXml&#34;</span><span style=color:#ce5c00;font-weight:700>));</span>  <span style=color:#8f5902;font-style:italic>//Model Attribute 이름은 공통으로 사용하는 것으로...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>writer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>close</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=예제>예제</h3><h4 id=ajaxautocomplete>ajax:autocomplete</h4><p>사원 정보 조회 페이지에서, 조회 조건중에 하나인 이름 필드에 자동완성기능(autocomplete)을 적용해 보자.
검색하려는 이름을 입력하기 시작하면, 입력값에 해당하는 prefix를 가진 이름들이 추천 리스트로 나온다.</p><p><img src=../images/ajax-autocomplete-sample.png alt=ajax-autocomplete-sample></p><p><strong>JSP</strong></p><p>/easycompany/webapp/WEB-INF/jsp/employeelist.jsp</p><pre tabindex=0><code class=language-jsp data-lang=jsp>...
&lt;%@ taglib prefix=&#34;ajax&#34; uri=&#34;http://ajaxtags.sourceforge.net/tags/ajaxtags&#34; %&gt;
...
&lt;!--Ajax Tags--&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/prototype.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/scriptaculous/scriptaculous.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/overlibmws/overlibmws.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/ajaxtags.js&#34;&gt;&lt;/script&gt;
&lt;link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/css/ajaxtags.css&#34; /&gt;
&lt;link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/css/displaytag.css&#34; /&gt;
...
&lt;form:form commandName=&#34;searchCriteria&#34; action=&#34;/easycompany/employeeList.do&#34;&gt;
&lt;table width=&#34;50%&#34; border=&#34;1&#34;&gt;
	&lt;tr&gt;
		&lt;td&gt;사원번호 :  &lt;form:input path=&#34;searchEid&#34;/&gt; &lt;/td&gt;
		&lt;td&gt;부서번호 : &lt;form:input path=&#34;searchDid&#34;/&gt; &lt;/td&gt;
		&lt;td&gt;이름 :   &lt;form:input path=&#34;searchName&#34;/&gt;
		&lt;/td&gt;
		&lt;td&gt;&lt;input type=&#34;submit&#34; value=&#34;검색&#34; onclick=&#34;this.disabled=true,this.form.submit();&#34; /&gt;&lt;/td&gt;
	&lt;/tr&gt;	
&lt;/table&gt;
&lt;/form:form&gt;
 
&lt;ajax:autocomplete 
  baseUrl=&#34;${pageContext.request.contextPath}/suggestName.do&#34; 
  source=&#34;searchName&#34; 
  target=&#34;searchName&#34; 
  className=&#34;autocomplete&#34; 
  minimumCharacters=&#34;1&#34; /&gt;
...
</code></pre><p><strong>Controller</strong></p><p>com.easycompany.controller.annotation.AjaxController</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.annotation</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>net.sourceforge.ajaxtags.xml.AjaxXmlBuilder</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>com.easycompany.view.AjaxXmlView</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>AjaxController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>EmployeeService</span> <span style=color:#000>employeeService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DepartmentService</span> <span style=color:#000>departmentService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/suggestName.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>suggestName</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@RequestParam</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;searchName&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>String</span> <span style=color:#000>searchName</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>ModelAndView</span> <span style=color:#000>model</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>AjaxXmlView</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>nameList</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>employeeService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNameListForSuggest</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>searchName</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>AjaxXmlBuilder</span> <span style=color:#000>ajaxXmlBuilder</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>AjaxXmlBuilder</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>for</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>nameList</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>			<span style=color:#000>ajaxXmlBuilder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addItem</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;ajaxXml&#34;</span><span style=color:#ce5c00;font-weight:700>,</span><span style=color:#000>ajaxXmlBuilder</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toString</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>한글처리설정</strong></p><p>위 예제에서 보면 <code>'/suggestName.do?searchName=김'</code> 같이, 사원 이름 prefix값이 파라미터로 전달되는데,
파라미터 값이 한글인 경우 제대로 처리되기 위해서는, <code>{Tomcat DIR}/conf/server.xml</code>에 인코딩 처리를 해줘야 한다.
UTF-8 인코딩을 한다면, <code>&lt;Connector/></code> 태그에 URIEncoding=“utf-8”을 추가하면 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;Connector</span> <span style=color:#c4a000>port=</span><span style=color:#4e9a06>&#34;8080&#34;</span> <span style=color:#c4a000>maxHttpHeaderSize=</span><span style=color:#4e9a06>&#34;8192&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#c4a000>maxThreads=</span><span style=color:#4e9a06>&#34;150&#34;</span> <span style=color:#c4a000>minSpareThreads=</span><span style=color:#4e9a06>&#34;25&#34;</span> <span style=color:#c4a000>maxSpareThreads=</span><span style=color:#4e9a06>&#34;75&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#c4a000>enableLookups=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#c4a000>redirectPort=</span><span style=color:#4e9a06>&#34;8443&#34;</span> <span style=color:#c4a000>acceptCount=</span><span style=color:#4e9a06>&#34;100&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#c4a000>connectionTimeout=</span><span style=color:#4e9a06>&#34;20000&#34;</span> <span style=color:#c4a000>disableUploadTimeout=</span><span style=color:#4e9a06>&#34;true&#34;</span> <span style=color:#c4a000>URIEncoding=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;Connector</span> <span style=color:#c4a000>port=</span><span style=color:#4e9a06>&#34;8009&#34;</span> 
</span></span><span style=display:flex><span>               <span style=color:#c4a000>enableLookups=</span><span style=color:#4e9a06>&#34;false&#34;</span> <span style=color:#c4a000>redirectPort=</span><span style=color:#4e9a06>&#34;8443&#34;</span> <span style=color:#c4a000>protocol=</span><span style=color:#4e9a06>&#34;AJP/1.3&#34;</span> <span style=color:#c4a000>URIEncoding=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h4 id=ajaxselect>ajax:select</h4><p>사원 정보 수정(입력) 페이지에서,
상위 부서 정보 select box에서 한 부서를 선택하면, 하위 부서 정보 select box는 해당 상위 부서에 속한 하위 부서 정보들로 옵션을 구성한다.</p><p><img src=../images/ajax-select-sample.png alt=ajax-select-sample></p><p><strong>JSP</strong></p><p>/easycompany/webapp/WEB-INF/jsp/addemployee.jsp, /easycompany/webapp/WEB-INF/jsp/modifyemployee.jsp</p><pre tabindex=0><code class=language-jsp data-lang=jsp>...
&lt;%@ taglib prefix=&#34;ajax&#34; uri=&#34;http://ajaxtags.sourceforge.net/tags/ajaxtags&#34; %&gt;
...
&lt;!--Ajax Tags--&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/prototype.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/scriptaculous/scriptaculous.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/overlibmws/overlibmws.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/ajaxtags.js&#34;&gt;&lt;/script&gt;
&lt;link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/css/ajaxtags.css&#34; /&gt;
&lt;link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/css/displaytag.css&#34; /&gt;
...
&lt;form:form commandName=&#34;employee&#34;&gt;
...
	&lt;tr&gt;
		&lt;th&gt;부서번호&lt;/th&gt;
		&lt;td&gt;
			&lt;form:select path=&#34;superdeptid&#34;&gt;
				&lt;option value=&#34;&#34;&gt;상위부서를 선택하세요.&lt;/option&gt;
				&lt;form:options items=&#34;${deptInfoOneDepthCategory}&#34; /&gt;
			&lt;/form:select&gt;
			&lt;form:select path=&#34;departmentid&#34;&gt;
				&lt;option value=&#34;&#34;&gt;근무부서를 선택하세요.&lt;/option&gt;
				&lt;form:options items=&#34;${deptInfoTwoDepthCategory}&#34; /&gt;
			&lt;/form:select&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
...
&lt;/form:form&gt;
 
&lt;ajax:select 
    baseUrl=&#34;${pageContext.request.contextPath}/autoSelectDept.do&#34;  
    parameters=&#34;depth=2,superdeptid={superdeptid}&#34; 
    source=&#34;superdeptid&#34; 
    target=&#34;departmentid&#34; 
    emptyOptionName=&#34;Select model&#34;/&gt;
...
</code></pre><h4 id=ajaxtabpanel-ajaxtab>ajax:tabPanel, ajax:tab</h4><p>부서정보 페이지에서 각 상위부서에 속한 하위부서리스트를 보여줄때, tab으로 처리해서 보여준다.</p><p><img src=../images/ajax-tabpanel-sample.png alt=ajax-tabpanel-sample></p><p><strong>JSP</strong></p><p>/easycompany/webapp/WEB-INF/jsp/departmentlist.jsp</p><pre tabindex=0><code class=language-jsp data-lang=jsp>...
&lt;%@ taglib prefix=&#34;ajax&#34; uri=&#34;http://ajaxtags.sourceforge.net/tags/ajaxtags&#34; %&gt;
...
&lt;!--Ajax Tags--&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/prototype.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/scriptaculous/scriptaculous.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/overlibmws/overlibmws.js&#34;&gt;&lt;/script&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/js/ajaxtags.js&#34;&gt;&lt;/script&gt;
&lt;link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/css/ajaxtags.css&#34; /&gt;
&lt;link type=&#34;text/css&#34; rel=&#34;stylesheet&#34; href=&#34;&lt;%=request.getContextPath()%&gt;/ajaxtags/css/displaytag.css&#34; /&gt;
...
		&lt;ajax:tabPanel id=&#34;departmentTab&#34;&gt;
		&lt;c:forEach items=&#34;${departmentlist}&#34; var=&#34;departmentinfo&#34; varStatus=&#34;status&#34;&gt;
			&lt;c:choose&gt;
				&lt;c:when test=&#34;${status.first}&#34;&gt;
			        &lt;ajax:tab caption=&#34;${departmentinfo.deptname}&#34; 
					  baseUrl=&#34;/easycompany/subDepartmentList.do?superdeptid=${departmentinfo.deptid}&amp;depth=2&#34;
					  defaultTab=&#34;true&#34;/&gt;
				&lt;/c:when&gt;
				&lt;c:otherwise&gt;
				&lt;ajax:tab caption=&#34;${departmentinfo.deptname}&#34; 
					  baseUrl=&#34;/easycompany/subDepartmentList.do?superdeptid=${departmentinfo.deptid}&amp;depth=2&#34;/&gt;
				&lt;/c:otherwise&gt;
			&lt;/c:choose&gt;
		&lt;/c:forEach&gt;
		&lt;/ajax:tabPanel&gt;
...
</code></pre><h2 id=참고자료>참고자료</h2><ul><li><a href=http://ajaxtags.sourceforge.net/index.html>AjaxTags Web Site</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-3910939c1a51aaefec093fee2eff210d>19 - Internationalization(국제화)</h1><div class=lead>Spring MVC는 Cookie, Session, AcceptHeader를 이용한 LocaleResolver를 제공하며, 다국어 메시지는 ResourceBundleMessageSource를 통해 관리된다. 사용자는 LocaleChangeInterceptor를 통해 언어를 변경하고, JSP에서 <code>&lt;spring:message></code> 태그로 해당 언어에 맞는 메시지를 표시할 수 있다.</div><h1 id=internationalization국제화>Internationalization(국제화)</h1><h2 id=개요>개요</h2><p>전자정부 표준 프레임워크에서는 Spring MVC 에서 제공하는 LocaleResolver를 이용한다.
우리는 여기서 LocaleResolver를 알아보고 적용하는 설정과 다국어가 적용된 message resource 를 가져와 활용하는 것을 보도록 하겠다.
Spring MVC 는 다국어를 지원하기 위하여 아래와 같은 종류의 LocaleResolver 를 제공하고 있다.</p><ul><li>CookieLocaleResolver<ul><li>쿠키를 이용한 locale정보 사용</li></ul></li><li>SessionLocaleResolver<ul><li>세션을 이용한 locale정보 사용</li></ul></li><li>AcceptHeaderLocaleResolver<ul><li>클라이언트의 브라우져에 설정된 locale정보 사용</li></ul></li></ul><p><strong>Bean 설정 파일에 정의하지 않을 경우 AcceptHeaderLocaleResolver 를 default 로 적용된다.</strong></p><h2 id=설명>설명</h2><h3 id=3가지의-localeresolver>3가지의 LocaleResolver</h3><h4 id=cookielocaleresolver>CookieLocaleResolver</h4><p>CookieLocaleResolver 를 설정하는 경우 사용자의 쿠키에 설정된 Locale 을 읽어 들인다.
samlple-servlet.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;localeResolver&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.i18n.CookieLocaleResolver&#34;</span> <span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cookieName&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;clientlanguage&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>   
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cookieMaxAge&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;100000&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;cookiePath&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;web/cookie&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>다음과 같은 속성을 사용할 수 있다.</p><table><thead><tr><th>속성</th><th>기본값</th><th>설명</th></tr></thead><tbody><tr><td>cookieName</td><td>classname + locale</td><td>쿠키 명</td></tr><tr><td>cookieMaxAge</td><td>integer.MAX_INT</td><td>-1 로 해두면 브라우저를 닫을 때 없어짐</td></tr><tr><td>cookiepath</td><td>/</td><td>Path 를 지정하면 해당하는 Path와 그 하위 Path 에서만 참조</td></tr></tbody></table><h4 id=sessionlocaleresolver>SessionLocaleResolver</h4><p>requst가 가지고 있는 session으로 부터 locale 정보를 가져온다.
samlple-servlet.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;localeResolver&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.i18n.SessionLocaleResolver&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h4 id=acceptheaderlocaleresolver>AcceptHeaderLocaleResolver</h4><p>사용자의 브라우저에서 보내진 request 의 헤더에 accept-language 부분에서 Locale 을 읽어 들인다. 사용자의 브라우저의 Locale 을 나타낸다.
samlple-servlet.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;localeResolver&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.i18n.AcceptHeaderLocaleResolver&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h3 id=xml-설정>XML 설정</h3><h4 id=web-configuration>Web Configuration</h4><p>Web 을 통해 들어오는 요청을 Charset UTF-8 적용한다.</p><p>CharacterEncodingFilter 을 이용하여 encoding 할 수 이도록 아래와 같이 세팅한다.</p><p><strong>web.xml</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;filter&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>&lt;filter-name&gt;</span>encoding-filter<span style=color:#204a87;font-weight:700>&lt;/filter-name&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>&lt;filter-class&gt;</span>
</span></span><span style=display:flex><span>           org.springframework.web.filter.CharacterEncodingFilter
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>&lt;/filter-class&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>&lt;init-param&gt;</span>
</span></span><span style=display:flex><span>           <span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>encoding<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>           <span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>UTF-8<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>&lt;/init-param&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;/filter&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;filter-mapping&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;filter-name&gt;</span>encoding-filter<span style=color:#204a87;font-weight:700>&lt;/filter-name&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;url-pattern&gt;</span>/*<span style=color:#204a87;font-weight:700>&lt;/url-pattern&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&lt;/filter-mapping&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h4 id=spring-configuration>Spring Configuration</h4><p>사용자의 브라우저의 Locale 정보를 이용하지 않고 사용자가 선택하여 언어를 직접 선택할 수 있도록 구현하려 한다면 CookieLocaleResolver 나 SessionLocaleResolver 를 이용한다. 먼저 다국어를 지원해야 하므로 메세지를 MessageSource 로 추출하여 구현해야 한다.
messageSource는 아래와 같이 설정하였다.</p><p><strong>samlple-servlet.xml</strong></p><p>context-common.xml 등에 설정된 경우 설정할 필요는 없다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;messageSource&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.context.support.ResourceBundleMessageSource&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;basenames&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;value&gt;</span>classpath:/message/message<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h3 id=xml-설정-1>XML 설정</h3><p>message properties 파일은 아래와 같다.
locale에 따라 ko, en 으로 구분하였다.
message_ko.properties</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#c4a000>view.category</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>카테고리</span>
</span></span></code></pre></div><p>message_en.properties</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#c4a000>view.category</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>category</span>
</span></span></code></pre></div><p>ResourceBundleMessageSource 는 beannames 명으로 messages 을 받아오는데 디폴트의 경우는 messages.properties 에서 message를 받아오고 locale 이 한국어일 경우는 messages_ko_KRproperties 에서 받아오고 영어일 경우는 messages_en_US.properties 에서 받아온다. 아래와 같이 localeResover 과 localeChangeInterceptor 를 등록하고 Annotation 기반에서 동작할 수 있도록 <strong>DefaultAnnotationHandlerMapping</strong> 에 interceptor 로 등록을 해준다.</p><p><strong>samlple-servlet.xml</strong> (Spring 3.0이하)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 세션을 이용한 Locale 이용시--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;localeResolver&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.i18n.SessionLocaleResolver&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 쿠키를 이용한 Locale 이용시  
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;bean id=&#34;localeResolver&#34; class=&#34;org.springframework.web.servlet.i18n.CookieLocaleResolver&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;localeChangeInterceptor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.i18n.LocaleChangeInterceptor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;paramName&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;language&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;annotationMapper&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;interceptors&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;localeChangeInterceptor&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p><strong>samlple-servlet.xml</strong> (Spring 3.1이상, 실행환경 대부분 버전이 해당된다.)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 세션을 이용한 Locale 이용시--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;localeResolver&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.i18n.SessionLocaleResolver&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 쿠키를 이용한 Locale 이용시  
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;bean id=&#34;localeResolver&#34; class=&#34;org.springframework.web.servlet.i18n.CookieLocaleResolver&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;localeChangeInterceptor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.i18n.LocaleChangeInterceptor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;paramName&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;language&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;webBindingInitializer&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.com.cmm.web.EgovBindingInitializer&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;interceptors&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;localeChangeInterceptor&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p><strong>설정 주의사항</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;mvc:annotation-driven/&gt;</span>
</span></span></code></pre></div><p>위의 내용이 설정되어 있을 경우 상단의 RequestMappingHandlerAdapter, RequestMappingHandlerMapping 설정이 적용되지 않는다. <code>mvc:annotation-driven</code>이 기본 설정으로 위 bean을 생성하므로 servlet xml에 선언되어 있을 경우 주석 처리한다. 세부 내용은 Spring MVC Tag Configuration 을 참고한다.
<code>mvc:annotation-driven</code>을 사용하려면 인터셉터를 명시적으로 선언해야 한다. RequestMappingHandlerAdapter, RequestMappingHandlerMapping Bean의 설정 내용을 삭제하고, 아래의 코드를 추가한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;mvc:interceptors&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;mvc:interceptor&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;mvc:mapping</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/**&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;localeChangeInterceptor&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.i18n.LocaleChangeInterceptor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;paramName&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;language&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>	    <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/mvc:interceptor&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/mvc:interceptors&gt;</span>
</span></span></code></pre></div><p>SessionLocaleResolver 를 이용하여 위와 같이 하였을 경우 Locale 결정은 <strong>language</strong> 로 Request Parameter 로 넘기게 된다. 카테고리 용어가 영어와 한글로 바뀌는 것을 아래와 같이 볼 수 있다.</p><p>리스트를 보여주는 화면에 예를 보자면 Spring 메시지 태그를 이용하여</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;spring:message</span> <span style=color:#c4a000>code=</span><span style=color:#4e9a06>&#34;view.category&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><p>으로 표현한다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ taglib prefix=&#34;spring&#34; uri=http://www.springframework.org/tags %&gt;
 
&lt;form:form commandName=&#34;message&#34; &gt;
....
		&lt;table border=&#34;1&#34; cellspacing=&#34;0&#34; class=&#34;boardList&#34; summary=&#34;List of Category&#34;&gt;
			&lt;thead&gt;
				&lt;tr&gt;
					&lt;th scope=&#34;col&#34;&gt;No.&lt;/th&gt;
					&lt;th scope=&#34;col&#34;&gt;
						&lt;input name=&#34;checkAll&#34; type=&#34;checkbox&#34; class=&#34;inputCheck&#34; title=&#34;Check All&#34; onclick=&#34;javascript:fncCheckAll();&#34;/&gt;
					&lt;/th&gt;
					&lt;th scope=&#34;col&#34;&gt;&lt;spring:message code=&#34;view.category&#34; /&gt; ID&lt;/th&gt;
					&lt;th scope=&#34;col&#34;&gt;&lt;spring:message code=&#34;view.category&#34; /&gt; 명&lt;/th&gt;
					&lt;th scope=&#34;col&#34;&gt;사용여부&lt;/th&gt;
					&lt;th scope=&#34;col&#34;&gt;Description&lt;/th&gt;
					&lt;th scope=&#34;col&#34;&gt;등록자&lt;/th&gt;
				&lt;/tr&gt;
			&lt;/thead&gt;
....
</code></pre><p>화면상으로 해당 페이지를 실행해보면 아래와 같다.</p><p>한글인 경우 :</p><pre tabindex=0><code>http://localhost:8080/sample-web/sale/listCategory.do?language=ko
</code></pre><p><img src=../images/internationalization-ko-sample.png alt=internationalization-ko></p><p>영어인 경우 :</p><pre tabindex=0><code>http://localhost:8080/sample-web/sale/listCategory.do?language=en
</code></pre><p><img src=../images/internationalization-en-sample.png alt=internationalization-en></p><p><strong>Java 소스내에서 locale 적용 메시지 가져오기</strong></p><p>참고로 MessageSource 는 아래와 같은 메소드로 이루어져 있다.(실제로 여기서의 구현체는 ResourceBundleMessageSource 임.)</p><p><img src=../images/internationalization-locale.png alt=internationalization-locale></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>msg</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>messageSource</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>messageKey</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>messageParameters</span><span style=color:#ce5c00;font-weight:700>,</span>	<span style=color:#000>defaultMessage</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>locale</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span></code></pre></div><h2 id=참고자료>참고자료</h2></div><div class=td-content style=page-break-before:always><h1 id=pg-4cc496746aaa077bb2f35dd989e2fea3>20 - Security Service</h1><div class=lead>입력값 유효성 검증을 위한 기능으로 Jakarta Commons Validator를 선택하여 Spring MVC와 연계해 활용하는 방법을 설명한다. 이를 통해 화면 처리 레이어에서 입력값 검증 기능을 제공하고, Spring Security를 활용한 공통 기반 레이어에서 인증 및 권한과 같은 보안 서비스를 지원한다.</div><h1 id=security-service>Security Service</h1><h2 id=개요>개요</h2><p>인증, 권한 같은 일반적인(통상적인) 개념의 Security 서비스는 Spring Security를 활용한 공통기반 레이어에서 제공한다.
화면 처리 레이어의 Security 서비스는 입력값 유효성 검증 기능을 제공한다.
입력값 유효성 검증(validation)을 위한 기능은 Valang, Jakarta Commons, Spring 등에서 제공하는데, 여기서는 기반 오픈소스로 Jakarta Commons Validator를 선택했다.
MVC 프레임워크인 Spring MVC와 Jakarta Commons Validator의 연계와 활용방안을 설명한다.</p><h2 id=설명>설명</h2><p>Jakarta Commons Validator는 필수값, 각종 primitive type(int,long,float…), 최대-최소길이, 이메일, 신용카드번호등의 값 체크등을 할 수 있도록 Template이 제공된다.
또한 client-side, server-side의 검증을 함께 할 수 있으며,
Configuration과 에러메시지를 client-side, server-side 별로 따로 하지 않고 한곳에 같이 쓰는 관리상의 장점이 있다.
자세한 설명은 아래의 문서를 참조하라.</p><ul><li><a href=./security-jakarta-commons-validator.md>Spring Framework에서 Commons Validator 사용</a> : 입력값을 Jakarta Commons Validator를 이용하여 client-side, server-side 검증(validation)함.</li><li><a href=./security-validation-add-rules-in-common-validator.md>Commons Validator에 validation rule 추가</a> : Commons Validator에 주민등록번호 validation rule을 추가해본다.</li></ul><h2 id=참고자료>참고자료</h2></div><div class=td-content style=page-break-before:always><h1 id=pg-4ab5f38785f99b8ed0ac7565fd474633>21 - Spring Framework + Jakarta Commons Validator</h1><div class=lead>Jakarta Commons Validator는 필수값, 길이, 이메일 등의 검증을 제공하며, Java와 JavaScript로 구현되어 클라이언트와 서버 양쪽에서 검증을 수행할 수 있다. Spring Framework에서는 Spring Modules를 통해 Commons Validator와 연동이 가능하며, 이를 통해 서버와 클라이언트 검증 설정을 통합적으로 관리할 수 있다. 본 문서는 설치 방법과 핵심 클래스(DefaultValidatorFactory, DefaultValidator), 설정 파일, 예제 프로젝트 적용 과정을 설명한다.</div><h1 id=spring-framework--jakarta-commons-validator>Spring Framework + Jakarta Commons Validator</h1><h2 id=개요>개요</h2><p>입력값 검증을 위한 Validation 기능은 Valang, Jakarta Commons, Spring 등에서 제공한다.<br>여기서는 Jakarta Commons Validator를 Spring Framework과 연동하여 사용하는 방법에 대해서 설명하고자 한다.<br>Jakarta Commons Validator는 필수값, 각종 primitive type(int,long,float…), 최대-최소길이, 이메일, 신용카드번호등의 값 체크등을 할 수 있도록 Template이 제공된다.<br>이 Template은 Java 뿐 아니라 Javascript로도 제공되어 client-side, server-side의 검증을 함께 할 수 있으며,
Configuration과 에러메시지를 client-side, server-side 별로 따로 하지 않고 한곳에 같이 쓰는 관리상의 장점이 있다.<br>Struts에서는 Commons Validator를 사용하기 위한 org.apache.struts.validator.ValidatorPlugIn 같은 플러그인 클래스를 제공하는데,
Spring에서는 Spring Modules 프로젝트에서 연계 모듈을 제공한다.<br>여기서는 server-side, client-side validation을 위해,
설치방법, Spring Module에서 제공하는 핵심 클래스인 DefaultValidatorFactory, DefaultValidator와 설정파일인 validator-rules.xml, validator.xml 에 대한 간략한 설명과
예제 프로젝트인 easycompany에 적용하는 과정을 설명한다.</p><h2 id=설명>설명</h2><h3 id=필요라이브러리>필요라이브러리</h3><ol><li>commons-validator : Ver 1.4.0 아래 4개의 파일에 대한 dependency가 있다.<ul><li>commons-beanutils : Ver 1.8.3</li><li>commons-digester : Ver 1.8</li><li>commons-logging : Ver 1.1.2</li><li>junit : Ver 3.8.2</li></ul></li><li><a href=http://www.egovframe.go.kr/maven/org/springmodules/spring-modules-validation/0.9/spring-modules-validation-0.9.jar>spring modules</a> : Ver 0.9 다운 받고 압축을 풀어 보면 여러 파일들이 있으나 여기서 필요한 건 spring-modules-validation.jar 뿐이다. 예제를 보려면 \samples\sources\spring-modules-validation-commons-samples-src.zip도 필요하다.</li><li>위에서 언급한 라이브러리들을 설치한다.</li></ol><h3 id=defaultvalidatorfactory-defaultbeanvalidator-설정>DefaultValidatorFactory, DefaultBeanValidator 설정</h3><p>Spring Validator와 Commons Validator의 연계를 위해 중요한 역할을 하는 클래스인 DefaultValidatorFactory, DefaultBeanValidator에 대해 간략하게 설명하자면 아래 표와 같다.</p><table><thead><tr><th>DefaultValidatorFactory</th><th>DefaultBeanValidator</th></tr></thead><tbody><tr><td>프로퍼티 &lsquo;validationConfigLocationsApache&rsquo;에 정의된 Validation rule을 기반으로 Commons Validator들의 인스턴스를 얻는다.</td><td>DefaultBeanValidator는 org.springframework.validation.Validator를 implements하고 있지만, DefaultValidatorFactory가 가져온 Commons Validator의 인스턴스를 이용해 validation을 수행한다. Controller에 validation 수행할때 이 DefaultBeanValidator를 참조하면 된다.</td></tr></tbody></table><p>아래 코드를 참조해 빈 정의 파일(예제에는 easycompany-servlet.xml)에 다음과 같이 ValidatorFactory,Validator,validator-rules.xml,validation.xml 파일을 등록한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Integration Apache Commons Validator by Spring Modules --&gt;</span>				
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;beanValidator&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springmodules.validation.commons.DefaultBeanValidator&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;validatorFactory&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;validatorFactory&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;validatorFactory&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springmodules.validation.commons.DefaultValidatorFactory&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;validationConfigLocations&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>                      <span style=color:#8f5902;font-style:italic>&lt;!-- validator-rules.xml, validator.xml의 위치--&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>/WEB-INF/conf/validator-rules.xml<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>&lt;value&gt;</span>/WEB-INF/conf/validator.xml<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h3 id=validator-rulesxml-설정>validator-rules.xml 설정</h3><p>validator-rules.xml은 application에서 사용하는 모든 validation rule에 대해 정의하는 파일이다.
예제에 있는 validator-rules.xml의 필수값 체크 부분을 보면 아래와 같이 작성되어 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;validator</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;required&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>classname=</span><span style=color:#4e9a06>&#34;org.springmodules.validation.commons.FieldChecks&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#c4a000>method=</span><span style=color:#4e9a06>&#34;validateRequired&#34;</span>
</span></span><span style=display:flex><span>         <span style=color:#c4a000>methodParams=</span><span style=color:#4e9a06>&#34;java.lang.Object,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                       org.apache.commons.validator.ValidatorAction,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                       org.apache.commons.validator.Field,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                       org.springframework.validation.Errors&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#c4a000>msg=</span><span style=color:#4e9a06>&#34;errors.required&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;javascript&gt;</span><span style=color:#8f5902;font-style:italic>&lt;![CDATA[
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>         .....
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            ]]&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;/javascript&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;/validator&gt;</span>
</span></span></code></pre></div><table><tr><th>name</th><td>validation rule(required,mask,integer,email…)</td></tr><tr><th>classname</th><td>validation check를 수행하는 클래스명(org.springmodules.validation.commons.FieldChecks)</td></tr><tr><th>method</th><td>validation check를 수행하는 클래스의 메소드명(validateRequired,validateMask…)</td></tr><tr><th>methodParams</th><td>validation check를 수행하는 클래스의 메소드의 파라미터</td></tr><tr><th>msg</th><td>에러 메시지 key</td></tr><tr><th>javascript</th><td>client-side validation을 위한 자바스크립트 코드</td></tr></table><p>Spring Modules에서 제공하는 validation rule에 따라 구성해보자.</p><p><strong>Spring Modules (0.9 기준)에서 제공하는 validation rule들은 아래와 같다.</strong></p><table><thead><tr><th>name(validation rule)</th><th>FieldCheck 클래스</th><th>FieldCheck 클래스의 메소드</th><th style=text-align:center>기능</th></tr></thead><tbody><tr><td>required</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateRequired</td><td style=text-align:center>필수값 체크</td></tr><tr><td>minlength</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateMinLength</td><td style=text-align:center>최소 길이 체크</td></tr><tr><td>maxlength</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateMaxLength</td><td style=text-align:center>최대 길이 체크</td></tr><tr><td>mask</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateMask</td><td style=text-align:center>정규식 체크</td></tr><tr><td>byte</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateByte</td><td style=text-align:center>Byte형 체크</td></tr><tr><td>short</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateShort</td><td style=text-align:center>Short형 체크</td></tr><tr><td>integer</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateInteger</td><td style=text-align:center>Integer형 체크</td></tr><tr><td>long</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateLong</td><td style=text-align:center>Long형 체크</td></tr><tr><td>float</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateFloat</td><td style=text-align:center>Float형 체크</td></tr><tr><td>double</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateDouble</td><td style=text-align:center>Double형 체크</td></tr><tr><td>date</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateDate</td><td style=text-align:center>Date형 체크</td></tr><tr><td>range</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateIntRange</td><td style=text-align:center>범위 체크</td></tr><tr><td>intRange</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateIntRange</td><td style=text-align:center>int형 범위 체크</td></tr><tr><td>floatRange</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateFloatRange</td><td style=text-align:center>Float형 범위체크</td></tr><tr><td>creditCard</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateCreditCard</td><td style=text-align:center>신용카드번호체크</td></tr><tr><td>email</td><td>org.springmodules.validation.commons.FieldChecks</td><td>validateEmail</td><td style=text-align:center>이메일체크</td></tr></tbody></table><p>validator-rules.xml을 직접 작성하는것 보다는 예제에 있는 파일을 참고하거나 copy해서 사용하면 편리하다.<br>spring-modules-0.9.zip을 압축을 풀어보면 예제코드가 있다.(\samples\sources\spring-modules-validation-commons-samples-src.zip)
예제코드의 validator-rules.xml(\webapp\WEB-INF\validator-rules.xml)에는 모든 validation rule이 이미 정의되어 있다.</p><p>org.springmodules.validation.commons.FieldChecks 클래스에는 필수값 체크, primitive 타입 체크등 여러 validation을 수행하는 메소드들이 있다.<br>FieldChecks 클래스 소스를 열어 보면 실제 validation 처리는 Commons Validator에 위임하고 있다.<br>따라서 주의 할점은 Commons Validator에서 제공하는 validation rule중에, FieldChecks 클래스가 제공하지 않는 rule도 있다는 것이다.<br>예를 들어 Commons Validator 1.3.1 에서는 URL이나 IP 관련 Validator를 제공하지만, Spring Modules의 FieldChecks 클래스에 해당 메소드가 없기 때문에,
새로운 FieldCheck 클래스를 추가한 후 validation-rules.xml에 클래스와 메소드를 등록해야 사용할 수 있다.<br>Spring Modules가 제공하는 validation rule외에 rule을 추가하는 방법에 대해서는 주민등록번호 validation rule 추가하기 를 참고하라.</p><h3 id=validatorxml-설정>validator.xml 설정</h3><p>validator.xml은 validation rule과 validation할 Form을 매핑한다.<br>form name과 field property의 name-rule은 Server-side와 Client-side인 경우에 따라 다르다.</p><p><strong>Server-side validation의 경우는,</strong><br>form name과 field property는 validation할 폼 클래스의 이름, 필드과 각각 매핑된다.(camel case)
폼 클래스가 Employee면 employee, DepartmentForm 이면 departmentForm을 form name으로 지정하라.</p><p><strong>Client-side의 경우는,</strong><br>form name은 JSP에서 설정한 &lt;validator:javascript formName=“employee” …/> 태그의 formName와 매핑되고, field property는 각각의 폼 필드의 이름과 일치하면 된다.</p><p><strong>따라서, Server-side, Client-side 둘 다 수행하려면,</strong><br>JSP의 &lt;validator:javascript formName=“employee” …/> 태그의 formName은 폼 클래스의 이름이 되어야 하고, JSP의 폼 필드들은 폼 클래스의 필드와 일치해야 한다.</p><p>depends는 해당 필드에 적용할 (validator-rules.xml에 정의된 rule name) validator를 의미한다.<br>&lt;arg key…>는 메시지 출력시 파라미터를 지정하는 값이다.<br>아래와 같이 작성했다면, Employee 클래스의 name 필드에 대해서 필수값 체크를, age 필드에 대해서 integer 체크를, email 필드에 대해선 필수값과 email 유효값 체크를 하겠다는 의미이다</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE form-validation PUBLIC 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>    &#34;-//Apache Software Foundation//DTD Commons Validator Rules Configuration 1.1//EN&#34; 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>    &#34;http://jakarta.apache.org/commons/dtds/validator_1_1.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;form-validation&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;formset&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;form</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;employee&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        	<span style=color:#204a87;font-weight:700>&lt;field</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;name&#34;</span> <span style=color:#c4a000>depends=</span><span style=color:#4e9a06>&#34;required&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        		<span style=color:#204a87;font-weight:700>&lt;arg0</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;employee.name&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/field&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;field</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;age&#34;</span> <span style=color:#c4a000>depends=</span><span style=color:#4e9a06>&#34;integer&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        		<span style=color:#204a87;font-weight:700>&lt;arg0</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;employee.age&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/field&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;field</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;email&#34;</span> <span style=color:#c4a000>depends=</span><span style=color:#4e9a06>&#34;required,email&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        		<span style=color:#204a87;font-weight:700>&lt;arg0</span> <span style=color:#c4a000>key=</span><span style=color:#4e9a06>&#34;employee.email&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;/field&gt;</span>		
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/form&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/formset&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/form-validation&gt;</span>
</span></span></code></pre></div><h3 id=server-side-validation>Server-Side Validation</h3><h4 id=controller>Controller</h4><p>Server-Side Validation을 위해 Controller에 validation 로직을 추가해 보자.<br>위 설정 파일에서 등록한 DefaultBeanValidator가 Controller에서 validation을 수행한다.<br>DefaultBeanValidator는 Commons Validator의 기능을 사용하지만 자신은 Spring Validator이기 때문에,
사용자는 Spring Validator를 사용하듯이 Controller에서 validation 코딩을 하면 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.annotation</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springmodules.validation.commons.DefaultBeanValidator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>UpdateEmployeeController</span> <span style=color:#ce5c00;font-weight:700>{</span>	
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DefaultBeanValidator</span> <span style=color:#000>beanValidator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateEmployee.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>updateEmployee</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;employee&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>Employee</span> <span style=color:#000>employee</span><span style=color:#ce5c00;font-weight:700>,</span>			
</span></span><span style=display:flex><span>			<span style=color:#000>BindingResult</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Model</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>beanValidator</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>validate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>employee</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//validation 수행
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasErrors</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#8f5902;font-style:italic>//만일 validation 에러가 있으면...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#ce5c00;font-weight:700>.....</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifyemployee&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#000>employeeManageService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updateEmployee</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>employee</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;changenotify&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>        
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=jsp>JSP</h4><p>Validation을 적용할 JSP를 작성한다.(modifyemployee.jsp)<br>form submit을 하면 이름, 나이, 이메일등의 입력값이 Employee 클래스에 바인딩이 되서 Controller에 전달이 되고,
Controller에 validation 수행 로직이 있으면 validator.xml 내용에 따라 validation이 이루어 진다.<br>만일 에러가 발생하면 &lt;form:error…/>에 에러에 해당하는 메시지를 출력한다. 에러 메시지에 관련해서는 아래 에러 메시지 등록을 참고하라.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form:form</span> <span style=color:#c4a000>commandName</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;employee&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        ....
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>이름<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>form:input</span> <span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;name&#34;</span> <span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#000;font-weight:700>/&gt;&lt;</span><span style=color:#204a87;font-weight:700>form:errors</span> <span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;name&#34;</span> <span style=color:#000;font-weight:700>/&gt;&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>비밀번호<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>form:input</span> <span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;password&#34;</span> <span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;10&#34;</span><span style=color:#000;font-weight:700>/&gt;&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>나이<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>form:input</span> <span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;age&#34;</span> <span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;10&#34;</span><span style=color:#000;font-weight:700>/&gt;&lt;</span><span style=color:#204a87;font-weight:700>form:errors</span> <span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;age&#34;</span> <span style=color:#000;font-weight:700>/&gt;&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>이메일<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>form:input</span> <span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;email&#34;</span> <span style=color:#c4a000>size</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;50&#34;</span><span style=color:#000;font-weight:700>/&gt;&lt;</span><span style=color:#204a87;font-weight:700>form:errors</span> <span style=color:#c4a000>path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;email&#34;</span> <span style=color:#000;font-weight:700>/&gt;&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span> <span style=color:#c4a000>width</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;80%&#34;</span> <span style=color:#c4a000>border</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;submit&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;LIST&#34;</span> <span style=color:#c4a000>onclick</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;location.href=&#39;/easycompany/employeeList.do&#39;&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>form:form</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><h4 id=에러-메시지-등록>에러 메시지 등록</h4><p>메시지 파일에 에러 메시지를 등록한다.<br>validation 에러가 발생하면 validator-rules.xml에서 정의했던 msg값으로 에러메시지의 key값을 찾아 해당하는 메시지를 출력해준다.<br>예를 들어, email validation에서 에러가 발생하면 msg값이 errors.email 이므로, “유효하지 않은 이메일 주소입니다.”라는 에러 메시지를 JSP에 있는 &lt;form:errors path=“email” /> 부분에 출력하게 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#c4a000>employee.name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>이름</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>employee.email</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>이메일</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>employee.age</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>나이</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>employee.password</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>비밀번호</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># -- validator errors --</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>errors.required</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>{0}은 필수 입력값입니다.</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>errors.minlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>{0}은 {1}자 이상 입력해야 합니다.</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>errors.maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>{0}은 {1}자 이상 입력할수 없습니다.</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>errors.invalid</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>{0}은 유효하지 않은 값입니다.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c4a000>errors.byte</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>{0}은  byte타입이어야 합니다.</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>errors.short</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>{0}은  short타입이어야 합니다.</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>errors.integer</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>{0}은 integer 타입이어야 합니다.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a40000>....</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c4a000>errors.email</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>유효하지 않은 이메일 주소입니다.</span>
</span></span></code></pre></div><h4 id=test>TEST</h4><p>이름 필드에 값을 비우고 submit하면, name에 필수값(required) validation rule이 설정되어 있으므로
아래와 같이 이름 필드 옆에 에러 메시지가 출력 될 것이다.</p><p><img src=../images/server-validate.jpg alt=server-validate></p><h3 id=client-side-validation>Client-Side Validation</h3><h4 id=validatorjsp-추가>validator.jsp 추가</h4><p>아래와 같은 내용의 validator.jsp를 작성한다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ page language=&#34;java&#34; contentType=&#34;javascript/x-javascript&#34; %&gt;
&lt;%@ taglib prefix=&#34;validator&#34; uri=&#34;http://www.springmodules.org/tags/commons-validator&#34; %&gt;
&lt;validator:javascript dynamicJavascript=&#34;false&#34; staticJavascript=&#34;true&#34;/&gt;
</code></pre><p>/validator.do로 호출하도록 Controller에서 메소드를 추가하고 requestmapping 한다.<br>validator.jsp를 http://localhost:8080/easycompany/validator.do 브라우져에서 호출해보면, validator-rules.xml에서 정의한 javascript 함수들이 다운로드 되거나 화면에 print 되는 걸 확인할 수 있을 것이다.<br>validator.jsp는 client-validation을 위해 validator-rules.xml에서 정의한 javascript 함수들을 로딩한다.<br>따라서 client-validation을 할 페이지에서는 이 validator.jsp을</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;c:url value=&#34;/validator.do&#34;/&gt;&#34;&gt;&lt;/script&gt;
</code></pre><p>같이 호출한다.</p><h4 id=jsp-설정taglibjavascript-추가>JSP 설정(taglib,javascript) 추가</h4><p>client-validation을 위해서는 해당 JSP에 아래와 같은 작업이 추가 되어야 한다. commons-validator taglib를 선언한다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;%@ taglib prefix=&#34;validator&#34; uri=&#34;http://www.springmodules.org/tags/commons-validator&#34; %&gt;
</code></pre><p>필요한 자바 스크립트 함수를 generate 하기 위한 코드를 추가 한다. validation-rules.xml에서 선언한 함수를 불러 오기 위해, 위에서 작성한 validator.jsp를 아래와 같이 호출한다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;c:url value=&#34;/validator.do&#34;/&gt;&#34;&gt;&lt;/script&gt;
</code></pre><p>위의 자바 스크립트 함수를 이용해 필요한 validation과 메시지 처리를 위한 자바 스크립트를 generate 하기 위한 코드를 추가 한다. formName에는 validator.xml에서 정의한 form의 이름을 써준다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;validator:javascript formName=&#34;employee&#34; staticJavascript=&#34;false&#34; xhtml=&#34;true&#34; cdata=&#34;false&#34;/&gt;
</code></pre><p>form submit시에 validateVO클래스명() 함수를 호출한다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>   ... onsubmit=&#34;return validateEmployee(this)&#34; &#34;&gt;
</code></pre><p>따라서 앞의 server-side validation에서 작성한 modifyemployee.jsp은 아래와 같이 변경된다.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>&lt;!-- commons-validator tag lib 선언--&gt;
&lt;%@ taglib prefix=&#34;validator&#34; uri=&#34;http://www.springmodules.org/tags/commons-validator&#34; %&gt;
 
....
&lt;!--for including generated Javascript Code(in validation-rules.xml)--&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;&lt;c:url value=&#34;/validator.do&#34;/&gt;&#34;&gt;&lt;/script&gt;
&lt;!--for including generated Javascript Code(validateEmployee(), formName:validator.xml에서 정의한 form의 이름)--&gt;
&lt;validator:javascript formName=&#34;employee&#34; staticJavascript=&#34;false&#34; xhtml=&#34;true&#34; cdata=&#34;false&#34;/&gt;
&lt;script type=&#34;text/javascript&#34;&gt;
	function save(form){	
		if(!validateEmployee(form)){
			return;
		}else{
			form.submit();
		}
	}
&lt;/script&gt;
....
&lt;form:form commandName=&#34;employee&#34;&gt;
&lt;table&gt;
        ....
	&lt;tr&gt;
		&lt;th&gt;이름&lt;/th&gt;
		&lt;td&gt;&lt;form:input path=&#34;name&#34; size=&#34;20&#34;/&gt;&lt;form:errors path=&#34;name&#34; /&gt;&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;th&gt;비밀번호&lt;/th&gt;
		&lt;td&gt;&lt;form:input path=&#34;password&#34; size=&#34;10&#34;/&gt;&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;th&gt;나이&lt;/th&gt;
		&lt;td&gt;&lt;form:input path=&#34;age&#34; size=&#34;10&#34;/&gt;&lt;form:errors path=&#34;age&#34; /&gt;&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;th&gt;이메일&lt;/th&gt;
		&lt;td&gt;&lt;form:input path=&#34;email&#34; size=&#34;50&#34;/&gt;&lt;form:errors path=&#34;email&#34; /&gt;&lt;/td&gt;
	&lt;/tr&gt;
&lt;/table&gt;
&lt;table width=&#34;80%&#34; border=&#34;1&#34;&gt;
	&lt;tr&gt;
		&lt;td&gt;
		&lt;!--&lt;input type=&#34;submit&#34;/&gt;--&gt;
                &lt;input type=&#34;button&#34; value=&#34;SAVE&#34; onclick=&#34;save(this.form)&#34;/&gt; &lt;!-- client-validation을 위해 바로 submit하지 않고 먼저 validateEmployee 함수를 호출--&gt;
		&lt;input type=&#34;button&#34; value=&#34;LIST&#34; onclick=&#34;location.href=&#39;/easycompany/employeeList.do&#39;&#34;/&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
&lt;/table&gt; 
&lt;/form:form&gt;
....
</code></pre><h4 id=test-1>TEST</h4><p>이번에도 이름 필드의 값을 지우고 저장 버튼을 누르면 아래와 같은 alert 메시지가 보일 것이다.</p><p><img src=../images/client-validate.jpg alt=client-validate></p><h2 id=참고문헌>참고문헌</h2><ul><li>Spring Modules Reference Documentation v 0.9, Chapter 17.Validation, P133~136</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-e45a4e52ea7552fe6295b4e19061e54d>22 - Commons Validator에 validation rule 추가하기</h1><div class=lead>Commons Validator는 기본적인 유형 외에도 프로젝트 특성에 맞는 공통 validation rule을 추가할 수 있다. 예제로 주민등록번호 검증기를 추가하여 validation rule을 확장하는 방법을 설명하며, 이를 easycompany 프로젝트에 적용했다.</div><h1 id=commons-validator에-validation-rule-추가하기>Commons Validator에 validation rule 추가하기</h1><h2 id=개요>개요</h2><p>Commons Validator는 primitive type, 필수값, 이메일등 흔히 사용되는 유형에 대한 validation rule을 template으로 제공하지만,
프로젝트의 특성에 따라 공통으로 사용되는 validation rule이 발생되고 이를 추가해야할 필요가 생길 수 있다.
공공프로젝트에서 흔히 사용되는 주민등록번호 validator를 추가해 봄으로써, validation rule을 추가하는 방법을 알아보고자 한다.<br>예제는 easycompany를 이용했다.</p><h2 id=설명>설명</h2><p>Spring Module을 이용해서 Commons Validator를 사용한다면 아래와 같은 내용을 validation rule 정의 파일(validator-rules.xml 같은)에서 보았을 것이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>&lt;!--필수값 체크 validation rule--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;validator</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;required&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#c4a000>classname=</span><span style=color:#4e9a06>&#34;org.springmodules.validation.commons.FieldChecks&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#c4a000>method=</span><span style=color:#4e9a06>&#34;validateRequired&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>methodParams=</span><span style=color:#4e9a06>&#34;java.lang.Object,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                     org.apache.commons.validator.ValidatorAction,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                     org.apache.commons.validator.Field,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                     org.springframework.validation.Errors&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#c4a000>msg=</span><span style=color:#4e9a06>&#34;errors.required&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>&lt;javascript&gt;</span><span style=color:#8f5902;font-style:italic>&lt;![CDATA[
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          ]]&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>&lt;/javascript&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/validator&gt;</span>
</span></span></code></pre></div><p>validator 태그의 각각의 attribute는 다음과 같은 의미를 같는다.</p><table><tr><th>name</th><td>validation rule(required,mask,integer,email…)</td></tr><tr><th>classname</th><td>validation check를 수행하는 클래스명</td></tr><tr><th>method</th><td>validation check를 수행하는 클래스의 메소드명</td></tr><tr><th>methodParams</th><td>validation check를 수행하는 클래스의 메소드의 파라미터</td></tr><tr><th>msg</th><td>에러 메시지 key</td></tr><tr><th>javascript</th><td>client-side validation을 위한 자바스크립트 코드</td></tr></table><p>주민등록번호 rule을 아래와 같이 추가한다고 하면,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;validator</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;ihidnum&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#c4a000>classname=</span><span style=color:#4e9a06>&#34;egovframework.rte.ptl.mvc.validation.RteFieldChecks&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#c4a000>method=</span><span style=color:#4e9a06>&#34;validateIhIdNum&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#c4a000>methodParams=</span><span style=color:#4e9a06>&#34;java.lang.Object,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                     org.apache.commons.validator.ValidatorAction,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                     org.apache.commons.validator.Field,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                     org.springframework.validation.Errors&#34;</span>                       
</span></span><span style=display:flex><span>            <span style=color:#c4a000>depends=</span><span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#c4a000>msg=</span><span style=color:#4e9a06>&#34;errors.ihidnum&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;javascript&gt;</span><span style=color:#8f5902;font-style:italic>&lt;![CDATA[
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          ]]&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>&lt;/javascript&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/validator&gt;</span>
</span></span></code></pre></div><p>필요한 작업은 아래와 같다.</p><ol><li>FieldCheck class(RteFieldChecks) 작성</li><li>Validator class(RteGenericValidator) 작성</li><li>validator-rules.xml 설정</li><li>validator.xml 설정</li><li>에러메시지 설정</li><li>TEST</li></ol><h3 id=fieldcheck-class-작성>FieldCheck class 작성</h3><p>org.springmodules.validation.commons.FieldChecks를 상속 받는 RteFieldChecks 클래스를 생성한다.
그리고 주민등록번호 validation을 담당할 validateIhIdNum 메소드를 추가한다.
주민등록번호 validation 로직이 RteFieldChecks.validateIhIdNum() 안에 있어도 되지만, org.springmodules.validation.commons.FieldChecks와 같은 방식으로 다른 Validator에 위임했다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>egovframework.rte.ptl.mvc.validation</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.apache.commons.validator.Field</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.apache.commons.validator.ValidatorAction</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.validation.Errors</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springmodules.validation.commons.FieldChecks</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>RteFieldChecks</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>FieldChecks</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>validateIhIdNum</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>bean</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ValidatorAction</span> <span style=color:#000>va</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#000>Field</span> <span style=color:#000>field</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Errors</span> <span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//bean에서 해당 field 값을 추출
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>String</span> <span style=color:#000>ihidnum</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>FieldChecks</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>extractValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>bean</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>field</span><span style=color:#ce5c00;font-weight:700>);</span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>                <span style=color:#8f5902;font-style:italic>//주민등록번호 유효성 검사 알고리즘은 RteGenericValidator가 가지고 있다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>RteGenericValidator</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isValidIdIhNum</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ihidnum</span><span style=color:#ce5c00;font-weight:700>)){</span> <span style=color:#8f5902;font-style:italic>//유효한 주민등록번호가 아니면
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>FieldChecks</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>rejectValue</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>errors</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>field</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>va</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//에러 처리
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span><span style=color:#204a87;font-weight:700>else</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=validator-class-작성>Validator class 작성</h3><p>주민등록번호 유효성체크 로직이 있는 RteGenericValidator 클래스를 작성해 보자.
유효성 체크 기준은</p><ol><li>값의 길이가 13자리이며, 7번째 자리가 1,2,3,4 중에 하나인가?</li><li>앞 6자리의 값이 유효한 날짜인가?</li><li>주민등록번호 마지막 자리를 이용한 check</li></ol><p>로 했다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>egovframework.rte.ptl.mvc.validation</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>java.io.Serializable</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.apache.commons.validator.GenericTypeValidator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>RteGenericValidator</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>Serializable</span> <span style=color:#ce5c00;font-weight:700>{</span>	
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>isValidIdIhNum</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>		
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//값의 길이가 13자리이며, 7번째 자리가 1,2,3,4 중에 하나인지 check.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>String</span> <span style=color:#000>regex</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;\\d{6}[1234]\\d{6}&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>matches</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>regex</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//앞 6자리의 값이 유효한 날짜인지 check.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>String</span> <span style=color:#000>strDate</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>substring</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>6</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>strDate</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>charAt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#39;1&#39;</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>charAt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#39;2&#39;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>?</span> <span style=color:#4e9a06>&#34;19&#34;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#4e9a06>&#34;20&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>strDate</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>			<span style=color:#000>strDate</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>strDate</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>substring</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;/&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>strDate</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>substring</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>6</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>					<span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;/&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>strDate</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>substring</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>8</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#000>SimpleDateFormat</span> <span style=color:#000>dateformat</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>SimpleDateFormat</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;yyyy/MM/dd&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Date</span> <span style=color:#000>date</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>dateformat</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>parse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>strDate</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>String</span> <span style=color:#000>resultStr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>dateformat</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>format</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>date</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(!</span><span style=color:#000>resultStr</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>equalsIgnoreCase</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>strDate</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ParseException</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>// TODO Auto-generated catch block
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>printStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//주민등록번호 마지막 자리를 이용한 check.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>char</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>charArray</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toCharArray</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>sum</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>int</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>arrDivide</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#204a87;font-weight:700>int</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>6</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>8</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>9</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5</span> <span style=color:#ce5c00;font-weight:700>};</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>charArray</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>sum</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#000>Integer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>parseInt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>charArray</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]))</span>
</span></span><span style=display:flex><span>					<span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>arrDivide</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>checkdigit</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>((</span><span style=color:#204a87;font-weight:700>int</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>11</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>sum</span> <span style=color:#ce5c00;font-weight:700>%</span> <span style=color:#0000cf;font-weight:700>11</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>%</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>checkdigit</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>Integer</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>parseInt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>valueOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>charArray</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>12</span><span style=color:#ce5c00;font-weight:700>])))</span> <span style=color:#ce5c00;font-weight:700>?</span> <span style=color:#204a87;font-weight:700>true</span>
</span></span><span style=display:flex><span>				<span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=validator-rulesxml-설정>validator-rules.xml 설정</h3><p>이제 주민등록번호 validation rule을 추가해 보자.
rule 이름은 ihidnum으로 하고 위에서 작성한 코드를 바탕으로 설정하면, (이미 위 개요에 나온 대로) 아래와 같다.
client-validation을 위해서 자바스크립트 코드도 추가했다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;validator</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;ihidnum&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#c4a000>classname=</span><span style=color:#4e9a06>&#34;egovframework.rte.ptl.mvc.validation.RteFieldChecks&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#c4a000>method=</span><span style=color:#4e9a06>&#34;validateIhIdNum&#34;</span>
</span></span><span style=display:flex><span>         <span style=color:#c4a000>methodParams=</span><span style=color:#4e9a06>&#34;java.lang.Object,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                       org.apache.commons.validator.ValidatorAction,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                       org.apache.commons.validator.Field,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                       org.springframework.validation.Errors&#34;</span>                       
</span></span><span style=display:flex><span>              <span style=color:#c4a000>depends=</span><span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#c4a000>msg=</span><span style=color:#4e9a06>&#34;errors.ihidnum&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>           <span style=color:#204a87;font-weight:700>&lt;javascript&gt;</span><span style=color:#8f5902;font-style:italic>&lt;![CDATA[
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>           function validateIhIdNum(form) {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                var bValid = true;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                var focusField = null;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                var i = 0;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                var fields = new Array();
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                oIhidnum = new ihidnum();                
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                for (x in oIhidnum) {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                	var field = form[oIhidnum[x][0]];
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                	if (field.type == &#39;text&#39; ||
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    	field.type == &#39;hidden&#39; ||
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                        field.type == &#39;textarea&#39;) {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                        if (trim(field.value).length==0 || !checkIhIdNum(field.value)) {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                            if (i == 0) {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                                focusField = field;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                            }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                            fields[i++] = oIhidnum[x][1];
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                            bValid = false;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                        }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                if (fields.length &gt; 0) {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    alert(fields.join(&#39;\n&#39;));
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                return bValid;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            /**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>             * Reference: JS Guide
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>             * http://jsguide.net/ver2/articles/frame.php?artnum=002
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>             */             
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            function checkIhIdNum(ihidnum){
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	fmt = /^\d{6}[1234]\d{6}$/;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	if(!fmt.test(ihidnum)){
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            		return false;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	}
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	birthYear = (ihidnum.charAt(7) &lt;= &#34;2&#34;) ? &#34;19&#34; : &#34;20&#34;;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				birthYear += ihidnum.substr(0, 2);
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				birthMonth = ihidnum.substr(2, 2) - 1;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				birthDate = ihidnum.substr(4, 2);
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				birth = new Date(birthYear, birthMonth, birthDate);
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				if( birth.getYear() % 100 != ihidnum.substr(0, 2) ||
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				    birth.getMonth() != birthMonth ||
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				    birth.getDate() != birthDate) {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				    return false;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>				}
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	var arrDivide = [2, 3, 4, 5, 6, 7, 8, 9, 2, 3, 4, 5];            	
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	var checkdigit = 0;            	
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	for(var i=0;i&lt;ihidnum.length-1;i++){
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            		checkdigit += parseInt(ihidnum.charAt(i)) * parseInt(arrDivide[i]);
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	}
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	checkdigit = (11 - (checkdigit%11))%10;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	if(checkdigit != ihidnum.charAt(12)){
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            		return false;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	}else{
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            		return true;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            	}
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            ]]&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#204a87;font-weight:700>&lt;/javascript&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;/validator&gt;</span>
</span></span></code></pre></div><h3 id=validatorxml-설정>validator.xml 설정</h3><p>ihidnum이란 필드에 주민등록번호 validation 체크를 해보자.
validator.xml에 필요한 내용을 추가하고.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;form-validation&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;formset&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;form</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;employee&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        	...
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>&lt;field</span> <span style=color:#c4a000>property=</span><span style=color:#4e9a06>&#34;ihidnum&#34;</span> <span style=color:#c4a000>depends=</span><span style=color:#4e9a06>&#34;ihidnum&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                ... 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/form&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/formset&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/form-validation&gt;</span>
</span></span></code></pre></div><h3 id=에러메시지-설정>에러메시지 설정</h3><p>messages 프로퍼티에 에러메시지를 추가하자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#c4a000>errors.ihidnum</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>유효하지 않은 주민등록번호입니다.</span>
</span></span></code></pre></div><h3 id=test>TEST</h3><p>주민등록번호 server-side,client-side validatin을 위한 환경은 다 갖추어졌다.
이제 EmployeeController에 validation을 추가하고,(이미 추가되어 있다면 pass)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.controller.annotation</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springmodules.validation.commons.DefaultBeanValidator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>EmployeeController</span> <span style=color:#ce5c00;font-weight:700>{</span>	
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DefaultBeanValidator</span> <span style=color:#000>beanValidator</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/updateEmployee.do&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>updateEmployee</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@ModelAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;employee&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>Employee</span> <span style=color:#000>employee</span><span style=color:#ce5c00;font-weight:700>,</span>			
</span></span><span style=display:flex><span>			<span style=color:#000>BindingResult</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Model</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>beanValidator</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>validate</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>employee</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>//validation 수행
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>bindingResult</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasErrors</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span> <span style=color:#8f5902;font-style:italic>//만일 validation 에러가 있으면...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#ce5c00;font-weight:700>.....</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;modifyemployee&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#000>employeeManageService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updateEmployee</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>employee</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;changenotify&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>        
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>VO Class(com.easycompany.model.Employee.java)에 주민등록번호 필드를 추가하고,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>com.easycompany.model</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>Employee</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>....</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>ihidnum</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>ihidnum1</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>ihidnum2</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getIhidnum</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ihidnum1</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>ihidnum2</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getIhidnum1</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>		
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ihidnum1</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setIhidnum1</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>ihidnum1</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ihidnum1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ihidnum1</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>getIhidnum2</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>ihidnum2</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setIhidnum2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>ihidnum2</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ihidnum2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>ihidnum2</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>JSP(/easycompany/webapp/jsp/modifyemployee.jsp)에 주민등록번호 입력 필드를 추가하자.</p><pre tabindex=0><code class=language-jsp data-lang=jsp>...
	&lt;tr&gt;
		&lt;th&gt;주민번호&lt;/th&gt;
		&lt;td&gt;
			&lt;form:input path=&#34;ihidnum1&#34; size=&#34;10&#34;/&gt; - &lt;form:input path=&#34;ihidnum2&#34; size=&#34;10&#34;/&gt;&lt;form:errors path=&#34;ihidnum&#34; /&gt;
			&lt;form:hidden path=&#34;ihidnum&#34;/&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
...
</code></pre><p>주민등록번호를 입력하지 않거나, 틀린번호를 입력시엔 아래와 같은 경고창이 뜬다.</p><p><img src=../images/ihidnum-validation.jpg alt=ihidnum-validation></p><p>틀린 입력값으로 client를 통과하더라도 Controller에서 validation이 추가로 동작하므로, server-side에서 validation error가 일어날것이다.</p><h2 id=참고자료>참고자료</h2><ul><li>Spring Modules Reference Documentation v 0.9, Chapter 17.Validation, P133~13</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-1fd485618572aabc83908f6a1e83b440>23 - UI Adaptor Service</h1><div class=lead>전자정부 표준프레임워크에서는 Spring MVC Annotation을 기반으로 요청 URI와 Controller 메소드를 매핑하며, 메소드 파라미터로 업무용 DTO 객체를 사용할 수 있도록 가이드한다. UI 솔루션과의 연동 방식은 프로젝트 특성에 맞게 설계해야 하며, 보통 Controller에서 데이터를 DTO 형태로 변환하여 업무 로직으로 넘기는 방식이 많이 사용된다.</div><h1 id=ui-adaptor-service>UI Adaptor Service</h1><h2 id=개요>개요</h2><p>전자정부 표준프레임워크와 UI 솔루션(Rich Internet Application) 연동에 대해 살펴 본다.
UI Adaptor를 적용하는 방식은 특정한 하나의 방법을 표준화하기 어렵다.
보통 Web Framework 과 UI 솔루션과의 연동을 하는 방법 중 가장 많이 사용하는 방식은
Controller 역할을 수행하는 Servlet 객체에서 업무 로직을 호출 전 데이터를 DTO 형태로 변화하여 업무 로직으로 넘기는 방식이다.</p><p>전자정부 표준프레임워크에서는 Spring MVC Annotation 기반으로 개발 시 요청되는 URI 와 Controller 클래스내의 메소드를 매핑하고 있다.
따라서 메소드의 파라미터로 넘어오는 객체가 request 객체가 아닌 업무용 DTO 클래스로 넘어올 수 있도록 가이드 하는 방식을 선택했다.
(사실 @ModelAttribute 를 이용하는 것과 같다.)
하지만 프로젝트 별로 비기능 요구사항의 특성을 고려하여 적합한 구조를 정의하여 적용하는 것이 필요하다.</p><p>UI 솔루션 업체별 상세 가이드</p><ul><li><a href="https://www.egovframe.go.kr/wiki/lib/exe/fetch.php?media=egovframework:rte:ptl:%EB%A7%88%EC%9D%B4%ED%94%8C%EB%9E%AB%ED%8F%BC_%EC%97%B0%EB%8F%99_%EC%83%98%ED%94%8C_%EC%84%A4%EB%AA%85%EC%84%9C%ED%8F%AC%ED%95%A8_.zip">연동_샘플_설명서포함_.zip</a> - written by 고석률(MiPlatform)</li><li><a href=https://maven.egovframe.go.kr/publist/HDD1/public/XPlatform.zip>XPlatform.zip</a> - XPlatform 제공(신규 템플릿)</li><li>넥사크로<ul><li><a href=https://maven.egovframe.go.kr/publist/HDD1/public/nexacro14/nexacroPlatform_UI%20Adaptor-Guide.zip>넥사크로플랫폼 UI Adaptor 개발가이드.zip</a> - 넥사크로플랫폼</li><li><a href=https://maven.egovframe.go.kr/publist/HDD1/public/nexacro14/nexacro14_2015.03.05.01(14.0.0.143).zip>nexacro14_2015.03.05.01(14.0.0.143).zip</a> - nexacro14</li><li><a href=https://maven.egovframe.go.kr/publist/HDD1/public/nexacro14/eGovFrame-3.2.7z>eGovFrame-3.2.7z</a> - 개발프로젝트</li></ul></li><li>토마토시스템즈</li><li>SHIFT(Gauce)</li></ul><h2 id=설명>설명</h2><p>중점적으로 우리가 살펴볼 내용은 Controller 앞단에서 UI 솔루션으로부터 넘어온 데이터를 DTO 로 변환하는 과정이다.
데이타 변환을 위해 우리는 ArgumentResolver 를 이용한 방법을 살펴보도록 하겠다.
UI 솔루션으로 넘어오는 데이터 객체는 request 객체에 포함되어 넘어온다. 우리가 필요한 것은 업무용 DTO 클래스이다.
업무용 DTO 클래스는 URI(@RequestMapping)와 매핑 된 Controller 메소드의 파라미터로 존재하게 된다.
Controller 메소드의 파라미터에 설정된 클래스(여기서는 DTO)를 AnnotationMethodHandlerAdapter 에서
그에 해당하는 ArgumentResolvers(customArgumentResolvers포함) 를 호출해준다.
따라서 우리는 ArgumentResolver를 확장하여 CustomRiaArgumentResolver 개발하여 AnnotationMethodHandlerAdapter에 등록한다.
CustomRiaArgumentResolver 에서 리턴되는 객체는 Contorller 단의 메소드의 파라미터로 이용된다.</p><ul><li>참고 : AnnotationMethodHandlerAdapter 는 URI 와 매핑되는 Contorller 의 메소드를 실행 시 파라미터로 존재하는 객체타입에대한 ArgumentResolver를 실행하여 가져온다.</li></ul><p>그리고 Controller단의 실행 결과는 ViewResovler를 통해 RiaView 로 전송되며 RiaVeiw는 결과물인 DTO 를 UI 솔루션 데이터 타입으로 변환하여 response로 보내어 진다.
다시 핵심적인 내용을 정리하자면 다음과 같다.</p><ol><li>AnnotationMethodHandlerAdapter 의 CustomRiaArgumentResolver 등록 ⇒ CustomRiaArgumentResolver</li><li>UIAdaptor 등록 ⇒ UIAdaptorImpl</li><li>RiaView 등록 ⇒ RiaView</li></ol><p>사용되는 DTO 를 아래 클래스로 생각하고 살펴보겠다.</p><p>UdDTO.java(샘플)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>UdDTO</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>Serializable</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Map</span> <span style=color:#000>variableList</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Map</span> <span style=color:#000>dataSetList</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>Map</span> <span style=color:#000>Objects</span> <span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setVariableList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span> <span style=color:#000>variableList</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>variableList</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>variableList</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setDataSetList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span> <span style=color:#000>dataSetList</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>dataSetList</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>dataSetList</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Map</span> <span style=color:#000>getVariableList</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>variableList</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Map</span> <span style=color:#000>getDataSetList</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>dataSetList</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setObjects</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span> <span style=color:#000>objects</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Objects</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>objects</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Map</span> <span style=color:#000>getObjects</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>Objects</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><h3 id=ui솔루션데이타에서-dto로-변환>UI솔루션데이타에서 DTO로 변환</h3><p>다음은 UTO 를 가져와 UI 솔루션에 의해 들어오는 객체로부터 UTO 로 변환하는 부분을 설명한다.
변환을 담당하는 UIAdaptorImpl 객체는 AnnotationMethodHandlerAdapter 의 <strong>CustomRiaArgumentResolver</strong> 에 설정된다.</p><p><strong>설정정보(CustomRiaArgumentResolver)</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;webBindingInitializer&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.web.common.EgovBindingInitializer&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;customArgumentResolvers&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;list&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.sale.web.CustomRiaArgumentResolver&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;uiAdaptor&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>&lt;ref</span> <span style=color:#c4a000>bean=</span><span style=color:#4e9a06>&#34;riaAdaptor&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/list&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><p>WebArgumentResolver의 구현체인 CustomRiaArgumentResolver 는 uiAdaptor 에 세팅된 Adaptor 를 실행해준다.</p><p><strong>CustomRiaArgumentResolver.java</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>CustomRiaArgumentResolver</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebArgumentResolver</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>UiAdaptor</span> <span style=color:#000>uiA</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>setUiAdaptor</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UiAdaptor</span> <span style=color:#000>uiA</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>uiA</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>uiA</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Object</span> <span style=color:#000>resolveArgument</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MethodParameter</span> <span style=color:#000>methodParameter</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>NativeWebRequest</span> <span style=color:#000>webRequest</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Class</span><span style=color:#ce5c00;font-weight:700>&lt;?&gt;</span> <span style=color:#000>type</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>methodParameter</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameterType</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Object</span> <span style=color:#000>uiObject</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uiA</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>UNRESOLVED</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//Controller의 실행되는 메소드의 파라미터타입 정보가 MethodParameter를 통해 넘어온다. 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#8f5902;font-style:italic>//설정한 UIAdaptro 구현체에 등록되어 있는 UTO 와 비교한다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>type</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>equals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>uiA</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getModelName</span><span style=color:#ce5c00;font-weight:700>()))</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>webRequest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getNativeRequest</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>// 여기서 데이타 만들어 넘긴다.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>uiObject</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UdDTO</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>uiA</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>convert</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>uiObject</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>UNRESOLVED</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><p>UiAdaptor 의 구현체는 아래와 같다. 여기서는 Miplatform 의 예를 들어 코드를 작성하였다.
UI 솔루션의 객체에서 DTO 로 데이터를 옮기는 역할은 converte4In 메소드에서 수행된다.</p><p><strong>RiaAdaptorImpl.java(MiPlatform ⇒ UdDTO)</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>RiaAdaptorImpl</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>UiAdaptor</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Log</span> <span style=color:#000>log</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LogFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLog</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>//resolveArgument 메소드에서 호출하는 메소드 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Object</span> <span style=color:#000>convert</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>PlatformRequest</span> <span style=color:#000>platformRequest</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>platformRequest</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PlatformRequest</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>PlatformRequest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CHARSET_UTF8</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000>platformRequest</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>receiveData</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStackTrace</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>// throw new IOException(&#34;PlatformRequest error&#34;);
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//UI 솔루션 데이터에서 DTO 객체로 변환
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>UdDTO</span> <span style=color:#000>dto</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>converte4In</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>platformRequest</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>dto</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>UdDTO</span> <span style=color:#000>converte4In</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>PlatformRequest</span> <span style=color:#000>platformRequest</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>UdDTO</span> <span style=color:#000>dto</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>UdDTO</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//... DTO 또는 VO 값 채우기 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#ce5c00;font-weight:700>.....</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>dto</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Class</span> <span style=color:#000>getModelName</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>UdDTO</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=controller-메소드-구현>Controller 메소드 구현</h3><p>UdDTO 클래스는 CustomRiaArgumentResolver 에서 만들어져 Controller 의 메소드의 parameter 형태로 가져온다.
아래 예는 Controller 단의 메소드 이다.</p><p><strong>XXCategoryController.java</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/sample/miplatform.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ModelAndView</span> <span style=color:#000>selectCategoryList4Mi</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>UdDTO</span> <span style=color:#000>miDto</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Model</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>ModelAndView</span> <span style=color:#000>mav</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ModelAndView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;riaView&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>//조회조건이 있을 경우 사용될 Map
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>smp</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HashMap</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		  <span style=color:#8f5902;font-style:italic>//Biz Layer 를 호출 한다. 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>List</span> <span style=color:#000>resultList</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>categoryService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>selectCategoryList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>smp</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>//결과값을 모델에 저장 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>mav</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;MiDTO&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>resultList</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Exception</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>info</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getStackTrace</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>mav</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=beannameviewresolver-설정>BeanNameViewResolver 설정</h3><p>모델 객체의 이름이 riaView 이다. 이것은 Bean Name을 직접 명시한 것으로 아래와 같은 설정(BeanNameViewResolver)이 필요하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.BeanNameViewResolver&#34;</span> <span style=color:#c4a000>p:order=</span><span style=color:#4e9a06>&#34;0&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.UrlBasedViewResolver&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>p:order=</span><span style=color:#4e9a06>&#34;1&#34;</span> <span style=color:#c4a000>p:viewClass=</span><span style=color:#4e9a06>&#34;org.springframework.web.servlet.view.JstlView&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#c4a000>p:prefix=</span><span style=color:#4e9a06>&#34;/WEB-INF/jsp/&#34;</span> <span style=color:#c4a000>p:suffix=</span><span style=color:#4e9a06>&#34;.jsp&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;riaView&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;egovframework.rte.fdl.sale.web.RiaView&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div><h3 id=riaview-구현>RiaView 구현</h3><p>RiaView 의 코드는 아래와 같다. DTO 를 업체에 맞춰 다시 가져 나가기 위해 convert 하는 모듈이다.
여기서는 Miplatform 객체로 변환한다. egovDs 라는 DataSet 으로 객체화 한후 stream 형태로 보내는 로직이다.
따라서 업체별 데이타 형태로 변환하여 보내도록 수정하면 된다.</p><p><strong>RiaView.java(DTO ⇒ MiPlatform)</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>....</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>RiaView</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractView</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#000>Log</span> <span style=color:#000>log</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>LogFactory</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLog</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@SuppressWarnings</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;unchecked&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>renderMergedOutputModel</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Map</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>	        <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>VariableList</span> <span style=color:#000>miVariableList</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>VariableList</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>DatasetList</span> <span style=color:#000>miDatasetList</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>DatasetList</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>PlatformData</span> <span style=color:#000>platformData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PlatformData</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>miVariableList</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>miDatasetList</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>List</span> <span style=color:#000>list</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;MiDTO&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Iterator</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>iterator</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>iterator</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Iterator</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>dataIterator</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>iterator</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>Dataset</span> <span style=color:#000>dataset</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Dataset</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;egovDs&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>while</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>iterator</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasNext</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>// Header 세팅
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>record</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>iterator</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>next</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Iterator</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>si</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>record</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>keySet</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>iterator</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>while</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>si</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasNext</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>String</span> <span style=color:#000>key</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>si</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>next</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>				<span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addColumn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ColumnInfo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>COLUMN_TYPE_STRING</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#0000cf;font-weight:700>255</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>while</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>dataIterator</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasNext</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Map</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>record</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>dataIterator</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>next</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Iterator</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>si</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>record</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>keySet</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>iterator</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>// Header 세팅
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>while</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>si</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasNext</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>String</span> <span style=color:#000>key</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>si</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>next</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>				<span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addColumn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ColumnInfo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>COLUMN_TYPE_STRING</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>short</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#0000cf;font-weight:700>255</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#8f5902;font-style:italic>// Value 세팅
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>			<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>row</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>appendRow</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Iterator</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>si2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>record</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>keySet</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>iterator</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>while</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>si2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>hasNext</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>String</span> <span style=color:#000>key</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>si2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>next</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>				<span style=color:#000>String</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>record</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>				<span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>out</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>println</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;key = &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>key</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34; , value = &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>				<span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setColumn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>row</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>			<span style=color:#000>miDatasetList</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>dataset</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>try</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PlatformResponse</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>PlatformConstants</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>CHARSET_UTF8</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>sendData</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>platformData</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>IOException</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>isErrorEnabled</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>log</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>error</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Exception occurred while writing xml to MiPlatform Stream.&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ex</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Exception</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h1 id=참고자료>참고자료</h1></div><div class=td-content style=page-break-before:always><h1 id=pg-abc8b87ef1cdce547d3438e20f288215>24 - Asynchronous request processing</h1><div class=lead>Servlet 3.0과 Spring MVC 3.2 이상에서는 비동기 요청 처리를 통해 요청 쓰레드가 반환된 후에도 내부 쓰레드에서 비동기 작업을 처리할 수 있다. 이를 위해 <code>Callable</code>, <code>DeferredResult</code>, <code>WebAsyncTask</code> 등을 사용해 시간이 오래 걸리는 작업을 비동기로 처리하고, 완료 후 응답을 보낼 수 있다.</div><h1 id=asynchronous-request-processing>Asynchronous request processing</h1><h2 id=개요>개요</h2><p>기존의 요청 처리는 하나의 요청에 대해 한 개의 쓰레드를 사용하였다. 하나의 쓰레드에서 요청-응답 과정을 모두 처리하기 때문에 요청처리 이후 응답이 오기까지 쓰레드를 대기상태로 유지하였다. 그러나 서버와의 연결을 유지한채 대기상태로 있는 것이 아니라 서버와의 처리를 계속 이어가게 해주기 위해서는 이러한 기존의 처리에 한계가 있었다.</p><p>Servlet 3.0에서 제공하는 비동기 요청 처리는 쓰레드가 대기상태로 있는 것이 아니라 요청을 처리하는 Servlet 쓰레드가 요청후 바로 반환되고 내부의 다른 쓰레드가 이를 처리했다가 처리완료 후 응답처리 리소스가 가용할 때 Servlet쓰레드가 응답처리를 계속 이어가게 해 주는 것이다.</p><p>비동기 요청처리를 위해 다음과 같은 환경이 필요하다.</p><ul><li>Servlet 3.0이상</li><li>Spring MVC 3.2이상 (eGov 3.0에 포함)</li><li>Web.xml 설정 변경</li></ul><h3 id=servlet-30을-위한-pom-dependency변경>Servlet 3.0을 위한 pom dependency변경</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- Servlet --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>javax.servlet<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>javax.servlet-api<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>3.0.1<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;scope&gt;</span>provided<span style=color:#204a87;font-weight:700>&lt;/scope&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/dependency&gt;</span>
</span></span></code></pre></div><h3 id=webxml설정-변경>web.xml설정 변경</h3><p>web.xml의 servlet버전을 변경해야한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;web-app</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://java.sun.com/xml/ns/javaee&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>version=</span><span style=color:#4e9a06>&#34;3.0&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/web-app&gt;</span>
</span></span></code></pre></div><p>web.xml내의 servlet설정에 async-supported 태그 값을 true로 설정한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;servlet-name&gt;</span>appServlet<span style=color:#204a87;font-weight:700>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span style=color:#204a87;font-weight:700>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;init-param&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;param-name&gt;</span>contextConfigLocation<span style=color:#204a87;font-weight:700>&lt;/param-name&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&lt;param-value&gt;</span>/WEB-INF/spring/appServlet/servlet-context.xml<span style=color:#204a87;font-weight:700>&lt;/param-value&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;/init-param&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;load-on-startup&gt;</span>1<span style=color:#204a87;font-weight:700>&lt;/load-on-startup&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&lt;async-supported&gt;</span>true<span style=color:#204a87;font-weight:700>&lt;/async-supported&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/servlet&gt;</span>
</span></span></code></pre></div><h2 id=설명>설명</h2><p>Spring의 비동기 요청처리에서는 Servlet 쓰레드는 요청을 처리하고 Spring의 Async 제공 클래스를 통해 비동기모드로 전환되며 Servlet 쓰레드는 반환된다. 그 후 내부 Application의 쓰레드에서 서비스 처리가 일어나게 된다. 처리완료 후 Servlet 쓰레드가 다시 응답을 받아 이를 클라이언트로 전송한다.</p><p>Spring의 비동기 요청처리에서 제공하는 Class는 Servlet 쓰레드가 반환된 이후 내부 서비스를 처리하는 쓰레드의 종류에 따라 나뉜다.</p><h3 id=callable>Callable</h3><p>요청을 처리하는 Servlet 쓰레드가 반환되면 Spring MVC에서 제어하는 쓰레드에 의해 비동기처리된다.</p><p>Callable의 처리과정은 다음과 같다.</p><ol><li>Controller의 RequestMapping method에서 일반적인 뷰 객체나 String값을 리턴하는 것이 아니라 Callable객체를 리턴한다.</li><li>Callable이 리턴될 때 Servlet 쓰레드가 반환되며 비동기처리를 Callable에게 위임한다.</li><li>Spring MVC내의 TaskExcutor에서 관리되는 쓰레드에서 Async처리가 된다.</li><li>Callable내부의 call()함수에서 리턴되는 값이 다시 Servlet 쓰레드로 전달된다.</li></ol><p>Callable은 주로 요청처리가 오래걸리는 DB작업, REST API 요청처리를 하는 데 적합하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#a40000>“</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>view</span><span style=color:#a40000>”</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Callable</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>callableWithView</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>Model</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Callable</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>call</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Thread</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>sleep</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2000</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#a40000>“</span><span style=color:#000>foo</span><span style=color:#a40000>”</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#a40000>“</span><span style=color:#000>bar</span><span style=color:#a40000>”</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#a40000>“</span><span style=color:#000>fruit</span><span style=color:#a40000>”</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#a40000>“</span><span style=color:#000>apple</span><span style=color:#a40000>”</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#a40000>“</span><span style=color:#000>view</span><span style=color:#a40000>”</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=defferedresult>DefferedResult</h3><p>Servlet 스레드는 반환하고 Spring MVC가 제어하지 않는 쓰레드를 통해 비동기를 처리한다. DefferedResult는 JMS, AMQP, 스케쥴러, Redis, 다른 HTTP요청에서 사용된다.</p><p>DefferedResult의 처리과정은 다음과 같다.</p><ol><li>Controller에서 DefferedResult를 반환하고 In-Memory Queue또는 List에 DefferedResult를 저장한다.</li><li>Servlet 쓰레드는 반환되고 이벤트 발생 시 Queue에서 DefferedResult객체를 꺼내 사용한다.</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/quotes&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@ResponseBody</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>DeferredResult</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>quotes</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>DeferredResult</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>deferredResult</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>DeferredResult</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Save the deferredResult in in-memory queue ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>queue</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>defferedResult</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>deferredResult</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// In some other thread...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/someEvent&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@ResponseBody</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>someEvent</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>for</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DefferedResult</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>queue</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>result</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setResult</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;view&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=asynctask>AsyncTask</h3><p>Callable과 동일한 방식으로 사용하며 Controller에서 Callable을 담아서 반환한다.</p><p>Timeout을 추가할 수 있으며 AsyncTaskExecutor를 지정하거나 작업의 종류에 따라 쓰레드 풀을 분리하여 사용할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/facebooklink&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>WebAsyncTask</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>facebooklink</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>WebAsyncTask</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;(</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>30000L</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#8f5902;font-style:italic>// Timeout
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#4e9a06>&#34;facebookTaskExecutor&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#8f5902;font-style:italic>// TaskExecutor
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Callable</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>call</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#8f5902;font-style:italic>// 작업
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>result</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>      <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=참고자료>참고자료</h3><ul><li><a href=http://docs.spring.io/spring/docs/3.2.6.RELEASE/spring-framework-reference/htmlsingle/#new-in-3.2-webmvc-async>Spring Framework - Reference Document / 4.1 Support for Servlet 3 based asynchronous request processing</a></li><li><a href=http://docs.spring.io/spring/docs/3.2.6.RELEASE/spring-framework-reference/htmlsingle/#mvc-ann-async>Spring Framework - Reference Document / 17.3.4 Asynchronous Request Processing</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-b9ed1bdf40b7ae592cb22b9c8363ac24>25 - jQuery 가이드</h1><div class=lead>jQuery는 다양한 UI 기능과 AJAX 요청을 지원하는 JavaScript 라이브러리로, 이를 통해 이벤트 처리, 자동 완성, 탭 등의 기능을 쉽게 구현할 수 있다. AJAX 요청은 <code>$.ajax()</code>, <code>$.get()</code>, <code>$.post()</code>와 같은 메서드를 사용하여 서버와 데이터를 비동기적으로 통신하며, JSON과 같은 형식으로 데이터를 주고받을 수 있다.</div><h1 id=jquery-가이드>jQuery 가이드</h1><h2 id=개요>개요</h2><p>jQuery는 브라우저 호환성이 있는 다양한 기능을 제공하는 자바스크립트 라이브러리이다. jQuery에서 제공하는 오픈 라이브러리들을 통해 java script로 ajax, event, 다양한 ui 기능 등을 구현할 수 있으며 위키가이드에서는 jQuery의 기본적인 몇가지 기능(ajax, callback함수, post호출 등)에 대하여 살펴본다.</p><p>자세한 내용은 <a href=https://jquery.com/>jQuery 사이트</a>를 살펴보도록 한다.</p><p>jQuery ajax의 다양한 기능들 중 기본Ajax기능과 응용을 통한 콤보박스, Select박스의 간단한 화면처리에 대하여 가이드한다.</p><ul><li><p>jQuery ajax 기본기능</p><ul><li><a href=#jqueryajax>jQuery.ajax()</a></li><li><a href=#jqueryget>jQuery.get()</a></li><li><a href=#jquerypost>jQuery.post()</a></li></ul></li><li><p>jQuery ajax 응용</p><ul><li><a href=#select-box>Select box</a></li><li><a href=#tabs>Tabs</a></li></ul></li></ul><h2 id=설정>설정</h2><p>jQuery를 이용하기 위해서는 jQuery java script를 추가해주어야 한다. 추가하는 방법은 jquery url을 직접 명시하는 경우, 프로젝트에 jquery java script를 직접 추가하여 참조하는 경우가 있다.</p><ul><li>jQuery url을 직접 명시하는 경우</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>script</span> <span style=color:#000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;//code.jquery.com/jquery-1.11.0.min.js&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;&lt;</span><span style=color:#a40000>/script&gt;</span>
</span></span></code></pre></div><ul><li>jQuery script를 직접 추가하여 참조하는 경우</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>script</span> <span style=color:#000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/javascript&#34;</span> <span style=color:#000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;jQuery파일 경로&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;&lt;</span><span style=color:#a40000>/script&gt;</span>
</span></span></code></pre></div><p>jquery-버전.js를 다운받아 프로젝트 하위경로에 추가한 후, 저장한 경로를 적어준다.</p><h2 id=jquery-ajax의-기본-기능>jQuery AJAX의 기본 기능</h2><h3 id=jqueryajax>jQuery.ajax()</h3><p>jQuery Ajax기능을 위해서는 기본적으로 jQuery.ajax(url[,settings]) 함수를 이용한다.</p><h4 id=ajax함수-안의-settings>ajax함수 안의 settings</h4><p>jQuery ajax함수 안에는 다음과 같은 설정들이 가능하다.</p><table><thead><tr><th>설정</th><th>설명</th><th>default</th><th>type</th></tr></thead><tbody><tr><td>url</td><td>request를 전달할 url명</td><td>N/A</td><td>url string</td></tr><tr><td>data</td><td>request에 담아 전달할 data명과 data값</td><td>N/A</td><td>String/Plain Object/Array</td></tr><tr><td>contentType</td><td>server로 데이터를 전달할 때 contentType</td><td>&lsquo;application/x-www-form-urlencoded; charset=UTF-8&rsquo;</td><td>contentType String</td></tr><tr><td>dataType</td><td>서버로부터 전달받을 데이터 타입</td><td>xml, json, script, or html</td><td>xml/html/script/json/jsonp/multiple, space-separated values</td></tr><tr><td>statusCode</td><td>HTTP 상태코드에 따라 분기처리되는 함수</td><td>N/A</td><td>상태코드로 분리되는 함수</td></tr><tr><td>beforeSend</td><td>request가 서버로 전달되기 전에 호출되는 콜백함수</td><td>N/A</td><td>Function( jqXHR jqXHR, PlainObject settings )</td></tr><tr><td>error</td><td>요청을 실패할 경우 호출되는 함수</td><td>N/A</td><td>Function( jqXHR jqXHR, String textStatus, String errorThrown )</td></tr><tr><td>success</td><td>요청에 성공할 경우 호출되는 함수</td><td>N/A</td><td>Function( PlainObject data, String textStatus, jqXHR jqXHR )</td></tr><tr><td>crossDomain</td><td>crossDomain request(jsonP와 같은)를 강제할 때 설정(cross-domain request설정 필요)</td><td>same-domain request에서 false, cross-domain request에서는 true</td><td>Boolean</td></tr></tbody></table><h5 id=예제-1>예제 1</h5><p>하나의 파라미터를 ajax request로 전달하는 예제는 다음과 같다.
example01.do로 호출을 하며 sampleInput이란 데이터명으로 “sampleData” String을 전달한다. 요청이 성공할 경우 success의 함수를 호출하며 실패시 error함수를 호출하는 자바스크립트 코드이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ajax</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>   <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;&lt;c:url value=&#39;/example01.do&#39;/&gt;&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>   <span style=color:#000>data</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>sampleInput</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;sampleData&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>   <span style=color:#000>success</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>textStatus</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>jqXHR</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//Sucess시, 처리
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>   <span style=color:#000>error</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>jqXHR</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>textStatus</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>errorThrown</span><span style=color:#000;font-weight:700>){</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//Error시, 처리
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h4 id=ajax함수의-callback함수>ajax함수의 callback함수</h4><p>ajax의 콜백함수이다. jQuery 1.5부터 jQuery의 모든 Ajax함수는 XMLHttpRequest객체의 상위 집합을 리턴받을 수 있게 되었다. 이 객체를 jQuery에서는 jqXHR이라 부르며, jqXHR의 함수로 콜백함수를 정의할 수 있다.</p><p>아래 콜백함수와 위의 settings에서 정의된 error, success콜백함수와 다른 점은 다음과 같다.</p><ul><li>사용자 정의에 의해 순차적으로 실행된다.</li><li>ajax에서 request를 리턴받아 호출할 수 있다.</li></ul><table><thead><tr><th>함수명</th><th>설명</th></tr></thead><tbody><tr><td><code>jqXHR.done(function( data, textStatus, jqXHR ) {});</code></td><td>성공시 호출되는 콜백함수</td></tr><tr><td><code>jqXHR.fail(function( jqXHR, textStatus, errorThrown ) {});</code></td><td>실패시 호출되는 콜백함수</td></tr><tr><td><code>jqXHR.always(function( data|jqXHR, textStatus, jqXHR'|errorThrown ) { });</code></td><td>항상 호출되는 콜백함수</td></tr></tbody></table><h5 id=예제-2>예제 2</h5><p>여러개의 데이터를 전달하며 호출 후 콜백함수로 서버에서 값을 받는 예제이다.
example02.do을 호출하며 name, location을 요청데이터로 전달한다. 성공시에 done콜백함수를 호출한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ajax</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>   <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;&lt;c:url value=&#39;/example02.do&#39;/&gt;&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>   <span style=color:#000>data</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;gil-dong&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#000>location</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;seoul&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>.</span><span style=color:#000>done</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>data</span> <span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span> <span style=color:#000>console</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span> <span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;Sample of data:&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>slice</span><span style=color:#000;font-weight:700>(</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>100</span> <span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h5 id=예제-3>예제 3</h5><p>example03.do를 호출하며 성공시 done콜백함수를, 실패시 fail콜백함수가 호출된다.
성공,실패여부에 상관없이 always콜백함수는 항상 호출된다. done, fail, always콜백함수는 ajax함수를 통해 리턴되 request로 호출가능하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>jqxhr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ajax</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;&lt;c:url value=&#39;/example03.do&#39;/&gt;&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>.</span><span style=color:#000>done</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;success&#34;</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>.</span><span style=color:#000>fail</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;error&#34;</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>.</span><span style=color:#000>always</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;complete&#34;</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>jqxhr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>always</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;second complete&#34;</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h3 id=jqueryget>jQuery.get()</h3><p>jQuery 1.5부터 sucess콜백함수는 jqXHR(XMLHttpRequest의 상위집합 객체)를 받을 수 있게 되었다. 그러나 JSONP와 같은 cross-domain request의 GET요청 시에는 jqXHR을 사용하여도 XHR인자는 success함수 안에서 undefined로 인식된다.</p><p>jQuery.get()은 ajax를 GET요청하는 함수이며 jqXHR을 반환받는다. 따라서 $.ajax()와 동일하게 done, fail, always콜백함수를 쓸 수 있다.
get함수는 ajax함수로 나타내면 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ajax</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>   <span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>url</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>   <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>   <span style=color:#000>success</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>success</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>   <span style=color:#000>dataType</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>dataType</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h4 id=get함수-설정>get함수 설정</h4><table><thead><tr><th>설정</th><th>설명</th><th>default</th><th>type</th></tr></thead><tbody><tr><td>url</td><td>request를 전달할 url명</td><td>N/A</td><td>url String</td></tr><tr><td>data</td><td>request에 담아 전달할 data명과 data값</td><td>N/A</td><td>String/Plain Object</td></tr><tr><td>dataType</td><td>서버로부터 전달받을 데이터 타입</td><td>xml, json, script, or html</td><td>String</td></tr><tr><td>success</td><td>요청에 성공할 경우 호출되는 함수</td><td>N/A</td><td>Function( PlainObject data, String textStatus, jqXHR jqXHR )</td></tr></tbody></table><h5 id=예제-1-1>예제 1</h5><p>url만 호출하고 결과값은 무시하는 경우</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;example.do&#34;</span> <span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h5 id=예제-2-1>예제 2</h5><p>url로 데이터만 보내고 결과는 무시하는 경우</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;example.do&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;gil-dong&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>location</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;seoul&#34;</span> <span style=color:#000;font-weight:700>}</span> <span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h5 id=예제-3-1>예제 3</h5><p>url를 호출하고 결과값을 Alert창으로 띄우는 경우</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;test.php&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>data</span> <span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;Data Loaded: &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>data</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h5 id=예제-4>예제 4</h5><p>url를 호출하고 결과값을 Alert창으로 띄우는 경우</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;example.do&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;gil-dong&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>location</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;seoul&#34;</span> <span style=color:#000;font-weight:700>}</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>.</span><span style=color:#000>done</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>data</span> <span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;Data Loaded: &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>data</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h3 id=jquerygetjson>jQuery.getJSON()</h3><p>ajax호출을 HTTP GET메서드로 JSON문자열로 인코딩한 데이터를 요청한다.
$.ajax()메서드로 표현하면 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ajax</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>    <span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>url</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>success</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>success</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>dataType</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;json&#39;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h4 id=getjson함수-설정>getJSON함수 설정</h4><table><thead><tr><th>설정</th><th>설명</th><th>default</th><th>type</th></tr></thead><tbody><tr><td>url</td><td>request를 전달할 url명</td><td>N/A</td><td>url String</td></tr><tr><td>data</td><td>request에 담아 전달할 data명과 data값</td><td>N/A</td><td>String/Plain Object</td></tr><tr><td>dataType</td><td>서버로부터 전달받을 데이터 타입</td><td>xml, json, script, or html</td><td>String</td></tr></tbody></table><h3 id=jquerypost>jQuery.post()</h3><p>jQuery.post()은 ajax를 POST요청하는 함수이며 jqXHR을 반환받는다. 따라서 ajax(), get()와 동일하게 done, fail, always콜백함수를 쓸 수 있다.
jQuery.post 함수 설정은 get함수와 동일하다.(jQuery.post( url [, data ] [, success ] [, dataType ] ))</p><p>jQuery.post함수를 ajax함수로 쓰면 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ajax</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>    <span style=color:#000>type</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;POST&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>url</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>url</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>success</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>success</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>dataType</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>dataType</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h4 id=예제-1-2>예제 1</h4><p>url만 호출하고 결과값은 무시하는 경우</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>post</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;example.do&#34;</span> <span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h4 id=예제-2-2>예제 2</h4><p>url로 데이터만 보내고 결과는 무시하는 경우</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>post</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;example.do&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;gil-dong&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>location</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;seoul&#34;</span> <span style=color:#000;font-weight:700>}</span> <span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h4 id=예제-3-2>예제 3</h4><p>url를 호출하고 결과값을 console log를 남기는 경우</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>post</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;example.do&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>data</span> <span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>name</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>location</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h4 id=예제-4-1>예제 4</h4><p>url로 데이터를 호출하고 결과값을 Alert창으로 띄우는 경우</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>post</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;example.do&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;gil-dong&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>location</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;seoul&#34;</span> <span style=color:#000;font-weight:700>}</span> <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>.</span><span style=color:#000>done</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>data</span> <span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;Data Loaded: &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>data</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h2 id=jquery-ajax-응용>jQuery Ajax 응용</h2><p>jQuery의 ajax 추가 UI기능(자동완성기능, 판넬 탭 등)을 사용하기 위해서는 jQuery UI를 설정해주어야 한다. 다음에서는 jQuery UI와 ajax를 이용한 자동완성기능(autocomplete), 판넬 탭(tabs)에 대하여 가이드한다.</p><h3 id=jquery-ui-설정>jQuery UI 설정</h3><p>jQuery UI(version 1.11.0)을 추가하기 위해서는 위에서 설정했던 기본 jQuery script와 jQuery ui스크립트를 다음과 같이 jsp에 추가해준다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>link</span> <span style=color:#000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css&#34;</span> <span style=color:#ce5c00;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>script</span> <span style=color:#000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;//code.jquery.com/jquery-1.11.0.min.js&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;&lt;</span><span style=color:#a40000>/script&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>script</span> <span style=color:#000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://code.jquery.com/ui/1.11.0/jquery-ui.js&#34;</span><span style=color:#ce5c00;font-weight:700>&gt;&lt;</span><span style=color:#a40000>/script&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>...</span>
</span></span></code></pre></div><p>jQuery UI script를 직접 추가하여 참조하는 경우는 jQuery-ui.js와 jQuery-ui.css를 다운받아 프로젝트 하위 경로에 추가한 후, 저장한 경로를 지정해준다.</p><h2 id=auto-complete>Auto complete</h2><p>jQuery에서는 input창에서 예상되는 텍스트값을 보여주는 자동완성기능을 쉽게 구현할 수 있도록 autoComplete()을 제공하고 있다.</p><h3 id=autocomplete의-설정>autoComplete의 설정</h3><table><thead><tr><th>구분</th><th>설정</th><th>설명</th><th>Type</th></tr></thead><tbody><tr><td>Options</td><td>source</td><td>하단에 뜨는 자동완성리스트(필수값)</td><td>Array, String, function</td></tr><tr><td>Options</td><td>minLength</td><td>자동완성이 동작하는 최소 문자열 수</td><td>Integer</td></tr><tr><td>Options</td><td>disabled</td><td>disable 여부</td><td>Boolean</td></tr><tr><td>Events</td><td>change(event, ui)</td><td>값 변경시 발생하는 이벤트 함수</td><td>autocompletechange</td></tr><tr><td>Events</td><td>focus( event, ui )</td><td>값이 포커스될 때 발생하는 이벤트 함수</td><td>autocompletefocus</td></tr><tr><td>Events</td><td>select( event, ui )</td><td>값이 선택될 때 발생하는 이벤트 함수</td><td>autocompleteselect<br><br></td></tr><tr><td>자세한 내용은 <a href=https://api.jqueryui.com/autocomplete/>jQuery 사이트의 autocomplete api</a>을 참고한다.</td><td></td><td></td><td></td></tr></tbody></table><h3 id=autocomplete-기본-예제>autoComplete 기본 예제</h3><p>기본 autoComplete기능 구현은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;en&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>jQuery UI Autocomplete - Default functionality<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;//code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;//code.jquery.com/jquery-1.10.2.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;//code.jquery.com/ui/1.11.0/jquery-ui.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/resources/demos/style.css&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>availableTags</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span> <span style=color:#4e9a06>&#34;ActionScript&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;AppleScript&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Asp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;BASIC&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>				<span style=color:#4e9a06>&#34;C&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;C++&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Clojure&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;COBOL&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ColdFusion&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Erlang&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>				<span style=color:#4e9a06>&#34;Fortran&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Groovy&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Haskell&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Java&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;JavaScript&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Lisp&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>				<span style=color:#4e9a06>&#34;Perl&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;PHP&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Python&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Ruby&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Scala&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Scheme&#34;</span> <span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;#tags&#34;</span> <span style=color:#000;font-weight:700>).</span><span style=color:#000>autocomplete</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>      <span style=color:#000>source</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>availableTags</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ui-widget&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>for</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tags&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Tags: <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tags&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위와 같이 했을 때 결과는 다음과 같다.</p><p><img src=../images/jquery-ajax-simpleautocomplete.png alt=simpleautocomplete></p><p>minLength는 default값이 1이기 때문에 input에 1개이상의 문자를 입력했을 때 source의 String배열들이 자동문자리스트로 뜨게 된다.</p><h3 id=autocomplete와-ajax를-이용한-응용예제>autoComplete와 ajax를 이용한 응용예제</h3><p>ajax를 통해 리스트를 받아와 autoComplete의 source로 뿌려주는 예제에 대해 살펴보자.</br>ajax를 통해 source를 가져오기 위해서는 서버호출 결과값이 2가지 중 하나의 타입이어야 한다.</p><ul><li>String array타입</li><li>Object(id, label,value 값을 갖는) array타입</li></ul><ol><li>String array로 가져오는 경우
example.do라는 url로 ajax호출을 통해 source를 가져오고 선택 시 값이 alert되도록 하는 예제이다.</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/javaScript&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;#autoValue&#39;</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>autocomplete</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>         <span style=color:#000>source</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	    <span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ajax</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>	       <span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;&lt;c:url value=&#39;/example.do&#39;/&gt;&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>	       <span style=color:#000>data</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>input</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>request</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>term</span> <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>               <span style=color:#000>success</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	          <span style=color:#000>response</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>locations</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	       <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>	   <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>	 <span style=color:#000>minLength</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>	 <span style=color:#000>select</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>event</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ui</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>ui</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>item</span> <span style=color:#ce5c00;font-weight:700>?</span> <span style=color:#4e9a06>&#34;Selected : &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>ui</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>item</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>label</span>
</span></span><span style=display:flex><span>		<span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Nothing select, input was &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>value</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	 <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>     <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>//... 생략
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;autoValue&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>//... 생략
</span></span></code></pre></div><p>data로 전송하는 request.term은 input값으로 사용자가 입력한 값이다. 즉, 사용자가 “je”를 입력하면 input = je 로 값이 넘어간다.</br>이 때 Controller에서는 reqeust.getParameter(“input”) 또는 @RequestParam(“input”) String input으로 값을 꺼낼 수 있다.</br></p><p>다음은 MappingJacksonJsonView의 빈을 jsonView로 등록했을 때 Controller에서 data를 꺼내고 결과값을 client로 넘겨주는 예제이다.(Ajax통신 시 java코드는 &lt;Ajax support java code 위키>를 참고한다.)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/autoList.do&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>autoList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ModelMap</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>String</span> <span style=color:#000>input</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getParameter</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;input&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>resultList</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>//...생략...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#8f5902;font-style:italic>//서비스클래스를 통해 결과값을 resultList에 담음		
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;locations&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>resultList</span> <span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;jsonView&#34;</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>이 때, 호출되는 Query문의 예이다. (mybatis예제)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;select</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;selectLocationList&#34;</span> <span style=color:#c4a000>parameterType=</span><span style=color:#4e9a06>&#34;string&#34;</span> <span style=color:#c4a000>resultType=</span><span style=color:#4e9a06>&#34;string&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>SELECT
</span></span><span style=display:flex><span>	LOCATION_NM
</span></span><span style=display:flex><span>FROM LOCATION
</span></span><span style=display:flex><span>	WHERE upper(LOCATION_NM) LIKE &#39;%&#39; || upper(#{input}) || &#39;%&#39;
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/select&gt;</span>
</span></span></code></pre></div><p>만약 결과값이 다음과 같다면</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;locations&#34;</span><span style=color:#000;font-weight:700>:[</span><span style=color:#4e9a06>&#34;Daejeon&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;Jeju-do&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;Jeolabuk-do&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;Jeolanam-do&#34;</span><span style=color:#000;font-weight:700>]}</span>
</span></span></code></pre></div><p>ajax의 성공시 콜백함수인 success에서는 data.locations로 값을 꺼내 autocomplete의 source를 설정할 수 있다.</br>위와 같은 경우 결과 화면은 다음과 같다.</p><p><img src=../images/jquery-ajax-autocomplete02.png alt=autocomplete02></p><ol start=2><li>Object array로 가져오는 경우</li></ol><p>위와 동일하게 Query문을 통해 입력값에 따라 데이터를 검색하고 Object array로 서버에서 결과값을 가져오는 경우에 대해 가이드한다.</br>Controller에서 List<object>의 값을 ModelMap에 “locations”라는 이름으로 클라이언트로 넘겨주고 서버에서 다음과 같이 json data가 넘어왔을 때</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;locations&#34;</span><span style=color:#000;font-weight:700>:[{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0006&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Daejeon&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;localNb&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;042&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0010&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Jeju-do&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;localNb&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;064&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0011&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Jeolabuk-do&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;localNb&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;063&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0012&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Jeolanam-do&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;localNb&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;061&#34;</span><span style=color:#000;font-weight:700>}]}</span>
</span></span></code></pre></div><p>autocomplete의 source에 넘어온 값이 나타나도록 하는 Object는 label, id, value값을 가질 수 있다. 그렇기 때문에 넘어온 request의 값을 success콜백함수에서 source에 나타나도록하는 Object형태로 변환해야 한다.</br>나머지 jQuery구현은 동일하다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>success</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>response</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>map</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>locations</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>item</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>item</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>locationId</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#000>label</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>item</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>locationNm</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic>//value: item.localNb
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000;font-weight:700>}));</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>이 때, 자동완성 리스트로 나타나는 값은 label이며, value를 설정해주었을때는 자동완성 리스트에서 값 선택 시 input값에 label값이 아닌 value값이 대입된다.</p><h2 id=select-box>Select box</h2><h3 id=selectboxcombobox-제어>selectbox(combobox) 제어</h3><p>jQuery에서는 별도로 select box ui함수를 제공하지 않는다.</br>jQuery를 통해 selectbox를 제어하는 방법에 대하여 알아보고 selectbox에 나타나는 리스트를 ajax로 구현하는 방법에 대하여 살펴본다.</br>다루고자 하는 selectbox가 다음과 같다고 가정하자.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>select</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;combobox&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>===locations===<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;01&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Seoul<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;02&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Busan<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;03&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Jeju-do<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;04&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Incheon<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>select</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><h4 id=selectbox-값-가져오기>selectbox 값 가져오기</h4><p>selectbox에서 선택된 value를 가져오는 방법은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>selectedVal</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;#combobox option:selected&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>val</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=selectbox-내용-가져오기>selectbox 내용 가져오기</h4><p>selectbox에서 선택된 text(ex:Seoul)를 가져오는 방법은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>selectedText</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;#combobox option:selected&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>text</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=selectbox에서-선택된-index값-가져오기>selectbox에서 선택된 Index값 가져오기</h4><p>selectbox의 리스트에서 선택된 Index를 구하는 방법은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>selectedIndex</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;#combobox option&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>index</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;#combobox option:selected&#34;</span><span style=color:#000;font-weight:700>));</span>
</span></span></code></pre></div><h4 id=selectbox에-리스트-마지막에-추가하기>selectbox에 리스트 마지막에 추가하기</h4><p>selectbox의 리스트에 값을 마지막에 추가하는 방법은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;#combobox&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;&lt;option value=&#34;</span><span style=color:#0000cf;font-weight:700>05</span><span style=color:#4e9a06>&#34;&gt;Daejeon&lt;/option&gt;&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><p>맨 앞에 추가하는 경우는 .prepend()를 쓴다.</p><h4 id=selectbox-값-교체하기>selectbox 값 교체하기</h4><p>selectbox의 리스트의 값들을 교체하는 방법은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>$(&#34;#combobox&#34;).html(
</span></span><span style=display:flex><span>&#34;<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;&#39;</span><span style=color:#000;font-weight:700>&gt;</span>===locations===<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;01&#39;</span><span style=color:#000;font-weight:700>&gt;</span>Jeju-do<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;02&#39;</span><span style=color:#000;font-weight:700>&gt;</span>Seoul<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;03&#39;</span><span style=color:#000;font-weight:700>&gt;</span>Incheon<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;04&#39;</span><span style=color:#000;font-weight:700>&gt;</span>Daejeon<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>&#34;)
</span></span></code></pre></div><h4 id=selectbox-값-교체하기-1>selectbox 값 교체하기</h4><p>selectbox의 리스트의 값들을 교체하는 방법은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>$(&#34;#combobox&#34;).html(
</span></span><span style=display:flex><span>&#34;<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;&#39;</span><span style=color:#000;font-weight:700>&gt;</span>===locations===<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;01&#39;</span><span style=color:#000;font-weight:700>&gt;</span>Jeju-do<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;02&#34;&gt;Seoul&lt;/option&gt;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>   &lt;option value=&#39;</span><span style=color:#c4a000>03</span><span style=color:#a40000>&#39;</span><span style=color:#000;font-weight:700>&gt;</span>Incheon<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;04&#39;</span><span style=color:#000;font-weight:700>&gt;</span>Daejeon<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>&#34;)
</span></span></code></pre></div><h4 id=selectbox에서-값-삭제하기>selectbox에서 값 삭제하기</h4><p>selectbox의 리스트에서 선택된 값을 삭제하는 방법은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;#combobox option:selected&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>remove</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h4 id=selectbox에서-값이-선택될-때-콜백함수>selectbox에서 값이 선택될 때 콜백함수</h4><p>selectbox에서 값이 선택되었을 때 호출되는 콜백함수는 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#a40000>&#34;#</span><span style=color:#000>combobox</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>change</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//기능구현
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h3 id=selectbox-만들기>selectbox 만들기</h3><p>위에서 쓴 selectbox 제어기능과 jQuery ajax함수를 이용하여 다음과 같이 간단히 selectbox를 만들 수 있다.</p><p>&lt;JSP에서 콤보박스 구현 예제></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/javaScript&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ajax</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>			<span style=color:#000>url</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;&lt;c:url value=&#39;/simpleCombo.do&#39;/&gt;&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>success</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>loadCombo</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;#combobox&#34;</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>locations</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>                                <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;#combobox&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>val</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>			<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;#combobox&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>change</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Selected : &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;#combobox option:selected&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>val</span><span style=color:#000;font-weight:700>());</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>loadCombo</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>target</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>dataArr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[];</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>inx</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#000>target</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>empty</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>each</span><span style=color:#000;font-weight:700>(</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>dataArr</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>inx</span><span style=color:#ce5c00;font-weight:700>++</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&lt;option value=&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>locationId</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;&gt;&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>locationNm</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;&lt;/option&gt; &#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>		<span style=color:#000>target</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dataArr</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>//... 생략
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>select</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;combobox&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>===locations===<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>option</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>select</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>&lt;서버에서 가져오는 결과값></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;locations&#34;</span><span style=color:#000;font-weight:700>:[{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0001&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Seoul&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0002&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Busan&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0003&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Daegu&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0004&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Gwangju&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0005&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Incheon&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0006&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Daejeon&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0007&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Ulsan&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0008&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Gyeonggi-do&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0009&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Gangwon-do&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0010&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Jeju-do&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0011&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Jeolabuk-do&#34;</span><span style=color:#000;font-weight:700>},{</span><span style=color:#204a87;font-weight:700>&#34;locationId&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;0012&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;locationNm&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Jeolanam-do&#34;</span><span style=color:#000;font-weight:700>}]}</span>
</span></span></code></pre></div><p>ajax함수가 실행되면서 simpleCombo.do를 통해 data를 가져오고 json값이 위와 같을 때 combobox를 구성하는 함수를 구현하여 combobox에 나오는 목록을 나타낼 수 있다.
위의 결과는 다음과 같다.</p><p><img src=../images/jquery-ajax-selectbox.png alt=selectbox></p><h2 id=tabs>Tabs</h2><p>Tab 기본 구현하기
jQuery UI에서 tab구현은 tabs()를 쓰며 추가 설정은 다음과 같다.</p><table><thead><tr><th>설정</th><th>설명</th><th>구분</th></tr></thead><tbody><tr><td>active</td><td>활성화될 panel선택</td><td>options</td></tr><tr><td>event</td><td>tab이 활성화되는 이벤트</td><td>options</td></tr><tr><td>hide</td><td>panel이 숨겨질 때 애니메이션</td><td>options</td></tr><tr><td>show</td><td>panel이 나타날 때 애니메이션</td><td>options</td></tr><tr><td>beforeLoad</td><td>Remote tab이 로드되기 전에 실행되기 전에 발생되는 이벤트 함수</td><td>events</td></tr><tr><td>create</td><td></td><td>events<br></td></tr></tbody></table><p>Tab을 구현하는 경우 기본 예제는 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!doctype html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;en&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>jQuery UI Tabs - Default functionality<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;//code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;//code.jquery.com/jquery-1.10.2.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;//code.jquery.com/ui/1.11.0/jquery-ui.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/resources/demos/style.css&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;#tabs&#34;</span> <span style=color:#000;font-weight:700>).</span><span style=color:#000>tabs</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tabs&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>ul</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#tabs-1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Nunc tincidunt<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#tabs-2&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Proin dolor<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#tabs-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Aenean lacinia<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>ul</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tabs-1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin. Sed ut dolor nec orci tincidunt interdum. Phasellus ipsum. Nunc tristique tempus lectus.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tabs-2&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Morbi tincidunt, dui sit amet facilisis feugiat, odio metus gravida ante, ut pharetra massa metus id nunc. Duis scelerisque molestie turpis. Sed fringilla, massa eget luctus malesuada, metus eros molestie lectus, ut tempus eros massa ut dolor. Aenean aliquet fringilla sem. Suspendisse sed ligula in ligula suscipit aliquam. Praesent in eros vestibulum mi adipiscing adipiscing. Morbi facilisis. Curabitur ornare consequat nunc. Aenean vel metus. Ut posuere viverra nulla. Aliquam erat volutpat. Pellentesque convallis. Maecenas feugiat, tellus pellentesque pretium posuere, felis lorem euismod felis, eu ornare leo nisi vel felis. Mauris consectetur tortor et purus.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tabs-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Mauris eleifend est et turpis. Duis id erat. Suspendisse potenti. Aliquam vulputate, pede vel vehicula accumsan, mi neque rutrum erat, eu congue orci lorem eget lorem. Vestibulum non ante. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Fusce sodales. Quisque eu urna vel enim commodo pellentesque. Praesent eu risus hendrerit ligula tempus pretium. Curabitur lorem enim, pretium nec, feugiat nec, luctus a, lacus.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Duis cursus. Maecenas ligula eros, blandit nec, pharetra at, semper at, magna. Nullam ac lacus. Nulla facilisi. Praesent viverra justo vitae neque. Praesent blandit adipiscing velit. Suspendisse potenti. Donec mattis, pede vel pharetra blandit, magna ligula faucibus eros, id euismod lacus dolor eget odio. Nam scelerisque. Donec non libero sed nulla mattis commodo. Ut sagittis. Donec nisi lectus, feugiat porttitor, tempor ac, tempor vitae, pede. Aenean vehicula velit eu tellus interdum rutrum. Maecenas commodo. Pellentesque nec elit. Fusce in lacus. Vivamus a libero vitae lectus hendrerit hendrerit.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위의 결과는 다음과 같다.</p><p><img src=../images/jquery-ajax-panel.png alt=panel></p><ul><li>referenced <a href=https://jqueryui.com/tabs/#default>jquery ui site</a></li></ul><p>ajax로 Tab 구현하기
ajax로 Tab을 구현하기 위해서는 각 Tab에 ajax호출 url을 지정해주기만 하면 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://code.jquery.com/jquery-1.10.2.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://code.jquery.com/ui/1.11.0/jquery-ui.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/javaScript&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span> <span style=color:#4e9a06>&#34;#tabs&#34;</span> <span style=color:#000;font-weight:700>).</span><span style=color:#000>tabs</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>      <span style=color:#000>beforeLoad</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span> <span style=color:#000>event</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ui</span> <span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>ui</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>jqXHR</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>ui</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>panel</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>html</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>            <span style=color:#4e9a06>&#34;Couldn&#39;t load this tab. We&#39;ll try to fix this as soon as possible. &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span>
</span></span><span style=display:flex><span>            <span style=color:#4e9a06>&#34;If this wouldn&#39;t be a demo.&#34;</span> <span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tabs&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>ul</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${pageContext.request.contextPath }/simpleCombo.do&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Tab 1<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	 <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${pageContext.request.contextPath }/tabTwoForm.do&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Tab 2<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>	 <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${pageContext.request.contextPath }/tabThreeForm.do&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Tab 3<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>ul</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위의 경우 첫번째 탭 지정시 simpleCombo.do가 호출되어 panel안에 simpleCombo.do를 통해 호출된 화면이 보여진다.</p><h2 id=참고자료>참고자료</h2><ul><li><a href=https://jquery.com/>jQuery Web Site</a></li><li><a href=https://jqueryui.com/index.html>jQuery UI Web Site</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-35218b5f118a49ed5ac39c858d34c2bf>26 - WebSocket</h1><div class=lead>WebSocket은 HTTP 환경에서 양방향 통신을 지원하는 Spring 기술로, Spring은 기본적으로 STOMP sub-protocol을 사용한다. Spring Framework 4.0부터 spring-websocket 모듈이 추가되어 복잡한 WebSocket 통신을 지원하며, JSR356(Java WebSocket API)과 호환된다.</div><h1 id=websocket>WebSocket</h1><h2 id=개요>개요</h2><p>WebSocket 은 HTTP 환경에서 소켓 통신을 지원하기 위한 Spring 기술이다. Spring 은 기본적으로 WebSocket sub-protocol 로 STOMP 를 사용한다.</p><p>(RFC6455는 웹 어플리케이션을 위한 새 기능으로 WebSocket protocol을 정의한다. 서버와 클라이언트간 양방향 통신(full-duplex)을 지원하는데, 이것은 웹을 좀 더 인터랙티브하게 만들기 위해 사용하였던 java applet, XMLHttpRequest, Flash, ActiveX 등의 기술을 대체하기 위한 중요한 기능이 될 수 있다.)</p><p>HTTP 는 초기 handshake (protocol upgrade or switch 요청이고 서버가 동의하는 경우 101 응답을 내려 줌)를 위해서만 사용되며, handshake 가 성공하면 HTTP upgrade 요청에 기인하는 TCP 소켓이 open 된 채 서버와 클라이언트간 통신을 처리한다.</p><ul><li>Spring Framework 4.0 에서는 새로운 spring-websocket module 을 포함하며 이를 통해 복잡한 WebSocket 을 지원하고, 이 모듈은 Java WebSocket API (JSR356) 과 호환되며 추가적인 기능을 제공한다.</li></ul><h3 id=spring-framework-40-websocket-지원-기능>Spring Framework 4.0 WebSocket 지원 기능</h3><p>WebSocket을 위한 요구사항.</p><ul><li>Java EE 7, JDK 7</li><li>Servlet 3.1 ( Container : Apache Tomcat 7.0.47+, Eclipse Jetty 9.0+, GlassFish 4.0+ )</li><li>Spring MVC 4.0이상 (eGov 3.5에 포함)</li><li>websocket을 지원하는 브라우저 <a href=http://websocketstest.com/>websocket 브라우저 테스트 페이지</a></li></ul><p><strong>1. WebSocket Fallback Options</strong></p><p>WebSocket은 Servlet 3.1에서 제공하기 시작한 기능을 이용하여 구현된 기술로서 모든 브라우저가 WebSocket을 지원하지는 않는다(IE는 10부터 지원).
따라서 WebSocket을 지원하지 않는 브라우저의 경우 해당 기능을 사용할 수 없고, 몇몇 Proxy 에서는 긴 연결상태를 강제로 끊어버리는 등의 오작동이 있을 수 있다. (관련 대안으로 fallback option을 지원하도록 구성된 Spring framework의 SockJS protocol 참고 - Spring 설정을 활성화 시킴으로서 쉽게 Application 에 적용 가능)</p><p><strong>2. Messaging Architecture</strong></p><p>기존에 구성하던 방식의 개발방법인 REST는 Web application 개발에 있어 많은 URL (noun) 과 몇개의 HTTP method (verbs), 그리고 상태와 무관한 architecture 를 사용한다.</p><p>WebSocket application 에서는 초기 HTTP handshake 에서만 하나의 URL 을 사용하고, 그 후의 모든 메시지는 handshake 시 맺어진 TCP 연결을 통해서 전송된다. 이것은 전통적인 messging application (JMS, AMQP) 과 가까운 비동기, event-driven, messaging 아키텍처를 사용하는 것이다.</p><p>Spring Framework 4.0 에서는 spring-messging 모듈을 통해 기능을 제공하는데, 이 모듈은 스프링 통합 프로젝트에서 사용하는 Message, MessageChannel, MessageHandler 와 같은 추상화된 개념을 제공하여 messaging archtecture 의 근간이 된다. 이 모듈은 Spring MVC annotaion 기반의 programming model 과 유사하게 작성할 수 있도록 몇 가지 annotation 을 포함하고 있다.</p><p><strong>3. Sub-Protocol Support in WebSocket</strong></p><p>WebSocket 은 messaging architecture 를 함축하지만 특정 messaging protocol 사용을 강제하지 않는다. 이것은 매우 얇은 layer 이며 단순히 TCP 위에서 일련의 byte 스트림들을 메시지로 변환하는 것에 지나지 않는다. 메시지의 의미 해석은 Application 에 맡겨둔 채 말이다.</p><p>HTTP (이것은 application level protocol 이다.) 와 달리 WebSocket 의 protocol 은 단순화 하여 어떻게 처리할지 어디로 route 할지에 대한 충분한 정보가 제공되지 않는 저수준으로 제공된다. 이러한 이유로 WebSocket RFC 에서는 sub-protocol 들의 사용을 정의하였다. handshake 사용 중 클라이언트와 서버는 Sec-WebSocket-Protocol 헤더를 사용할 수 있고 이를 통해 서로 통신할 sub protocol 을 합의한다. WebSocket 은 sub-protocol 을 강제하지 않기에 필수적인 것은 아니지만 이 경우 client/server 는 서로 message 포맷에 대해 합의되어야 한다.</p><p>Spring 은 STOMP 지원을 제공하며 이는 HTTP 와 유사한 형태로 script 언어에서 사용을 위해 만들어진 것이다. STOMP 는 널리 지원되고 WebSocket 사용에 적합하다.</p><p><strong>4. WebSocket 을 사용하여야 하는가?</strong></p><p>WebSocket 은 서버와 클라이언트가 적은 지연에 매우 빈번하게 이벤트를 교환해야 할 경우에 적합하다. 이는 finance, game, collaboration 등의 application 일 수 있다. 이들은 모두 time delay 에 민감하고 매우 빈번하게 많은 종류의 메시지를 교환해야 한다.</p><p>social, news feed 와 같은 경우는 단순 polling 으로 충분하다. 이들은 latency 가 중요한 요소가 아니다. latency 가 중요하더라도 message 의 크기가 작다면 (network failure check 같은) long polling 이 충분한 대안이 될 수 있다.</p><p>low latency 와 high frequency 가 중요한 경우에는 WebSocket 이 적합하다. 하지만 이러한 경우에도 모든 client-server 통신이 WebSocket 을 이용해야 하는 지는 application 에 따라 다를 수 있다. 최적의 경우를 생각하여 client 가 사용할 수 있는 대안으로서 WebSocket 과 REST API 를 모두 제공해야 할 수도 있다. 이 경우 REST 호출을 통해 특정 메시지를 WebSocket 클라이언트들에게 모두 전달될 필요가 있을 수도 있다.</p><p>Spring Framework 는 @Controller, @RestController 클래스에 HTTP 핸들링 메소드와 WebSocket 핸들링 메소드를 사용할 수 있다. 게다가 Spring MVC 요청 핸들링 메소드는 모든 WebSocket 클라이언트에 메시지를 전달하거나 특정 사용자에게만 전달하는 것을 쉽게 제공한다.</p><h3 id=websocket-api>WebSocket API</h3><p>Spring Framework 는 다양한 WebSocket Engine 에 적합하게 설계되었다. 예를 들어 Tomcat (7.0.47+) or GlassFish (4.0+), WildFly (8.0+) JSR-356 런타임상에서 구동하거나 Jetty (9.1+) 에서와 같이 native WebSocket 지원 환경에서 구동할 수 있다.</p><p>직접적인 WebSocket API 를 application 개발에 사용하는 것은 매우 저수준의 행위까지 설계해야 한다. 메시지 포맷에 대한 것 또는 annotation 을 통한 message 라우팅 같은 것을 지원하도록 application 에서는 sub-protocol 을 사용하는 것이 좋으며, 이러한 맥락에서 Spring 은 STOMP over WebSocket 을 지원한다.</p><h4 id=spring-websocket-지원-살펴보기>Spring WebSocket 지원 살펴보기</h4><p><strong>1. WebSocketHandler 설정</strong></p><p>Spring 은 WebSocketHandler 를 구현함으로 WebSocket 서버를 만드는 것을 지원한다. WebSocketHandler 는 TextWebSocketHandler 나 BinaryWebSocketHandler 로 세분화 되어 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.web.socket.WebSocketHandler</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.web.socket.WebSocketSession</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.web.socket.TextMessage</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>MyHandler</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>TextWebSocketHandler</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>handleTextMessage</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebSocketSession</span> <span style=color:#000>session</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>TextMessage</span> <span style=color:#000>message</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>특정 URL 에 WebSocketHandler 를 설정하는 Java-Config 설정</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.web.socket.config.annotation.EnableWebSocket</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.web.socket.config.annotation.WebSocketConfigurer</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.web.socket.config.annotation.WebSocketHandlerRegistry</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocket</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>registerWebSocketHandlers</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebSocketHandlerRegistry</span> <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>myHandler</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#4e9a06>&#34;/myHandler&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>WebSocketHandler</span> <span style=color:#000>myHandler</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MyHandler</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>동일 설정을 위한 XML Config 설정</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:websocket=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/websocket&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34; 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket/spring-websocket-4.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;websocket:handlers&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:mapping</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/myHandler&#34;</span> <span style=color:#c4a000>handler=</span><span style=color:#4e9a06>&#34;myHandler&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/websocket:handlers&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;myHandler&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.samples.MyHandler&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>위의 설정은 Spring 의 DispatcherServlet 을 사용하는 설정이다. 하지만 Spring 은 다른 Web 개발 환경에서 WebSocketHandler 를 사용할 수 있도록 WebSocketHttpRequestHandler 를 지원한다.</p><p><strong>2. WebSocket Handshaking 커스터마이즈</strong></p><p>초기 WebSockethandshake 를 커스터마이징 하는 가장 손쉬운 방법은 HandshakeInterceptor 를 사용하는 것인데 이것은 handshake 하는 것에 대한 before 와 after 처리를 기술할 수 있다. 이것은 handshake 를 준비하기 위해 사용되거나 WebSocketSession 에서 특정 attribute 를 이용할 수 있도록 하는데 사용된다. 아래는 Spring 에서 제공되는 interceptor 로 http 세션 attribute 를 WebSocketSession 에 전달해 주는 일을 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocket</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>registerWebSocketHandlers</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebSocketHandlerRegistry</span> <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MyHandler</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#4e9a06>&#34;/myHandler&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addInterceptors</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>HttpSessionHandshakeInterceptor</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:websocket=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/websocket&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34; 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket/spring-websocket-4.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;websocket:handlers&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:mapping</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/myHandler&#34;</span> <span style=color:#c4a000>handler=</span><span style=color:#4e9a06>&#34;myHandler&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:handshake-interceptors&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.web.socket.server.support.HttpSessionHandshakeInterceptor&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/websocket:handshake-interceptors&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/websocket:handlers&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;myHandler&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.samples.MyHandler&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>좀 더 고급 옵션을 적용하려면 DefaultHandshakeHandler 를 확장하여야 한다. 이것은 validating, client origin, sub-protocol 협의 및 기타 여러가지를 포함하고 있다. application 은 특정 WebSocket server engine 이나 아직 지원하지 않는 버전에 대한 지원을 위해서 커스텀 RequestUpgradeStrategy 를 설정할 필요가 있다.</p><p><strong>3. WebSocketHandler Decoration</strong></p><p>Spring 은 WebSocketHandlerDecorator 기본 클래스를 제공한다. 이것은 WebSocketHandler 에 추가적인 행위를 decorate 하는데 사용된다. Logging, Exception Handling WebSocketHandlerDecorator 구현이 Java-config 나 XML config 를 통해서 기본적으로 제공되고 있다. ExceptionWebSocketHandlerDecorator 는 WebSocketHandler 에서 발생하는 처리되지 않은 모든 예외를 catch 하여 Server error 를 나타내기 위해 1011 status code 로 응답한다.</p><p><strong>4. 배포 고려사항</strong></p><p>Spring WebSocket API 는 Spring MVC application 과 통합이 쉽다. 그것은 Dispatcher Servlet 이 HTTP WebSocket handshake 뿐만 아니라 다른 HTTP 요청도 서비스 하기 때문이다. WebSocketHttpRequestHandler 를 사용하면 다른 HTTP 처리 시나리오 (Spring MVC 이외의 다른 Web Framework 와 같은) 와도 쉽게 결합할 수 있다. 그러나 JSR-356 runtime 에 특별한 고려사항이 있다.</p><p>Java WebSocket API (JSR-356) 는 두가지 배포 메커니즘을 제공한다. 첫번째는 시작 시 Servlet container classpath scan (Servlet 3 의 기능) 에 관한 것이고 다른 것은 Servlet container 초기화에서 사용하기 위한 registration API 에 관한 것이다. 이것 중 어느 것도 모든 HTTP 요청을 처리하는 단일 front controller 를 사용하지 못한다. 즉 DispatcherServlet 은 원칙적으로 WebSocket handshake 와 다른 모든 HTTP 요청에 대해서 사용할 수 없다.</p><p>이것은 JSR-356 이 가지는 매우 중요한 한계인데 Spring 의 WebSocket 지원은 JSR-356 runtime 환경에서도 서버 특화의 RequestUpgradeStrategy 를 제공함으로 이를 지원하고 있다. 현재 Spring 은 Tomcat 7.0.47+, Jetty 9.1+, GlassFish4.0+, WildFly8.0+ 을 지원한다. 추가적인 지원은 더 많은 WebSocket runtime 을 이용할 수 있을 때 추가될 것이다.</p><p>두 번째 고려사항은 JSR-356 지원의 Servlet container 가 SCI scan 을 수행하도록 하고 있어 application 구동을 느리게 (혹은 어떤 특정 상황에서는 매우 느리게) 할 수 있다는 것이다. 만약 JSR-356 지원 Servlet container version 업그레이드시 명백한 영향이 목격된다면, 선택적으로 web fragments (SCI scanning) 을 활성 및 비활성할 수 있다. (이는 web.xml 의 absolute-ordering 을 사용토록 한다.) web fragment 순서를 명확히 하도록 web.xml 에서 absolute-ordering 을 사용 토록 한다. (이는 scanning 을 사용치 않도록 하는 방법이다.)</p><p><strong>5. WebSocket 엔진 설정하기</strong></p><p>각각의 기반이 되는 WebSocket engine 들은 message buffer size 나 idle timeout 등의 runtime 특성을 조절할 수 있는 configuration properties 를 가지고 있다. 이는 Tomcat, WildFly, Glassfish 에서ServletServerContainerFactoryBean 을 WebSocket java config 에 추가하여 설정할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocket</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ServletServerContainerFactoryBean</span> <span style=color:#000>createWebSocketContainer</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>ServletServerContainerFactoryBean</span> <span style=color:#000>container</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ServletServerContainerFactoryBean</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#000>container</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setMaxTextMessageBufferSize</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>8192</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>container</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setMaxBinaryMessageBufferSize</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>8192</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>container</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:websocket=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/websocket&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34; 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket/spring-websocket.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework...ServletServerContainerFactoryBean&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;maxTextMessageBufferSize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;8192&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;maxBinaryMessageBufferSize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;8192&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>client 측 WebSocket 설정을 위해서는 WebSocketContainerFactoryBean(XML) 이나 ContainerProvider.getWebSocketContainer() 를 이용한다.</p><p>Jetty 를 사용하는 경우에는 미리 설정된 WebSocketServerFactory 를 필요로 하고 이를 WebSocket java config 를 통해서 Spring 의 DefaultHandshakeHandler 에 추가한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocket</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>registerWebSocketHandlers</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebSocketHandlerRegistry</span> <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>echoWebSocketHandler</span><span style=color:#ce5c00;font-weight:700>(),</span>
</span></span><span style=display:flex><span>            <span style=color:#4e9a06>&#34;/echo&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>setHandshakeHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>handshakeHandler</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>DefaultHandshakeHandler</span> <span style=color:#000>handshakeHandler</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#000>WebSocketPolicy</span> <span style=color:#000>policy</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>WebSocketPolicy</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebSocketBehavior</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>SERVER</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>policy</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setInputBufferSize</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>8192</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>policy</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setIdleTimeout</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>600000</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>DefaultHandshakeHandler</span><span style=color:#ce5c00;font-weight:700>(</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>JettyRequestUpgradeStrategy</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>WebSocketServerFactory</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>policy</span><span style=color:#ce5c00;font-weight:700>)));</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:websocket=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/websocket&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34; 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket/spring-websocket.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;websocket:handlers&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:mapping</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/echo&#34;</span> <span style=color:#c4a000>handler=</span><span style=color:#4e9a06>&#34;echoHandler&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:handshake-handler</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;handshakeHandler&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/websocket:handlers&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;handshakeHandler&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework...DefaultHandshakeHandler&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;upgradeStrategy&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;upgradeStrategy&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework...JettyRequestUpgradeStrategy&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;constructor-arg</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;serverFactory&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;serverFactory&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.eclipse.jetty...WebSocketServerFactory&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;constructor-arg&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.eclipse.jetty...WebSocketPolicy&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;constructor-arg</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;SERVER&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;inputBufferSize&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;8092&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;idleTimeout&#34;</span> <span style=color:#c4a000>value=</span><span style=color:#4e9a06>&#34;600000&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/constructor-arg&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-d54688493603f8e6fe7e2cb7d9d22f8e>27 - STOMP over WebSocket 개요 및 메시지 처리 흐름</h1><div class=lead>STOMP는 간단한 메시징 프로토콜로, Spring Framework에서 WebSocket과 결합해 메시지 전송 및 구독 기능을 제공한다. Spring WebSocket 설정을 통해 클라이언트와 서버 간의 메시지 흐름을 관리하며, 메시지를 처리하고 broadcasting하는 기능을 지원한다.</div><h1 id=stomp-over-websocket-messaging-architecture>STOMP Over WebSocket Messaging Architecture</h1><p><a href=http://docs.spring.io/spring/docs/current/spring-framework-reference/html/websocket.html#websocket-stomp>http://docs.spring.io/spring/docs/current/spring-framework-reference/html/websocket.html#websocket-stomp</a></p><p>WebSocket protocol 은 content 를 정의하지 않은 채 2 가지 유형 (text, binary) 의 메시지로 분류했다. content 를 정의하지 않은 대신 client 와 서버는 sub-protocol (content 를 정의하는 고수준의 protocol) 을 사용하는 것을 합의해야 할 수도 있다. sub-protocol 을 사용하는 것은 option 이지만 client 와 server 모두 메시지를 어떻게 해석해야 할지를 이해하는 것이 필요하다.</p><h2 id=1-stomp-개요>1. STOMP 개요</h2><p><a href=http://stomp.github.io/stomp-specification-1.2.html#Abstract>STOMP</a> 는 Ruby, Python, Perl 과 같은 스크립트 언어를 위해 고안된 단순한 메시징 프로토콜이다. 그것은 메시징 프로토콜에서 일반적으로 사용되는 패턴들의 일부를 제공한다. STOMP 는 TCP 나 WebSocket 과 같은 신뢰성있는 양방향 streaming network protocol 상에 사용될 수 있다.</p><p>STOMP 는 HTTP 에 모델링된 frame 기반 프로토콜이다. 다음은 frame 의 구조이다.</p><pre tabindex=0><code>COMMAND
header1:value1
header2:value2
 
Body^@
</code></pre><p>클라이언트는 메시지를 보내기 위해 SEND 명령을 사용하거나 수신 메시지에 관심을 표현하기 위해 SUBSCRIBE 명령을 사용할 수 있다. 이런 명령어들은 “destination” 헤더를 요구하는데 어디에 메시지를 전송할 지 혹은 어디에서 메시지를 구독할지를 나타낸다.</p><p>다음은 stock shares 를 구매하기 위한 요청 전송의 예이다.</p><pre tabindex=0><code>SEND
destination:/queue/trade
content-type:application/json
content-length:44
 
{&#34;action&#34;:&#34;BUY&#34;,&#34;ticker&#34;:&#34;MMM&#34;,&#34;shares&#34;,44}^@
</code></pre><p>다음은 stock quotes 를 얻기위한 클라이언트 구독의 예이다.</p><pre tabindex=0><code>SUBSCRIBE
id:sub-1
destination:/topic/price.stock.*
 
^@
</code></pre><p>destination 의 의미는 STOMP spec 에서 투명하게 남겨두었다. 그것은 어떤 문자열이든 될 수 있고 그 의미나 문법은 온전히 STOMP 서버에 맡겨진다. 그러나 일반적으로 다음의 규칙을 사용하곤 한다.</p><p>“topic/..” - publish-subscribe (one to many) “queue/” - point-to-point (one to one)</p><p>STOMP 서버는 모든 구독자에게 message 를 broadcasting 하기 위해 MESSAGE 명령을 사용할 수 있다. 다음은 stock quote 를 구독자에서 전달하는 예이다.</p><pre tabindex=0><code>MESSAGE
message-id:nxahklf6-1
subscription:sub-1
destination:/topic/price.stock.MMM
 
{&#34;ticker&#34;:&#34;MMM&#34;,&#34;price&#34;:129.45}^@
</code></pre><p>서버는 불분명한 메시지를 전송할 수 없음을 알아야 한다. 즉 서버의 모든 메시지는 특정 클라이언트 구독에 응답하여야 하고 서버 메시지의 “subscription-id” 헤더는 클라이언트 구독의 “id” 헤더와 일치하여야 한다.</p><p>지금까지 STOMP 의 가장 기본적인 이해를 위한 것이다. 상세한 것은 <a href=http://stomp.github.io/stomp-specification-1.2.html>specification</a> 을 통해 살펴볼 수 있다.</p><p>다음은 STOMP over WebSocket 사용 application 의 장점을 요약한 것이다.</p><ul><li>Standard message format</li><li>Application-level protocol with support for common messaging patterns</li><li>Client-side support, e.g. stomp.js, msgs.js</li><li>The ability to interpret, route, and process messages on both client and server-side</li><li>The option to plug a message broker — RabbitMQ, ActiveMQ, many others — to broadcast messages (explained later)</li></ul><p>순수 WebSocket 과 비교하여 STOMP 사용의 가장 중요한 요소는 Spring Framework 가 마치 SpringMVC 가 HTTP 에 프로그래밍 모델을 제공하는 것처럼 application 수준의 사용을 위한 프로그래밍 모델을 제공한다는 것이다.</p><h2 id=2-enable-stomp-over-websocket>2. Enable STOMP over WebSocket</h2><p>Spring Framework 는 spring-messaging 와 spring-websocket 모듈을 통해 STOMP over WebSocket 사용을 제공한다.</p><p>다음은 SockJS fallback option 을 사용하는 STOMP WebSocket endpoint 설정의 예이다. endpoint 는 /app/portfolio URL 경로에 클라이언트가 접속할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.web.socket.config.annotation.EnableWebSocketMessageBroker</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>org.springframework.web.socket.config.annotation.StompEndpointRegistry</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocketMessageBroker</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketMessageBrokerConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>configureMessageBroker</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MessageBrokerRegistry</span> <span style=color:#000>config</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>config</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setApplicationDestinationPrefixes</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/app&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>enableSimpleBroker</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/queue&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;/topic&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>registerStompEndpoints</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>StompEndpointRegistry</span> <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addEndpoint</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/portfolio&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>withSockJS</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>동일 XML 설정은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:websocket=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/websocket&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34; 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket/spring-websocket-4.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;websocket:message-broker</span> <span style=color:#c4a000>application-destination-prefix=</span><span style=color:#4e9a06>&#34;/app&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:stomp-endpoint</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/portfolio&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;websocket:sockjs/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/websocket:stomp-endpoint&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:simple-broker</span> <span style=color:#c4a000>prefix=</span><span style=color:#4e9a06>&#34;/queue, /topic&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/websocket:message-broker&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>브라우저 측에서는 stomp.js 나 sockjs-client 를 사용하여 접속한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>socket</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>SockJS</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/spring-websocket-portfolio/portfolio&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>stompClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Stomp</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>over</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>socket</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>stompClient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>connect</span><span style=color:#000;font-weight:700>({},</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>frame</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>SockJS 없는 WebSocket 사용은 다음과 같다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>socket</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>WebSocket</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/spring-websocket-portfolio/portfolio&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>stompClient</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Stomp</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>over</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>socket</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#000>stompClient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>connect</span><span style=color:#000;font-weight:700>({},</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>frame</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>위의 stomp 클라이언트는 login 과 passcode 헤더를 정의할 필요가 없다. 제공되더라도 무시되거나 서버측에서 재정의 될 것이다. 인증에 대해서는 <a href=http://docs.spring.io/spring/docs/current/spring-framework-reference/html/websocket.html#websocket-stomp-handle-broker-relay-configure>Section 20.4.8, “Connections To Full-Featured Broker”</a> 와 <a href=http://docs.spring.io/spring/docs/current/spring-framework-reference/html/websocket.html#websocket-stomp-authentication>Section 20.4.9, “Authentication”</a> 를 참고하라</p><h2 id=3-flow-of-messages>3. Flow of Messages</h2><p>STOMP endpoint 가 설정될 때, spring application 은 연결된 클라이언트들에게 마치 STOMP broker 인 것처럼 동작한다. 들어오는 메시지를 처리하고 다시 메시지를 전송한다. 이 장에서는 Application 내에서 message flow 가 어떠한지에 대한 개략적인 개요를 제공한다.</p><p>spring-messaging 모듈은 <a href=https://spring.io/spring-integration>Spring Integration</a> 프로젝트에 기반한 다양한 추상화를 포함하고 있으며, messging application 의 building block 으로 사용하도록 의도되었다.</p><ul><li>Message  —  represents a message with headers and a payload.</li><li>MessageHandler — a contract for handling a message.</li><li>MessageChannel  —  a contract for sending a message enabling loose coupling between senders and receivers.</li><li>SubscribableChannel  —  extends MessageChannel and sends messages to registered MessageHandler subscribers.</li><li>ExecutorSubscribableChannel  —  a concrete implementation of SubscribableChannel that can deliver messages asynchronously through a thread pool.</li></ul><p>제공되는 STOMP over WebSocket 설정 (Java,XML 모두) 은 다음의 3 가지 channel 들을 포함하여 실제적인 message flow 를 만들어내는데 사용된다.</p><ul><li>“clientInboundChannel” — for messages from WebSocket clients. Every incoming WebSocket message carrying a STOMP frame is sent through this channel.</li><li>“clientOutboundChannel” — for messages to WebSocket clients. Every outgoing STOMP message from the broker is sent through this channel before getting sent to a client’s WebSocket session.</li><li>“brokerChannel” — for messages to the broker from within the application. Every message sent from the application to the broker passes through this channel.</li></ul><p>“clientInboundChannel” 의 메시지는 처리 (요청 실행과 같은) 를 위해 annotated method 로 흐르거나 broker (구동과 같은) 에 포워딩 될 수 있다. STOMP destination 은 단순한 prefix 기반 라우팅을 위해 사용되어진다. 예를 들어 ”/app” prefix 는 annotated method 로 라우팅하고 ”/topic” 이나 ”/queue” 는 broker 에 라우팅되는 것이다.</p><p>메지시 처리 annotated method 가 return type 을 갖을 때는 그 return value 는 Spring Message 의 payload 로서 “brokerChannel” 에 전송된다. 그러면 broker 는 메시지를 client 들에게 broadcasting 한다. 메시지를 destination 에 전송하는 것은 messaging template 의 도움으로 application 내 어디에서나 수행될 수 있다. 예를 들어, HTTP POST 처리 메소드는 메시지를 연결된 클라이언트들에게 broadcast 할 수 있는 것이다. 또는 service component 는 주기적으로 stock quotes 를 broadcast 할 수 있다.</p><p>다음은 메시지 흐름을 보여주는 단순한 예이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocketMessageBroker</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketMessageBrokerConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>registerStompEndpoints</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>StompEndpointRegistry</span> <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addEndpoint</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/portfolio&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>configureMessageBroker</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MessageBrokerRegistry</span> <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setApplicationDestinationPrefixes</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/app&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>enableSimpleBroker</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/topic/&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>GreetingController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@MessageMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/greeting&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>handle</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>greeting</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#4e9a06>&#34;[&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>getTimestamp</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;: &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>greeting</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>다음은 위 예제의 메시지 흐름에 대한 설명이다.</p><ul><li>WebSocket clients connect to the WebSocket endpoint at ”/portfolio”. * Subscriptions to ”/topic/greeting” pass through the “clientInboundChannel” and are forwarded to the broker.</li><li>Greetings sent to ”/app/greeting” pass through the “clientInboundChannel” and are forwarded to the GreetingController.</li><li>The controller adds the current time and the return value is passed through the “brokerChannel” as message to ”/topic/greeting” (destination is selected based on a convention but can be overridden via @SendTo).</li><li>The broker in turn broadcasts messages to subscribers and they pass through the “clientOutboundChannel”.</li></ul><p>다음 장에서 argument 와 return value 의 종류를 포함한 annotated method 의 상세한 내용을 제공한다.</p><h2 id=4-annotation-message-handling>4. Annotation Message Handling</h2><p>@MessageMapping annotation 은 @Controller 와 @RestController annotated class 의 메소드에 적용할 수 있다. 이것은 메소드를 path-like message destination 에 매핑하기 위해 사용될 수 있다. 이것은 또한 controller 내의 모든 annotated method 들과 공유되는 매핑을 표현하기 위해 type-level @MessageMapping 과 결합할 수 있다.</p><p>Destination mapping 은 Ant-style pattern (e.g. ”/foo*”, ”/foo/**”) 과 template variable (e.g. ”/foo/{id}”, 이것은 @DestinationVariable 메소드 인자를 통해 접근될 수 있다.) 을 포함할 수 있다. 이처럼 SpringMVC 사용자 친화적인데, 실질적으로 SpringMVC 가 그러하듯 AntPathMatcher 는 pattern 기반의 destination mapping 과 template variable 추출에 사용된다.</p><p>@MessageMapping 메소드에서 다음의 method 인자가 지원된다.</p><ul><li>Message method argument to get access to the complete message being processed.</li><li>@Payload-annotated argument for access to the payload of a message, converted with a org.springframework.messaging.converter.MessageConverter. The presence of the annotation is not required since it is assumed by default. Payload method arguments annotated with Validation annotations (like @Validated) will be subject to JSR-303 validation.</li><li>@Header-annotated arguments for access to a specific header value along with type conversion using an org.springframework.core.convert.converter.Converter if necessary.</li><li>@Headers-annotated method argument that must also be assignable to java.util.Map for access to all headers in the message.</li><li>MessageHeaders method argument for getting access to a map of all headers.</li><li>MessageHeaderAccessor, SimpMessageHeaderAccessor, or StompHeaderAccessor for access to headers via typed accessor methods.</li><li>@DestinationVariable-annotated arguments for access to template variables extracted from the message destination. Values will be converted to the declared method argument type as necessary.</li><li>java.security.Principal method arguments reflecting the user logged in at the time of the WebSocket HTTP handshake.</li></ul><p>@MessageMapping 메소드의 return value 는 org.springframework.messaging.converter.MessageConverter 를 통해 변환되고 새로운 메시지의 body 로 사용된다. 이 새로운 메시지는 기본적으로 “brokerChannel” 에 client 메시지와 같은 destination 이지만 기본값 ”/topic” prefix 를 사용하여 전달된다. @SendTo message level annotation 은 다른 destination 을 지정하고자 할 때 사용될 수 있다.</p><p>@SubscribeMapping annotation 은 @Controller 메소드에 구독 요청을 매핑하기 위해 사용될 수 있다. 이것은 method level 에 지원되지만, type level 의 @MessageMapping annotation 과 결합하여 같은 controller 내의 모든 message handling method 들과의 공유 매핑을 표현할 수 있다.</p><p>기본적으로 @SubscribeMapping 메소드의 return value 는 broker 에 전달되는 것이 아니라 바로 연결된 클라이언트들에 메시지로서 전달된다. 이것은 request-reply message 교환에 유용하다. 예를 들어, application UI 가 초기화 될 때 application data 를 가져오는 것이다. 대안으로서 @SubscribeMapping 메소드가 @SendTo 가 적용되는 경우 결과 message 는 지정된 대상 destination 을 사용하여 “brokerChannel” 에 전달된다.</p><h2 id=5-sending-messages>5. Sending Messages</h2><p>Application 의 어떤 부분에서라도 접속된 client 들에게 메시지를 보내고자 할 때 어떻게 해야 할까? 어떠한 application component 라도 “brokerChannel” 에 메시지를 전송할 수 있다. 이를 위한 가장 쉬운 방법은 SimpMessagingTemplate 을 주입받아서 메시지 전송에 사용하는 것이다. 이것은 다음의 예제를 통해 확인할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>GreetingController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>SimpMessagingTemplate</span> <span style=color:#000>template</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>GreetingController</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>SimpMessagingTemplate</span> <span style=color:#000>template</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>template</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>template</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/greetings&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>greet</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>greeting</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>String</span> <span style=color:#000>text</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;[&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>getTimestamp</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;]:&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>greeting</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>template</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>convertAndSend</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/topic/greetings&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>text</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=6-simple-broker>6. Simple Broker</h2><p>기본 제공되는 단순한 message broker 는 클라이언트로부터의 구독 요청을 처리하고 그것을 메모리에 저장하고 일치하는 destination 을 가지는 연결된 client 들에 메시지를 brodcasting 한다. broker 는 Ant-style destination pattern 구독을 포함하는 동시에 path-like destination 을 지원한다.</p><h2 id=7-full-featured-broker>7. Full-Featured Broker</h2><p>Simple broker 가 초기 시작을 위해서는 훌륭하지만 STOMP 명령의 subset 들만을 지원하고 (e.g. no acks, receipts, etc) 단순 메시지 전송 loop 에 의존하며, clustering 에 적합하지 않다. 대신 application 은 full-featured message broker 를 사용하도록 업그레이드 할 수 있다.</p><p>적합한 message broker 선택 ( <a href=http://www.rabbitmq.com/stomp.html>RabbitMQ</a>, <a href=http://activemq.apache.org/stomp.html>ActiveMQ</a>, others) 을 위해 STOMP 문서를 확인하라. 그것을 설치하고 STOMP 지원을 활성화하여 broker 를 구동하라. 그 다음 Spring configuration 에서 simple broker 대신 STOMP broker relay 를 활성화 하라.</p><p>다음은 full-featured broker 를 활성화하는 설정예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocketMessageBroker</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketMessageBrokerConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>registerStompEndpoints</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>StompEndpointRegistry</span> <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addEndpoint</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/portfolio&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>withSockJS</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>configureMessageBroker</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>MessageBrokerRegistry</span> <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>enableStompBrokerRelay</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/topic/&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#4e9a06>&#34;/queue/&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setApplicationDestinationPrefixes</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/app&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:websocket=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/websocket&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34; 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket/spring-websocket-4.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;websocket:message-broker</span> <span style=color:#c4a000>application-destination-prefix=</span><span style=color:#4e9a06>&#34;/app&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:stomp-endpoint</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/portfolio&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;websocket:sockjs/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/websocket:stomp-endpoint&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:stomp-broker-relay</span> <span style=color:#c4a000>prefix=</span><span style=color:#4e9a06>&#34;/topic,/queue&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/websocket:message-broker&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>위의 설정에서 “STOMP broker relay” 는 Spring <a href=http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/messaging/MessageHandler.html>MessageHandler</a> 인데 이것은 외부 broker 에 메시지들을 forwarding 함으로써 메시지들을 처리한다. 그렇게 하기 위해 broker 에 TCP 연결을 맺고 모든 메시지를 broker 에 forwarding 하고 broker 로 부터 수신된 메시지를 WebSocket session 을 통해 client 에 역 forwarding (되돌려준다.) 한다. 본질적으로 그것은 마치 양방향으로 message 를 forwarding 하는 “relay” 처럼 동작한다.</p><p>org.projectreactor:reactor-net 의존성을 추가하여 TCP connection 관리를 할 수 있다.</p><p>게다가 application components (e.g. HTTP request handling method, business service, etc) 는 또한 메시지를 broker relay 에 전송할 수 있다. Section 20.4.5, “Sending Messages” 에서 subscribed WebSocket 클라이언트들에 메시지를 broadcast 하는 것이 설명되어 있다.</p><p>사실상 broker relay 는 강력하고 scalabale 한 message brodcasting 을 활성화 한다.</p><h2 id=8-connections-to-full-featured-broker>8. Connections To Full-Featured Broker</h2><p>STOMP broker relay 는 broker 에 대한 단일 “system” TCP connection 을 유지한다. 이 connection 은 receiving message 가 아닌 server 측 application 에 기인하는 message 들만을 위해 사용된다. 이러한 접속을 위해 STOMP credentials 을 설정할 수 있다. (STOMP frame login 과 passcode 헤더) 이것은 Java config 와 XML 모두에서 systemLogin/systemPasscode 속성으로 노출된다. (기본값은 guest/guest 이다.)</p><p>STOMP broker relay 는 또한 모든 접속된 WebSocket client 를 위해 별도의 TCP 연결을 생성한다. 클라이언트를 대신해 모든 TCP 연결을 위해 STOMP credetial 을 설정할 수 있다. 이것은 Java config 와 XML 모두에서 clientLogin/clientPasscode 속성으로 노출된다. (기본값은 guest/guest 이다.)</p><p>STOMP broker relay 는 또한 “system” TCP connection 상에서 message broker 로부터의/로 hearbeat 을 전송하고 수신한다. heartbeat 전송/수신의 interval 을 설정할 수 있는데 기본값은 10 초이다. 만약 broker 에 대한 연결이 끊어지면 broker relay 는 재접속 시도를 성공할 때까지 5 초마다 계속한다.</p><p>Spring Bean 은 <code>ApplicationListener&lt;BrokerAvailabilityEvent></code> 를 구현할 수 있는데 이를 통해 broker 에 대한 “system” connection 이 끊기고 재접속될 때 알림을 받을 수 있다. 예를 들어, stock quote 를 broadcasting 하는 Stock Quote service 는 어떠한 active “system” connection 이 없을 때 메시지 전송시도를 중단할 수 있다.</p><p>STOMP broker relay 는 virtualHost 속성으로 설정될 수 있다. 이 속성의 값은 모든 CONNECT frame 의 host header 에 설정될 것이고 예를 들어 TCP connection 이 맺어진 실제 host 가 cloud-based STOMP service 를 제공하는 host 와 다른 cloud 환경에서 유용할 수 있다.</p><h2 id=9-authentication>9. Authentication</h2><p>WebSocket-style application 에서 누가 메시지를 보냈는지 아는것은 때때로 유용하다. 그래서 몇가지 인증 형태가 사용자 identity 를 형성하고 그것을 현재 session 에 연결하는데 필요하다.</p><p>Web application 은 이미 HTTP 기반의 인증을 사용한다. 예를 들어, Spring Security 는 보통 application 의 HTTP URL 을 보호할 수 있다. WebSocket session 이 HTTP handshake 로 시작하기 때문에 STOMP/WebSocket 에 매핑된 URL 은 이미 보호되고 인증을 요구한다는 것을 의미한다. 게다가 WebSocket 연결을 시작하는 page 는 그 스스로 거의 보호되는 것이고 실제 handshake 시까지 그 사용자는 인증되어져야 한다.</p><p>WebSocket hanshake 가 형성되고 새로운 WebSocket session 이 생성될 때 Spring WebSocket 지원은 자동적으로 HTTP request 로 부터 WebSocket session 으로 java.security.Principal 을 전달한다. 이후 WebSocket session 상의 application 을 통한 모든 message flow 는 사용자 정보가 포함되어진다. 그것은 message 의 header 에 존재한다. Controller 메소드는 javax.security.Principal 타입의 메소드 인자를 추가함으로 현재 사용자에 접근할 수 있다.</p><p>비록 STOMP CONNECT frame 이 인증을 위한 “login” 과 “passcode” 헤더를 가지고 있다하더라도, Spring 의 STOMP WebSocket 지원은 그것들을 무시하고 사용자가 HTTP 를 통해 기 인증되었기를 기대한다.</p><p>어떤 경우에는 사용자가 공식적으로 인증되지 않았을 때일지라도 WebSocket session 에 identity 를 부여하는것이 유용할 수도 있다. 예를 들면, mobile app 은 익명의 사용자에 어떤 identity (아마도 지리적 위치에 기반하여) 를 부여하기도 한다. 이때에 사용자 정의 handshake handler 가 사용될 수 있다. (Section 20.2.4, “Deployment Considerations” 에서 예제를 확인하라)</p><h2 id=10-user-destinations>10. User Destinations</h2><p>Application 은 특정 사용자를 지정하여 메시지를 전송할 수 있다. 연결된 사용자가 메시지를 수신하기 위해 그들은 인증되어져야 한다. 그래야 그들의 session 이 실제 user name 과 연결되기 때문이다. 앞선 section 에서 인증에 대해 확인하라</p><p>Spring 의 STOMP 지원은 /user/ 접두어로 destination 을 식별한다. 예를 들어, 클라이언트가 /user/position-updates destination 에 subscribe 할 수 있다. 이 destination 은 UserDestinationMessageHandler 에 의해 처리되고 사용자 session 에 unique 한 destination 으로 변환된다. (e.g. /user/position-updates-123) 이것은 일반적으로 명명된 destination 에 subscribing 편의를 제공하는 동시에 /user/position-updates 에 subscribe 하는 어떤 다른 사용자와 충돌하지 않음을 보장한다.</p><p>전송 측에서 메시지는 /user/{username}/position-updates 와 같은 destination 에 전송될 수 있다. 그러면 UserDestinationMessageHandler 에 의해 지정한 사용자 명에 속한 unique destination 과 같도록 번역될 것이다.</p><p>이것은 application 내의 어떤 component 도 name 과 일반적인 destination 만 알면 특정 사용자에 메시지를 전송할 수 있게 한다. 이것이 외부 message broker 와 같이 사용될 때 사용자 session 이 넘치면 모든 unique 한 사용자 queue 가 삭제되도록 하기 위해 inactive queue 를 다루는 방법에 대해 broker 문서를 확인하라. 예를 들어 RabbitMQ 는 /exchange/amq.direct/position-updates 와 같은 destination 이 사용될 때 auto-delete queue 를 생성한다. 클라이언트가 /user/exchange/amq.direct/position-updates 에 subscrbe 하는것이 그러한 경우이다. ActiveMQ 는 inactive destination 을 제거하기 위한 configuration options 이 있다.</p><h2 id=11-applicationcontext-events>11. ApplicationContext Events</h2><p>STOMP messaging 지원은 다음의 ApplicationContext 이벤트를 발생시킨다. 이러한 이벤트들중 하나 혹은 그 이상을 처리하기 위해 Spring 관리 component 는 ApplicationListener 를 구현할 수 있다. 이벤트는 다음과 같다.</p><p>BrokerAvailabilityEvent — broker 가 available/inavailable 될 때 나타난다. “simple” broker 는 시작시 즉시 available 되고 application 구동중 유지되지만 STOMP “broker relay” 는 만약 broker 가 재시작되면 full featured broker 에 대한 연결을 잃을 지도 모른다. broker relay 는 reconnect logic 을 가지고 있고 broker 에 대한 “system” connection 을 broker 가 돌아오면 재설정 할 것이다. 그 결과 이 event 는 상태가 connected 에서 disconnected 가 될 때나 그 반대일때마다 발생한다. SimpMessagingTemplate 을 사용하는 Components 는 이 이벤트에 subscribe 하여야 하며 broker 가 이용불가일 때 메시지를 전송하지 말아야 한다. 어떤 경우에서는 메시지를 전송할 때 MessageDeliveryException 을 처리하도록 준비되어야 한다. SessionConnectEvent — 새로운 클라이언트 session 을 나타내는 STOMP CONNECT 가 수신될 때 나타난다. 이 이벤트는 session id , user information 및 client 가 보냈을 지 모르는 어떤 사용자 정의 header 를 포함한다. 이것은 client sessions 을 추적하는데 유용하다. 이 이벤트에 subscribe 하는 Components 는 SimpMessageHeaderAccessor 나 StompMessageHeaderAccessor 를 사용하여 메시지를 wrapping 할 수 있다. SessionConnectedEvent — broker 가 SessionConnectEvent 이후 CONNECT 에 대한 응답으로 STOMP CONNECTED frame 을 전송했을 때 짧게 발생한다. 이 시점에 STOMP session 은 완전히 연결되었음으로 간주될 수 있다. SessionDisconnectEvent — STOMP session 이 끝났을 때 발생한다. DISCONNECT 는 client 로 부터 전송되거나 WebSocket session 이 closed 될 때 자동적으로 발생되어질 수 있다. 어떤 경우에 이 이벤트는 세션당 한번 이상 발생할수도 있다. Components 는 복수의 disconnect events 에 대해 idempotent(멱등) 해야 한다. full-featured broker 를 사용할 때, STOMP “broker relay” 는 자동적으로 broker 가 일시적으로 이용불가한 “system” connection 을 재접속 한다. 그러나 Client connections 는 자동적으로 재접속 되지 않는다. heartbeats 이 활성화 되어 있다면, client 는 일반적으로 10초 안에 broker 가 응답하지 않음을 알게 될 것이다. Clients 는 스스로 reconnect logic 을 구현해야할 필요가 있다.</p><h2 id=12-configuration-and-performance>12. Configuration and Performance</h2><p>성능에 대한 은총알은 없다. 많은 요인 (메시지 size, volume, application 메소드가 blocking 을 요하는 작업을 수행하는지 여부, network 속도 같은 외부요소 및 기타등등) 이 영향을 끼친다. 이 section 의 목적은 scaling 에 대한 생각과 더불어 이용가능한 configuration options 의 개요를 제공하는 것이다.</p><p>messaging application 에선 messages 는 thread pool 에 기반한 비동기 수행을 위해 channels 을 통해 전달된다. 이런 application 을 설정하는 것은 channels 과 messages flow 에 대한 지식이 요구된다. 그래서 Section 20.4.3, “Flow of Messages” 를 리뷰해보기 바란다.</p><p>시작하기 좋은 위치는 “clientInboundChannel” 과 “clientOutboundChannel” 를 지지하는 thread pools 을 설정하는 것이다. 기본적으로 이 둘은 사용가능한 processor 수의 2배로 설정된다.</p><p>막약 annotated method 에서 메시지 처리가 주로 CPU 소비에 기인하면 “clientInboundChannel” 의 thread 수는 processor 수에 가깝게 유지되어야 한다. 만약 작업이 IO 소비에 기인하고 database 나 다른 external system 에 blocking 을 요한다면 thread pool size 는 증가되어야 할 필요가 있다.</p><p>ThreadPoolExecutor 는 3 가지 중요한 property 를 갖는다. 그것은 core 와 max thread pool size 와 이용가능한 thread 가 없을 때 작업을 저장하기 위한 queue capacity 이다.</p><p>일반적인 혼동이 오는 지점은 core pool size (e.g. 10) 와 max pool size (e.g. 20) 설정이 10 에서 20 threads 를 가지는 thread pool 로 나타나는 것이다. 사실 capacity 가 그 기본값인 Integer.MAX_VALUE 인채로 남겨두면 thread pool 은 모든 추가적인 작업이 queue 에 쌓일 것이기 때문에 결코 core pool size 위로 증가하지 않을 것이다.</p><p>이러한 properties 들이 어떻게 작용하고 다양한 queuing strategies 를 이해하기 위해 ThreadPoolExecutor 의 Javadoc 을 확인하라.</p><p>“clientOutboundChannel” 측에서 thread pool 은 온전히 WebSocket clients 에 메시지를 전송하는 것과 관련있다. 만약 clients 가 빠른 network 에 있다면 스레드 수는 이용가능한 processors 수에 가깝게 유지되어야 한다. 만약 그들이 느리거나 low bandwidth 상에 있다면 그들은 메시지 소비를 위해 더 오래 점유할 것이고 thread pool 에 부담을 줄 것이다. 그래서 thread pool size 증가가 필요할 수도 있을 것이다.</p><p>“clientInboundChannel” 에 대한 부하는 예상가능하다 — 결국 그것은 application 이 무엇을 하는지에 기인한다.— ”clientOutboundChannel” 을 어떻게 설정해야 하는지는 application 제어를 넘어서는 요인에 기인하기 때문에 좀더 어렵다. 이러한 이유로 메시지 전송과 관련한 두가지 추가적인 properties 가 있다. 그것은 “sendTimeLimit” 와 “sendBufferSizeLimit” 이다. 이것은 얼마나 오래 그 전송이 허락되는가와 얼마나 많은 데이터가 client 에 메시지 전송시 buffer 되는지를 설정하는데 사용된다.</p><p>일반적인 생각은 어떤 주어진 시간에 단 하나의 thread 만이 client 에 메시지 전송을 위해 사용되어져야 한다는 것이다. 모든 추가적인 메시지는 동시에 버퍼링 되고 이러한 properties 가 얼마나 오래 메시지 전송에 점유가 허락되는가와 얼마나 많은 데이터가 동시에 버퍼링 되는가에 사용할 수 있다. 중요한 추가적인 세부사항은 XML schema 의 Javadoc 을 참고하라.</p><p>다음은 설정 예이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocketMessageBroker</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketMessageBrokerConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>configureWebSocketTransport</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebSocketTransportRegistration</span> <span style=color:#000>registration</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registration</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSendTimeLimit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>15</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#0000cf;font-weight:700>1000</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>setSendBufferSizeLimit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>512</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#0000cf;font-weight:700>1024</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:websocket=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/websocket&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34; 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket/spring-websocket-4.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;websocket:message-broker&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:transport</span> <span style=color:#c4a000>send-timeout=</span><span style=color:#4e9a06>&#34;15000&#34;</span> <span style=color:#c4a000>send-buffer-size=</span><span style=color:#4e9a06>&#34;524288&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>&lt;!-- ... --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/websocket:message-broker&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>위의 WebSocket 전송 설정은 들어오는 STOMP messages 에 허락되는 최대 사이즈를 설정하는데 사용될 수 있다. 비록 이론적으로 WebSocket message 가 size 에 제한이 없지만, 실제 WebSocket servers 는 한계를 부여한다. 예를 들어 Tomcat 에서 8K 이고 Jetty 에서 64K 이다. 이런 이유로 stomp.js 같은 STOMP clients 는 커다란 STOMP messages 를 16K boundaries 로 분리하고 그들을 복수개의 WebSocket messages 로 전송한 후 서버가 buffer 해서 재조합하도록 한다.</p><p>Spring 의 STOMP over WebSocket 지원은 이것을 수행한다. 그래서 applications 은 STOMP messages 를 위해 WebSocket server 고유의 message sizes 를 무시한 채 maximum size 를 설정할 수 있다. WebSocket message size 가 만약 최소 16K WebSocket messages 전송을 보장하여야 한다면 자동적으로 조정되어질 것을 명심하라.</p><p>다음은 설정예시이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocketMessageBroker</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketMessageBrokerConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>configureWebSocketTransport</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebSocketTransportRegistration</span> <span style=color:#000>registration</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registration</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setMessageSizeLimit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>128</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#0000cf;font-weight:700>1024</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:websocket=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/websocket&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34; 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket/spring-websocket-4.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;websocket:message-broker&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:transport</span> <span style=color:#c4a000>message-size=</span><span style=color:#4e9a06>&#34;131072&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>&lt;!-- ... --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/websocket:message-broker&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>scaling 에 대한 중요한 point 는 복수개의 application instances 를 사용하는 것이다. 현재 simple broker 로는 불가능하다. 그러나 RabbitMQ 같은 full-featured broker 를 사용할 때, 각 application instance 는 broker 에 연결하고 하나의 application instance 로부터의 messages broadcast 는 어떤 다른 application instances 를 통해 연결된 WebSocket clients 에 그 broker 를 통해 broadcast 할 수 있다.</p><h2 id=13-testing-annotated-controller-methods>13. Testing Annotated Controller Methods</h2><p>Spring 의 STOMP over WebSocket 지원에 2가지 주요한 접근이 있다. 첫번째는 controller 의 기능과 annotated message handling method 의 기능을 검증하는 server-side tests 를 작성하는 것이다. 두번째는 client 와 server 구동과 관련한 전체 end-to-end tests 를 작성하는 것이다.</p><p>2 가지 접근은 상호 보완적이지 않다. 그와는 반대로 전체 test 전략에 각각 위치한다. Server-side tests 는 좀더 집중되고 작성하고 유지하기가 쉽다. 반면에 End-to-end integration tests 는 좀 더 완벽하고 테스트가 더 많지만 그것들은 작성과 유지에 더 많이 관련되어 진다.</p><p>가장 단순한 server-side tests 는 controller unit tests 를 작성하는 것이다. 그러나 이것은 충분히 유용하지 않다. 왜냐하면 controller 의 많은 부분이 annotations 에 의존하기 때문이다. 순수한 unit tests 는 그것을 테스트하지 못한다.</p><p>이상적으로 테스트 하의 controllers 는 마치 SpringMVC Test framework 에서 HTTP 요청을 처리하는 controller 를 테스트하는 접근같이 runtime 에서 처럼 호출되어야 한다. 즉 구동중인 Servlet container 없이 Spring Framework 가 annotated controllers 를 호출하는 것이다. Spring MVC Test 와 같이 2가지 가능한 대안이 있다. 그것은 “context-based” 나 “standalone” setup 을 사용하는 것이다.</p><p>Spring TestContext framework 의 도움으로 실제 Spring configuration 로드하고 “clientInboundChannel” 를 테스트 field 로 주입받아서, 이를 사용하여 메시지를 전송한다. 수동적으로 controllers 를 호출하기 위해 필요한 최소한의 Spring framework infrastructure 를 설정한다. (SimpAnnotationMethodMessageHandler) 그리고 메시지를 controller 에 직접 전달한다. 이 두가지 시나리오는 tests for the stock portfolio sample application 에서 시연되고 있다.</p><p>두번째 접근은 end-to-end integration tests 를 만드는 것이다. 이를 위해 WebSocket server 를 embedded mode 로 구동할 필요가 있고 STOMP frame 을 포함하는 메시지를 전송하는 WebSocket client 로서 서버에 접속한다. stock portfolio sample application 에 대한 test 는 embedded WebSocket 서버로서 Tomcat 을 사용하고 test 목적의 간단한 STOMP client 를 사용하는 접근을 보여준다.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-43e62e63dc735ca18e8286a5e96a43cf>28 - SockJS Fallback Options</h1><div class=lead>Spring은 WebSocket이 지원되지 않는 환경에서 SockJS 프로토콜을 사용해 WebSocket API를 에뮬레이션하는 fallback 옵션을 제공한다.</div><h1 id=sockjs-fallback-options>SockJS Fallback Options</h1><p><a href=http://docs.spring.io/spring/docs/current/spring-framework-reference/html/websocket.html#websocket-fallback>http://docs.spring.io/spring/docs/current/spring-framework-reference/html/websocket.html#websocket-fallback</a></p><p>WebSocket 이 아직까지 모든 브라우저에서 지원되지 않거나 네트워크 프락시 제약등으로 사용할 수 없는 경우가 있다. 이에 Spring 은 fallback 옵션을 제공하는데 이는 SockJS protocol 에 기반으로 WebSocket API 를 emulate 한다.</p><h2 id=1-sockjs-개요>1. SockJS 개요</h2><p>SockJS 는 application 으로 하여금 WebSocket API 를 사용하는데 있다. 만약 WebSocket 사용이 불가한 경우에도 이를 fallback option 으로 제공하여 어떠한 코드 변화없이 WebSocket API 를 사용토록 한다.</p><h3 id=sockjs-구성>SockJS 구성</h3><ul><li><a href=https://github.com/sockjs/sockjs-protocol>SockJS protocol</a></li><li><a href=https://github.com/sockjs/sockjs-client>SockJS client</a> - javascript library</li><li>SockJS 서버 구현 - spring-websocket 모듈을 통해 제공</li></ul><p>SockJS 는 여러가지 테크닉을 이용하여 다양한 브라우저 및 브라우저 버전을 지원한다. 전송 타입은 다음의 3가지로 분류된다.
<strong>WebSocket, HTTP Streaming, HTTP Long Polling</strong>. 이들 각각을 살펴보려면 여기 를 참조한다.</p><p>SockJS client 는 서버의 기본 정보를 얻기 위해서 “GET /info” 를 호출한다. 그 이후에 SockJS 는 어떤 전송 타입을 사용할지를 결정한다. WebSocket 은 최우선책이며, 이후로 HTTP Streaming > HTTP (long) polling 이 사용된다.</p><p>모든 전송 요청은 다음의 URL 구조를 갖는다.</p><p><code>http://host:port/myApp/myEndpoint/{server-id}/{session-id}/{transport}</code></p><ul><li>{server-id} - 클러스터에서 요청을 routing 하는데 사용하나 이외에는 의미가 없다.</li><li>{session-id} - SockJS session 에 소속하는 HTTP 요청과 연관성이 있다.</li><li>{transport} - 전송타입 ex> websocket, xhr-streaming, 기타 등등</li></ul><p>WebSocket 전송은 WebSocket handshaking 을 위한 오직 하나의 HTTP 요청을 필요로 한다. 모든 메시지들은 그 이후에 사용했던 socket 을 통해 교환된다.</p><p>HTTP 전송은 좀 더 많은 요청을 필요로 한다. 예를 들어 Ajax/XHR streaming 은 server 에서 client 로의 메시지를 위해 하나의 long-running 요청이 있고 추가적인 HTTP POST 요청은 client 에서 server 로의 메시지를 위해 사용된다. Long polling 은 server 가 client 로의 응답 후에 현재의 요청을 끝내는 것을 제외하고는 XHR streaming 과 유사하다.</p><p>SockJS 는 최소한의 message framing 을 추가한다. 예를 들어 server 는 “o” (open frame) 를 초기에 전송하고, 메시지는 <code>[“message1”,”message2”]</code> 와 같은 JSON-encoded 배열로서 전달되며, 문자 “h” (hearbeat frame) 는 기본적으로 25초간 메시지 흐름이 없는 경우에 전송하고 “c” (close frame) 는 해당 세션을 종료한다.</p><p>이에 대한 자세한 이해는 브라우저에서 확인할 수 있다. SockJS 는 debug flag 를 제공하고, 전송타입을 고정하여 각각에 대해서 살펴볼 수 있다. 서버는 “org.springframework.web.socket” 에 TRACE 로깅을 활성화 하여 로그를 볼 수 있다.</p><h2 id=2-sockjs-활성화>2. SockJS 활성화</h2><p>SockJS 는 설정을 통해 쉽게 활성화 할 수 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocket</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>registerWebSocketHandlers</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>WebSocketHandlerRegistry</span> <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addHandler</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>myHandler</span><span style=color:#ce5c00;font-weight:700>(),</span> <span style=color:#4e9a06>&#34;/myHandler&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>withSockJS</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>WebSocketHandler</span> <span style=color:#000>myHandler</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>MyHandler</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;beans</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/beans&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xmlns:websocket=</span><span style=color:#4e9a06>&#34;http://www.springframework.org/schema/websocket&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34; 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        http://www.springframework.org/schema/websocket/spring-websocket-4.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;websocket:handlers&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:mapping</span> <span style=color:#c4a000>path=</span><span style=color:#4e9a06>&#34;/myHandler&#34;</span> <span style=color:#c4a000>handler=</span><span style=color:#4e9a06>&#34;myHandler&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;websocket:sockjs/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/websocket:handlers&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;myHandler&#34;</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.samples.MyHandler&#34;</span><span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/beans&gt;</span>
</span></span></code></pre></div><p>위의 설정은 Spring MVC 에서 사용하기 위한 것으로 DispatcherServlet 설정에 포함되어져야 한다. (application context 를 계층적으로 가져갈 경우) 그러나 Spring WebSocket 이 SpringMVC 이외에도 사용할 수 있도록 제공되듯, SockJS 도 그러하다. 이는 <a href=http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/socket/sockjs/support/SockJsHttpRequestHandler.html>SockJsHttpRequestHandler</a> 를 통해서 제공된다.</p><p>browser (클라이언트) 측에서는 W3C WebSocket API 를 emulate 하는 <a href=https://github.com/sockjs/sockjs-client>sockjs-client</a> 를 사용할 수 있다. 이를 통해 서버와 통신하여 최적의 전송타입을 선택한다. 이 외에도 포함할 전송타입을 지정하는 몇가지 설정을 제공한다.</p><h2 id=3-ie-8-9-에서의-http-streaming-ajaxxhr-vs-iframe>3. IE 8, 9 에서의 HTTP Streaming (Ajax/XHR vs IFrame)</h2><p>IE 8/9 는 대중적으로 사용되고 있다. 이것은 SockJS 가 필요한 핵심적인 이유이다.</p><p>SockJS 는 Ajax/XHR Streaming 을 Microsoft 의 <a href=http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx>XDomainRequest</a> 를 통해 지원하고 있다. 이것은 서로 다른 도메인 간에도 동작하지만 cookie 전송을 지원하지 않는다. Cookie 는 Java Application 에서 매우 필수적이다. 그러나 SockJS 클라이언트는 Java 만을 위한 것이 아닌 많은 서버 타입을 위해 사용되도록 고안되었기 때문에 Cookie 를 중요하게 다룰지 여부를 알려주어야 한다. SockJS 클라이언트는 Ajax/XHR Streaming 을 선택하거나 그렇지 않다면 iframe 기반의 technique 을 사용한다.</p><p>SockJS 클라이언트로 부터의 최초 요청인 &lsquo;/info&rsquo; 는 클라이언트의 전송 타입 선택을 위한 정보를 위한 요청이다. 상세한 내용 중 하나는 서버 application 이 cookie 에 의존 (authentication 목적이나 session clustering with stick mode 등) 하는지 여부이다. Spring 의 SockJS 지원은 sessionCookieNeeded 라는 속성을 포함한다. 이것은 Java application 이 JSESSIONID cookie 에 의존하기 때문에 기본적으로 활성화 된다. 만약 이 기능을 OFF 한다면 비로서 SockJS 클라이언트는 xdr-streaming 을 IE 8/9 에서 사용토록 선택되어 진다.</p><p>iframe 기반의 전송을 사용한다면 browser 가 HTTP 응답헤더인 X-Frame-Option 이 DENY, SAMEORIGIN, ALLOW-FROM <code>&lt;origin></code> 로 설정됨에 따라 iframe 사용을 블락시킬수 있음을 염두에 두어야 한다. 이러한 헤더는 clickjacking 이라 알려진 공격을 방어하기 위한 목적으로 주로 사용된다.</p><p>Spring Security 3.2+ 에서 X-Frame-Options 헤더를 모든 응답에 설정하도록 지원하고 있다. 즉 Spring Security Java Config 에서 이 값을 DENY 로 기본설정한다. Spring Security XML 설정에서는 이 헤더를 설정하지 않지만 차후에 기본값으로 설정될 여지가 있다.</p><p>Spring Security 의 Section 7.1. Default Security Headers 에서 X-Frame-Options 헤더 설정에 대한 상세 문서를 살펴볼 수 있다. 이에 대한 추가적인 배경을 보고자 한다면 <a href=https://jira.spring.io/browse/SEC-2501>SEC-2501</a> 을 살펴본다.</p><p>X-Frame-Option 응답헤더를 추가한다면 (Spring Security 를 사용한다면 그렇게 된다.) 헤더 값을 SAMEORIGIN 이나 ALLOW-FROM <code>&lt;origin></code> 으로 설정할 필요가 있다. 이와 더불어 Spring SockJS 지원은 SockJS 클라이언트의 location 을 알아야 할 필요가 있다. 왜냐하면 client 가 iframe 상에서 로드될 것이기 때문이다. 기본적으로 iframe 은 SockJS 클라이언트 (sockJS.js) 를 CDN location 으로부터 다운되도록 설정되어 있다. 이를 same origin 으로 설정하는 것이 필요하다.</p><p>Java Config 에서 아래와 같이 설정할 수 있다. XML 에서는 <code>&lt;websocket:sockjs></code> 에서 설정한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@EnableWebSocket</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>WebSocketConfig</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>WebSocketConfigurer</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>registerStompEndpoints</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>StompEndpointRegistry</span> <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addEndpoint</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/portfolio&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>withSockJS</span><span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span>                <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setClientLibraryUrl</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;http://localhost:8080/myapp/js/sockjs-client.js&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>초기 개발중에는 SockJS client devel mode 를 활성화 하라. 이는 SockJS request (iframe 같은) 를 브라우저가 캐시하는 것을 방지한다. 이에 대한 방법은 <a href=https://github.com/sockjs/sockjs-client>SockJS client</a> page 에서 확인할 수 있다.</p><h2 id=4-heartbeat-messages>4. Heartbeat Messages</h2><p>SockJS 프로토콜은 server 가 hearbeat message 를 전송하도록 하여 proxies 가 connection 을 hung 으로 인식하지 못하도록 할 필요가 있다. Spring SockJS 설정은 heartbeatTime 속성을 가지는데 빈도를 조정하는데 사용된다. 기본값은 해당 커넥션에 어떤 메시지도 없는 25초를 사용한다. 이 25초는 <a href=http://tools.ietf.org/html/rfc6202>IETF 권고안</a> 을 따르고 있다.</p><p>STOMP over WebSocket/SockJS 를 사용할 때 만약 STOMP 클라이언트와 서버가 heartbeat 교환에 합의한다면 SockJS heartbeat 은 비활성화 된다.</p><p>Spring SockJS 지원은 heartbeat 작업을 스케줄링하기 위해 TaskScheduler 를 설정하도록 하고 있다. TaskScheduler 는 이용가능한 processor 의 수에 따른 기본값으로 설정된 thread pool 로부터 가져오는데 이는 특정한 요구에 적합한 값을 설정하는 것을 고려해야 한다.</p><h2 id=5-servlet-3-async-requests>5. Servlet 3 Async Requests</h2><p>HTTP streaming 과 HTTP long polling SockJS 전송은 커넥션을 보통의 경우보다 오래 open 되도록 한다. 이것에 대한 개요는 <a href=https://spring.io/blog/2012/05/08/spring-mvc-3-2-preview-techniques-for-real-time-updates/>다음</a> 에서 확인한다.</p><p>Servlet Container 에서 이것은 Servlet 3 async 지원을 통해 수행되는데 이것은 요청을 처리중인 Servlet 스레드를 빠져나오고 다른 Servlet 스레드에서 응답을 기록하도록 한다.</p><p>Servlet API 가 가지는 특정 이슈가 있는데 그것은 클라이언트의 갑작스러운 사라짐에 어떠한 알림도 제공하지 않는 것이다. ( <a href=https://java.net/jira/browse/SERVLET_SPEC-44>SERVLET_SPEC-44</a> 참고) 그러나 Servlet container 는 응답을 write 하기 위한 이어지는 시도에 예외를 발생한다. Spring SockJS 지원은 기본 25초 간격의 heartbeat message 를 전송하므로 이를 통해 보통 client disconnect 는 주기 안에 발견되어 진다. (주기를 짧게 하면 더 빨리 알게됨)</p><p>결론적으로, Network IO failure 은 client disconnect 에 대해서 빈번하게 발생할 여지가 있다. 이것은 로그를 stack trace 로 채우게 될 수도 있다. Spring 은 이러한 client disconnect 를 식별하기위해 최선의 노력을 하고 이에 따른 최소한의 메시지를 기록하려고 노력한다. (이 로그는 AbstractSockJsSession 에 정의된 DISCONNECTED_CLIENT_LOG_CATEGORY 로그 카테고리를 사용한다. 만약 stack trace 를 보고자 한다면 해당 로그 카테고리를 TRACE 로 설정하라)</p><h2 id=6-cors-headers-for-sockjs>6. CORS Headers for SockJS</h2><p>SockJS protocol 은 XHR streaming 과 polling 전송에 cross-domain 지원을 위한 CORS 헤더를 사용한다. 그래서 CORS 헤더가 응답에서 발견되지 않는다면 CORS 헤더들이 자동으로 추가된다. 만약 Servlet Filter 등을 통해서 CORS 헤더가 이미 설정된다면 Spring SockJsService 는 이를 스킵한다.</p><p>다음은 SockJS 에 의해 기대되는 header 와 값들이다.</p><ul><li>“Access-Control-Allow-Origin” - intitialized from the value of the “origin” request header or “*”.</li><li>“Access-Control-Allow-Credentials” - always set to true.</li><li>“Access-Control-Request-Headers” - initialized from values from the equivalent request header.</li><li>“Access-Control-Allow-Methods” - the HTTP methods a transport supports (see TransportType enum).</li><li>“Access-Control-Max-Age” - set to 31536000 (1 year).</li></ul><p>정확한 구현을 보고자 한다면 AbstractSockJsService.addCorsHeaders() 와 TransportType enum 을 소스에서 살펴보라.</p><p>대안으로서 CORS 설정은 SockJS endpoint prefix 를 제외 URL 목록으로 고려한다면, Spring SockJsService 가 그것을 처리토록 한다.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-86ef8b41b494dd5887eb46c6b99cc161>29 - UI - bootstrap</h1><div class=lead>Bootstrap은 반응형 웹 디자인을 쉽게 구현하기 위한 프론트엔드 프레임워크로, 다양한 CSS, JavaScript 컴포넌트와 UI 템플릿을 제공하여 빠르게 웹사이트를 구축할 수 있다. 또한 그리드 시스템, 다양한 UI 컴포넌트, 모달과 같은 동적 기능들을 지원하며, 모바일 중심으로 설계되어 다양한 디바이스에서 최적화된 화면을 제공한다.</div><h1 id=ui---bootstrap>UI - bootstrap</h1><h2 id=개요>개요</h2><p>부트스트랩(Bootstrap)은 웹디자인을 쉽게 하기 위해 트위터에서 오픈 소스로 공개한 프런트 엔드 프레임워크로, 유연한 HTML, CSS, JavaScript 템플릿과 UI컴포넌트, 인터렉션을 제공하여 손 쉽게 웹 사이트를 구축할 수 있는 시작점이 된다.</p><p>부트스트랩의 장점은 크게 다음과 같다.</p><ul><li>부트스트랩 3 이후부터 모바일 중심의 프레임워크이다</li><li>다양한 브라우저들을 지원한다.</li><li>반응형 웹에 최적화 되어있다. 부트스트랩은 스마트폰, 태블릿, 데스크탑에 최적화 되어 css가 조정이 된다.</li><li>시작이 용이하다. HTML, CSS만 알고 있어도 부트스트랩의 사용이 가능하다.</li></ul><p>이러한 장점들로 인해 표준프레임워크에서는 실행환경 UI로 bootstrap을 선정하였다.</p><p>본 가이드에서는 부트스트랩의 기본적인 소개와 몇 가지의 예제를 제공한다.</p><p>자세한 내용은 부트스트랩 사이트의 <a href=http://getbootstrap.com/>가이드</a>나 w3schools의 <a href=http://www.w3schools.com/bootstrap/bootstrap_get_started.asp>튜토리얼</a>을 참조하도록 한다.</p><h2 id=시작하기>시작하기</h2><p>부트스트랩을 사용하기 위해서는 부트스트랩 관련 CSS와 JavaScript를 추가해 주어야 한다. 추가하는 방법은 두가지로 부트스트랩을 다운로드 하여 사용하거나, 다운로드 하지 않을 경우 CDN 링크를 추가하여 사용 한다.</p><p>※ 주의사항 : 부트스트랩을 사용하려면 <strong>jQuery</strong>가 필요하므로 반드시 별도로 추가하여 주어야 한다.</p><ul><li>다운로드<ul><li><a href=http://getbootstrap.com/getting-started/#download>부트스트랩 사이트</a>의 메뉴 중 시작하기 > 다운로드 항목에서 원하는 종류의 다운로드를 진행한다.</li><li>부트스트랩 사이트에서는 여러가지 다운로드를 제공하는데, 본 가이드에서는 <strong>프리컴파일 된 부트스트랩</strong>을 다운로드하여 진행하였다.<ul><li>프리컴파일 된 부트스트랩 : 컴파일되고 최소화된 CSS, 자바스크립트, 폰트 제공. 문서나 원본 파일들은 포함되어 있지 않음</li></ul></li></ul></li><li>부트스트랩 CDN<ul><li>MaxCDN에서 부트스트랩의 CSS 와 자바스크립트를 CDN으로 지원한다. 이를 사용하려면, 아래의 부트스트랩 CDN 링크들을 추가하면 사용할 수 있다. 자세한 내용은 다음 <a href=http://getbootstrap.com/getting-started/#download-cdn>링크(download-cdn)</a>를 확인 한다.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 최신 컴파일 및 최소화된 최신 CSS --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 옵션 테마 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- jQuery library 부트스트랩을 사용하려면 jQuery가 필요함--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!-- 최신 컴파일 및 최소화된 자바스크립트 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><h3 id=파일-구조>파일 구조</h3><p>프리 컴파일 된 부트스트랩을 다운로드하고, 압축을 해제하면 다음과 같은 구조를 볼 수 있다.</p><pre tabindex=0><code>bootstrap/
├── css/
│   ├── bootstrap.css
│   ├── bootstrap.css.map
│   ├── bootstrap.min.css
│   ├── bootstrap-theme.css
│   ├── bootstrap-theme.css.map
│   └── bootstrap-theme.min.css
├── js/
│   ├── bootstrap.js
│   └── bootstrap.min.js
└── fonts/
    ├── glyphicons-halflings-regular.eot
    ├── glyphicons-halflings-regular.svg
    ├── glyphicons-halflings-regular.ttf
    ├── glyphicons-halflings-regular.woff
    └── glyphicons-halflings-regular.woff2
</code></pre><p>위의 구조는 어느 웹프로젝트에도 쉽게 적용하기 위한 가장 기본적인 형태다. 컴파일 된 CSS와 JavaScript(bootstrap.<em>)를 제공하고, 컴파일 되고 최소화된 CSS와 JavaScript(bootstrap.min.</em>) 도 제공한다.</p><p>그리고 Glyphicons 의 폰트 파일들과 부가적인 부트스트랩 테마 파일들도 같이 존재한다.</p><h2 id=부트스트랩의-특징>부트스트랩의 특징</h2><h3 id=html5>HTML5</h3><p>부트스트랩은 HTML5의 HTML요소와 CSS속성을 요구하기 때문에 HTML5 doctype을 사용해야 한다. 항상 페이지의 시작부분에 <strong>HTML5 doctype</strong>과 <code>&lt;head></code>내에 <strong>lang</strong> 속성과 <strong>character set</strong>을 추가해 주어야 한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ko&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span> 
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><h3 id=모바일-친화적>모바일 친화적</h3><p>부트스트랩2 에서는 모바일 친화적인 스타일을 프레임워크의 core로 추가했는데, 부트스트랩3 부터는 시작부터 모바일 친화적으로 설계 되었다.</p><p>다음은 페이지의 렌더링과 확대/축소를 사용하기 위한 것으로, <code>&lt;head></code> 내에 <code>viewport</code> 메타 태그를 추가한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><ul><li><strong>width=device-width</strong><ul><li>device의 화면 폭(width)에 따라 페이지의 화면 폭을 설정한다.(device마다 달라짐)</li></ul></li><li><strong>initial-scale=1</strong><ul><li>페이지가 처음 브라우저에 로드 될 때 초기 zoom level을 설정한다.</li></ul></li><li><strong>user-scalable=no</strong><ul><li>모바일 기기의 Zoom기능을 끌 수 있다.</li></ul></li></ul><h3 id=컨테이너>컨테이너</h3><p>부트스트랩은 사이트 전체의 콘텐츠를 감싸는 컨테이너 요소가 필요하다.</p><p>다음의 두 예제는 컨테이너에 대한 예제이다.</p><p>※ jsfiddle.net을 이용하여 아래의 예제코드를 실행 결과를 링크로 제공.</p><h4 id=예제-1--container>예제 1 : container</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ko&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Bootstrap Example<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;container&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h1</span><span style=color:#000;font-weight:700>&gt;</span>My First Bootstrap Page<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h1</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>This is some text.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>결과 보기 : <a href="https://jsfiddle.net/ymxvbzo7/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=ymxvbzo7">https://jsfiddle.net/ymxvbzo7/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=ymxvbzo7</a></p><h4 id=예제-2--container-fluid>예제 2 : container-fluid</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ko&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Bootstrap Example<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;container-fluid&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h1</span><span style=color:#000;font-weight:700>&gt;</span>My First Bootstrap Page<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h1</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>This is some text.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>결과 보기 : <a href="https://jsfiddle.net/y1hL9vqd/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=y1hL9vqd">https://jsfiddle.net/y1hL9vqd/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=y1hL9vqd</a></p><p><img src=../images/bootstrap-myfirstbootstrap-sample1.png alt=bootstrap-myfirstbootstrap-sample1></p><p><img src=../images/bootstrap-myfirstbootstrap-sample2.png alt=bootstrap-myfirstbootstrap-sample2></p><p>위의 그림처럼 두 예제의 결과보기의 화면의 폭을 좌우로 늘려보면, 두 예제의 차이점을 알 수 있다.</p><p>첫번째 예제는 고정 폭 컨테이너(<code>&lt;div class="container"></code>)를 사용하였고, 두번째 예제는 최대 폭 컨테이너(<code>&lt;div class="container-fluid"></code>)를 사용한 예제이다.</p><p>그 밖에 세부 내용은 <a href=http://getbootstrap.com/css/#overview-container>링크</a>를 참조하도록 한다.</p><h3 id=그리드-시스템>그리드 시스템</h3><p>부트스트랩은 반응형, 페이지 레이아웃을 위해 자체적인 그리드 레이아웃 시스템을 제공한다.</p><p>부트스트랩의 그리드 시스템은 <strong>12열의 그리드</strong>(12-column grid)로 구성되어 있으며, device나 viewport의 크기에 따라 자동으로 열이 적절한 크기로 배열되게 한다.</p><h4 id=고려사항>고려사항</h4><ul><li>행(row)은 반드시 <strong>.container</strong>(고정폭) 나 <strong>.container-fluid</strong>(전체폭) 안에 위치해야 한다.</li><li>열(column)들은 수평그룹을 만드는데 행을 이용한다.</li><li>콘텐츠는 열 안에 위치해야 한다. 그리고 열 들만이 행의 바로 아래에 올 수 있다.</li><li><strong>.row</strong>와 <strong>.col-xs-4</strong> 같은 사전 정의된 그리드 클래스들을 통해 간편하게 그리드 레이아웃 만들 수 있다.</li><li>열은 <strong>padding</strong> 으로 여백을 줄 수 있다. 패딩은 행 내에서 첫 열과 마지막 열을 위해 <strong>.row</strong> 내에 음수 마진으로 offset 되어 있다.</li><li>그리드 열은 <strong>12</strong>개의 가능한 열들을 원하는 만큼 명시하는 것으로 만들어진다.( ex) 같은 크기의 3개 열 : <strong>.col-xs-4</strong> 를 3개 사용)</li></ul><p>기타사항은 <a href=http://getbootstrap.com/css/#grid-intro>링크</a> 내용을 참조하도록 한다.</p><h4 id=그리드-옵션>그리드 옵션</h4><table><thead><tr><th></th><th>매우 작은 기기 모바일 폰( &lt; 768px)</th><th>작은 기기 태블릿 (≥768px)</th><th>중간 기기 데스크탑 (≥992px)</th><th>큰 기기 데스크탑 (≥1200px)</th></tr></thead><tbody><tr><td>그리드 적용</td><td>항상</td><td>분기점보다 크면 적용</td><td></td><td></td></tr><tr><td>컨테이너 너비</td><td>없음 (auto)</td><td>750px</td><td>970px</td><td>1170px</td></tr><tr><td>클래스 접두사</td><td>.col-xs-</td><td>.col-sm-</td><td>.col-md-</td><td>.col-lg-</td></tr><tr><td>컬럼 수</td><td>12</td><td></td><td></td><td></td></tr><tr><td>컬럼 너비</td><td>Auto</td><td>~62px</td><td>~81px</td><td>~97px</td></tr><tr><td>사이 너비</td><td>30px (컬럼의 양쪽에 15px 씩)</td><td></td><td></td><td></td></tr></tbody></table><p>세부내용은 <a href=http://getbootstrap.com/css/#grid-options>링크</a>의 표를 참조한다.</p><h4 id=기본적인-부트스트랩-그리드-구조>기본적인 부트스트랩 그리드 구조</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;row&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-sm-4&#34;</span><span style=color:#000;font-weight:700>&gt;</span>.col-sm-4<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-sm-4&#34;</span><span style=color:#000;font-weight:700>&gt;</span>.col-sm-4<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-sm-4&#34;</span><span style=color:#000;font-weight:700>&gt;</span>.col-sm-4<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><ul><li>행(row)를 생성해야 한다.(<code>&lt;div class="row"></code>)</li><li>행 안에 적절한 수의 열(column)을 추가한다. (<code>&lt;div class="col-sm-4">.col-sm-4&lt;/div></code>)</li><li>행 안의 열의 수는 항상 12열을 맞춰야 한다.</li></ul><h4 id=그리드-예제--stacked-to-horizontal>그리드 예제 : Stacked-to-horizontal</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ko&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Bootstrap Example<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;container&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h1</span><span style=color:#000;font-weight:700>&gt;</span>Grid<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h1</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>This example demonstrates a 50%/50% split on small, medium and large devices. On extra small devices, it will stack (100% width).<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Resize the browser window to see the effect.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;row&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-sm-6&#34;</span> <span style=color:#c4a000>style</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;background-color:yellow;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>br</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-sm-6&#34;</span> <span style=color:#c4a000>style</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;background-color:pink;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto.    
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p><img src=../images/bootstrap-grid-sample.png alt=bootstrap-grid-sample></p><p>결과 보기 : <a href="https://jsfiddle.net/eh5kmtt9/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=eh5kmtt9">https://jsfiddle.net/eh5kmtt9/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=eh5kmtt9</a></p><p>결과창의 좌우폭을 확대 및 축소를 해보면, 화면 사이즈에 맞춰서 열(column)이 쌓이거나(stack) 수평이 되게 늘어나는 것을 확인 할 수 있다.이와 같이 손 쉽게 반응형을 지원하고, 페이지 레이아웃을 구성할 수 있다.</p><p>그 밖의 예제들은 부트스트랩 사이트 <a href=http://getbootstrap.com/css/#grid>그리드 부분</a>에서 내용을 확인하도록 한다.</p><h3 id=다양한-스타일의-css>다양한 스타일의 CSS</h3><p>부트스트랩은 깔끔하고 잘 정돈된 느낌의 다양한 스타일의 CSS를 제공한다. 자세한 내용은 <a href=http://getbootstrap.com/css/>링크</a>의 내용을 확인하도록 한다.</p><h4 id=테이블>테이블</h4><p>다음은 부트스트랩에서 제공하는 클래스를 적용한 테이블 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ko&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Bootstrap Example<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;container&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>Contextual Classes<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Contextual classes can be used to color table rows or table cells. The classes that can be used are: .active, .success, .info, .warning, and .danger.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;table&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>thead</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>Firstname<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>Lastname<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>Email<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>thead</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tbody</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;success&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>John<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>Doe<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>example1@example.com<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;danger&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>Mary<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>Moe<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>example2@example.com<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;info&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>July<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>Dooley<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>example3@example.com<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tbody</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>결과보기 : <a href="https://jsfiddle.net/r60oymr2/3/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=r60oymr2">https://jsfiddle.net/r60oymr2/3/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=r60oymr2</a></p><p><img src=../images/bootstrap-table-sample.png alt=bootstrap-table-sample></p><p>부트스트랩에서 기본적으로 제공하는 테이블 디자인 중 하나이다.</p><h4 id=폼>폼</h4><p>다음은 부트스트랩에서 제공하는 폼의 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ko&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Bootstrap Example<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;container&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>Inline form<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Make the viewport larger than 768px wide to see that all of the form elements are inline, left aligned, and the labels are alongside.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-inline&#34;</span> <span style=color:#c4a000>role</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>for</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;email&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Email:<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;email&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control&#34;</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;email&#34;</span> <span style=color:#c4a000>placeholder</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Enter email&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>for</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;pwd&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Password:<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;password&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control&#34;</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;pwd&#34;</span> <span style=color:#c4a000>placeholder</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Enter password&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span><span style=color:#000;font-weight:700>&gt;</span> Remember me<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-default&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Submit<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>form</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>결과보기 : <a href="https://jsfiddle.net/4006oqs0/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=4006oqs0">https://jsfiddle.net/4006oqs0/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=4006oqs0</a></p><p><img src=../images/bootstrap-form-sample.png alt=bootstrap-form-sample></p><p>위의 예제는 인라인 폼(inline form)이 적용 된 예제로, 화면의 폭에 따라 입력창의 위치가 변화한다.</p><h4 id=버튼>버튼</h4><p>다음은 부트스트랩에서 제공하는 버튼 디자인이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ko&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Bootstrap Example<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;container&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>Button<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#8f5902;font-style:italic>&lt;!-- Standard button --&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-default&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Default<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#8f5902;font-style:italic>&lt;!-- Provides extra visual weight and identifies the primary action in a set of buttons --&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-primary&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Primary<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#8f5902;font-style:italic>&lt;!-- Indicates a successful or positive action --&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-success&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Success<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#8f5902;font-style:italic>&lt;!-- Contextual button for informational alert messages --&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-info&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Info<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#8f5902;font-style:italic>&lt;!-- Indicates caution should be taken with this action --&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-warning&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Warning<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#8f5902;font-style:italic>&lt;!-- Indicates a dangerous or potentially negative action --&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-danger&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Danger<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#8f5902;font-style:italic>&lt;!-- Deemphasize a button by making it look like a link while maintaining button behavior --&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-link&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Link<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>결과보기 : <a href="https://jsfiddle.net/ysohpdqh/5/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=ysohpdqh">https://jsfiddle.net/ysohpdqh/5/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=ysohpdqh</a></p><p><img src=../images/bootstrap-button-sample.png alt=bootstrap-button-sample></p><h3 id=컴포넌트>컴포넌트</h3><p>부트스트랩에서는 iconography, dropdown, input group, navigation, alerts 등의 재사용 가능한 컴포넌트를 제공하고 있다. 본 가이드에서는 몇 가지 컴포넌트만 소개한다.</p><p>그 밖의 다른 컴포넌트 들은 <a href=http://getbootstrap.com/components/>링크</a>를 통해 확인 하도록 한다.</p><h4 id=glyphicons>Glyphicons</h4><p>250개 이상의 기호가 Glyphicon Halflings 세트로 폰트 포맷에 포함되어 있다.</p><p><img src=../images/bootstrap-glyphicons.png alt=bootstrap-glyphicons></p><h5 id=사용방법>사용방법</h5><p>사용할 부분에 다음 구문을 삽입한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;glyphicon glyphicon-search&#34;</span> <span style=color:#c4a000>aria-hidden</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>위의 구문에서 원하는 Glyphicon의 <strong>class</strong>를 교체하여 사용한다.</p><p>다음은 Glyphicon을 사용한 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ko&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Bootstrap Example<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;container&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>Glyphicon Examples<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Envelope icon: <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;glyphicon glyphicon-envelope&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Envelope icon as a link:
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;glyphicon glyphicon-envelope&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Search icon: <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;glyphicon glyphicon-search&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Search icon on a button:
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-default&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;glyphicon glyphicon-search&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span> Search
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Search icon on a styled button:
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-info&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;glyphicon glyphicon-search&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span> Search
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Print icon: <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;glyphicon glyphicon-print&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Print icon on a styled link button:
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-success btn-lg&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;glyphicon glyphicon-print&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span> Print 
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>결과보기 : <a href="https://jsfiddle.net/t1tresaj/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=t1tresaj">https://jsfiddle.net/t1tresaj/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=t1tresaj</a></p><p><img src=../images/bootstrap-glyphicons-sample.png alt=bootstrap-glyphicons-sample></p><h4 id=페이지네이션pagination>페이지네이션(Pagination)</h4><p>페이지네이션 컴포넌트로 사이트나 앱을 위한 페이지네이션 링크를 제공한다.</p><h5 id=사용방법-1>사용방법</h5><p>페이지네이션의 경우 순서가 없는 목록(<code>unordered list</code>, <code>&lt;ul></code> )에 <strong>.pagination</strong> class 클래스를 추가한다.</p><p>다음은 페이지네이션을 사용한 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ko&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Bootstrap Example<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;container&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>Pagination - Active State<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Add class .active to let the user know which page he/she is on:<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>ul</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;pagination&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#&#34;</span><span style=color:#000;font-weight:700>&gt;</span>1<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;active&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#&#34;</span><span style=color:#000;font-weight:700>&gt;</span>2<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#&#34;</span><span style=color:#000;font-weight:700>&gt;</span>3<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#&#34;</span><span style=color:#000;font-weight:700>&gt;</span>4<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#&#34;</span><span style=color:#000;font-weight:700>&gt;</span>5<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>ul</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>결과보기 : <a href="https://jsfiddle.net/L860z1cy/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=L860z1cy">https://jsfiddle.net/L860z1cy/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=L860z1cy</a></p><p><img src=../images/bootstrap-pagination-sample.png alt=bootstrap-pagination-sample></p><p>위의 예제에서 <strong>리스트 아이템</strong>(<code>list item</code>, <code>&lt;li></code>)에 <strong>.active</strong> class를 추가하면, 해당 링크는 활성 상태가 된다.</p><p>클릭할 수 없는 링크일 경우 .disable을 사용하면 비활성 상태로 된다.</p><h3 id=자바스크립트>자바스크립트</h3><p>부트스트랩 내에 존재하는 UI 컴포넌트에 동적인 인터랙션이 필요한 컴포넌트는 12개가 넘는 jQuery plugin을 통하여 컨트롤 할 수 있도록 되어있다.</p><p>단 컴포넌트를 주의할 점은 모든 플러그인은 jQuery에 의존하기 때문에 jQuery는 반드시 플러그인 파일 전에 포함되어야 한다.</p><p>본 가이드에서는 모달(modal)에 대한 가이드만 제공한다.</p><h4 id=모달modal>모달(Modal)</h4><p>모달 플러그인은 현재 페이지의 상단에 표시되는 대화 상자 / 팝업 창이다.</p><ul><li>다른 모달이 보이는 동안에 모달은 열리지 않는다.</li><li>다른 컴포넌트가 모달의 모습이나 기능에 영향을 끼치지 않도록 항상 모달의 HTML 코드를 문서 상단에 위치한다.</li><li>모바일 기기에서는 제약사항이 있다.</li><li>플러그인 사용 시 개별적(<strong>modal.js</strong>)으로 include하거나, 전체(<strong>bootstrap.js</strong> 또는 <strong>bootstrap.min.js</strong>)를 include하여 사용할 수 있다.</li></ul><h5 id=사용법>사용법</h5><p>다음은 기본적인 modal을 만드는 방법을 보여주는 예제이다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>lang</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;ko&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Bootstrap Example<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>charset</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;utf-8&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js&#34;</span> 
</span></span><span style=display:flex><span>         <span style=color:#c4a000>integrity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS&#34;</span> <span style=color:#c4a000>crossorigin</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;anonymous&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;container&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>Modal Example<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h2</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#8f5902;font-style:italic>&lt;!-- Trigger the modal with a button --&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-info btn-lg&#34;</span> <span style=color:#c4a000>data-toggle</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;modal&#34;</span> <span style=color:#c4a000>data-target</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#myModal&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Open Modal<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#8f5902;font-style:italic>&lt;!-- Modal --&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;modal fade&#34;</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;myModal&#34;</span> <span style=color:#c4a000>role</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;dialog&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;modal-dialog&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#8f5902;font-style:italic>&lt;!-- Modal content--&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;modal-content&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;modal-header&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                     <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;close&#34;</span> <span style=color:#c4a000>data-dismiss</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;modal&#34;</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#ce5c00>&amp;times;</span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                     <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h4</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;modal-title&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Modal Header<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h4</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;modal-body&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                     <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Some text in the modal.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;modal-footer&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                     <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-default&#34;</span> <span style=color:#c4a000>data-dismiss</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;modal&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Close<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>결과보기 : <a href="https://jsfiddle.net/eqfmxd3e/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=eqfmxd3e">https://jsfiddle.net/eqfmxd3e/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=eqfmxd3e</a></p><p><img src=../images/bootstrap-modal-sample.png alt=bootstrap-modal-sample></p><p>위의 예제의 구조를 보면 크게 <strong>Triger</strong>, <strong>Modal</strong>, <strong>Modal content</strong>로 구성된 것을 확인할 수 있다.</p><ul><li>Trigger<ul><li>모달 윈도우를 호출하려면 트리거가 필요하다.</li><li>보통 버튼이나 링크를 트리거로 사용한다.</li><li>두 개의 <strong>data-</strong>* 속성을 include 해야 한다.<ul><li>data-toggle=<strong>modal</strong> : 모달 윈도우를 연다.</li><li>data-target=<strong>#myModal</strong> : 모달 윈도우를 열 id</li></ul></li></ul></li><li>Modal<ul><li>모달의 부모 <code>&lt;div></code>에는 모달(<strong>myModal</strong>)을 트리거 하기 위해 사용되는 <strong>data-target</strong>의 속성 값과 동일한 ID를 가져야 한다.</li><li><strong>.modal</strong> 클래스는 content에서 modal의 <code>&lt;div></code>를 식별하고, 그것을 focus로 가져온다.</li><li><strong>.fade</strong> 클래스는 모달 안과 밖으로 fade 전환 효과를 추가해 준다. 만약 효과를 사용하지 않으면 이 클래스를 삭제한다.</li><li><strong>role=dialog</strong> 속성은 스크린 리더를 사용하는 사람들에 대한 접근성을 향상시킨다.</li><li><strong>.modal-dialog</strong> 클래스는 모달의 적절한 폭과 여백을 설정한다.</li></ul></li><li>Modal content<ul><li><strong>modal-content</strong> 클래스의 <code>&lt;div></code>는 모달의 스타일(border, background-color 등…)을 지정한다. 여기에 모달의 header, body, footer를 추가한다.</li><li><strong>.modal-header</strong> 클래스는 모달의 header 스타일을 정의하는데 사용한다.</li><li>header 안의 <code>&lt;button></code>에는 <strong>data-dismiss=modal</strong> 속성이 정의되어 있는데 이는 클릭하면 모달을 닫는 기능을 수행한다.</li><li><strong>.close</strong> 클래스는 닫기 버튼의 스타일이다.</li><li><strong>.modal-title</strong> 클래스는 header의 적절한 라인 높이의 스타일이다.</li><li><strong>.modal-body</strong> 클래스는 모달의 body 스타일을 정의하는데 사용한다. 여기에 다른 HTML markup(paragraphs, images, videos, 등…)들을 추가한다.</li><li><strong>.modal-footer</strong> 클래스는 모달의 footer 스타일을 정의하는데 사용한다. 기본적으로 우측 정렬로 되어있다.</li></ul></li></ul><h2 id=참고자료>참고자료</h2><ul><li><a href=http://getbootstrap.com/>부트스트랩 사이트</a></li><li><a href=https://getbootstrap.kr/>부트스트랩 한글번역 사이트</a></li><li><a href=http://www.w3schools.com/bootstrap/default.asp>w3schools bootstrap Tutorial</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-b243bf573fb36b506ca8d9b28e282192>30 - UX/UI Controller Component</h1><div class=lead>전자정부는 스마트 전자정부 기반 시스템 구축을 위해 UI/UX Controller Component, HTML5, CSS3, JavaScript Module App Framework를 활용하며, jQuery Mobile을 오픈소스로 채택하여 이를 커스터마이징한다. UI 레이어에서는 터치 최적화된 UI 컨트롤러 컴포넌트와 모바일 특화 HTML5 태그, CSS3를 통해 유연한 사용자 환경을 제공하며, JavaScript와 JSON 구조로 효율적인 UX/UI 컨트롤을 지원한다.</div><h1 id=uxui-controller-component>UX/UI Controller Component</h1><h2 id=개요>개요</h2><p>전자정부에서 효율적인 스마트 전자정부 기반시스템의 구축•운영을 통해 전자정부의 서비스 품질 UX 레이어는 UI/UX Controller Component, JavaScript Module App Framework, HTML5, CSS3 서비스를 제공한다. 오픈소스는 JQuery Mobile을 채택하였으며 jQuery Mobile은 html5, CSS3, javascript를 제공한다. 오픈 소스를 Customizing 하여 UI레이어의 기능을 사용 하며 내용은 아래와 같다 UI/UX Controller Component 모바일 웹 사용자 환경(UX/UI)에 대한 유연한 대응을 위해 Touch Optimized 된 필수 UI 컨트롤러 컴포넌트를 제공한다. HTML5는 모바일 웹 페이지 구성 시 사용 할 수 있는 마크업 언어로서 모바일 특화 태그 밑 디바이스 API를 제공한다. CSS3는 모바일 기기 및 브라우저에 따라 적합한 컴포넌트가 보여지는 기능을 제공한다. 또한 JavaScript Module App Framework UX/UI controller component의 효율성을 보장하는 javascript 밑 Json 구조를 제공한다.</p><h2 id=설명>설명</h2><p>UX 처리 레이어는 모바일 환경을 화면을 담당하는 레이어로 화면 구성을 위한 Button, Panel, Internal/Externel Link, Process Dialog/Bar, Menu, Date/Time Picker, Check, Radio, Label/Text, TABS, Form, Grid, List View ICon, Selector, Collapsible Block를 제공한다.모바일 화면에 특화된 16개의 컴포넌트를 제공한다</p><h3 id=모바일-페이지-선언>모바일 페이지 선언</h3><p>jQuery Mobile 은 HTML5의 doctype 으로 선언하여야 하며, jQueryMobile에서 사용하는 CSS, JS(jQuery, jQueryMobile)를 Import 함으로서 사용 할 수 있다.</p><p>jQuery Mobile은 jQuery Core를 사용하고 있다.</p><h4 id=모바일-page-header>모바일 Page Header</h4><p>Page의 Header 선언 부분에 모바일 실행환경을 import한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>eGovFrame<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;viewport&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/css/egovframework/mbl/cmm/jquery.mobile-1.3.2.css&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/css/egovframework/mbl/cmm/EgovMobile-1.3.2.css&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/js/egovframework/mbl/cmm/jquery-1.9.1.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/js/egovframework/mbl/cmm/jquery.mobile-1.3.2.min.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/js/egovframework/mbl/cmm/EgovMobile-1.3.2.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> ...
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><h4 id=모바일-page-body>모바일 Page Body</h4><p>jQuery Mobile 의 Page 구조는 div를 사용하여 표현하며 html5의 ‘data-*&rsquo; 속성을 이용하여 구조를 구분한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>data-role</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>“page”</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>data-role</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>“header”</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>data-role</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>“content”</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>data-role</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>“footer”</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><h4 id=모바일-page-link>모바일 Page Link</h4><p>jQuery Mobile 은 하나의 페이지를 &lt;div data-role=“page”> 단위로 관리 하며 한 HTML 내에 여러 &lt;div data-role=“page”> 가 있을 경우 제일 상단의 div page를 첫 화면으로 인식한다. 이들 내부 페이지 간 이동은 링크 속성에 #pageName을 사용해서 가능 하다. jQuery Mobile 은 외부 페이지 이동시 anchor 태그의 링크를 가로채서 Ajax 로 해당 URL 호출 후 호출 된 Page 의 &lt;div data-role=“page”> 영역만 가져와서 호출 한 HTML 페이지의 DOM 에 해당 내용을 추가 한다.</p><ul><li>Ajax 로 호출된 page 의 CSS, JS 는 가져 오지 않기 때문에 호출한 Page는 호출된 Page 의 JS, CSS를 포함하고 있어야 한다.</li><li>외부페이지 이동 시 ajax 통신을 하고 싶지 않은 경우에는 data-ajax=“false”를 사용한다.</li></ul><h3 id=ux-component>UX Component</h3><table><thead><tr><th><strong>컴포넌트</strong></th><th><strong>제공기능</strong></th></tr></thead><tbody><tr><td><strong>Button</strong></td><td><strong>설명</strong>: 명령 수행, 옵션 선택, 다른 대화 상자 열기 등에 사용하는 컴포넌트 제공</td></tr><tr><td></td><td><strong>형태</strong>: 둥근 형(radius: 1em), 사각형(radius: 0em)</td></tr><tr><td></td><td><strong>배치</strong>: vertical group, horizontal group</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td></td><td><strong>높이</strong>: normal(39px), small (28px)</td></tr><tr><td></td><td><strong>넓이</strong>: 화면에 맞게 , 텍스트에 맞게</td></tr><tr><td><strong>Panel</strong></td><td><strong>설명</strong>: Header/footer 와 함께 페이지를 구성하는 요소</td></tr><tr><td></td><td><strong>무늬</strong>: 격자 형태 무늬 제공</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 회색, 연한회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td><strong>Internal / External Link</strong></td><td><strong>설명</strong>: 표준 링크 기능을 제공하며 기본적으로 Ajax 를 사용한 링크 방식 제공</td></tr><tr><td></td><td><strong>링크</strong>: 페이지 내부링크, 도메인 내부 링크, 외부 링크, 이메일 링크, 폰 링크, 에러 페이지 링크</td></tr><tr><td><strong>Label / Text</strong></td><td><strong>설명</strong>: 색상, 배치, 크기, 폰트를 지정 할 수 있는 가이드 제공</td></tr><tr><td></td><td><strong>색상</strong>: 초록, 빨강, 파랑</td></tr><tr><td></td><td><strong>배치</strong>: 왼쪽, 중간, 오른쪽</td></tr><tr><td></td><td><strong>크기</strong>: 15px, 25px, 30px</td></tr><tr><td></td><td><strong>폰트</strong>: helvetica, verdana, tahoma</td></tr><tr><td><strong>Tabs</strong></td><td><strong>설명</strong>: Header와 footer 에 사용되며 탭 버튼으로 문서간 이동 기능 제공</td></tr><tr><td></td><td><strong>형태</strong>: round tab(radius: 0.250em), normal tab(radius: 0em)</td></tr><tr><td></td><td><strong>배치</strong>: 1, 1/2, 1/3, 1/4, 1/5, 1/2 다중행 tab</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td><strong>Form</strong></td><td><strong>설명</strong>: HTML Form 요소를 모바일 환경에 최적화하여 제공</td></tr><tr><td></td><td><strong>요소</strong>: Text inputs, Search inputs, Sliders, Switches, Radio buttons, Check boxes, Selectors</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td><strong>Menu</strong></td><td><strong>설명</strong>: Dialog, Grid, List, Collapsible 컴포넌트를 사용하여 메뉴 구성 기능 제공</td></tr><tr><td></td><td><strong>효과</strong>: slide, slideup, slidedown, pop, fade, flip, turn, flow, slidefade</td></tr><tr><td></td><td><strong>형태</strong>: Dialog, Grid, List, Collapsible</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td><strong>Processing Dialog / Bar</strong></td><td><strong>설명</strong>: 페이지 전환 간 진행 상태를 확인 할 수 있는 Progress Dialog/Bar 제공</td></tr><tr><td></td><td><strong>형태</strong>: Processing Dialog, Processing Bar</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td><strong>Dialog</strong></td><td><strong>설명</strong>: 사용자와 상호작용할 수 있는 Dialog 기능 제공</td></tr><tr><td></td><td><strong>형태</strong>: Dialog, Action Sheet, Overlay, Alert, Prompt, Confirm</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td><strong>Grid View</strong></td><td><strong>설명</strong>: Grid 형태로 컨텐츠를 배치할 수 있는 컴포넌트 제공</td></tr><tr><td></td><td><strong>배치</strong>: 1/2, 1/3, 1/4, 1/5, 가변 Grid View</td></tr><tr><td><strong>Table / List View</strong></td><td><strong>설명</strong>: Table/List 형태로 컨텐츠를 배치할 수 있는 컴포넌트 제공</td></tr><tr><td></td><td><strong>형태</strong>: Read-only list, Link list</td></tr><tr><td></td><td><strong>기능</strong>: Nested List, Numbered List, Split Button, List Divider, Count Bubble, Thumbnail, List icon, Content Formatting, Search Filter Bar, Change Mode List, Checked List</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td><strong>Date / Time Picker</strong></td><td><strong>설명</strong>: 날짜와 시간을 선택할 수 있는 Picker 제공</td></tr><tr><td></td><td><strong>형태</strong>: Android Date Picker, Popup Calendar, Android Time Picker, Flip Picker(Date, Time)</td></tr><tr><td><strong>Check/ Radio</strong></td><td><strong>설명</strong>: Check/Radio 형태로 항목을 선택할 수 있는 기능 제공</td></tr><tr><td></td><td><strong>배치</strong>: vertical group, horizontal group</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td><strong>Icon</strong></td><td><strong>설명</strong>: 모바일 어플리케이션에 가장 많이 사용되는 아이콘 제공</td></tr><tr><td></td><td><strong>형태</strong>: arrow-l, arrow-r, arrow-u, arrow-d, delete, plus, minus, check, gear, refresh, forward, back, grid, star, alert, info, search, home, phone, mail, gps, audio, camera, file, mic, explorer</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td><strong>Selector / Switch</strong></td><td><strong>설명</strong>: Selector/Switch 형태로 항목을 선택할 수 있는 기능 제공</td></tr><tr><td></td><td><strong>효과</strong>: pop-up, list</td></tr><tr><td></td><td><strong>기능</strong>: 다중선택, 단일 선택</td></tr><tr><td></td><td><strong>모양</strong>: 둥근 형(radius: 1em), 사각형(radius: 0em)</td></tr><tr><td></td><td><strong>넓이</strong>: 화면에 맞게, 텍스트에 맞게</td></tr><tr><td></td><td><strong>효과</strong>: Shadow 적용, Shadow 제거</td></tr><tr><td></td><td><strong>형태</strong>: 비그룹, 그룹</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr><tr><td><strong>Collapsible Block</strong></td><td><strong>설명</strong>: 콘텐츠 영역을 접었다 펼 수 있는 컨트롤 기능 제공</td></tr><tr><td></td><td><strong>형태</strong>: normal, Group, Nested</td></tr><tr><td></td><td><strong>색상</strong>: 검정, 파랑, 회색, 흰색, 노랑, 빨강, 초록</td></tr></tbody></table><h3 id=ux-컴포넌트별-브라우저-호환성-준수-지침-기준>UX 컴포넌트별 브라우저 호환성 준수 지침 기준</h3><ol><li>근거 기준: 전자정부서비스 호환성 준수지침(행정안전부고시 제2010-40호, 2010. 6. 24)</li><li>개정 이유: 모바일 전자정부 서비스 제공시 접근성 제고등을 위하여 공공기관이 준수해야 할 사항을 규정</li><li>주요 개정 내용<ul><li>국민들이 다양한 모바일 기기를 사용할 수 있도록 모바일 ‘앱’방식보다 모바일’웹’방식을 권고</li><li>모바일 웹 방식 개발을 위한 기술 표준 지침<ul><li>최소3종 이상 웹 브라우저에서 동등한 서비스 제공</li><li>국제 표준화 기구에서 제공하는 표준 사용 의무화</li></ul></li></ul></li><li>전자정부 모바일 서비스 제공 원칙<ul><li>다양한 스마트폰 사용자들이 모두 혜택을 받을 수 있도록 모바일 웹 방식의 개발을 권장</li><li>모바일 공통컴포넌트 별 지원 브라우저(호환성) 참조</li></ul></li></ol><h3 id=ux-컴포넌트-별-지원-브라우저-호환성>UX 컴포넌트 별 지원 브라우저 (호환성)</h3><p><strong>테스트 디바이스</strong></p><p><img src=../images/img_test_device_wbg.png alt=img_test_device></p><p><strong>테스트 브라우저</strong></p><p><img src=../images/test_browser.png alt=test_browser></p><p><strong>모바일 표준프레임워크 사용자경험(UX)지원 브라우저 내용</strong></p><p><img src=../images/table_support.png alt=table_support></p><h2 id=참고자료>참고자료</h2><p><a href=http://m.egovframe.go.kr/mguide3.5/>모바일 실행환경 사용자경험(UX)지원기능 가이드</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-7293ece693e0270846af1dfc6d4eca30>31 - HTML5 CSS3.0 JavaScript Module App Framework 기본 활용</h1><div class=lead>전자정부는 효율적인 스마트 전자정부 시스템 구축을 위해 UI/UX Controller Component, HTML5, CSS3, JavaScript Module App Framework를 제공하며, 이 과정에서 jQuery Mobile을 활용하여 모바일 웹 사용자 경험을 최적화한다. Ajax 기반의 페이지 이동 및 다양한 이벤트와 메서드를 지원하여 반응형 모바일 애플리케이션 개발을 용이하게 한다.</div><h1 id=html5-css30-javascript-module-app-framework-기본-활용>HTML5 CSS3.0 JavaScript Module App Framework 기본 활용</h1><h2 id=개요>개요</h2><p>전자정부에서 효율적인 스마트 전자정부 기반 시스템의 구축•운영을 위해 전자정부의 서비스 품질 UX 레이어로 <strong>UI/UX Controller Component</strong>, <strong>HTML5</strong>, <strong>CSS3</strong>, <strong>JavaScript Module App Framework</strong> 서비스를 제공한다.
오픈소스는 JQuery Mobile을 채택하였으며 jQuery Mobile은 html5, CSS3, javascript를 제공한다. 이를 Customizing 하여 UI 레이어의 기능을 사용하며 내용은 아래와 같다.</p><ul><li><strong>UI/UX Controller Component</strong> : 모바일 웹 사용자 환경(UX/UI)에 대한 유연한 대응을 위해 Touch Optimized 된 필수 UI 컨트롤러 컴포넌트를 제공한다.</li><li><strong>HTML5</strong> : 모바일 웹 페이지 구성 시 사용할 수 있는 마크업 언어로서 모바일 특화 태그 및 디바이스 API를 제공한다.</li><li><strong>CSS3</strong> : 모바일 기기 및 브라우저에 따라 적합한 컴포넌트가 보이게 하는 기능을 제공한다.</li><li><strong>JavaScript Module App Framework</strong> : UX/UI controller component의 효율성을 보장하는 javascript 및 Json 구조를 제공한다.</li></ul><h2 id=설명>설명</h2><h3 id=기본-활용-구조>기본 활용 구조</h3><p>전자정부 모바일 표준프레임워크 실행환경은 기존 전자정부 표준프레임워크의 디렉터리 구조 및 표준을 준수하고 있으며, 모바일 웹 개발에 편의를 제공하기 위해 하위 디렉터리 구조를 다음과 같이 구성하고 있다.</p><ul><li><p>프로젝트의 하위 폴더인 ‘src’에 실행환경을 지원하는 라이브러리 및 JSP 파일이 존재한다. 라이브러리는 CSS, JavaScript 및 이미지 파일로 구성되어 있다.</p><p><img src=../images/html5etc-mrtelib.jpg alt="전자정부 모바일 표준프레임워크 실행환경 라이브러리 경로 이미지"></p></li><li><p>전자정부 모바일 표준 프레임워크는 CSS 및 JavaScript를 이용하여 실행환경을 제공하며 CSS, javascript, image는 각각 유기적으로 연결되어 있다.</p><p><img src=../images/html5etc-mrtelib2.jpg alt="전자정부 모바일 표준프레임워크 실행환경의 CSS, JavaScript, Images 설명"></p></li><li><p>HTML5 <tag>패턴인 ‘data-role’ 속성에 적용된 값에 따라 Page, Header, Content, Footer 영역으로 구분된다.</p><p><img src=../images/html5etc-mrtelib3.jpg alt="전자정부 모바일 표준프레임워크 실행환경의 영역 설명"></p></li></ul><h3 id=javascript-구조와-ajax-처리>javascript 구조와 Ajax 처리</h3><p>모바일 페이지 이동은 기본적으로 Ajax를 이용하여 처리된다. 이는 모바일에 최적화된 화면 전환 효과를 주기 위함으로 옵션 설정을 통해 변경 가능하다.</p><ul><li><p>페이지 내부 이동</p><ul><li><p>하나의 HTML 파일 안에 여러 page가 선언되어 있는 경우에 사용할 수 있는 방법으로 모바일 page 구성의 기본 방식이다.</p></li><li><p>페이지 내부 이동은 Ajax 통신을 사용하며 page로 선언된 div 태그의 id 값을 링크의 href 속성 값(#pageId)으로 적용하여 사용 가능하다. (한 HTML 내에 여러 page가 선언되어 있을 경우 제일 상단의 page를 첫 화면으로 인식한다.)</p></li><li><p>페이지 내부 이동은 Ajax 방식을 기본으로 하기 때문에 연속적으로 여러 번 사용하면 DOM 객체를 제대로 못 불러 올 경우가 있으므로 외부 페이지 이동을 권장한다.</p><p><img src=../images/html5etc-mrtelib4.jpg alt="전자정부 모바일 표준프레임워크 실행환경 페이지 내부 이동"></p></li></ul></li><li><p>페이지 외부 이동</p><ul><li>페이지 외부 이동은 Ajax 통신을 이용하며 Ajax로 호출한 html의 data-role=“page” 영역만 읽어 들여서 호출한 html 페이지의 DOM 요소에 추가해 준다. (페이지 내부 이동과 유사 한 구조로 DOM 관리)<ul><li><p>Ajax로 호출된 HTML의 page 영역만 가져오기 때문에 호출된 페이지에서 사용하는 JavaScript, CSS 등은 호출을 한 HTML 내에 존재해야 한다.</p></li><li><p>Ajax 통신을 사용하고 싶지 않은 경우 Internal / External UX Component를 참조하여 변경 가능하다.</p><p><img src=../images/html5etc-mrtelib5.jpg alt="전자정부 모바일 표준프레임워크 실행환경 페이지 외부 이동"></p></li></ul></li></ul></li><li><p>mobileinit 이벤트와 기본 환경 설정</p><ul><li>전자정부 모바일 표준프레임워크는 모바일 애플리케이션이 시작될 때 각종 초기화 작업이 수행될 수 있도록 mobileinit 이벤트를 통하여 기본 환경 설정을 변경할 수 있도록 한다.</li><li>mobileinit 이벤트는 page가 시작되자마자 발생하는 이벤트로 첫 번째 초기화 작업 시 실행되며, 함수 내부에 여러 이벤트를 적용하여 사용할 수 있다.<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>document</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>bind</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;mobileinit&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(){</span>
</span></span><span style=display:flex><span>      <span style=color:#8f5902;font-style:italic>//apply overrides here
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div></li><li>mobileinit 이벤트는 실행 즉시 발생하므로 jquerymoible.js가 로드되기 전에 바인딩 되어야 한다. 다시 말해 mobileinit 이벤트의 위치는 jquery 라이브러리와 jquerymobile 라이브러리 사이에 위치 해야 한다.<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;jquery.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;custom-scripting.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;jquery-mobile.js&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div></li></ul></li><li><p>$.mobile 객체를 통해 재설정이 가능한 주요 기본 환경설정</p><table><thead><tr><th>기본 환경설정</th><th>설명</th></tr></thead><tbody><tr><td>loadingMessage (string, default: “loading”)</td><td>페이지가 로딩될 때 나타나는 텍스트를 설정한다. ‘false’로 설정하면 로딩 메시지가 나타나지 않는다.</td></tr><tr><td>pageLoadErrorMessage (string, default: “Error Loading Page”)</td><td>Ajax 방식의 페이지 이동에서 페이지를 로드하지 못했을 경우 나타나는 에러 메시지의 텍스트를 설정한다.</td></tr><tr><td>defaultDialogTransition (string, default: &lsquo;pop&rsquo;)</td><td>다이얼로그에서 Ajax 방식을 통한 페이지 전환에 관여하는 기본 환경설정을 변경한다. defaultDialogTransition 옵션을 ‘none’으로 설정하면 화면전환 효과가 적용되지 않는다.</td></tr><tr><td>defaultPageTransition (string, default: &lsquo;slide&rsquo;)</td><td>Ajax 방식을 사용하는 페이지 전환에 관여하는 기본 환경설정을 변경한다. defaultPageTransition 옵션을 ‘none’으로 설정하면 화면전환 효과가 적용되지 않는다.</td></tr><tr><td>ajaxEnabled (boolean, default: true)</td><td>모든 링크 이동이나 폼 전송은 기본적으로 Ajax 방식을 기반으로 하고 있다. Ajax가 아니라 일반 방식으로 페이지 이동을 처리하고 싶다면 이 값을 ‘false’로 지정한다.</td></tr></tbody></table></li><li><p>이벤트</p><ul><li><p>전자정부 모바일 표준프레임워크는 스마트 기반 모바일 환경에 적합한 이벤트를 선별하여 제공한다. Touch, Mouse, Window 영역의 다양한 이벤트를 지원 가능 여부에 따라 선택적으로 이용하기 때문에 모바일 환경과 데스크톱(Desktop) 환경 모두에서 사용 가능하다. live() 또는 bind() 메서드를 이용하여 여러 이벤트를 함께 사용할 수 있다.</p></li><li><p>지원 터치 이벤트</p><table><thead><tr><th>터치 이벤트</th><th>설명</th></tr></thead><tbody><tr><td>tap</td><td>Touch가 감지되면 즉시 발생하는 이벤트이다.</td></tr><tr><td>taphold</td><td>tap을 일정 시간 이상 지속했을 때 발생하는 이벤트이다.</td></tr><tr><td>swipe</td><td>30pixel 이상의 수평 방향이나 20pixel 이상의 수직 방향으로 드래그(drag) 되면 발생하는 이벤트이다.</td></tr><tr><td>swipeleft</td><td>swipe 이벤트가 왼쪽으로 일어났을 때 발생하는 이벤트이다.</td></tr><tr><td>swiperight</td><td>swipe 이벤트가 오른쪽으로 일어났을 때 발생하는 이벤트이다.</td></tr></tbody></table></li><li><p>지원 화면 방향 전환 및 스크롤 이벤트</p><table><thead><tr><th>화면 방향 전환 및 스크롤 이벤트</th><th>설명</th></tr></thead><tbody><tr><td>orientationChange</td><td>기기의 방향이 수평 또는 수직으로 바뀌었을 때 발생하는 이벤트이다. orientationChange 이벤트가 지원되지 않을 경우에는 resize 이벤트가 자동으로 bind 된다.</td></tr><tr><td>scrollstart</td><td>스크롤(scroll)이 시작되면 발생하는 이벤트이다. (iOS 기기는 스크롤 중에는 DOM 을 변경하지 않고 queue에 저장해두었다가 스크롤이 끝난 후에 변경한다.)</td></tr><tr><td>scrollstop</td><td>스크롤이 끝나면 발생하는 이벤트이다.</td></tr></tbody></table></li><li><p>지원 페이지 이벤트</p><table><thead><tr><th>페이지 이벤트</th><th>설명</th></tr></thead><tbody><tr><td>pagebeforecreate</td><td>페이지가 초기화되기 직전에 발생하며 페이지 로딩 시 가장 먼저 발생하는 이벤트이다. 페이지 생성 시에만 이벤트가 발생한다.</td></tr><tr><td>pagecreate</td><td>페이지 초기화가 끝나면 발생하는 이벤트이다. 페이지 생성이 완료된 시점에만 이벤트가 발생한다.</td></tr><tr><td>pagebeforeshow</td><td>화면전환이 일어나기 전, 즉 페이지가 보이기 전에 매번 발생하는 이벤트이다.</td></tr><tr><td>pageshow</td><td>화면전환이 완료되었거나 페이지가 보인 후에 매번 발생하는 이벤트이다.</td></tr><tr><td>pagebeforehide</td><td>화면전환이 일어나기 전, 즉 페이지가 숨겨지기 전에 매번 발생하는 이벤트이다.</td></tr></tbody></table></li><li><p>Visual Mouse event</p><table><thead><tr><th>페이지 이벤트</th><th>설명</th></tr></thead><tbody><tr><td>vmouseover</td><td>터치 이벤트 또는 mouseover가 발생할 때 나타나는 이벤트이다.</td></tr><tr><td>vmousedown</td><td>터치 이벤트 또는 mousedown이 발생할 때 나타나는 이벤트이다.</td></tr><tr><td>vmousemove</td><td>터치 이벤트 또는 mousemove가 발생할 때 나타나는 이벤트이다.</td></tr><tr><td>vmouseup</td><td>터치 이벤트 또는 mouseup이 발생할 때 나타나는 이벤트이다.</td></tr></tbody></table></li></ul></li><li><p>메서드 & 유틸리티</p><ul><li>전자정부 모바일 표준프레임워크는 $.mobile 객체에 대한 메서드와 속성들을(properties) 제공한다.<table><thead><tr><th>메서드</th><th>설명</th></tr></thead><tbody><tr><td>$.mobile.changePage(method)</td><td>프로그램 코드 상에서 페이지를 이동할 수 있도록 지원하는 메서드이다. 주로 화면전환, 페이지 로딩 등의 기능이 가능한 환경에서 링크 클릭이나 폼 전송을 할 때 내부적으로 사용된다.</td></tr><tr><td>$.mobile.loadPage(method)</td><td>외부 페이지를 로드하고, DOM에 추가한다. 이 메서드는 첫 번째 인자로 URL이 올 때 changePage() 함수를 통해 내부적으로 호출된다. 이 함수는 현재 활성화된 페이지에는 영향을 주지 않고, 백그라운드에서 페이지를 로드 할 때 사용된다.</td></tr><tr><td>$.mobile.loading(“show”)</td><td>페이지 로딩 메시지를 보여준다.</td></tr><tr><td>$.mobile.loading(“hide”)</td><td>페이지 로딩 메시지를 숨긴다.</td></tr></tbody></table></li></ul></li></ul><h2 id=참고자료>참고자료</h2><ul><li>🌏 <a href=https://www.w3.org/TR/html5/>HTML5</a></li><li>🌏 <a href=https://www.w3.org/TR/css3-selectors/>CSS3</a></li><li>🌏 <a href=https://jquerymobile.com>JavaScript Module App Framework</a></li></ul></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/eGovFramework/egovframe-docs aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2016&ndash;2024
<span class=td-footer__authors>eGovFrame | <a href="https://www.egovframe.go.kr/home/sub.do?menuNo=23">Apache 2.0</a> |</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href="https://www.egovframe.go.kr/home/sub.do?menuNo=77" target=_blank rel=noopener>개인정보 보호 정책</a></span></div></div></div></footer></div><script src=/egovframe-docs/js/main.min.4eb19af2236072614b7d308c10176f918f1b447443492377d98b5b2c5e44aac3.js integrity="sha256-TrGa8iNgcmFLfTCMEBdvkY8bRHRDSSN32YtbLF5EqsM=" crossorigin=anonymous></script>
<script defer src=/egovframe-docs/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script>
<script src=/egovframe-docs/js/tabpane-persist.js></script></body></html>